!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.CodeMirror=t()}(this,function(){"use strict";function gu(n){return new RegExp("(^|\\s)"+n+"(?:$|\\s)\\s*")}function ci(n){for(var t=n.childNodes.length;t>0;--t)n.removeChild(n.firstChild);return n}function ct(n,t){return ci(n).appendChild(t)}function i(n,t,i,r){var u=document.createElement(n),f;if(i&&(u.className=i),r&&(u.style.cssText=r),"string"==typeof t)u.appendChild(document.createTextNode(t));else if(t)for(f=0;f<t.length;++f)u.appendChild(t[f]);return u}function kr(n,t,r,u){var f=i(n,t,r,u);return f.setAttribute("role","presentation"),f}function li(n,t){if(3==t.nodeType&&(t=t.parentNode),n.contains)return n.contains(t);do if(11==t.nodeType&&(t=t.host),t==n)return!0;while(t=t.parentNode)}function fi(){var n;try{n=document.activeElement}catch(t){n=document.body||null}for(;n&&n.shadowRoot&&n.shadowRoot.activeElement;)n=n.shadowRoot.activeElement;return n}function gi(n,t){var i=n.className;gu(t).test(i)||(n.className+=(i?" ":"")+t)}function cs(n,t){for(var r=n.split(" "),i=0;i<r.length;i++)r[i]&&!gu(r[i]).test(t)&&(t+=" "+r[i]);return t}function ls(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t)}}function nr(n,t,i){t||(t={});for(var r in n)!n.hasOwnProperty(r)||!1===i&&t.hasOwnProperty(r)||(t[r]=n[r]);return t}function at(n,t,i,r,u){var f,e,o;for(null==t&&-1==(t=n.search(/[^\s\u00a0]/))&&(t=n.length),f=r||0,e=u||0;;){if(o=n.indexOf("\t",f),o<0||o>=t)return e+(t-f);e+=o-f;e+=i-e%i;f=o+1}}function d(n,t){for(var i=0;i<n.length;++i)if(n[i]==t)return i;return-1}function as(n,t,i){for(var f,e,r=0,u=0;;){if(f=n.indexOf("\t",r),-1==f&&(f=n.length),e=f-r,f==n.length||u+e>=t)return r+Math.min(e,t-u);if(u+=f-r,u+=i-u%i,r=f+1,u>=t)return r}}function vs(n){for(;es.length<=n;)es.push(s(es)+" ");return es[n]}function s(n){return n[n.length-1]}function de(n,t){for(var r=[],i=0;i<n.length;i++)r[i]=t(n[i],i);return r}function vb(n,t,i){for(var r=0,u=i(t);r<n.length&&i(n[r])<=u;)r++;n.splice(r,0,t)}function pl(){}function wl(n,t){var i;return Object.create?i=Object.create(n):(pl.prototype=n,i=new pl),t&&nr(t,i),i}function ys(n){return/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||wtt.test(n))}function ge(n,t){return t?!!(t.source.indexOf("\\w")>-1&&ys(n))||t.test(n):ys(n)}function bl(n){for(var t in n)if(n.hasOwnProperty(t)&&n[t])return!1;return!0}function ps(n){return n.charCodeAt(0)>=768&&btt.test(n)}function kl(n,t,i){for(;(i<0?t>0:t<n.length)&&ps(n.charAt(t));)t+=i;return t}function nf(n,t,i){for(var f,r,u=t>i?-1:1;;){if(t==i)return t;if(f=(t+i)/2,r=u<0?Math.ceil(f):Math.floor(f),r==t)return n(r)?t:i;n(r)?i=r:t=r+u}}function yb(n,t,r){var u=this,f;this.input=r;u.scrollbarFiller=i("div",null,"CodeMirror-scrollbar-filler");u.scrollbarFiller.setAttribute("cm-not-content","true");u.gutterFiller=i("div",null,"CodeMirror-gutter-filler");u.gutterFiller.setAttribute("cm-not-content","true");u.lineDiv=kr("div",null,"CodeMirror-code");u.selectionDiv=i("div",null,null,"position: relative; z-index: 1");u.cursorDiv=i("div",null,"CodeMirror-cursors");u.measure=i("div",null,"CodeMirror-measure");u.lineMeasure=i("div",null,"CodeMirror-measure");u.lineSpace=kr("div",[u.measure,u.lineMeasure,u.selectionDiv,u.cursorDiv,u.lineDiv],null,"position: relative; outline: none");f=kr("div",[u.lineSpace],"CodeMirror-lines");u.mover=i("div",[f],null,"position: relative");u.sizer=i("div",[u.mover],"CodeMirror-sizer");u.sizerWidth=null;u.heightForcer=i("div",null,null,"position: absolute; height: "+rb+"px; width: 1px;");u.gutters=i("div",null,"CodeMirror-gutters");u.lineGutter=null;u.scroller=i("div",[u.sizer,u.heightForcer,u.gutters],"CodeMirror-scroll");u.scroller.setAttribute("tabIndex","-1");u.wrapper=i("div",[u.scrollbarFiller,u.gutterFiller,u.scroller],"CodeMirror");e&&l<8&&(u.gutters.style.zIndex=-1,u.scroller.style.paddingRight=0);tt||wi&&oe||(u.scroller.draggable=!0);n&&(n.appendChild?n.appendChild(u.wrapper):n(u.wrapper));u.viewFrom=u.viewTo=t.first;u.reportedViewFrom=u.reportedViewTo=t.first;u.view=[];u.renderedView=null;u.externalMeasured=null;u.viewOffset=0;u.lastWrapHeight=u.lastWrapWidth=0;u.updateLineNumbers=null;u.nativeBarWidth=u.barHeight=u.barWidth=0;u.scrollbarsClipped=!1;u.lineNumWidth=u.lineNumInnerWidth=u.lineNumChars=null;u.alignWidgets=!1;u.cachedCharWidth=u.cachedTextHeight=u.cachedPaddingH=null;u.maxLine=null;u.maxLineLength=0;u.maxLineChanged=!1;u.wheelDX=u.wheelDY=u.wheelStartX=u.wheelStartY=null;u.shift=!1;u.selForContextMenu=null;u.activeTouch=null;r.init(u)}function t(n,t){var i,r,u,f;if((t-=n.first)<0||t>=n.size)throw new Error("There is no line "+(t+n.first)+" in the document.");for(i=n;!i.lines;)for(r=0;;++r){if(u=i.children[r],f=u.chunkSize(),t<f){i=u;break}t-=f}return i.lines[t]}function tr(n,t,i){var u=[],r=t.line;return n.iter(t.line,i.line+1,function(n){var f=n.text;r==i.line&&(f=f.slice(0,i.ch));r==t.line&&(f=f.slice(t.ch));u.push(f);++r}),u}function ws(n,t,i){var r=[];return n.iter(t,i,function(n){r.push(n.text)}),r}function dt(n,t){var r=t-n.height,i;if(r)for(i=n;i;i=i.parent)i.height+=r}function h(n){var r;if(null==n.parent)return null;for(var i=n.parent,u=d(i.lines,n),t=i.parent;t;i=t,t=t.parent)for(r=0;t.children[r]!=i;++r)u+=t.children[r].chunkSize();return u+i.first}function ir(n,t){var f=n.first,r,u,e,i,o;n:do{for(r=0;r<n.children.length;++r){if(u=n.children[r],e=u.height,t<e){n=u;continue n}t-=e;f+=u.chunkSize()}return f}while(!n.lines);for(i=0;i<n.lines.length;++i){if(o=n.lines[i].height,t<o)break;t-=o}return f+i}function tf(n,t){return t>=n.first&&t<n.first+n.size}function bs(n,t){return String(n.lineNumberFormatter(t+n.firstLineNumber))}function n(t,i,r){if(void 0===r&&(r=null),!(this instanceof n))return new n(t,i,r);this.line=t;this.ch=i;this.sticky=r}function u(n,t){return n.line-t.line||n.ch-t.ch}function ks(n,t){return n.sticky==t.sticky&&0==u(n,t)}function ds(t){return n(t.line,t.ch)}function no(n,t){return u(n,t)<0?t:n}function to(n,t){return u(n,t)<0?n:t}function dl(n,t){return Math.max(n.first,Math.min(t,n.first+n.size-1))}function f(i,r){if(r.line<i.first)return n(i.first,0);var u=i.first+i.size-1;return r.line>u?n(u,t(i,u).text.length):pb(r,t(i,r.line).text.length)}function pb(t,i){var r=t.ch;return null==r||r>i?n(t.line,i):r<0?n(t.line,0):t}function gl(n,t){for(var r=[],i=0;i<t.length;i++)r[i]=f(n,t[i]);return r}function wb(){ub=!0}function bb(){ki=!0}function io(n,t,i){this.marker=n;this.from=t;this.to=i}function rf(n,t){var i,r;if(n)for(i=0;i<n.length;++i)if(r=n[i],r.marker==t)return r}function kb(n,t){for(var r,i=0;i<n.length;++i)n[i]!=t&&(r||(r=[])).push(n[i]);return r}function db(n,t){n.markedSpans=n.markedSpans?n.markedSpans.concat([t]):[t];t.marker.attachLine(n)}function gb(n,t,i){var e,f,r,u,o;if(n)for(f=0;f<n.length;++f)r=n[f],u=r.marker,null!=r.from&&!(u.inclusiveLeft?r.from<=t:r.from<t)&&(r.from!=t||"bookmark"!=u.type||i&&r.marker.insertLeft)||(o=null==r.to||(u.inclusiveRight?r.to>=t:r.to>t),(e||(e=[])).push(new io(u,r.from,o?null:r.to)));return e}function nk(n,t,i){var e,f,r,u,o;if(n)for(f=0;f<n.length;++f)r=n[f],u=r.marker,(null==r.to||(u.inclusiveRight?r.to>=t:r.to>t)||r.from==t&&"bookmark"==u.type&&(!i||r.marker.insertLeft))&&(o=null==r.from||(u.inclusiveLeft?r.from<=t:r.from<t),(e||(e=[])).push(new io(u,o?null:r.from-t,null==r.to?null:r.to-t)));return e}function gs(n,i){var w,b,a,h,v,y,e,p,d,g,c,nt;if(i.full||(w=tf(n,i.from.line)&&t(n,i.from.line).markedSpans,b=tf(n,i.to.line)&&t(n,i.to.line).markedSpans,!w&&!b))return null;var k=i.from.ch,it=i.to.ch,tt=0==u(i.from,i.to),r=gb(w,k,tt),f=nk(b,it,tt),o=1==i.text.length,l=s(i.text).length+(o?k:0);if(r)for(a=0;a<r.length;++a)h=r[a],null==h.to&&(v=rf(f,h.marker),v?o&&(h.to=null==v.to?null:v.to+l):h.to=k);if(f)for(y=0;y<f.length;++y)e=f[y],null!=e.to&&(e.to+=l),null==e.from?rf(r,e.marker)||(e.from=l,o&&(r||(r=[])).push(e)):(e.from+=l,o&&(r||(r=[])).push(e));if(r&&(r=na(r)),f&&f!=r&&(f=na(f)),p=[r],!o){if(g=i.text.length-2,g>0&&r)for(c=0;c<r.length;++c)null==r[c].to&&(d||(d=[])).push(new io(r[c].marker,null,null));for(nt=0;nt<g;++nt)p.push(d);p.push(f)}return p}function na(n){for(var i,t=0;t<n.length;++t)i=n[t],null!=i.from&&i.from==i.to&&!1!==i.marker.clearWhenEmpty&&n.splice(t--,1);return n.length?n:null}function tk(n,t,i){var r=null,e,h,f;if(n.iter(t.line,i.line+1,function(n){var t,i;if(n.markedSpans)for(t=0;t<n.markedSpans.length;++t)i=n.markedSpans[t].marker,!i.readOnly||r&&-1!=d(r,i)||(r||(r=[])).push(i)}),!r)return null;for(e=[{from:t,to:i}],h=0;h<r.length;++h)for(var l=r[h],o=l.find(0),s=0;s<e.length;++s)if(f=e[s],!(u(f.to,o.from)<0||u(f.from,o.to)>0)){var c=[s,1],a=u(f.from,o.from),v=u(f.to,o.to);(a<0||!l.inclusiveLeft&&!a)&&c.push({from:f.from,to:o.from});(v>0||!l.inclusiveRight&&!v)&&c.push({from:o.to,to:f.to});e.splice.apply(e,c);s+=c.length-3}return e}function ta(n){var i=n.markedSpans,t;if(i){for(t=0;t<i.length;++t)i[t].marker.detachLine(n);n.markedSpans=null}}function ia(n,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(n);n.markedSpans=t}}function ro(n){return n.inclusiveLeft?-1:0}function uo(n){return n.inclusiveRight?1:0}function ra(n,t){var i=n.lines.length-t.lines.length,o;if(0!=i)return i;var r=n.find(),f=t.find(),e=u(r.from,f.from)||ro(n)-ro(t);return e?-e:(o=u(r.to,f.to)||uo(n)-uo(t),o||t.id-n.id)}function ua(n,t){var r,f=ki&&n.markedSpans,i,u;if(f)for(i=void 0,u=0;u<f.length;++u)(i=f[u]).marker.collapsed&&null==(t?i.from:i.to)&&(!r||ra(r,i.marker)<0)&&(r=i.marker);return r}function fa(n){return ua(n,!0)}function uf(n){return ua(n,!1)}function ea(n,i,r,f,e){var v=t(n,i),l=ki&&v.markedSpans,h,o;if(l)for(h=0;h<l.length;++h)if(o=l[h],o.marker.collapsed){var s=o.marker.find(0),c=u(s.from,r)||ro(o.marker)-ro(e),a=u(s.to,f)||uo(o.marker)-uo(e);if(!(c>=0&&a<=0||c<=0&&a>=0)&&(c<=0&&(o.marker.inclusiveRight&&e.inclusiveLeft?u(s.to,r)>=0:u(s.to,r)>0)||c>=0&&(o.marker.inclusiveRight&&e.inclusiveLeft?u(s.from,f)<=0:u(s.from,f)<0)))return!0}}function gt(n){for(var t;t=fa(n);)n=t.find(-1,!0).line;return n}function ik(n){for(var t;t=uf(n);)n=t.find(1,!0).line;return n}function rk(n){for(var i,t;i=uf(n);)n=i.find(1,!0).line,(t||(t=[])).push(n);return t}function nh(n,i){var r=t(n,i),u=gt(r);return r==u?i:h(u)}function oa(n,i){if(i>n.lastLine())return i;var u,r=t(n,i);if(!rr(n,r))return i;for(;u=uf(r);)r=u.find(1,!0).line;return h(r)+1}function rr(n,t){var u=ki&&t.markedSpans,i,r;if(u)for(i=void 0,r=0;r<u.length;++r)if((i=u[r]).marker.collapsed&&(null==i.from||!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&th(n,t,i)))return!0}function th(n,t,i){var f,r,u;if(null==i.to)return f=i.marker.find(1,!0),th(n,f.line,rf(f.line.markedSpans,i.marker));if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(r=void 0,u=0;u<t.markedSpans.length;++u)if((r=t.markedSpans[u]).marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(null==r.to||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&th(n,t,r))return!0}function ei(n){for(var e,i,r,o,u=0,t=(n=gt(n)).parent,f=0;f<t.lines.length;++f){if(e=t.lines[f],e==n)break;u+=e.height}for(i=t.parent;i;t=i,i=t.parent)for(r=0;r<i.children.length;++r){if(o=i.children[r],o==t)break;u+=o.height}return u}function fo(n){var r,i,t,u,f;if(0==n.height)return 0;for(i=n.text.length,t=n;r=fa(t);)u=r.find(0,!0),t=u.from.line,i+=u.from.ch-u.to.ch;for(t=n;r=uf(t);)f=r.find(0,!0),i-=t.text.length-f.from.ch,i+=(t=f.to.line).text.length-f.to.ch;return i}function ih(n){var i=n.display,r=n.doc;i.maxLine=t(r,r.first);i.maxLineLength=fo(i.maxLine);i.maxLineChanged=!0;r.iter(function(n){var t=fo(n);t>i.maxLineLength&&(i.maxLineLength=t,i.maxLine=n)})}function uk(n,t,i,r){var e,f,u;if(!n)return r(t,i,"ltr",0);for(e=!1,f=0;f<n.length;++f)u=n[f],(u.from<i&&u.to>t||t==i&&u.to==t)&&(r(Math.max(u.from,t),Math.min(u.to,i),1==u.level?"rtl":"ltr",f),e=!0);e||r(t,i,"ltr")}function ff(n,t,i){var f,r,u;for(he=null,r=0;r<n.length;++r){if(u=n[r],u.from<t&&u.to>t)return r;u.to==t&&(u.from!=u.to&&"before"==i?f=r:he=r);u.from==t&&(u.from!=u.to&&"before"!=i?f=r:he=r)}return null!=f?f:he}function oi(n,t){var i=n.order;return null==i&&(i=n.order=ktt(n.text,t)),i}function rh(n,t){return n._handlers&&n._handlers[t]||fb}function lt(n,t,i){var u,r,f;n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent?n.detachEvent("on"+t,i):(u=n._handlers,r=u&&u[t],r&&(f=d(r,i),f>-1&&(u[t]=r.slice(0,f).concat(r.slice(f+1)))))}function v(n,t){var r=rh(n,t),u,i;if(r.length)for(u=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,u)}function w(n,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),v(n,i||t.type,n,t),uh(t)||t.codemirrorIgnore}function sa(n){var i=n._handlers&&n._handlers.cursorActivity,r,t;if(i)for(r=n.curOp.cursorActivityHandlers||(n.curOp.cursorActivityHandlers=[]),t=0;t<i.length;++t)-1==d(r,i[t])&&r.push(i[t])}function vt(n,t){return rh(n,t).length>0}function dr(n){n.prototype.on=function(n,t){r(this,n,t)};n.prototype.off=function(n,t){lt(this,n,t)}}function it(n){n.preventDefault?n.preventDefault():n.returnValue=!1}function ha(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function uh(n){return null!=n.defaultPrevented?n.defaultPrevented:0==n.returnValue}function ef(n){it(n);ha(n)}function fh(n){return n.target||n.srcElement}function ca(n){var t=n.which;return null==t&&(1&n.button?t=1:2&n.button?t=3:4&n.button&&(t=2)),kt&&n.ctrlKey&&1==t&&(t=3),t}function fk(n){var t,r;return null==fl&&(t=i("span","​"),ct(n,i("span",[t,document.createTextNode("x")])),0!=n.firstChild.offsetHeight&&(fl=t.offsetWidth<=1&&t.offsetHeight>2&&!(e&&l<8))),r=fl?i("span","​"):i("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px"),r.setAttribute("cm-text",""),r}function ek(n){if(null!=el)return el;var i=ct(n,document.createTextNode("AخA")),t=cu(i,0,1).getBoundingClientRect(),r=cu(i,1,2).getBoundingClientRect();return ci(n),!(!t||t.left==t.right)&&(el=r.right-t.right<3)}function ok(n){if(null!=hl)return hl;var t=ct(n,i("span","x")),r=t.getBoundingClientRect(),u=cu(t,0,1).getBoundingClientRect();return hl=Math.abs(r.left-u.left)>1}function sk(n,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2));cl[n]=t}function eo(n){if("string"==typeof n&&au.hasOwnProperty(n))n=au[n];else if(n&&"string"==typeof n.name&&au.hasOwnProperty(n.name)){var t=au[n.name];"string"==typeof t&&(t={name:t});(n=wl(t,n)).name=t.name}else{if("string"==typeof n&&/^[\w\-]+\/[\w\-]+\+xml$/.test(n))return eo("application/xml");if("string"==typeof n&&/^[\w\-]+\/[\w\-]+\+json$/.test(n))return eo("application/json")}return"string"==typeof n?{name:n}:n||{name:"null"}}function eh(n,t){var f,i,u,r,e;if(t=eo(t),f=cl[t.name],!f)return eh(n,"text/plain");if(i=f(n,t),vu.hasOwnProperty(t.name)){u=vu[t.name];for(r in u)u.hasOwnProperty(r)&&(i.hasOwnProperty(r)&&(i["_"+r]=i[r]),i[r]=u[r])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(e in t.modeProps)i[e]=t.modeProps[e];return i}function hk(n,t){nr(t,vu.hasOwnProperty(n)?vu[n]:vu[n]={})}function ur(n,t){var r,u,i;if(!0===t)return t;if(n.copyState)return n.copyState(t);r={};for(u in t)i=t[u],i instanceof Array&&(i=i.concat([])),r[u]=i;return r}function oh(n,t){for(var i;n.innerMode&&(i=n.innerMode(t))&&i.mode!=n;)t=i.state,n=i.mode;return i||{mode:n,state:t}}function la(n,t,i){return!n.startState||n.startState(t,i)}function aa(n,t,i,r){var u=[n.state.modeGen],f={},o,e;for(ba(n,t.text,n.doc.mode,i,function(n,t){return u.push(n,t)},f,r),o=i.state,e=0;e<n.state.overlays.length;++e)!function(r){var o=n.state.overlays[r],e=1,s=0;i.state=!0;ba(n,t.text,o.mode,i,function(n,t){for(var r,f,i=e;s<n;)r=u[e],r>n&&u.splice(e,1,n,u[e+1],r),e+=2,s=Math.min(n,r);if(t)if(o.opaque)u.splice(i,e-i,n,"overlay "+t),e=i+2;else for(;i<e;i+=2)f=u[i+1],u[i+1]=(f?f+" ":"")+"overlay "+t},f)}(e);return i.state=o,{styles:u,classes:f.bgClass||f.textClass?f:null}}function va(n,t,i){if(!t.styles||t.styles[0]!=n.state.modeGen){var r=of(n,h(t)),u=t.text.length>n.options.maxHighlightLength&&ur(n.doc.mode,r.state),f=aa(n,t,r);u&&(r.state=u);t.stateAfter=r.save(!u);t.styles=f.styles;f.classes?t.styleClasses=f.classes:t.styleClasses&&(t.styleClasses=null);i===n.doc.highlightFrontier&&(n.doc.modeFrontier=Math.max(n.doc.modeFrontier,++n.doc.highlightFrontier))}return t.styles}function of(n,i,r){var u=n.doc,o=n.display;if(!u.mode.startState)return new ri(u,!0,i);var e=ck(n,i,r),s=e>u.first&&t(u,e-1).stateAfter,f=s?ri.fromSaved(u,s,e):new ri(u,la(u.mode),e);return u.iter(e,i,function(t){sh(n,t.text,f);var r=f.line;t.stateAfter=r==i-1||r%5==0||r>=o.viewFrom&&r<o.viewTo?f.save():null;f.nextLine()}),r&&(u.modeFrontier=f.line),f}function sh(n,t,i,r){var f=n.doc.mode,u=new p(t,n.options.tabSize,i);for(u.start=u.pos=r||0,""==t&&ya(f,i.state);!u.eol();)hh(f,u,i.state),u.start=u.pos}function ya(n,t){if(n.blankLine)return n.blankLine(t);if(n.innerMode){var i=oh(n,t);return i.mode.blankLine?i.mode.blankLine(i.state):void 0}}function hh(n,t,i,r){for(var f,u=0;u<10;u++)if(r&&(r[0]=oh(n,i).mode),f=n.token(t,i),t.pos>t.start)return f;throw new Error("Mode "+n.name+" failed to advance stream.");}function pa(n,i,r,u){var h,c,o=n.doc,l=o.mode,a=t(o,(i=f(o,i)).line),s=of(n,i.line,r),e=new p(a.text,n.options.tabSize,s);for(u&&(c=[]);(u||e.pos<i.ch)&&!e.eol();)e.start=e.pos,h=hh(l,e,s.state),u&&c.push(new ll(e,h,ur(o.mode,s.state)));return u?c:new ll(e,h,s.state)}function wa(n,t){var i,r;if(n)for(;;){if(i=n.match(/(?:^|\s+)line-(background-)?(\S+)/),!i)break;n=n.slice(0,i.index)+n.slice(i.index+i[0].length);r=i[1]?"bgClass":"textClass";null==t[r]?t[r]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+i[2])}return n}function ba(n,t,i,r,u,f,e){var c=i.flattenSpans,a,y;null==c&&(c=n.options.flattenSpans);var s,h=0,l=null,o=new p(t,n.options.tabSize,r),v=n.options.addModeClass&&[null];for(""==t&&wa(ya(i,r.state),f);!o.eol();){if((o.pos>n.options.maxHighlightLength?(c=!1,e&&sh(n,t,r,o.pos),o.pos=t.length,s=null):s=wa(hh(i,o,r.state,v),f),v)&&(a=v[0].name,a&&(s="m-"+(s?a+" "+s:a))),!c||l!=s){for(;h<o.start;)u(h=Math.min(o.start,h+5e3),l);l=s}o.start=o.pos}for(;h<o.pos;)y=Math.min(o.pos,h+5e3),u(y,l),h=y}function ck(n,i,r){for(var s,e,h,c,o,f=n.doc,l=r?-1:i-(n.doc.mode.innerMode?1e3:100),u=i;u>l;--u){if(u<=f.first)return f.first;if(s=t(f,u-1),e=s.stateAfter,e&&(!r||u+(e instanceof ce?e.lookAhead:0)<=f.modeFrontier))return u;h=at(s.text,null,n.options.tabSize);(null==o||c>h)&&(o=u-1,c=h)}return o}function lk(n,i){var u,r,f;if(n.modeFrontier=Math.min(n.modeFrontier,i),!(n.highlightFrontier<i-10)){for(u=n.first,r=i-1;r>u;r--)if(f=t(n,r).stateAfter,f&&(!(f instanceof ce)||r+f.lookAhead<i)){u=r+1;break}n.highlightFrontier=Math.min(n.highlightFrontier,u)}}function ak(n,t,i,r){n.text=t;n.stateAfter&&(n.stateAfter=null);n.styles&&(n.styles=null);null!=n.order&&(n.order=null);ta(n);ia(n,i);var u=r?r(n):1;u!=n.height&&dt(n,u)}function vk(n){n.parent=null;ta(n)}function ka(n,t){if(!n||/^\s*$/.test(n))return null;var i=t.addModeClass?iit:tit;return i[n]||(i[n]=n.replace(/\S+/g,"cm-$&"))}function da(n,t){var s=kr("span",null,null,tt?"padding-right: .1px":null),i={pre:kr("pre",[s],"CodeMirror-line"),content:s,col:0,pos:0,cm:n,trailingSpace:!1,splitSpaces:(e||tt)&&n.getOption("lineWrapping")},u,r,o,f;for(t.measure={},u=0;u<=(t.rest?t.rest.length:0);u++)r=u?t.rest[u-1]:t.line,o=void 0,i.pos=0,i.addToken=pk,ek(n.display.measure)&&(o=oi(r,n.doc.direction))&&(i.addToken=bk(i.addToken,o)),i.map=[],kk(r,i,va(n,r,t!=n.display.externalMeasured&&h(r))),r.styleClasses&&(r.styleClasses.bgClass&&(i.bgClass=cs(r.styleClasses.bgClass,i.bgClass||"")),r.styleClasses.textClass&&(i.textClass=cs(r.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(fk(n.display.measure))),0==u?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}));return tt&&(f=i.content.lastChild,(/\bcm-tab\b/.test(f.className)||f.querySelector&&f.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")),v(n,"renderLine",n,t.line,i.pre),i.pre.className&&(i.textClass=cs(i.pre.className,i.textClass||"")),i}function yk(n){var t=i("span","•","cm-invalidchar");return t.title="\\u"+n.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function pk(n,t,r,u,f,o,s){var v,c,y,p,a,d,g,w,nt;if(t){var h,b=n.splitSpaces?wk(t,n.trailingSpace):t,k=n.cm.state.specialChars,tt=!1;if(k.test(t))for(h=document.createDocumentFragment(),v=0;;){if(k.lastIndex=v,c=k.exec(t),y=c?c.index-v:t.length-v,y&&(p=document.createTextNode(b.slice(v,v+y)),e&&l<9?h.appendChild(i("span",[p])):h.appendChild(p),n.map.push(n.pos,n.pos+y,p),n.col+=y,n.pos+=y),!c)break;v+=y+1;a=void 0;"\t"==c[0]?(d=n.cm.options.tabSize,g=d-n.col%d,(a=h.appendChild(i("span",vs(g),"cm-tab"))).setAttribute("role","presentation"),a.setAttribute("cm-text","\t"),n.col+=g):"\r"==c[0]||"\n"==c[0]?((a=h.appendChild(i("span","\r"==c[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",c[0]),n.col+=1):((a=n.cm.options.specialCharPlaceholder(c[0])).setAttribute("cm-text",c[0]),e&&l<9?h.appendChild(i("span",[a])):h.appendChild(a),n.col+=1);n.map.push(n.pos,n.pos+1,a);n.pos++}else n.col+=t.length,h=document.createTextNode(b),n.map.push(n.pos,n.pos+t.length,h),e&&l<9&&(tt=!0),n.pos+=t.length;if(n.trailingSpace=32==b.charCodeAt(t.length-1),r||u||f||tt||s)return w=r||"",u&&(w+=u),f&&(w+=f),nt=i("span",[h],w,s),o&&(nt.title=o),n.content.appendChild(nt);n.content.appendChild(h)}}function wk(n,t){var r;if(n.length>1&&!/  /.test(n))return n;for(var u=t,f="",i=0;i<n.length;i++)r=n.charAt(i)," "==r&&u&&(i==n.length-1||32==n.charCodeAt(i+1))&&(r=" "),f+=r,u=" "==r;return f}function bk(n,t){return function(i,r,u,f,e,o,s){var h,a,c,l;for(u=u?u+" cm-force-border":"cm-force-border",h=i.pos,a=h+r.length;;){for(c=void 0,l=0;l<t.length&&!((c=t[l]).to>h&&c.from<=h);l++);if(c.to>=a)return n(i,r,u,f,e,o,s);n(i,r.slice(0,c.to-h),u,f,null,o,s);f=null;r=r.slice(c.to-h);h=c.to}}}function ga(n,t,i,r){var u=!r&&i.widgetNode;u&&n.map.push(n.pos,n.pos+t,u);!r&&n.cm.display.input.needsContentAttribute&&(u||(u=n.content.appendChild(document.createElement("span"))),u.setAttribute("cm-marker",i.id));u&&(n.cm.display.input.setUneditable(u),n.content.appendChild(u));n.pos+=t;n.trailingSpace=!1}function kk(n,t,i){var nt=n.markedSpans,tt=n.text,y=0,u,f,a,d,c,g,et,v;if(nt)for(var it,l,p,w,b,k,e,rt=tt.length,r=0,ot=1,s="",o=0;;){if(o==r){p=w=b=k=l="";e=null;o=1/0;for(var ut=[],h=void 0,ft=0;ft<nt.length;++ft)u=nt[ft],f=u.marker,"bookmark"==f.type&&u.from==r&&f.widgetNode?ut.push(f):u.from<=r&&(null==u.to||u.to>r||f.collapsed&&u.to==r&&u.from==r)?(null!=u.to&&u.to!=r&&o>u.to&&(o=u.to,w=""),f.className&&(p+=" "+f.className),f.css&&(l=(l?l+";":"")+f.css),f.startStyle&&u.from==r&&(b+=" "+f.startStyle),f.endStyle&&u.to==o&&(h||(h=[])).push(f.endStyle,u.to),f.title&&!k&&(k=f.title),f.collapsed&&(!e||ra(e.marker,f)<0)&&(e=u)):u.from>r&&o>u.from&&(o=u.from);if(h)for(a=0;a<h.length;a+=2)h[a+1]==o&&(w+=" "+h[a]);if(!e||e.from==r)for(d=0;d<ut.length;++d)ga(t,0,ut[d]);if(e&&(e.from||0)==r){if(ga(t,(null==e.to?rt+1:e.to)-r,e.marker,null==e.from),null==e.to)return;e.to==r&&(e=!1)}}if(r>=rt)break;for(c=Math.min(rt,o);;){if(s){if(g=r+s.length,e||(et=g>c?s.slice(0,c-r):s,t.addToken(t,et,it?it+p:p,b,r+et.length==o?w:"",k,l)),g>=c){s=s.slice(c-r);r=c;break}r=g;b=""}s=tt.slice(y,y=i[ot++]);it=ka(i[ot++],t.cm.options)}}else for(v=1;v<i.length;v+=2)t.addToken(t,tt.slice(y,y=i[v]),ka(i[v+1],t.cm.options))}function nv(n,t,i){this.line=t;this.rest=rk(t);this.size=this.rest?h(s(this.rest))-i+1:1;this.node=this.text=null;this.hidden=rr(n,t)}function oo(n,i,r){for(var o,e,f=[],u=i;u<r;u=o)e=new nv(n.doc,t(n.doc,u),u),o=u+e.size,f.push(e);return f}function dk(n){yu?yu.ops.push(n):n.ownsGroup=yu={ops:[n],delayedCallbacks:[]}}function gk(n){var u=n.delayedCallbacks,i=0,r,t;do{for(;i<u.length;i++)u[i].call(null);for(r=0;r<n.ops.length;r++)if(t=n.ops[r],t.cursorActivityHandlers)for(;t.cursorActivityCalled<t.cursorActivityHandlers.length;)t.cursorActivityHandlers[t.cursorActivityCalled++].call(null,t.cm)}while(i<u.length)}function nd(n,t){var i=n.ownsGroup;if(i)try{gk(i)}finally{yu=null;t(i)}}function g(n,t){var u=rh(n,t),i,f,r;if(u.length)for(f=Array.prototype.slice.call(arguments,2),yu?i=yu.delayedCallbacks:le?i=le:(i=le=[],setTimeout(td,0)),r=0;r<u.length;++r)!function(n){i.push(function(){return u[n].apply(null,f)})}(r)}function td(){var t=le,n;for(le=null,n=0;n<t.length;++n)t[n]()}function tv(n,t,i,r){for(var u,f=0;f<t.changes.length;f++)u=t.changes[f],"text"==u?rd(n,t):"gutter"==u?rv(n,t,i,r):"class"==u?ch(n,t):"widget"==u&&ud(n,t,r);t.changes=null}function sf(n){return n.node==n.text&&(n.node=i("div",null,null,"position: relative"),n.text.parentNode&&n.text.parentNode.replaceChild(n.node,n.text),n.node.appendChild(n.text),e&&l<8&&(n.node.style.zIndex=2)),n.node}function id(n,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass,u;(r&&(r+=" CodeMirror-linebackground"),t.background)?r?t.background.className=r:(t.background.parentNode.removeChild(t.background),t.background=null):r&&(u=sf(t),t.background=u.insertBefore(i("div",null,r),u.firstChild),n.display.input.setUneditable(t.background))}function iv(n,t){var i=n.display.externalMeasured;return i&&i.line==t.line?(n.display.externalMeasured=null,t.measure=i.measure,i.built):da(n,t)}function rd(n,t){var r=t.text.className,i=iv(n,t);t.text==t.node&&(t.node=i.pre);t.text.parentNode.replaceChild(i.pre,t.text);t.text=i.pre;i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,ch(n,t)):r&&(t.text.className=r)}function ch(n,t){id(n,t);t.line.wrapClass?sf(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function rv(n,t,r,u){var c,f,l,e,s,o,h;if((t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass)&&(c=sf(t),t.gutterBackground=i("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(n.options.fixedGutter?u.fixedPos:-u.gutterTotalWidth)+"px; width: "+u.gutterTotalWidth+"px"),n.display.input.setUneditable(t.gutterBackground),c.insertBefore(t.gutterBackground,t.text)),f=t.line.gutterMarkers,(n.options.lineNumbers||f)&&(l=sf(t),e=t.gutter=i("div",null,"CodeMirror-gutter-wrapper","left: "+(n.options.fixedGutter?u.fixedPos:-u.gutterTotalWidth)+"px"),n.display.input.setUneditable(e),l.insertBefore(e,t.text),t.line.gutterClass&&(e.className+=" "+t.line.gutterClass),!n.options.lineNumbers||f&&f["CodeMirror-linenumbers"]||(t.lineNumber=e.appendChild(i("div",bs(n.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+u.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+n.display.lineNumInnerWidth+"px"))),f))for(s=0;s<n.options.gutters.length;++s)o=n.options.gutters[s],h=f.hasOwnProperty(o)&&f[o],h&&e.appendChild(i("div",[h],"CodeMirror-gutter-elt","left: "+u.gutterLeft[o]+"px; width: "+u.gutterWidth[o]+"px"))}function ud(n,t,i){t.alignable&&(t.alignable=null);for(var r=t.node.firstChild,u=void 0;r;r=u)u=r.nextSibling,"CodeMirror-linewidget"==r.className&&t.node.removeChild(r);uv(n,t,i)}function fd(n,t,i,r){var u=iv(n,t);return t.text=t.node=u.pre,u.bgClass&&(t.bgClass=u.bgClass),u.textClass&&(t.textClass=u.textClass),ch(n,t),rv(n,t,i,r),uv(n,t,r),t.node}function uv(n,t,i){if(fv(n,t.line,t,i,!0),t.rest)for(var r=0;r<t.rest.length;r++)fv(n,t.rest[r],t,i,!1)}function fv(n,t,r,u,f){var e,o;if(t.widgets)for(var h=sf(r),s=0,c=t.widgets;s<c.length;++s)e=c[s],o=i("div",[e.node],"CodeMirror-linewidget"),e.handleMouseEvents||o.setAttribute("cm-ignore-events","true"),ed(e,o,r,u),n.display.input.setUneditable(o),f&&e.above?h.insertBefore(o,r.gutter||r.text):h.appendChild(o),g(e,"redraw")}function ed(n,t,i,r){if(n.noHScroll){(i.alignable||(i.alignable=[])).push(t);var u=r.wrapperWidth;t.style.left=r.fixedPos+"px";n.coverGutter||(u-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px");t.style.width=u+"px"}n.coverGutter&&(t.style.zIndex=5,t.style.position="relative",n.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function hf(n){var t,r;return null!=n.height?n.height:(t=n.doc.cm,!t)?0:(li(document.body,n.node)||(r="position: relative;",n.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),n.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),ct(t.display.measure,i("div",[n.node],null,r))),n.height=n.node.parentNode.offsetHeight)}function si(n,t){for(var i=fh(t);i!=n.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==n.sizer&&i!=n.mover)return!0}function so(n){return n.lineSpace.offsetTop}function lh(n){return n.mover.offsetHeight-n.lineSpace.offsetHeight}function ev(n){if(n.cachedPaddingH)return n.cachedPaddingH;var r=ct(n.measure,i("pre","x")),u=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,t={left:parseInt(u.paddingLeft),right:parseInt(u.paddingRight)};return isNaN(t.left)||isNaN(t.right)||(n.cachedPaddingH=t),t}function ni(n){return rb-n.display.nativeBarWidth}function fr(n){return n.display.scroller.clientWidth-ni(n)-n.display.barWidth}function ah(n){return n.display.scroller.clientHeight-ni(n)-n.display.barHeight}function od(n,t,i){var f=n.options.lineWrapping,h=f&&fr(n),e,u,r,o,s;if(!t.measure.heights||f&&t.measure.width!=h){if(e=t.measure.heights=[],f)for(t.measure.width=h,u=t.text.firstChild.getClientRects(),r=0;r<u.length-1;r++)o=u[r],s=u[r+1],Math.abs(o.bottom-s.bottom)>2&&e.push((o.bottom+s.top)/2-i.top);e.push(i.bottom-i.top)}}function ov(n,t,i){var r,u;if(n.line==t)return{map:n.measure.map,cache:n.measure.cache};for(r=0;r<n.rest.length;r++)if(n.rest[r]==t)return{map:n.measure.maps[r],cache:n.measure.caches[r]};for(u=0;u<n.rest.length;u++)if(h(n.rest[u])>i)return{map:n.measure.maps[u],cache:n.measure.caches[u],before:!0}}function sd(n,t){var u=h(t=gt(t)),i=n.display.externalMeasured=new nv(n.doc,t,u),r;return i.lineN=u,r=i.built=da(n,i),i.text=r.pre,ct(n.display.lineMeasure,r.pre),i}function sv(n,t,i,r){return ti(n,gr(n,t),i,r)}function vh(n,t){if(t>=n.display.viewFrom&&t<n.display.viewTo)return n.display.view[sr(n,t)];var i=n.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size)return i}function gr(n,t){var u=h(t),i=vh(n,u),r;return i&&!i.text?i=null:i&&i.changes&&(tv(n,i,u,gh(n)),n.curOp.forceUpdate=!0),i||(i=sd(n,t)),r=ov(i,t,u),{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function ti(n,t,i,r,u){t.before&&(i=-1);var f,e=i+(r||"");return t.cache.hasOwnProperty(e)?f=t.cache[e]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(od(n,t.view,t.rect),t.hasHeights=!0),(f=cd(n,t,i,r)).bogus||(t.cache[e]=f)),{left:f.left,right:f.right,top:u?f.rtop:f.top,bottom:u?f.rbottom:f.bottom}}function hv(n,t,i){for(var s,f,h,o,e,u,r=0;r<n.length;r+=3)if(e=n[r],u=n[r+1],t<e?(f=0,h=1,o="left"):t<u?h=(f=t-e)+1:(r==n.length-3||t==u&&n[r+3]>t)&&(f=(h=u-e)-1,t>=u&&(o="right")),null!=f){if(s=n[r+2],e==u&&i==(s.insertLeft?"left":"right")&&(o=i),"left"==i&&0==f)for(;r&&n[r-2]==n[r-3]&&n[r-1].insertLeft;)s=n[2+(r-=3)],o="left";if("right"==i&&f==u-e)for(;r<n.length-3&&n[r+3]==n[r+4]&&!n[r+5].insertLeft;)s=n[(r+=3)+2],o="right";break}return{node:s,start:f,end:h,collapse:o,coverStart:e,coverEnd:u}}function hd(n,t){var i=eb,r,u;if("left"==t)for(r=0;r<n.length&&(i=n[r]).left==i.right;r++);else for(u=n.length-1;u>=0&&(i=n[u]).left==i.right;u--);return i}function cd(n,t,i,r){var u,f=hv(t.map,i,r),s=f.node,o=f.start,h=f.end,v=f.collapse,w,b,c;if(3==s.nodeType){for(w=0;w<4;w++){for(;o&&ps(t.line.text.charAt(f.coverStart+o));)--o;for(;f.coverStart+h<f.coverEnd&&ps(t.line.text.charAt(f.coverStart+h));)++h;if((u=e&&l<9&&0==o&&h==f.coverEnd-f.coverStart?s.parentNode.getBoundingClientRect():hd(cu(s,o,h).getClientRects(),r)).left||u.right||0==o)break;h=o;o-=1;v="right"}e&&l<11&&(u=ld(n.display.measure,u))}else o>0&&(v=r="right"),u=n.options.lineWrapping&&(b=s.getClientRects()).length>1?b["right"==r?b.length-1:0]:s.getBoundingClientRect();e&&l<9&&!o&&(!u||!u.left&&!u.right)&&(c=s.parentNode.getClientRects()[0],u=c?{left:c.left,right:c.left+lf(n.display),top:c.top,bottom:c.bottom}:eb);for(var k=u.top-t.rect.top,d=u.bottom-t.rect.top,g=(k+d)/2,y=t.view.measure.heights,a=0;a<y.length-1&&!(g<y[a]);a++);var nt=a?y[a-1]:0,tt=y[a],p={left:("right"==v?u.right:u.left)-t.rect.left,right:("left"==v?u.left:u.right)-t.rect.left,top:nt,bottom:tt};return u.left||u.right||(p.bogus=!0),n.options.singleCursorHeightPerLine||(p.rtop=k,p.rbottom=d),p}function ld(n,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!ok(n))return t;var i=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*r,bottom:t.bottom*r}}function cv(n){if(n.measure&&(n.measure.cache={},n.measure.heights=null,n.rest))for(var t=0;t<n.rest.length;t++)n.measure.caches[t]={}}function lv(n){n.display.externalMeasure=null;ci(n.display.lineMeasure);for(var t=0;t<n.display.view.length;t++)cv(n.display.view[t])}function cf(n){lv(n);n.display.cachedCharWidth=n.display.cachedTextHeight=n.display.cachedPaddingH=null;n.options.lineWrapping||(n.display.maxLineChanged=!0);n.display.lineNumChars=null}function av(){return rs&&us?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function vv(){return rs&&us?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function yh(n){var i=0,t;if(n.widgets)for(t=0;t<n.widgets.length;++t)n.widgets[t].above&&(i+=hf(n.widgets[t]));return i}function ho(n,t,i,r,u){var e,f,o,s;return(u||(e=yh(t),i.top+=e,i.bottom+=e),"line"==r)?i:(r||(r="local"),f=ei(t),("local"==r?f+=so(n.display):f-=n.display.viewOffset,"page"==r||"window"==r)&&(o=n.display.lineSpace.getBoundingClientRect(),f+=o.top+("window"==r?0:vv()),s=o.left+("window"==r?0:av()),i.left+=s,i.right+=s),i.top+=f,i.bottom+=f,i)}function yv(n,t,i){var r,u,f,e;return"div"==i?t:(r=t.left,u=t.top,"page"==i?(r-=av(),u-=vv()):"local"!=i&&i||(f=n.display.sizer.getBoundingClientRect(),r+=f.left,u+=f.top),e=n.display.lineSpace.getBoundingClientRect(),{left:r-e.left,top:u-e.top})}function ph(n,i,r,u,f){return u||(u=t(n.doc,i.line)),ho(n,u,sv(n,u,i.ch,f),r)}function pt(n,i,r,u,f,e){function c(t,i){var o=ti(n,f,t,i?"right":"left",e);return i?o.left=o.right:o.right=o.left,ho(n,u,o,r)}function l(n,t,i){var r=1==h[t].level;return c(i?n-1:n,r!=i)}u=u||t(n.doc,i.line);f||(f=gr(n,u));var h=oi(u,n.doc.direction),o=i.ch,s=i.sticky;if(o>=u.text.length?(o=u.text.length,s="before"):o<=0&&(o=0,s="after"),!h)return c("before"==s?o-1:o,"before"==s);var y=ff(h,o,s),a=he,v=l(o,y,"before"==s);return null!=a&&(v.other=l(o,a,"before"!=s)),v}function pv(n,i){var r=0,u,e;return i=f(n.doc,i),n.options.lineWrapping||(r=lf(n.display)*i.ch),u=t(n.doc,i.line),e=ei(u)+so(n.display),{left:r,right:r,top:e,bottom:e+u.height}}function wh(t,i,r,u,f){var e=n(t,i,r);return e.xRel=f,u&&(e.outside=!0),e}function bh(n,i,r){var u=n.doc,f,s,e;if((r+=n.display.viewOffset)<0)return wh(u.first,0,null,!0,-1);if(f=ir(u,r),s=u.first+u.size-1,f>s)return wh(u.first+u.size-1,t(u,s).text.length,null,!0,1);for(i<0&&(i=0),e=t(u,f);;){var o=ad(n,e,f,i,r),c=uf(e),l=c&&c.find(0,!0);if(!c||!(o.ch>l.from.ch||o.ch==l.from.ch&&o.xRel>0))return o;f=h(e=l.to.line)}}function wv(n,t,i,r){r-=yh(t);var u=t.text.length,f=nf(function(t){return ti(n,i,t-1).bottom<=r},u,0);return u=nf(function(t){return ti(n,i,t).top>r},f,u),{begin:f,end:u}}function kh(n,t,i,r){return i||(i=gr(n,t)),wv(n,t,i,ho(n,t,ti(n,i,r),"line").top)}function dh(n,t,i,r){return!(n.bottom<=i)&&(n.top>i||(r?n.left:n.right)>t)}function ad(t,i,r,u,f){var s,b,k,a;f-=ei(i);var c=gr(t,i),v=yh(i),y=0,p=i.text.length,o=!0,d=oi(i,t.doc.direction);d&&(s=(t.options.lineWrapping?yd:vd)(t,i,r,c,d,u,f),y=(o=1!=s.level)?s.from:s.to-1,p=o?s.to:s.from-1);var w,l,g=null,h=null,e=nf(function(n){var i=ti(t,c,n);return i.top+=v,i.bottom+=v,!!dh(i,u,f,!1)&&(i.top<=f&&i.left<=u&&(g=n,h=i),!0)},y,p),nt=!1;return h?(b=u-h.left<h.right-u,k=b==o,e=g+(k?0:1),l=k?"after":"before",w=b?h.left:h.right):(o||e!=p&&e!=y||e++,l=0==e?"after":e==i.text.length?"before":ti(t,c,e-(o?1:0)).bottom+v<=f==o?"after":"before",a=pt(t,n(r,e,l),"line",i,c),w=a.left,nt=f<a.top||f>=a.bottom),e=kl(i.text,e,1),wh(r,e,l,nt,u-w)}function vd(t,i,r,u,f,e,o){var h=nf(function(s){var h=f[s],c=1!=h.level;return dh(pt(t,n(r,c?h.to:h.from,c?"before":"after"),"line",i,u),e,o,!0)},0,f.length-1),s=f[h],c,l;return h>0&&(c=1!=s.level,l=pt(t,n(r,c?s.from:s.to,c?"after":"before"),"line",i,u),dh(l,e,o,!0)&&l.top>o&&(s=f[h-1])),s}function yd(n,t,i,r,u,f,e){for(var s,l,v,y=wv(n,t,r,e),h=y.begin,c=y.end,o=null,p=null,a=0;a<u.length;a++)s=u[a],s.from>=c||s.to<=h||(l=ti(n,r,1!=s.level?Math.min(c,s.to)-1:Math.max(h,s.from)).right,v=l<f?f-l+1e9:l-f,(!o||p>v)&&(o=s,p=v));return o||(o=u[u.length-1]),o.from<h&&(o={from:h,to:o.to,level:o.level}),o.to>c&&(o={from:o.from,to:c,level:o.level}),o}function er(n){var r,t;if(null!=n.cachedTextHeight)return n.cachedTextHeight;if(null==wr){for(wr=i("pre"),r=0;r<49;++r)wr.appendChild(document.createTextNode("x")),wr.appendChild(i("br"));wr.appendChild(document.createTextNode("x"))}return ct(n.measure,wr),t=wr.offsetHeight/50,t>3&&(n.cachedTextHeight=t),ci(n.measure),t||1}function lf(n){var r,f,u,t;return null!=n.cachedCharWidth?n.cachedCharWidth:(r=i("span","xxxxxxxxxx"),f=i("pre",[r]),ct(n.measure,f),u=r.getBoundingClientRect(),t=(u.right-u.left)/10,t>2&&(n.cachedCharWidth=t),t||10)}function gh(n){for(var i=n.display,u={},f={},e=i.gutters.clientLeft,t=i.gutters.firstChild,r=0;t;t=t.nextSibling,++r)u[n.options.gutters[r]]=t.offsetLeft+t.clientLeft+e,f[n.options.gutters[r]]=t.clientWidth;return{fixedPos:nc(i),gutterTotalWidth:i.gutters.offsetWidth,gutterLeft:u,gutterWidth:f,wrapperWidth:i.wrapper.clientWidth}}function nc(n){return n.scroller.getBoundingClientRect().left-n.sizer.getBoundingClientRect().left}function bv(n){var t=er(n.display),i=n.options.lineWrapping,r=i&&Math.max(5,n.display.scroller.clientWidth/lf(n.display)-3);return function(u){var e,f;if(rr(n.doc,u))return 0;if(e=0,u.widgets)for(f=0;f<u.widgets.length;f++)u.widgets[f].height&&(e+=u.widgets[f].height);return i?e+(Math.ceil(u.text.length/r)||1)*t:e+t}}function tc(n){var t=n.doc,i=bv(n);t.iter(function(n){var t=i(n);t!=n.height&&dt(n,t)})}function or(i,r,u,f){var a=i.display,s,c,h,o,e,l;if(!u&&"true"==fh(r).getAttribute("cm-not-content"))return null;h=a.lineSpace.getBoundingClientRect();try{s=r.clientX-h.left;c=r.clientY-h.top}catch(r){return null}return e=bh(i,s,c),f&&1==e.xRel&&(o=t(i.doc,e.line).text).length==e.ch&&(l=at(o,o.length,i.options.tabSize)-o.length,e=n(e.line,Math.max(0,Math.round((s-ev(i.display).left)/lf(i.display))-l))),e}function sr(n,t){if(t>=n.display.viewTo||(t-=n.display.viewFrom)<0)return null;for(var r=n.display.view,i=0;i<r.length;i++)if((t-=r[i].size)<0)return i}function af(n){n.display.input.showSelection(n.display.input.prepareSelection())}function kv(n,t){var i,e;void 0===t&&(t=!0);for(var u=n.doc,f={},o=f.cursors=document.createDocumentFragment(),s=f.selection=document.createDocumentFragment(),r=0;r<u.sel.ranges.length;r++)(t||r!=u.sel.primIndex)&&(i=u.sel.ranges[r],i.from().line>=n.display.viewTo||i.to().line<n.display.viewFrom||(e=i.empty(),(e||n.options.showCursorWhenSelecting)&&dv(n,i.head,o),e||pd(n,i,s)));return f}function dv(n,t,r){var u=pt(n,t,"div",null,null,!n.options.singleCursorHeightPerLine),e=r.appendChild(i("div"," ","CodeMirror-cursor")),f;(e.style.left=u.left+"px",e.style.top=u.top+"px",e.style.height=Math.max(0,u.bottom-u.top)*n.options.cursorHeight+"px",u.other)&&(f=r.appendChild(i("div"," ","CodeMirror-cursor CodeMirror-secondarycursor")),f.style.display="",f.style.left=u.other.left+"px",f.style.top=u.other.top+"px",f.style.height=.85*(u.other.bottom-u.other.top)+"px")}function co(n,t){return n.top-t.top||n.left-t.left}function pd(r,u,f){function e(n,t,r,u){t<0&&(t=0);t=Math.round(t);u=Math.round(u);b.appendChild(i("div",null,"CodeMirror-selected","position: absolute; left: "+n+"px;\n                             top: "+t+"px; width: "+(null==r?y-n:r)+"px;\n                             height: "+(u-t)+"px"))}function v(i,u,f){function l(t,u){return ph(r,n(i,t),"div",c,u)}var o,h,c=t(a,i),v=c.text.length,p=oi(c,a.direction);return uk(p,u||0,null==f?v:f,function(n,t,i,a){var b=l(n,"ltr"==i?"left":"right"),w=l(t-1,"ltr"==i?"right":"left"),d,rt,nt,k,g,tt,it;"ltr"==i?(d=null==u&&0==n?s:b.left,rt=null==f&&t==v?y:w.right,w.top-b.top<=3?e(d,w.top,rt-d,w.bottom):(e(d,b.top,null,b.bottom),b.bottom<w.top&&e(s,b.bottom,null,w.top),e(s,w.top,w.right,w.bottom))):n<t&&(nt=null==u&&0==n?y:b.right,k=null==f&&t==v?s:w.left,w.top-b.top<=3?e(k,w.top,nt-k,w.bottom):(g=s,a&&(tt=kh(r,c,null,n).end,g=l(tt-(/\s/.test(c.text.charAt(tt-1))?2:1),"left").left),e(g,b.top,nt-g,b.bottom),b.bottom<w.top&&e(s,b.bottom,null,w.top),it=null,p.length,it=l(kh(r,c,null,t).begin,"right").right-k,e(k,w.top,it,w.bottom)));(!o||co(b,o)<0)&&(o=b);co(w,o)<0&&(o=w);(!h||co(b,h)<0)&&(h=b);co(w,h)<0&&(h=w)}),{start:o,end:h}}var w=r.display,a=r.doc,b=document.createDocumentFragment(),k=ev(r.display),s=k.left,y=Math.max(w.sizerWidth,fr(r)-w.sizer.offsetLeft)-k.right,c=u.from(),l=u.to();if(c.line==l.line)v(c.line,c.ch,l.ch);else{var d=t(a,c.line),g=t(a,l.line),p=gt(d)==gt(g),o=v(c.line,c.ch,p?d.text.length+1:null).end,h=v(l.line,p?0:null,l.ch).start;p&&(o.top<h.top-2?(e(o.right,o.top,null,o.bottom),e(s,h.top,h.left,h.bottom)):e(o.right,o.top,h.left-o.right,o.bottom));o.bottom<h.top&&e(s,o.bottom,null,h.top)}f.appendChild(b)}function ic(n){var t,i;n.state.focused&&(t=n.display,clearInterval(t.blinker),i=!0,t.cursorDiv.style.visibility="",n.options.cursorBlinkRate>0?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},n.options.cursorBlinkRate):n.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function gv(n){n.state.focused||(n.display.input.focus(),rc(n))}function ny(n){n.state.delayingBlurEvent=!0;setTimeout(function(){n.state.delayingBlurEvent&&(n.state.delayingBlurEvent=!1,vf(n))},100)}function rc(n,t){n.state.delayingBlurEvent&&(n.state.delayingBlurEvent=!1);"nocursor"!=n.options.readOnly&&(n.state.focused||(v(n,"focus",n,t),n.state.focused=!0,gi(n.display.wrapper,"CodeMirror-focused"),n.curOp||n.display.selForContextMenu==n.doc.sel||(n.display.input.reset(),tt&&setTimeout(function(){return n.display.input.reset(!0)},20)),n.display.input.receivedFocus()),ic(n))}function vf(n,t){n.state.delayingBlurEvent||(n.state.focused&&(v(n,"blur",n,t),n.state.focused=!1,yr(n.display.wrapper,"CodeMirror-focused")),clearInterval(n.display.blinker),setTimeout(function(){n.state.focused||(n.display.shift=!1)},150))}function lo(n){for(var t,i,o,s,h,u,r=n.display,c=r.lineDiv.offsetTop,f=0;f<r.view.length;f++)if(t=r.view[f],i=void 0,!t.hidden&&(e&&l<8?(o=t.node.offsetTop+t.node.offsetHeight,i=o-c,c=o):(s=t.node.getBoundingClientRect(),i=s.bottom-s.top),h=t.line.height-i,i<2&&(i=er(r)),(h>.005||h<-.005)&&(dt(t.line,i),ty(t.line),t.rest)))for(u=0;u<t.rest.length;u++)ty(t.rest[u])}function ty(n){if(n.widgets)for(var t=0;t<n.widgets.length;++t)n.widgets[t].height=n.widgets[t].node.parentNode.offsetHeight}function uc(n,i,r){var f=r&&null!=r.top?Math.max(0,r.top):n.scroller.scrollTop,o,s;f=Math.floor(f-so(n));var h=r&&null!=r.bottom?r.bottom:f+n.wrapper.clientHeight,u=ir(i,f),e=ir(i,h);return r&&r.ensure&&(o=r.ensure.from.line,s=r.ensure.to.line,o<u?(u=o,e=ir(i,ei(t(i,o))+n.wrapper.clientHeight)):Math.min(s,i.lastLine())>=e&&(u=ir(i,ei(t(i,s))-n.wrapper.clientHeight),e=s)),{from:u,to:Math.max(e,u+1)}}function iy(n){var i=n.display,r=i.view,u,f;if(i.alignWidgets||i.gutters.firstChild&&n.options.fixedGutter){for(var o=nc(i)-i.scroller.scrollLeft+n.doc.scrollLeft,s=i.gutters.offsetWidth,e=o+"px",t=0;t<r.length;t++)if(!r[t].hidden&&(n.options.fixedGutter&&(r[t].gutter&&(r[t].gutter.style.left=e),r[t].gutterBackground&&(r[t].gutterBackground.style.left=e)),u=r[t].alignable,u))for(f=0;f<u.length;f++)u[f].style.left=e;n.options.fixedGutter&&(i.gutters.style.left=o+s+"px")}}function ry(n){if(!n.options.lineNumbers)return!1;var u=n.doc,r=bs(n.options,u.first+u.size-1),t=n.display;if(r.length!=t.lineNumChars){var f=t.measure.appendChild(i("div",[i("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),e=f.firstChild.offsetWidth,o=f.offsetWidth-e;return t.lineGutter.style.width="",t.lineNumInnerWidth=Math.max(e,t.lineGutter.offsetWidth-o)+1,t.lineNumWidth=t.lineNumInnerWidth+o,t.lineNumChars=t.lineNumInnerWidth?r.length:-1,t.lineGutter.style.width=t.lineNumWidth+"px",hc(n),!0}return!1}function wd(n,t){var u;if(!w(n,"scrollCursorIntoView")){var f=n.display,e=f.sizer.getBoundingClientRect(),r=null;(t.top+e.top<0?r=!0:t.bottom+e.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null==r||vtt)||(u=i("div","​",null,"position: absolute;\n                         top: "+(t.top-f.viewOffset-so(n.display))+"px;\n                         height: "+(t.bottom-t.top+ni(n)+f.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),n.display.lineSpace.appendChild(u),u.scrollIntoView(r),n.display.lineSpace.removeChild(u))}}function bd(t,i,r,u){var c,s;for(null==u&&(u=0),t.options.lineWrapping||i!=r||(r="before"==(i=i.ch?n(i.line,"before"==i.sticky?i.ch-1:i.ch,"after"):i).sticky?n(i.line,i.ch+1,"before"):i),s=0;s<5;s++){var h=!1,f=pt(t,i),e=r&&r!=i?pt(t,r):f,o=fc(t,c={left:Math.min(f.left,e.left),top:Math.min(f.top,e.top)-u,right:Math.max(f.left,e.left),bottom:Math.max(f.bottom,e.bottom)+u}),l=t.doc.scrollTop,a=t.doc.scrollLeft;if(null!=o.scrollTop&&(pf(t,o.scrollTop),Math.abs(t.doc.scrollTop-l)>1&&(h=!0)),null!=o.scrollLeft&&(hr(t,o.scrollLeft),Math.abs(t.doc.scrollLeft-a)>1&&(h=!0)),!h)break}return c}function kd(n,t){var i=fc(n,t);null!=i.scrollTop&&pf(n,i.scrollTop);null!=i.scrollLeft&&hr(n,i.scrollLeft)}function fc(n,t){var r=n.display,h=er(n.display),o;t.top<0&&(t.top=0);var e=n.curOp&&null!=n.curOp.scrollTop?n.curOp.scrollTop:r.scroller.scrollTop,u=ah(n),i={};t.bottom-t.top>u&&(t.bottom=t.top+u);var c=n.doc.height+lh(r),a=t.top<h,v=t.bottom>c-h;t.top<e?i.scrollTop=a?0:t.top:t.bottom>e+u&&(o=Math.min(t.top,(v?c:t.bottom)-u),o!=e&&(i.scrollTop=o));var l=n.curOp&&null!=n.curOp.scrollLeft?n.curOp.scrollLeft:r.scroller.scrollLeft,f=fr(n)-(n.options.fixedGutter?r.gutters.offsetWidth:0),s=t.right-t.left>f;return s&&(t.right=t.left+f),t.left<10?i.scrollLeft=0:t.left<l?i.scrollLeft=Math.max(0,t.left-(s?0:10)):t.right>f+l-3&&(i.scrollLeft=t.right+(s?0:10)-f),i}function ec(n,t){null!=t&&(ao(n),n.curOp.scrollTop=(null==n.curOp.scrollTop?n.doc.scrollTop:n.curOp.scrollTop)+t)}function nu(n){ao(n);var t=n.getCursor();n.curOp.scrollToPos={from:t,to:t,margin:n.options.cursorScrollMargin}}function yf(n,t,i){null==t&&null==i||ao(n);null!=t&&(n.curOp.scrollLeft=t);null!=i&&(n.curOp.scrollTop=i)}function dd(n,t){ao(n);n.curOp.scrollToPos=t}function ao(n){var t=n.curOp.scrollToPos;t&&(n.curOp.scrollToPos=null,uy(n,pv(n,t.from),pv(n,t.to),t.margin))}function uy(n,t,i,r){var u=fc(n,{left:Math.min(t.left,i.left),top:Math.min(t.top,i.top)-r,right:Math.max(t.right,i.right),bottom:Math.max(t.bottom,i.bottom)+r});yf(n,u.scrollLeft,u.scrollTop)}function pf(n,t){Math.abs(n.doc.scrollTop-t)<2||(wi||sc(n,{top:t}),fy(n,t,!0),wi&&sc(n),bf(n,100))}function fy(n,t,i){t=Math.min(n.display.scroller.scrollHeight-n.display.scroller.clientHeight,t);(n.display.scroller.scrollTop!=t||i)&&(n.doc.scrollTop=t,n.display.scrollbars.setScrollTop(t),n.display.scroller.scrollTop!=t&&(n.display.scroller.scrollTop=t))}function hr(n,t,i,r){t=Math.min(t,n.display.scroller.scrollWidth-n.display.scroller.clientWidth);(i?t==n.doc.scrollLeft:Math.abs(n.doc.scrollLeft-t)<2)&&!r||(n.doc.scrollLeft=t,iy(n),n.display.scroller.scrollLeft!=t&&(n.display.scroller.scrollLeft=t),n.display.scrollbars.setScrollLeft(t))}function wf(n){var t=n.display,i=t.gutters.offsetWidth,r=Math.round(n.doc.height+lh(n.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:n.options.fixedGutter?i:0,docHeight:r,scrollHeight:r+ni(n)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function tu(n,t){var i,r,u;for(t||(t=wf(n)),i=n.display.barWidth,r=n.display.barHeight,ey(n,t),u=0;u<4&&i!=n.display.barWidth||r!=n.display.barHeight;u++)i!=n.display.barWidth&&n.options.lineWrapping&&lo(n),ey(n,wf(n)),i=n.display.barWidth,r=n.display.barHeight}function ey(n,t){var i=n.display,r=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=r.right)+"px";i.sizer.style.paddingBottom=(i.barHeight=r.bottom)+"px";i.heightForcer.style.borderBottom=r.bottom+"px solid transparent";r.right&&r.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=r.bottom+"px",i.scrollbarFiller.style.width=r.right+"px"):i.scrollbarFiller.style.display="";r.bottom&&n.options.coverGutterNextToScrollbar&&n.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=r.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function oy(n){n.display.scrollbars&&(n.display.scrollbars.clear(),n.display.scrollbars.addClass&&yr(n.display.wrapper,n.display.scrollbars.addClass));n.display.scrollbars=new ob[n.options.scrollbarStyle](function(t){n.display.wrapper.insertBefore(t,n.display.scrollbarFiller);r(t,"mousedown",function(){n.state.focused&&setTimeout(function(){return n.display.input.focus()},0)});t.setAttribute("cm-not-content","true")},function(t,i){"horizontal"==i?hr(n,t):pf(n,t)},n);n.display.scrollbars.addClass&&gi(n.display.wrapper,n.display.scrollbars.addClass)}function cr(n){n.curOp={cm:n,viewChanged:!1,startHeight:n.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++rit};dk(n.curOp)}function lr(n){nd(n.curOp,function(n){for(var t=0;t<n.ops.length;t++)n.ops[t].cm.curOp=null;gd(n)})}function gd(n){for(var r,u,f,e,t=n.ops,i=0;i<t.length;i++)ng(t[i]);for(r=0;r<t.length;r++)tg(t[r]);for(u=0;u<t.length;u++)ig(t[u]);for(f=0;f<t.length;f++)rg(t[f]);for(e=0;e<t.length;e++)ug(t[e])}function ng(n){var t=n.cm,i=t.display;og(t);n.updateMaxLine&&ih(t);n.mustUpdate=n.viewChanged||n.forceUpdate||null!=n.scrollTop||n.scrollToPos&&(n.scrollToPos.from.line<i.viewFrom||n.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping;n.update=n.mustUpdate&&new os(t,n.mustUpdate&&{top:n.scrollTop,ensure:n.scrollToPos},n.forceUpdate)}function tg(n){n.updatedDisplay=n.mustUpdate&&oc(n.cm,n.update)}function ig(n){var t=n.cm,i=t.display;n.updatedDisplay&&lo(t);n.barMeasure=wf(t);i.maxLineChanged&&!t.options.lineWrapping&&(n.adjustWidthTo=sv(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=n.adjustWidthTo,n.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+n.adjustWidthTo+ni(t)+t.display.barWidth),n.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+n.adjustWidthTo-fr(t)));(n.updatedDisplay||n.selectionChanged)&&(n.preparedSelection=i.input.prepareSelection())}function rg(n){var t=n.cm,i;null!=n.adjustWidthTo&&(t.display.sizer.style.minWidth=n.adjustWidthTo+"px",n.maxScrollLeft<t.doc.scrollLeft&&hr(t,Math.min(t.display.scroller.scrollLeft,n.maxScrollLeft),!0),t.display.maxLineChanged=!1);i=n.focus&&n.focus==fi();n.preparedSelection&&t.display.input.showSelection(n.preparedSelection,i);(n.updatedDisplay||n.startHeight!=t.doc.height)&&tu(t,n.barMeasure);n.updatedDisplay&&cc(t,n.barMeasure);n.selectionChanged&&ic(t);t.state.focused&&n.updateInput&&t.display.input.reset(n.typing);i&&gv(n.cm)}function ug(n){var t=n.cm,o=t.display,s=t.doc,i,r,u,e;if(n.updatedDisplay&&hy(t,n.update),null==o.wheelStartX||null==n.scrollTop&&null==n.scrollLeft&&!n.scrollToPos||(o.wheelStartX=o.wheelStartY=null),null!=n.scrollTop&&fy(t,n.scrollTop,n.forceScroll),null!=n.scrollLeft&&hr(t,n.scrollLeft,!0,!0),n.scrollToPos&&wd(t,bd(t,f(s,n.scrollToPos.from),f(s,n.scrollToPos.to),n.scrollToPos.margin)),i=n.maybeHiddenMarkers,r=n.maybeUnhiddenMarkers,i)for(u=0;u<i.length;++u)i[u].lines.length||v(i[u],"hide");if(r)for(e=0;e<r.length;++e)r[e].lines.length&&v(r[e],"unhide");o.wrapper.offsetHeight&&(s.scrollTop=t.display.scroller.scrollTop);n.changeObjs&&v(t,"changes",t,n.changeObjs);n.update&&n.update.finish()}function ot(n,t){if(n.curOp)return t();cr(n);try{return t()}finally{lr(n)}}function b(n,t){return function(){if(n.curOp)return t.apply(n,arguments);cr(n);try{return t.apply(n,arguments)}finally{lr(n)}}}function rt(n){return function(){if(this.curOp)return n.apply(this,arguments);cr(this);try{return n.apply(this,arguments)}finally{lr(this)}}}function k(n){return function(){var t=this.cm;if(!t||t.curOp)return n.apply(this,arguments);cr(t);try{return n.apply(this,arguments)}finally{lr(t)}}}function et(n,t,i,r){var u,e,o,s,h,f;null==t&&(t=n.doc.first);null==i&&(i=n.doc.first+n.doc.size);r||(r=0);u=n.display;(r&&i<u.viewTo&&(null==u.updateLineNumbers||u.updateLineNumbers>t)&&(u.updateLineNumbers=t),n.curOp.viewChanged=!0,t>=u.viewTo)?ki&&nh(n.doc,t)<u.viewTo&&vi(n):i<=u.viewFrom?ki&&oa(n.doc,i+r)>u.viewFrom?vi(n):(u.viewFrom+=r,u.viewTo+=r):t<=u.viewFrom&&i>=u.viewTo?vi(n):t<=u.viewFrom?(e=vo(n,i,i+r,1),e?(u.view=u.view.slice(e.index),u.viewFrom=e.lineN,u.viewTo+=r):vi(n)):i>=u.viewTo?(o=vo(n,t,t,-1),o?(u.view=u.view.slice(0,o.index),u.viewTo=o.lineN):vi(n)):(s=vo(n,t,t,-1),h=vo(n,i,i+r,1),s&&h?(u.view=u.view.slice(0,s.index).concat(oo(n,s.lineN,h.lineN)).concat(u.view.slice(h.index)),u.viewTo+=r):vi(n));f=u.externalMeasured;f&&(i<f.lineN?f.lineN+=r:t<f.lineN+f.size&&(u.externalMeasured=null))}function ai(n,t,i){var r,u,f,e;n.curOp.viewChanged=!0;r=n.display;u=n.display.externalMeasured;(u&&t>=u.lineN&&t<u.lineN+u.size&&(r.externalMeasured=null),t<r.viewFrom||t>=r.viewTo)||(f=r.view[sr(n,t)],null!=f.node&&(e=f.changes||(f.changes=[]),-1==d(e,i)&&e.push(i)))}function vi(n){n.display.viewFrom=n.display.viewTo=n.doc.first;n.display.view=[];n.display.viewOffset=0}function vo(n,t,i,r){var o,u=sr(n,t),f=n.display.view,e,s;if(!ki||i==n.doc.first+n.doc.size)return{index:u,lineN:i};for(e=n.display.viewFrom,s=0;s<u;s++)e+=f[s].size;if(e!=t){if(r>0){if(u==f.length-1)return null;o=e+f[u].size-t;u++}else o=e-t;t+=o;i+=o}for(;nh(n.doc,i)!=i;){if(u==(r<0?0:f.length-1))return null;i+=r*f[u-(r<0?1:0)].size;u+=r}return{index:u,lineN:i}}function fg(n,t,i){var r=n.display;0==r.view.length||t>=r.viewTo||i<=r.viewFrom?(r.view=oo(n,t,i),r.viewFrom=t):(r.viewFrom>t?r.view=oo(n,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(sr(n,t))),r.viewFrom=t,r.viewTo<i?r.view=r.view.concat(oo(n,r.viewTo,i)):r.viewTo>i&&(r.view=r.view.slice(0,sr(n,i))));r.viewTo=i}function sy(n){for(var t,r=n.display.view,u=0,i=0;i<r.length;i++)t=r[i],t.hidden||t.node&&!t.changes||++u;return u}function bf(n,t){n.doc.highlightFrontier<n.display.viewTo&&n.state.highlight.set(t,ls(eg,n))}function eg(n){var i=n.doc;if(!(i.highlightFrontier>=n.display.viewTo)){var u=+new Date+n.options.workTime,t=of(n,i.highlightFrontier),r=[];i.iter(t.line,Math.min(i.first+i.size,n.display.viewTo+500),function(f){var o,e,c,s;if(t.line>=n.display.viewFrom){var h=f.styles,l=f.text.length>n.options.maxHighlightLength?ur(i.mode,t.state):null,a=aa(n,f,t,!0);for(l&&(t.state=l),f.styles=a.styles,o=f.styleClasses,e=a.classes,e?f.styleClasses=e:o&&(f.styleClasses=null),c=!h||h.length!=f.styles.length||o!=e&&(!o||!e||o.bgClass!=e.bgClass||o.textClass!=e.textClass),s=0;!c&&s<h.length;++s)c=h[s]!=f.styles[s];c&&r.push(t.line);f.stateAfter=t.save();t.nextLine()}else f.text.length<=n.options.maxHighlightLength&&sh(n,f.text,t),f.stateAfter=t.line%5==0?t.save():null,t.nextLine();if(+new Date>u)return bf(n,n.options.workDelay),!0});i.highlightFrontier=t.line;i.modeFrontier=Math.max(i.modeFrontier,t.line);r.length&&ot(n,function(){for(var t=0;t<r.length;t++)ai(n,r[t],"text")})}}function og(n){var t=n.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=ni(n)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=ni(n)+"px",t.scrollbarsClipped=!0)}function sg(n){var r,i,t;return n.hasFocus()?null:(r=fi(),!r||!li(n.display.lineDiv,r))?null:(i={activeElt:r},window.getSelection&&(t=window.getSelection(),t.anchorNode&&t.extend&&li(n.display.lineDiv,t.anchorNode)&&(i.anchorNode=t.anchorNode,i.anchorOffset=t.anchorOffset,i.focusNode=t.focusNode,i.focusOffset=t.focusOffset)),i)}function hg(n){if(n&&n.activeElt&&n.activeElt!=fi()&&(n.activeElt.focus(),n.anchorNode&&li(document.body,n.anchorNode)&&li(document.body,n.focusNode))){var t=window.getSelection(),i=document.createRange();i.setEnd(n.anchorNode,n.anchorOffset);i.collapse(!1);t.removeAllRanges();t.addRange(i);t.extend(n.focusNode,n.focusOffset)}}function oc(n,i){var r=n.display,e=n.doc,s,o,c;if(i.editorIsHidden)return vi(n),!1;if(!i.force&&i.visible.from>=r.viewFrom&&i.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==sy(n))return!1;ry(n)&&(vi(n),i.dims=gh(n));var h=e.first+e.size,u=Math.max(i.visible.from-n.options.viewportMargin,e.first),f=Math.min(h,i.visible.to+n.options.viewportMargin);return(r.viewFrom<u&&u-r.viewFrom<20&&(u=Math.max(e.first,r.viewFrom)),r.viewTo>f&&r.viewTo-f<20&&(f=Math.min(h,r.viewTo)),ki&&(u=nh(n.doc,u),f=oa(n.doc,f)),s=u!=r.viewFrom||f!=r.viewTo||r.lastWrapHeight!=i.wrapperHeight||r.lastWrapWidth!=i.wrapperWidth,fg(n,u,f),r.viewOffset=ei(t(n.doc,r.viewFrom)),n.display.mover.style.top=r.viewOffset+"px",o=sy(n),!s&&0==o&&!i.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))?!1:(c=sg(n),o>4&&(r.lineDiv.style.display="none"),cg(n,r.updateLineNumbers,i.dims),o>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,hg(c),ci(r.cursorDiv),ci(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,s&&(r.lastWrapHeight=i.wrapperHeight,r.lastWrapWidth=i.wrapperWidth,bf(n,400)),r.updateLineNumbers=null,!0)}function hy(n,t){for(var u,i=t.viewport,r=!0;(r&&n.options.lineWrapping&&t.oldDisplayWidth!=fr(n)||(i&&null!=i.top&&(i={top:Math.min(n.doc.height+lh(n.display)-ah(n),i.top)}),t.visible=uc(n.display,n.doc,i),!(t.visible.from>=n.display.viewFrom&&t.visible.to<=n.display.viewTo)))&&oc(n,t);r=!1)lo(n),u=wf(n),af(n),tu(n,u),cc(n,u),t.force=!1;t.signal(n,"update",n);n.display.viewFrom==n.display.reportedViewFrom&&n.display.viewTo==n.display.reportedViewTo||(t.signal(n,"viewportChange",n,n.display.viewFrom,n.display.viewTo),n.display.reportedViewFrom=n.display.viewFrom,n.display.reportedViewTo=n.display.viewTo)}function sc(n,t){var i=new os(n,t),r;oc(n,i)&&(lo(n),hy(n,i),r=wf(n),af(n),tu(n,r),cc(n,r),i.finish())}function cg(n,t,i){function c(t){var i=t.nextSibling;return tt&&kt&&n.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var r,h,a,e=n.display,v=n.options.lineNumbers,o=e.lineDiv,u=o.firstChild,l=e.view,f=e.viewFrom,s=0;s<l.length;s++){if(r=l[s],!r.hidden)if(r.node&&r.node.parentNode==o){for(;u!=r.node;)u=c(u);h=v&&null!=t&&t<=f&&r.lineNumber;r.changes&&(d(r.changes,"gutter")>-1&&(h=!1),tv(n,r,f,i));h&&(ci(r.lineNumber),r.lineNumber.appendChild(document.createTextNode(bs(n.options,f))));u=r.node.nextSibling}else a=fd(n,r,f,i),o.insertBefore(a,u);f+=r.size}for(;u;)u=c(u)}function hc(n){var t=n.display.gutters.offsetWidth;n.display.sizer.style.marginLeft=t+"px"}function cc(n,t){n.display.sizer.style.minHeight=t.docHeight+"px";n.display.heightForcer.style.top=t.docHeight+"px";n.display.gutters.style.height=t.docHeight+n.display.barHeight+ni(n)+"px"}function cy(n){var r=n.display.gutters,e=n.options.gutters,t,u,f;for(ci(r),t=0;t<e.length;++t)u=e[t],f=r.appendChild(i("div",null,"CodeMirror-gutter "+u)),"CodeMirror-linenumbers"==u&&(n.display.lineGutter=f,f.style.width=(n.display.lineNumWidth||1)+"px");r.style.display=t?"":"none";hc(n)}function lc(n){var t=d(n.gutters,"CodeMirror-linenumbers");-1==t&&n.lineNumbers?n.gutters=n.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!n.lineNumbers&&(n.gutters=n.gutters.slice(0),n.gutters.splice(t,1))}function ly(n){var i=n.wheelDeltaX,t=n.wheelDeltaY;return null==i&&n.detail&&n.axis==n.HORIZONTAL_AXIS&&(i=n.detail),null==t&&n.detail&&n.axis==n.VERTICAL_AXIS?t=n.detail:null==t&&(t=n.wheelDelta),{x:i,y:t}}function lg(n){var t=ly(n);return t.x*=st,t.y*=st,t}function ay(n,t){var v=ly(t),e=v.x,u=v.y,i=n.display,r=i.scroller,y=r.scrollWidth>r.clientWidth,h=r.scrollHeight>r.clientHeight,f,c,o;if(e&&y||u&&h){if(u&&kt&&tt)n:for(f=t.target,c=i.view;f!=r;f=f.parentNode)for(o=0;o<c.length;o++)if(c[o].node==f){n.display.currentWheelTarget=f;break n}if(e&&!wi&&!bt&&null!=st)return u&&h&&pf(n,Math.max(0,r.scrollTop+u*st)),hr(n,Math.max(0,r.scrollLeft+e*st)),(!u||u&&h)&&it(t),void(i.wheelStartX=null);if(u&&null!=st){var l=u*st,s=n.doc.scrollTop,a=s+i.wrapper.clientHeight;l<0?s=Math.max(0,s+l-50):a=Math.min(n.doc.height,a+l+50);sc(n,{top:s,bottom:a})}ae<20&&(null==i.wheelStartX?(i.wheelStartX=r.scrollLeft,i.wheelStartY=r.scrollTop,i.wheelDX=e,i.wheelDY=u,setTimeout(function(){if(null!=i.wheelStartX){var n=r.scrollLeft-i.wheelStartX,t=r.scrollTop-i.wheelStartY,u=t&&i.wheelDY&&t/i.wheelDY||n&&i.wheelDX&&n/i.wheelDX;i.wheelStartX=i.wheelStartY=null;u&&(st=(st*ae+u)/(ae+1),++ae)}},200)):(i.wheelDX+=e,i.wheelDY+=u))}}function wt(n,t){var c=n[t],i,f,r;for(n.sort(function(n,t){return u(n.from(),t.from())}),t=d(n,c),i=1;i<n.length;i++)if(f=n[i],r=n[i-1],u(r.to(),f.from())>=0){var e=to(r.from(),f.from()),s=no(r.to(),f.to()),h=r.empty()?f.from()==f.head:r.from()==r.head;i<=t&&--t;n.splice(--i,2,new o(h?s:e,h?e:s))}return new ht(n,t)}function yi(n,t){return new ht([new o(n,t||n)],0)}function pi(t){return t.text?n(t.from.line+t.text.length-1,s(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function vy(t,i){if(u(t,i.from)<0)return t;if(u(t,i.to)<=0)return pi(i);var f=t.line+i.text.length-(i.to.line-i.from.line)-1,r=t.ch;return t.line==i.to.line&&(r+=pi(i).ch-i.to.ch),n(f,r)}function ac(n,t){for(var u,r=[],i=0;i<n.sel.ranges.length;i++)u=n.sel.ranges[i],r.push(new o(vy(u.anchor,t),vy(u.head,t)));return wt(r,n.sel.primIndex)}function yy(t,i,r){return t.line==i.line?n(r.line,t.ch-i.ch+r.ch):n(r.line+(t.line-i.line),t.ch)}function ag(t,i,r){for(var v,y,h=[],e=n(t.first,0),c=e,f=0;f<i.length;f++){var l=i[f],s=yy(l.from,e,c),a=yy(pi(l),e,c);(e=l.to,c=a,"around"==r)?(v=t.sel.ranges[f],y=u(v.head,v.anchor)<0,h[f]=new o(y?a:s,y?s:a)):h[f]=new o(s,s)}return new ht(h,t.sel.primIndex)}function vc(n){n.doc.mode=eh(n.options,n.doc.modeOption);kf(n)}function kf(n){n.doc.iter(function(n){n.stateAfter&&(n.stateAfter=null);n.styles&&(n.styles=null)});n.doc.modeFrontier=n.doc.highlightFrontier=n.doc.first;bf(n,100);n.state.modeGen++;n.curOp&&et(n)}function py(n,t){return 0==t.from.ch&&0==t.to.ch&&""==s(t.text)&&(!n.cm||n.cm.options.wholeLineUpdateBefore)}function yc(n,i,r,u){function a(n){return r?r[n]:null}function h(n,t,r){ak(n,t,r,u);g(n,"change",n,i)}function y(n,t){for(var r=[],i=n;i<t;++i)r.push(new pr(f[i],a(i),u));return r}var e=i.from,c=i.to,f=i.text,o=t(n,e.line),l=t(n,c.line),w=s(f),p=a(f.length-1),v=c.line-e.line,b,k,d;i.full?(n.insert(0,y(0,f.length)),n.remove(f.length,n.size-f.length)):py(n,i)?(b=y(0,f.length-1),h(l,l.text,p),v&&n.remove(e.line,v),b.length&&n.insert(e.line,b)):o==l?1==f.length?h(o,o.text.slice(0,e.ch)+w+o.text.slice(c.ch),p):(k=y(1,f.length-1),k.push(new pr(w+o.text.slice(c.ch),p,u)),h(o,o.text.slice(0,e.ch)+f[0],a(0)),n.insert(e.line+1,k)):1==f.length?(h(o,o.text.slice(0,e.ch)+f[0]+l.text.slice(c.ch),a(0)),n.remove(e.line+1,v)):(h(o,o.text.slice(0,e.ch)+f[0],a(0)),h(l,w+l.text.slice(c.ch),p),d=y(1,f.length-1),v>1&&n.remove(e.line+1,v-1),n.insert(e.line+1,d));g(n,"change",n,i)}function ar(n,t,i){function r(n,u,f){var o,e,s;if(n.linked)for(o=0;o<n.linked.length;++o)e=n.linked[o],e.doc!=u&&(s=f&&e.sharedHist,i&&!s||(t(e.doc,s),r(e.doc,n,s)))}r(n,null,!0)}function wy(n,t){if(t.cm)throw new Error("This document is already in use.");n.doc=t;t.cm=n;tc(n);vc(n);by(n);n.options.lineWrapping||ih(n);n.options.mode=t.modeOption;et(n)}function by(n){("rtl"==n.doc.direction?gi:yr)(n.display.lineDiv,"CodeMirror-rtl")}function vg(n){ot(n,function(){by(n);et(n)})}function yo(n){this.done=[];this.undone=[];this.undoDepth=1/0;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=n||1}function pc(n,t){var i={from:ds(t.from),to:pi(t),text:tr(n,t.from,t.to)};return gy(n,i,t.from.line,t.to.line+1),ar(n,function(n){return gy(n,i,t.from.line,t.to.line+1)},!0),i}function ky(n){for(;n.length&&s(n).ranges;)n.pop()}function yg(n,t){return t?(ky(n.done),s(n.done)):n.done.length&&!s(n.done).ranges?s(n.done):n.done.length>1&&!n.done[n.done.length-2].ranges?(n.done.pop(),s(n.done)):void 0}function dy(n,t,i,r){var f=n.history,e,o,h,c;if(f.undone.length=0,h=+new Date,(f.lastOp==r||f.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&n.cm&&f.lastModTime>h-n.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(e=yg(f,f.lastOp==r)))o=s(e.changes),0==u(t.from,t.to)&&0==u(t.from,o.to)?o.to=pi(t):e.changes.push(pc(n,t));else for(c=s(f.done),c&&c.ranges||po(n.sel,f.done),e={changes:[pc(n,t)],generation:f.generation},f.done.push(e);f.done.length>f.undoDepth;)f.done.shift(),f.done[0].ranges||f.done.shift();f.done.push(i);f.generation=++f.maxGeneration;f.lastModTime=f.lastSelTime=h;f.lastOp=f.lastSelOp=r;f.lastOrigin=f.lastSelOrigin=t.origin;o||v(n,"historyAdded")}function pg(n,t,i,r){var u=t.charAt(0);return"*"==u||"+"==u&&i.ranges.length==r.ranges.length&&i.somethingSelected()==r.somethingSelected()&&new Date-n.history.lastSelTime<=(n.cm?n.cm.options.historyEventDelay:500)}function wg(n,t,i,r){var u=n.history,f=r&&r.origin;i==u.lastSelOp||f&&u.lastSelOrigin==f&&(u.lastModTime==u.lastSelTime&&u.lastOrigin==f||pg(n,f,s(u.done),t))?u.done[u.done.length-1]=t:po(t,u.done);u.lastSelTime=+new Date;u.lastSelOrigin=f;u.lastSelOp=i;r&&!1!==r.clearRedo&&ky(u.undone)}function po(n,t){var i=s(t);i&&i.ranges&&i.equals(n)||t.push(n)}function gy(n,t,i,r){var u=t["spans_"+n.id],f=0;n.iter(Math.max(n.first,i),Math.min(n.first+n.size,r),function(i){i.markedSpans&&((u||(u=t["spans_"+n.id]={}))[f]=i.markedSpans);++f})}function bg(n){if(!n)return null;for(var t,i=0;i<n.length;++i)n[i].marker.explicitlyCleared?t||(t=n.slice(0,i)):t&&t.push(n[i]);return t?t.length?t:null:n}function kg(n,t){var u=t["spans_"+n.id],r,i;if(!u)return null;for(r=[],i=0;i<t.text.length;++i)r.push(bg(u[i]));return r}function np(n,t){var i=kg(n,t),s=gs(n,t),r,f,u,e,h,o;if(!i)return s;if(!s)return i;for(r=0;r<i.length;++r)if(f=i[r],u=s[r],f&&u)n:for(e=0;e<u.length;++e){for(h=u[e],o=0;o<f.length;++o)if(f[o].marker==h.marker)continue n;f.push(h)}else u&&(i[r]=u);return i}function iu(n,t,i){for(var u,l,h,c,r,a,f,e=[],o=0;o<n.length;++o)if(u=n[o],u.ranges)e.push(i?ht.prototype.deepCopy.call(u):u);else for(l=u.changes,h=[],e.push({changes:h}),c=0;c<l.length;++c)if(r=l[c],a=void 0,h.push({from:r.from,to:r.to,text:r.text}),t)for(f in r)(a=f.match(/^spans_(\d+)$/))&&d(t,Number(a[1]))>-1&&(s(h)[f]=r[f],delete r[f]);return e}function wc(n,t,i,r){var f,e;return r?(f=n.anchor,i&&(e=u(t,f)<0,e!=u(i,f)<0?(f=t,t=i):e!=u(t,i)<0&&(t=i)),new o(f,t)):new o(i||t,t)}function wo(n,t,i,r,u){null==u&&(u=n.cm&&(n.cm.display.shift||n.extend));nt(n,new ht([wc(n.sel.primary(),t,i,u)],0),r)}function tp(n,t,i){for(var u=[],f=n.cm&&(n.cm.display.shift||n.extend),r=0;r<n.sel.ranges.length;r++)u[r]=wc(n.sel.ranges[r],t[r],null,f);nt(n,wt(u,n.sel.primIndex),i)}function bc(n,t,i,r){var u=n.sel.ranges.slice(0);u[t]=i;nt(n,wt(u,n.sel.primIndex),r)}function ip(n,t,i,r){nt(n,yi(t,i),r)}function dg(n,t,i){var r={ranges:t.ranges,update:function(t){var r=this,i;for(this.ranges=[],i=0;i<t.length;i++)r.ranges[i]=new o(f(n,t[i].anchor),f(n,t[i].head))},origin:i&&i.origin};return v(n,"beforeSelectionChange",n,r),n.cm&&v(n.cm,"beforeSelectionChange",n.cm,r),r.ranges!=t.ranges?wt(r.ranges,r.ranges.length-1):t}function rp(n,t,i){var r=n.history.done,u=s(r);u&&u.ranges?(r[r.length-1]=t,bo(n,t,i)):nt(n,t,i)}function nt(n,t,i){bo(n,t,i);wg(n,n.sel,n.cm?n.cm.curOp.id:NaN,i)}function bo(n,t,i){(vt(n,"beforeSelectionChange")||n.cm&&vt(n.cm,"beforeSelectionChange"))&&(t=dg(n,t,i));up(n,ep(n,t,i&&i.bias||(u(t.primary().head,n.sel.primary().head)<0?-1:1),!0));i&&!1===i.scroll||!n.cm||nu(n.cm)}function up(n,t){t.equals(n.sel)||(n.sel=t,n.cm&&(n.cm.curOp.updateInput=n.cm.curOp.selectionChanged=!0,sa(n.cm)),g(n,"cursorActivity",n))}function fp(n){up(n,ep(n,n.sel,null,!1))}function ep(n,t,i,r){for(var f,u=0;u<t.ranges.length;u++){var e=t.ranges[u],s=t.ranges.length==n.sel.ranges.length&&n.sel.ranges[u],h=kc(n,e.anchor,s&&s.anchor,i,r),c=kc(n,e.head,s&&s.head,i,r);(f||h!=e.anchor||c!=e.head)&&(f||(f=t.ranges.slice(0,u)),f[u]=new o(h,c))}return f?wt(f,t.primIndex):t}function ru(n,i,r,f,e){var c=t(n,i.line),a,h,o,s,y,l;if(c.markedSpans)for(a=0;a<c.markedSpans.length;++a)if(h=c.markedSpans[a],o=h.marker,(null==h.from||(o.inclusiveLeft?h.from<=i.ch:h.from<i.ch))&&(null==h.to||(o.inclusiveRight?h.to>=i.ch:h.to>i.ch))){if(e&&(v(o,"beforeCursorEnter"),o.explicitlyCleared)){if(c.markedSpans){--a;continue}break}if(!o.atomic)continue;return r&&(s=o.find(f<0?1:-1),y=void 0,(f<0?o.inclusiveRight:o.inclusiveLeft)&&(s=op(n,s,-f,s&&s.line==i.line?c:null)),s&&s.line==i.line&&(y=u(s,r))&&(f<0?y<0:y>0))?ru(n,s,i,f,e):(l=o.find(f<0?-1:1),(f<0?o.inclusiveLeft:o.inclusiveRight)&&(l=op(n,l,f,l.line==i.line?c:null)),l?ru(n,l,i,f,e):null)}return i}function kc(t,i,r,u,f){var e=u||1,o=ru(t,i,r,e,f)||!f&&ru(t,i,r,e,!0)||ru(t,i,r,-e,f)||!f&&ru(t,i,r,-e,!0);return o||(t.cantEdit=!0,n(t.first,0))}function op(i,r,u,e){return u<0&&0==r.ch?r.line>i.first?f(i,n(r.line-1)):null:u>0&&r.ch==(e||t(i,r.line)).text.length?r.line<i.first+i.size-1?n(r.line+1,0):null:new n(r.line,r.ch+u)}function sp(t){t.setSelection(n(t.firstLine(),0),n(t.lastLine()),ii)}function hp(n,t,i){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return r.canceled=!0}};return i&&(r.update=function(t,i,u,e){t&&(r.from=f(n,t));i&&(r.to=f(n,i));u&&(r.text=u);void 0!==e&&(r.origin=e)}),v(n,"beforeChange",n,r),n.cm&&v(n.cm,"beforeChange",n.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function uu(n,t,i){var u,r;if(n.cm){if(!n.cm.curOp)return b(n.cm,uu)(n,t,i);if(n.cm.state.suppressEdits)return}if(!(vt(n,"beforeChange")||n.cm&&vt(n.cm,"beforeChange"))||(t=hp(n,t,!0)))if(u=ub&&!i&&tk(n,t.from,t.to),u)for(r=u.length-1;r>=0;--r)cp(n,{from:u[r].from,to:u[r].to,text:r?[""]:t.text,origin:t.origin});else cp(n,t)}function cp(n,t){var i,r;(1!=t.text.length||""!=t.text[0]||0!=u(t.from,t.to))&&(i=ac(n,t),dy(n,t,i,n.cm?n.cm.curOp.id:NaN),df(n,t,i,gs(n,t)),r=[],ar(n,function(n,i){i||-1!=d(r,n.history)||(yp(n.history,t),r.push(n.history));df(n,t,null,gs(n,t))}))}function ko(n,t,i){var c,v,o,l;if(!n.cm||!n.cm.state.suppressEdits||i){for(var r,u=n.history,a=n.sel,f="undo"==t?u.done:u.undone,h="undo"==t?u.undone:u.done,e=0;e<f.length&&(r=f[e],i?!r.ranges||r.equals(n.sel):r.ranges);e++);if(e!=f.length){for(u.lastOrigin=u.lastSelOrigin=null;(r=f.pop()).ranges;){if(po(r,h),i&&!r.equals(n.sel))return void nt(n,r,{clearRedo:!1});a=r}for(c=[],po(a,h),h.push({changes:c,generation:u.generation}),u.generation=r.generation||++u.maxGeneration,v=vt(n,"beforeChange")||n.cm&&vt(n.cm,"beforeChange"),o=r.changes.length-1;o>=0;--o)if(l=function(i){var u=r.changes[i],o,e;if(u.origin=t,v&&!hp(n,u,!1))return f.length=0,{};c.push(pc(n,u));o=i?ac(n,u):s(f);df(n,u,o,np(n,u));!i&&n.cm&&n.cm.scrollIntoView({from:u.from,to:pi(u)});e=[];ar(n,function(n,t){t||-1!=d(e,n.history)||(yp(n.history,u),e.push(n.history));df(n,u,null,np(n,u))})}(o),l)return l.v}}}function lp(t,i){if(0!=i&&(t.first+=i,t.sel=new ht(de(t.sel.ranges,function(t){return new o(n(t.anchor.line+i,t.anchor.ch),n(t.head.line+i,t.head.ch))}),t.sel.primIndex),t.cm)){et(t.cm,t.first,t.first-i,i);for(var u=t.cm.display,r=u.viewFrom;r<u.viewTo;r++)ai(t.cm,r,"gutter")}}function df(i,r,u,f){var o,e;if(i.cm&&!i.cm.curOp)return b(i.cm,df)(i,r,u,f);r.to.line<i.first?lp(i,r.text.length-1-(r.to.line-r.from.line)):r.from.line>i.lastLine()||(r.from.line<i.first&&(o=r.text.length-1-(i.first-r.from.line),lp(i,o),r={from:n(i.first,0),to:n(r.to.line+o,r.to.ch),text:[s(r.text)],origin:r.origin}),e=i.lastLine(),r.to.line>e&&(r={from:r.from,to:n(e,t(i,e).text.length),text:[r.text[0]],origin:r.origin}),r.removed=tr(i,r.from,r.to),u||(u=ac(i,r)),i.cm?gg(i.cm,r,f):yc(i,r,f),bo(i,u,ii))}function gg(n,i,r){var f=n.doc,e=n.display,u=i.from,o=i.to,s=!1,c=u.line,y,l,a,v;n.options.lineWrapping||(c=h(gt(t(f,u.line))),f.iter(c,o.line+1,function(n){if(n==e.maxLine)return s=!0,!0}));f.sel.contains(i.from,i.to)>-1&&sa(n);yc(f,i,r,bv(n));n.options.lineWrapping||(f.iter(c,u.line+i.text.length,function(n){var t=fo(n);t>e.maxLineLength&&(e.maxLine=n,e.maxLineLength=t,e.maxLineChanged=!0,s=!1)}),s&&(n.curOp.updateMaxLine=!0));lk(f,u.line);bf(n,400);y=i.text.length-(o.line-u.line)-1;i.full?et(n):u.line!=o.line||1!=i.text.length||py(n.doc,i)?et(n,u.line,o.line+1,y):ai(n,u.line,"text");l=vt(n,"changes");a=vt(n,"change");(a||l)&&(v={from:u,to:o,text:i.text,removed:i.removed,origin:i.origin},a&&g(n,"change",n,v),l&&(n.curOp.changeObjs||(n.curOp.changeObjs=[])).push(v));n.display.selForContextMenu=null}function fu(n,t,i,r,f){if(r||(r=i),u(r,i)<0){var e;i=(e=[r,i])[0];r=e[1]}"string"==typeof t&&(t=n.splitLines(t));uu(n,{from:i,to:r,text:t,origin:f})}function ap(n,t,i,r){i<n.line?n.line+=r:t<n.line&&(n.line=t,n.ch=0)}function vp(t,i,r,u){for(var f,c,s,h,e,o=0;o<t.length;++o)if(f=t[o],c=!0,f.ranges)for(f.copied||((f=t[o]=f.deepCopy()).copied=!0),s=0;s<f.ranges.length;s++)ap(f.ranges[s].anchor,i,r,u),ap(f.ranges[s].head,i,r,u);else{for(h=0;h<f.changes.length;++h)if(e=f.changes[h],r<e.from.line)e.from=n(e.from.line+u,e.from.ch),e.to=n(e.to.line+u,e.to.ch);else if(i<=e.to.line){c=!1;break}c||(t.splice(0,o+1),o=0)}}function yp(n,t){var i=t.from.line,r=t.to.line,u=t.text.length-(r-i)-1;vp(n.done,i,r,u);vp(n.undone,i,r,u)}function gf(n,i,r,u){var f=i,e=i;return"number"==typeof i?e=t(n,dl(n,i)):f=h(i),null==f?null:(u(e,f)&&n.cm&&ai(n.cm,f,r),e)}function ne(n){var r=this,i,t;for(this.lines=n,this.parent=null,i=0,t=0;t<n.length;++t)n[t].parent=r,i+=n[t].height;this.height=i}function te(n){var f=this,t;this.children=n;for(var r=0,u=0,i=0;i<n.length;++i)t=n[i],r+=t.chunkSize(),u+=t.height,t.parent=f;this.size=r;this.height=u;this.parent=null}function pp(n,t,i){ei(t)<(n.curOp&&n.curOp.scrollTop||n.doc.scrollTop)&&ec(n,i)}function nn(n,t,i,r){var u=new wu(n,i,r),f=n.cm;return f&&u.noHScroll&&(f.display.alignWidgets=!0),gf(n,t,"widget",function(t){var i=t.widgets||(t.widgets=[]),r;return(null==u.insertAt?i.push(u):i.splice(Math.min(i.length-1,Math.max(0,u.insertAt)),0,u),u.line=t,f&&!rr(n,t))&&(r=ei(t)<n.scrollTop,dt(t,t.height+hf(u)),r&&ec(f,u.height),f.curOp.forceUpdate=!0),!0}),g(f,"lineWidgetAdded",f,u,"number"==typeof t?t:h(t)),u}function eu(n,t,i,f,e){var o,l,a,h,s,c;if(f&&f.shared)return tn(n,t,i,f,e);if(n.cm&&!n.cm.curOp)return b(n.cm,eu)(n,t,i,f,e);if(o=new hi(n,e),l=u(t,i),f&&nr(f,o,!1),l>0||0==l&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=kr("span",[o.replacedWith],"CodeMirror-widget"),f.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),f.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(ea(n,t.line,t,i,o)||t.line!=i.line&&ea(n,i.line,t,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");bb()}if(o.addToHistory&&dy(n,{from:t,to:i,origin:"markText"},n.sel,NaN),h=t.line,s=n.cm,n.iter(h,i.line+1,function(n){s&&o.collapsed&&!s.options.lineWrapping&&gt(n)==s.display.maxLine&&(a=!0);o.collapsed&&h!=t.line&&dt(n,0);db(n,new io(o,h==t.line?t.ch:null,h==i.line?i.ch:null));++h}),o.collapsed&&n.iter(t.line,i.line+1,function(t){rr(n,t)&&dt(t,0)}),o.clearOnEnter&&r(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(wb(),(n.history.done.length||n.history.undone.length)&&n.clearHistory()),o.collapsed&&(o.id=++al,o.atomic=!0),s){if(a&&(s.curOp.updateMaxLine=!0),o.collapsed)et(s,t.line,i.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(c=t.line;c<=i.line;c++)ai(s,c,"text");o.atomic&&fp(s.doc);g(s,"markerAdded",s,o)}return o}function tn(n,t,i,r,u){(r=nr(r)).shared=!1;var e=[eu(n,t,i,r,u)],o=e[0],h=r.widgetNode;return ar(n,function(n){h&&(r.widgetNode=h.cloneNode(!0));e.push(eu(n,f(n,t),f(n,i),r,u));for(var c=0;c<n.linked.length;++c)if(n.linked[c].isParent)return;o=s(e)}),new bu(e,o)}function wp(t){return t.findMarks(n(t.first,0),t.clipPos(n(t.lastLine())),function(n){return n.parent})}function rn(n,t){for(var f,r=0;r<t.length;r++){var i=t[r],e=i.find(),o=n.clipPos(e.from),s=n.clipPos(e.to);u(o,s)&&(f=eu(n,o,s,i.primary,i.primary.type),i.markers.push(f),f.parent=i)}}function un(n){for(var t=0;t<n.length;t++)!function(t){var i=n[t],f=[i.primary.doc],r,u;for(ar(i.primary.doc,function(n){return f.push(n)}),r=0;r<i.markers.length;r++)u=i.markers[r],-1==d(f,u.doc)&&(u.parent=null,i.markers.splice(r--,1))}(t)}function fn(n){var t=this,i,r,c,u,o;if((bp(t),!w(t,n)&&!si(t.display,n))&&(it(n),e&&(hb=+new Date),i=or(t,n,!0),r=n.dataTransfer.files,i&&!t.isReadOnly()))if(r&&r.length&&window.FileReader&&window.File)for(var h=r.length,l=Array(h),a=0,s=0;s<h;++s)!function(n,r){if(!t.options.allowDropFileTypes||-1!=d(t.options.allowDropFileTypes,n.type)){var u=new FileReader;u.onload=b(t,function(){var n=u.result,e;(/[\x00-\x08\x0e-\x1f]{2}/.test(n)&&(n=""),l[r]=n,++a==h)&&(e={from:i=f(t.doc,i),to:i,text:t.doc.splitLines(l.join(t.doc.lineSeparator())),origin:"paste"},uu(t.doc,e),rp(t.doc,yi(i,pi(e))))});u.readAsText(n)}}(r[s],s);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1)return t.state.draggingText(n),void setTimeout(function(){return t.display.input.focus()},20);try{if(c=n.dataTransfer.getData("Text"),c){if(t.state.draggingText&&!t.state.draggingText.copy&&(u=t.listSelections()),bo(t.doc,yi(i,i)),u)for(o=0;o<u.length;++o)fu(t.doc,"",u[o].anchor,u[o].head,"drag");t.replaceSelection(c,"around","paste");t.display.input.focus()}}catch(n){}}}function en(n,t){if(e&&(!n.state.draggingText||+new Date-hb<100))ef(t);else if(!w(n,t)&&!si(n.display,t)&&(t.dataTransfer.setData("Text",n.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!tb)){var r=i("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";bt&&(r.width=r.height=1,n.display.wrapper.appendChild(r),r._top=r.offsetTop);t.dataTransfer.setDragImage(r,0,0);bt&&r.parentNode.removeChild(r)}}function on(n,t){var u=or(n,t),r;u&&(r=document.createDocumentFragment(),dv(n,u,r),n.display.dragCursor||(n.display.dragCursor=i("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),n.display.lineSpace.insertBefore(n.display.dragCursor,n.display.cursorDiv)),ct(n.display.dragCursor,r))}function bp(n){n.display.dragCursor&&(n.display.lineSpace.removeChild(n.display.dragCursor),n.display.dragCursor=null)}function kp(n){var i,t,r;if(document.getElementsByClassName)for(i=document.getElementsByClassName("CodeMirror"),t=0;t<i.length;t++)r=i[t].CodeMirror,r&&n(r)}function sn(){cb||(hn(),cb=!0)}function hn(){var n;r(window,"resize",function(){null==n&&(n=setTimeout(function(){n=null;kp(cn)},100))});r(window,"blur",function(){return kp(vf)})}function cn(n){var t=n.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,n.setSize())}function ln(n){var i=n.split(/-(?!$)/),u,f,e,o,r,t;for(n=i[i.length-1],r=0;r<i.length-1;r++)if(t=i[r],/^(cmd|meta|m)$/i.test(t))o=!0;else if(/^a(lt)?$/i.test(t))u=!0;else if(/^(c|ctrl|control)$/i.test(t))f=!0;else{if(!/^s(hift)?$/i.test(t))throw new Error("Unrecognized modifier name: "+t);e=!0}return u&&(n="Alt-"+n),f&&(n="Ctrl-"+n),o&&(n="Cmd-"+n),e&&(n="Shift-"+n),n}function an(n){var e={},t,o,r,u,f,i,s,h;for(t in n)if(n.hasOwnProperty(t)){if(o=n[t],/^(name|fallthrough|(de|at)tach)$/.test(t))continue;if("..."==o){delete n[t];continue}for(r=de(t.split(" "),ln),u=0;u<r.length;u++)if(f=void 0,i=void 0,u==r.length-1?(i=r.join(" "),f=o):(i=r.slice(0,u+1).join(" "),f="..."),s=e[i],s){if(s!=f)throw new Error("Inconsistent bindings for "+i);}else e[i]=f;delete n[t]}for(h in e)n[h]=e[h];return n}function ou(n,t,i,r){var u=(t=go(t)).call?t.call(n,r):t[n],f,e;if(!1===u)return"nothing";if("..."===u)return"multi";if(null!=u&&i(u))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ou(n,t.fallthrough,i,r);for(f=0;f<t.fallthrough.length;f++)if(e=ou(n,t.fallthrough[f],i,r),e)return e}}function dp(n){var t="string"==typeof n?n:di[n.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function gp(n,t,i){var r=n;return t.altKey&&"Alt"!=r&&(n="Alt-"+n),(ib?t.metaKey:t.ctrlKey)&&"Ctrl"!=r&&(n="Ctrl-"+n),(ib?t.ctrlKey:t.metaKey)&&"Cmd"!=r&&(n="Cmd-"+n),!i&&t.shiftKey&&"Shift"!=r&&(n="Shift-"+n),n}function nw(n,t){if(bt&&34==n.keyCode&&n.char)return!1;var i=di[n.keyCode];return null!=i&&!n.altGraphKey&&gp(i,n,t)}function go(n){return"string"==typeof n?ui[n]:n}function su(n,t){for(var r,e,o=n.doc.sel.ranges,i=[],f=0;f<o.length;f++){for(r=t(o[f]);i.length&&u(r.from,s(i).to)<=0;)if(e=i.pop(),u(e.from,r.from)<0){r.from=e.from;break}i.push(r)}ot(n,function(){for(var t=i.length-1;t>=0;t--)fu(n.doc,"",i[t].from,i[t].to,"+delete");nu(n)})}function dc(n,t,i){var r=kl(n.text,t+i,i);return r<0||r>n.text.length?null:r}function gc(t,i,r){var u=dc(t,i.ch,r);return null==u?null:new n(i.line,u,r<0?"after":"before")}function nl(t,i,r,u,f){var h,e,o,c,l,a;return t&&(h=oi(r,i.doc.direction),h)?(o=f<0?s(h):h[0],c=f<0==(1==o.level)?"after":"before",o.level>0?(l=gr(i,r),e=f<0?r.text.length-1:0,a=ti(i,l,e).top,e=nf(function(n){return ti(i,l,n).top==a},f<0==(1==o.level)?o.from:o.to-1,e),"before"==c&&(e=dc(r,e,1))):e=f<0?o.to:o.from,new n(u,e,c)):new n(u,f<0?r.text.length:0,f<0?"before":"after")}function vn(t,i,r,u){var o=oi(i,t.doc.direction),v,f,l,e,b,p,c,a;if(!o||(r.ch>=i.text.length?(r.ch=i.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after"),v=ff(o,r.ch,r.sticky),f=o[v],"ltr"==t.doc.direction&&f.level%2==0&&(u>0?f.to>r.ch:f.from<r.ch)))return gc(i,r,u);var y,s=function(t,r){return dc(i,t instanceof n?t.ch:t,r)},w=function(n){return t.options.lineWrapping?(y=y||gr(t,i),kh(t,i,y,n)):{begin:0,end:i.text.length}},h=w("before"==r.sticky?s(r,-1):r.ch);return("rtl"==t.doc.direction||1==f.level)&&(l=1==f.level==u<0,e=s(r,l?1:-1),null!=e&&(l?e<=f.to&&e<=h.end:e>=f.from&&e>=h.begin))?(b=l?"before":"after",new n(r.line,e,b)):(p=function(t,i,u){for(var c=function(t,i){return i?new n(r.line,s(t,1),"before"):new n(r.line,t,"after")};t>=0&&t<o.length;t+=i){var e=o[t],h=i>0==(1!=e.level),f=h?u.begin:s(u.end,-1);if(e.from<=f&&f<e.to||(f=h?e.from:s(e.to,-1),u.begin<=f&&f<u.end))return c(f,h)}},c=p(v+u,u,h),c)?c:(a=u>0?h.end:s(h.begin,-1),null==a||u>0&&a==i.text.length||!(c=p(u>0?0:o.length-1,u,w(a)))?null:c)}function tw(n,i){var u=t(n.doc,i),r=gt(u);return r!=u&&(i=h(r)),nl(!0,n,r,i,1)}function yn(n,i){var r=t(n.doc,i),u=ik(r);return u!=r&&(i=h(u)),nl(!0,n,r,i,-1)}function iw(i,r){var u=tw(i,r.line),e=t(i.doc,u.line),o=oi(e,i.doc.direction),f,s;return!o||0==o[0].level?(f=Math.max(0,e.text.search(/\S/)),s=r.line==u.line&&r.ch<=f&&r.ch,n(u.line,s?0:f,u.sticky)):u}function ns(n,t,i){if("string"==typeof t&&!(t=pe[t]))return!1;n.display.input.ensurePolled();var u=n.display.shift,r=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0);i&&(n.display.shift=!1);r=t(n)!=fs}finally{n.display.shift=u;n.state.suppressEdits=!1}return r}function pn(n,t,i){for(var u,r=0;r<n.state.keyMaps.length;r++)if(u=ou(t,n.state.keyMaps[r],i,n),u)return u;return n.options.extraKeys&&ou(t,n.options.extraKeys,i,n)||ou(t,n.options.keyMap,i,n)}function ie(n,t,i,r){var f=n.state.keySeq,u;if(f){if(dp(t))return"handled";uit.set(50,function(){n.state.keySeq==f&&(n.state.keySeq=null,n.display.input.reset())});t=f+" "+t}return u=pn(n,t,r),"multi"==u&&(n.state.keySeq=t),"handled"==u&&g(n,"keyHandled",n,t,i),"handled"!=u&&"multi"!=u||(it(i),ic(n)),f&&!u&&/\'$/.test(t)?(it(i),!0):!!u}function rw(n,t){var i=nw(t,!0);return!!i&&(t.shiftKey&&!n.state.keySeq?ie(n,"Shift-"+i,t,function(t){return ns(n,t,!0)})||ie(n,i,t,function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return ns(n,t)}):ie(n,i,t,function(t){return ns(n,t)}))}function wn(n,t,i){return ie(n,"'"+i+"'",t,function(t){return ns(n,t,!0)})}function uw(n){var t=this,i,r;(t.curOp.focus=fi(),w(t,n))||(e&&l<11&&27==n.keyCode&&(n.returnValue=!1),i=n.keyCode,t.display.shift=16==i||n.shiftKey,r=rw(t,n),bt&&(vl=r?i:null,!r&&88==i&&!nit&&(kt?n.metaKey:n.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||bn(t))}function bn(n){function t(n){18!=n.keyCode&&n.altKey||(yr(i,"CodeMirror-crosshair"),lt(document,"keyup",t),lt(document,"mouseover",t))}var i=n.display.lineDiv;gi(i,"CodeMirror-crosshair");r(document,"keyup",t);r(document,"mouseover",t)}function fw(n){16==n.keyCode&&(this.doc.sel.shift=!1);w(this,n)}function ew(n){var t=this,i,r,u;if(!(si(t.display,n)||w(t,n)||n.ctrlKey&&!n.altKey||kt&&n.metaKey)){if(i=n.keyCode,r=n.charCode,bt&&i==vl)return vl=null,void it(n);bt&&(!n.which||n.which<10)&&rw(t,n)||(u=String.fromCharCode(null==r?i:r),"\b"!=u&&(wn(t,n,u)||t.display.input.onKeyPress(n)))}}function kn(n,t){var i=+new Date;return be&&be.compare(i,n,t)?(we=be=null,"triple"):we&&we.compare(i,n,t)?(be=new yl(i,n,t),we=null,"double"):(we=new yl(i,n,t),be=null,"single")}function ow(n){var t=this,i=t.display;if(!(w(t,n)||i.activeTouch&&i.input.supportsTouch()))if(i.input.ensurePolled(),i.shift=n.shiftKey,si(i,n))tt||(i.scroller.draggable=!1,setTimeout(function(){return i.scroller.draggable=!0},100));else if(!tl(t,n)){var r=or(t,n),u=ca(n),f=r?kn(r,u):"single";window.focus();1==u&&t.state.selectingText&&t.state.selectingText(n);r&&dn(t,u,r,f,n)||(1==u?r?ntt(t,r,f,n):fh(n)==i.scroller&&it(n):2==u?(r&&wo(t.doc,r),setTimeout(function(){return i.input.focus()},20)):3==u&&(ul?cw(t,n):ny(t)))}}function dn(n,t,i,r,u){var f="Click";return"double"==r?f="Double"+f:"triple"==r&&(f="Triple"+f),f=(1==t?"Left":2==t?"Middle":"Right")+f,ie(n,gp(f,u),u,function(t){if("string"==typeof t&&(t=pe[t]),!t)return!1;var r=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0);r=t(n,i)!=fs}finally{n.state.suppressEdits=!1}return r})}function gn(n,t,i){var u=n.getOption("configureMouse"),r=u?u(n,t,i):{},f;return null==r.unit&&(f=ytt?i.shiftKey&&i.metaKey:i.altKey,r.unit=f?"rectangle":"single"==t?"char":"double"==t?"word":"line"),(null==r.extend||n.doc.extend)&&(r.extend=n.doc.extend||i.shiftKey),null==r.addNew&&(r.addNew=kt?i.metaKey:i.ctrlKey),null==r.moveOnDrag&&(r.moveOnDrag=!(kt?i.altKey:i.ctrlKey)),r}function ntt(n,t,i,r){e?setTimeout(ls(gv,n),0):n.curOp.focus=fi();var f,o=gn(n,i,r),s=n.doc.sel;n.options.dragDrop&&dtt&&!n.isReadOnly()&&"single"==i&&(f=s.contains(t))>-1&&(u((f=s.ranges[f]).from(),t)<0||t.xRel>0)&&(u(f.to(),t)>0||t.xRel<0)?ttt(n,r,t,o):itt(n,r,t,o)}function ttt(n,t,i,u){var f=n.display,s=!1,o=b(n,function(t){tt&&(f.scroller.draggable=!1);n.state.draggingText=!1;lt(document,"mouseup",o);lt(document,"mousemove",h);lt(f.scroller,"dragstart",c);lt(f.scroller,"drop",o);s||(it(t),u.addNew||wo(n.doc,i,null,null,u.extend),tt||e&&9==l?setTimeout(function(){document.body.focus();f.input.focus()},20):f.input.focus())}),h=function(n){s=s||Math.abs(t.clientX-n.clientX)+Math.abs(t.clientY-n.clientY)>=10},c=function(){return s=!0};tt&&(f.scroller.draggable=!0);n.state.draggingText=o;o.copy=!u.moveOnDrag;f.scroller.dragDrop&&f.scroller.dragDrop();r(document,"mouseup",o);r(document,"mousemove",h);r(f.scroller,"dragstart",c);r(f.scroller,"drop",o);ny(n);setTimeout(function(){return f.input.focus()},20)}function sw(t,i,r){if("char"==r)return new o(i,i);if("word"==r)return t.findWordAt(i);if("line"==r)return new o(n(i.line,0),f(t.doc,n(i.line+1,0)));var u=r(t,i);return new o(u.from,u.to)}function itt(i,e,s,h){function et(r){var k,p,rt;if(0!=u(g,r))if(g=r,"rectangle"==h.unit){for(var v=[],b=i.options.tabSize,ut=at(t(c,s.line).text,s.ch,b),ft=at(t(c,r.line).text,r.ch,b),et=Math.min(ut,ft),ot=Math.max(ut,ft),e=Math.min(s.line,r.line),st=Math.min(i.lastLine(),Math.max(s.line,r.line));e<=st;e++)k=t(c,e).text,p=as(k,et,b),et==ot?v.push(new o(n(e,p),n(e,p))):k.length>p&&v.push(new o(n(e,p),n(e,as(k,ot,b))));v.length||v.push(new o(s,s));nt(c,wt(y.ranges.slice(0,l).concat(v),l),{origin:"*mouse",scroll:!1});i.scrollIntoView(r)}else{var tt,it=a,w=sw(i,r,h.unit),d=it.anchor;u(w.anchor,d)>0?(tt=w.head,d=to(it.from(),w.anchor)):(tt=w.anchor,d=no(it.to(),w.head));rt=y.ranges.slice(0);rt[l]=rtt(i,new o(f(c,d),tt));nt(c,wt(rt,l),ol)}}function d(n){var e=++k,t=or(i,n,!0,"rectangle"==h.unit),r,f;t&&(0!=u(t,g)?(i.curOp.focus=fi(),et(t),r=uc(p,c),(t.line>=r.to||t.line<r.from)&&setTimeout(b(i,function(){k==e&&d(n)}),150)):(f=n.clientY<ut.top?-20:n.clientY>ut.bottom?20:0,f&&setTimeout(b(i,function(){k==e&&(p.scroller.scrollTop+=f,d(n))}),50)))}function rt(n){i.state.selectingText=!1;k=1/0;it(n);p.input.focus();lt(document,"mousemove",ft);lt(document,"mouseup",tt);c.history.lastSelOrigin=null}var p=i.display,c=i.doc,a,l,y,v,w;it(e);y=c.sel;v=y.ranges;(h.addNew&&!h.extend?(l=c.sel.contains(s),a=l>-1?v[l]:new o(s,s)):(a=c.sel.primary(),l=c.sel.primIndex),"rectangle"==h.unit)?(h.addNew||(a=new o(s,s)),s=or(i,e,!0,!0),l=-1):(w=sw(i,s,h.unit),a=h.extend?wc(a,w.anchor,w.head,h.extend):w);h.addNew?-1==l?(l=v.length,nt(c,wt(v.concat([a]),l),{scroll:!1,origin:"*mouse"})):v.length>1&&v[l].empty()&&"char"==h.unit&&!h.extend?(nt(c,wt(v.slice(0,l).concat(v.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),y=c.sel):bc(c,l,a,ol):(l=0,nt(c,new ht([a],0),ol),y=c.sel);var g=s,ut=p.wrapper.getBoundingClientRect(),k=0,ft=b(i,function(n){ca(n)?d(n):rt(n)}),tt=b(i,rt);i.state.selectingText=tt;r(document,"mousemove",ft);r(document,"mouseup",tt)}function rtt(i,r){var f=r.anchor,e=r.head,d=t(i.doc,f.line),s,l,h,c,a,v,y;if(0==u(f,e)&&f.sticky==e.sticky||(s=oi(d),!s)||(l=ff(s,f.ch,f.sticky),h=s[l],h.from!=f.ch&&h.to!=f.ch)||(c=l+(h.from==f.ch==(1!=h.level)?0:1),0==c||c==s.length))return r;e.line!=f.line?a=(e.line-f.line)*("ltr"==i.doc.direction?1:-1)>0:(v=ff(s,e.ch,e.sticky),y=v-l||(e.ch-f.ch)*(1==h.level?-1:1),a=v==c-1||v==c?y<0:y>0);var p=s[c+(a?-1:0)],w=a==(1==p.level),b=w?p.from:p.to,k=w?"after":"before";return f.ch==b&&f.sticky==k?r:new o(new n(f.line,b,k),e)}function hw(n,t,i,r){var e,u,o,s,f,h;if(t.touches)e=t.touches[0].clientX,u=t.touches[0].clientY;else try{e=t.clientX;u=t.clientY}catch(t){return!1}if(e>=Math.floor(n.display.gutters.getBoundingClientRect().right))return!1;if(r&&it(t),o=n.display,s=o.lineDiv.getBoundingClientRect(),u>s.bottom||!vt(n,i))return uh(t);for(u-=s.top-o.viewOffset,f=0;f<n.options.gutters.length;++f)if(h=o.gutters.childNodes[f],h&&h.getBoundingClientRect().right>=e)return v(n,i,n,ir(n.doc,u),n.options.gutters[f],t),uh(t)}function tl(n,t){return hw(n,t,"gutterClick",!0)}function cw(n,t){si(n.display,t)||utt(n,t)||w(n,t,"contextmenu")||n.display.input.onContextMenu(t)}function utt(n,t){return!!vt(n,"gutterContextMenu")&&hw(n,t,"gutterContextMenu",!1)}function lw(n){n.display.wrapper.className=n.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+n.options.theme.replace(/(^|\s)\s*/g," cm-s-");cf(n)}function re(n){cy(n);et(n);iy(n)}function ftt(n,t,i){if(!t!=!(i&&i!=du)){var u=n.display.dragFunctions,f=t?r:lt;f(n.display.scroller,"dragstart",u.start);f(n.display.scroller,"dragenter",u.enter);f(n.display.scroller,"dragover",u.over);f(n.display.scroller,"dragleave",u.leave);f(n.display.scroller,"drop",u.drop)}}function ett(n){n.options.lineWrapping?(gi(n.display.wrapper,"CodeMirror-wrap"),n.display.sizer.style.minWidth="",n.display.sizerWidth=null):(yr(n.display.wrapper,"CodeMirror-wrap"),ih(n));tc(n);et(n);cf(n);setTimeout(function(){return tu(n)},100)}function a(n,t){var o=this,i,s,r,u,f;if(!(this instanceof a))return new a(n,t);this.options=t=t?nr(t):{};nr(lb,t,!1);lc(t);i=t.value;"string"==typeof i&&(i=new ft(i,t.mode,null,t.lineSeparator,t.direction));this.doc=i;s=new a.inputStyles[t.inputStyle](this);r=this.display=new yb(n,i,s);r.wrapper.CodeMirror=this;cy(this);lw(this);t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");oy(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new bi,keySeq:null,specialChars:null};t.autofocus&&!oe&&r.input.focus();e&&l<11&&setTimeout(function(){return o.display.input.reset(!0)},20);ott(this);sn();cr(this);this.curOp.forceUpdate=!0;wy(this,i);t.autofocus&&!oe||this.hasFocus()?setTimeout(ls(rc,this),20):vf(this);for(u in ss)ss.hasOwnProperty(u)&&ss[u](o,t[u],du);for(ry(this),t.finishInit&&t.finishInit(this),f=0;f<hs.length;++f)hs[f](o);lr(this);tt&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(r.lineDiv).textRendering&&(r.lineDiv.style.textRendering="auto")}function ott(t){function h(){i.activeTouch&&(a=setTimeout(function(){return i.activeTouch=null},1e3),(s=i.activeTouch).end=+new Date)}function y(n){if(1!=n.touches.length)return!1;var t=n.touches[0];return t.radiusX<=1&&t.radiusY<=1}function c(n,t){if(null==t.left)return!0;var i=t.left-n.left,r=t.top-n.top;return i*i+r*r>400}var i=t.display,a,s,u;r(i.scroller,"mousedown",b(t,ow));e&&l<11?r(i.scroller,"dblclick",b(t,function(n){var i,r;w(t,n)||(i=or(t,n),!i||tl(t,n)||si(t.display,n)||(it(n),r=t.findWordAt(i),wo(t.doc,r.anchor,r.head)))})):r(i.scroller,"dblclick",function(n){return w(t,n)||it(n)});ul||r(i.scroller,"contextmenu",function(n){return cw(t,n)});s={end:0};r(i.scroller,"touchstart",function(n){if(!w(t,n)&&!y(n)&&!tl(t,n)){i.input.ensurePolled();clearTimeout(a);var r=+new Date;i.activeTouch={start:r,moved:!1,prev:r-s.end<=300?s:null};1==n.touches.length&&(i.activeTouch.left=n.touches[0].pageX,i.activeTouch.top=n.touches[0].pageY)}});r(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)});r(i.scroller,"touchend",function(r){var u=i.activeTouch,s,e;u&&!si(i,r)&&null!=u.left&&!u.moved&&new Date-u.start<300&&(e=t.coordsChar(i.activeTouch,"page"),s=!u.prev||c(u,u.prev)?new o(e,e):!u.prev.prev||c(u,u.prev.prev)?t.findWordAt(e):new o(n(e.line,0),f(t.doc,n(e.line+1,0))),t.setSelection(s.anchor,s.head),t.focus(),it(r));h()});r(i.scroller,"touchcancel",h);r(i.scroller,"scroll",function(){i.scroller.clientHeight&&(pf(t,i.scroller.scrollTop),hr(t,i.scroller.scrollLeft,!0),v(t,"scroll",t))});r(i.scroller,"mousewheel",function(n){return ay(t,n)});r(i.scroller,"DOMMouseScroll",function(n){return ay(t,n)});r(i.wrapper,"scroll",function(){return i.wrapper.scrollTop=i.wrapper.scrollLeft=0});i.dragFunctions={enter:function(n){w(t,n)||ef(n)},over:function(n){w(t,n)||(on(t,n),ef(n))},start:function(n){return en(t,n)},drop:b(t,fn),leave:function(n){w(t,n)||bp(t)}};u=i.input.getField();r(u,"keyup",function(n){return fw.call(t,n)});r(u,"keydown",b(t,uw));r(u,"keypress",b(t,ew));r(u,"focus",function(n){return rc(t,n)});r(u,"blur",function(n){return vf(t,n)})}function ue(i,r,u,f){var d,s=i.doc,e,c,l,y,w,a,b,k;null==u&&(u="add");"smart"==u&&(s.mode.indent?d=of(i,r).state:u="prev");var v=i.options.tabSize,h=t(s,r),p=at(h.text,null,v);if(h.stateAfter&&(h.stateAfter=null),c=h.text.match(/^\s*/)[0],f||/\S/.test(h.text)){if("smart"==u&&((e=s.mode.indent(d,h.text.slice(c.length),h.text))==fs||e>150)){if(!f)return;u="prev"}}else e=0,u="not";if("prev"==u?e=r>s.first?at(t(s,r-1).text,null,v):0:"add"==u?e=p+i.options.indentUnit:"subtract"==u?e=p-i.options.indentUnit:"number"==typeof u&&(e=p+u),e=Math.max(0,e),l="",y=0,i.options.indentWithTabs)for(w=Math.floor(e/v);w;--w)y+=v,l+="\t";if(y<e&&(l+=vs(e-y)),l!=c)return fu(s,l,n(r,0),n(r,c.length),"+input"),h.stateAfter=null,!0;for(a=0;a<s.sel.ranges.length;a++)if(b=s.sel.ranges[a],b.head.line==r&&b.head.ch<c.length){k=n(r,c.length);bc(s,a,new o(k,k));break}}function ts(n){yt=n}function il(i,r,u,f,e){var p=i.doc,y,k,l,b;i.display.shift=!1;f||(f=p.sel);var a=i.state.pasteIncoming||"paste"==e,v=sl(r),o=null;if(a&&f.ranges.length>1)if(yt&&yt.text.join("\n")==r){if(f.ranges.length%yt.text.length==0)for(o=[],y=0;y<yt.text.length;y++)o.push(p.splitLines(yt.text[y]))}else v.length==f.ranges.length&&i.options.pasteLinesPerSelection&&(o=de(v,function(n){return[n]}));for(l=f.ranges.length-1;l>=0;l--){var w=f.ranges[l],h=w.from(),c=w.to();w.empty()&&(u&&u>0?h=n(h.line,h.ch-u):i.state.overwrite&&!a?c=n(c.line,Math.min(t(p,c.line).text.length,c.ch+s(v).length)):yt&&yt.lineWise&&yt.text.join("\n")==r&&(h=c=n(h.line,0)));k=i.curOp.updateInput;b={from:h,to:c,text:o?o[l%o.length]:v,origin:e||(a?"paste":i.state.cutIncoming?"cut":"+input")};uu(i.doc,b);g(i,"inputRead",i,b)}r&&!a&&vw(i,r);nu(i);i.curOp.updateInput=k;i.curOp.typing=!0;i.state.pasteIncoming=i.state.cutIncoming=!1}function aw(n,t){var i=n.clipboardData&&n.clipboardData.getData("Text");if(i)return n.preventDefault(),t.isReadOnly()||t.options.disableInput||ot(t,function(){return il(t,i,0,null,"paste")}),!0}function vw(n,i){var e,u,r,f,o,s;if(n.options.electricChars&&n.options.smartIndent)for(e=n.doc.sel,u=e.ranges.length-1;u>=0;u--)if(r=e.ranges[u],!(r.head.ch>100||u&&e.ranges[u-1].head.line==r.head.line)){if(f=n.getModeAt(r.head),o=!1,f.electricChars){for(s=0;s<f.electricChars.length;s++)if(i.indexOf(f.electricChars.charAt(s))>-1){o=ue(n,r.head.line,"smart");break}}else f.electricInput&&f.electricInput.test(t(n.doc,r.head.line).text.slice(0,r.head.ch))&&(o=ue(n,r.head.line,"smart"));o&&g(n,"electricInput",n,r.head.line)}}function yw(t){for(var u,i,f=[],e=[],r=0;r<t.doc.sel.ranges.length;r++)u=t.doc.sel.ranges[r].head.line,i={anchor:n(u,0),head:n(u+1,0)},e.push(i),f.push(t.getRange(i.anchor,i.head));return{text:f,ranges:e}}function pw(n,t){n.setAttribute("autocorrect","off");n.setAttribute("autocapitalize","off");n.setAttribute("spellcheck",!!t)}function ww(){var n=i("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=i("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return tt?n.style.width="1000px":n.setAttribute("wrap","off"),ee&&(n.style.border="1px solid black"),pw(n),t}function rl(i,r,u,f,e){function w(){var f=r.line+u;return!(f<i.first||f>=i.first+i.size)&&(r=new n(f,r.ch,r.sticky),h=t(i,f))}function s(n){var t;if(null==(t=e?vn(i.cm,h,r,u):gc(h,r,u))){if(n||!w())return!1;r=nl(e,i.cm,h,r.line,u)}else r=t;return!0}var p=r,b=u,h=t(i,r.line),l,o,a;if("char"==f)s();else if("column"==f)s(!0);else if("word"==f||"group"==f)for(var v=null,y="group"==f,k=i.cm&&i.cm.getHelper(r,"wordChars"),c=!0;!(u<0)||s(!c);c=!1){if(l=h.text.charAt(r.ch)||"\n",o=ge(l,k)?"w":y&&"\n"==l?"n":!y||/\s/.test(l)?null:"p",!y||c||o||(o="s"),v&&v!=o){u<0&&(u=1,s(),r.sticky="after");break}if(o&&(v=o),u>0&&!s(!c))break}return a=kc(i,r,p,b,!0),ks(p,a)&&(a.hitSide=!0),a}function bw(n,t,i,r){var u,s=n.doc,h=t.left,e,o,f;for("page"==r?(e=Math.min(n.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),o=Math.max(e-.5*er(n.display),3),u=(i>0?t.bottom:t.top)+i*o):"line"==r&&(u=i>0?t.bottom+3:t.top-3);(f=bh(n,h,u)).outside;){if(i<0?u<=0:u>=s.height){f.hitSide=!0;break}u+=5*i}return f}function kw(n,i){var u=vh(n,i.line),r;if(!u||u.hidden)return null;var f=t(n.doc,i.line),s=ov(u,f,i.line),e=oi(f,n.doc.direction),o="left";return e&&(o=ff(e,i.ch)%2?"right":"left"),r=hv(s.map,i.ch,o),r.offset="right"==r.collapse?r.end:r.start,r}function stt(n){for(var t=n;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function hu(n,t){return t&&(n.bad=!0),n}function htt(t,i,r,u,f){function a(n){return function(t){return t.id==n}}function h(){s&&(o+=l,s=!1)}function e(n){n&&(h(),o+=n)}function c(i){var o,v,y,p,w,r;if(1==i.nodeType){if(o=i.getAttribute("cm-text"),null!=o)return void e(o||i.textContent.replace(/\u200b/g,""));if(y=i.getAttribute("cm-marker"),y)return p=t.findMarks(n(u,0),n(f+1,0),a(+y)),void(p.length&&(v=p[0].find(0))&&e(tr(t.doc,v.from,v.to).join(l)));if("false"==i.getAttribute("contenteditable"))return;for(w=/^(pre|div|p)$/i.test(i.nodeName),w&&h(),r=0;r<i.childNodes.length;r++)c(i.childNodes[r]);w&&(s=!0)}else 3==i.nodeType&&e(i.nodeValue)}for(var o="",s=!1,l=t.doc.lineSeparator();c(i),i!=r;)i=i.nextSibling;return o}function is(t,i,r){var u,f,e;if(i==t.display.lineDiv){if(!(u=t.display.lineDiv.childNodes[r]))return hu(t.clipPos(n(t.display.viewTo-1)),!0);i=null;r=0}else for(u=i;;u=u.parentNode){if(!u||u==t.display.lineDiv)return null;if(u.parentNode&&u.parentNode==t.display.lineDiv)break}for(f=0;f<t.display.view.length;f++)if(e=t.display.view[f],e.node==u)return ctt(e,i,r)}function ctt(t,i,r){function v(i,r,u){for(var o,e,s,l,c,f=-1;f<(p?p.length:0);f++)for(o=f<0?k.map:p[f],e=0;e<o.length;e+=3)if(s=o[e+2],s==i||s==r)return l=h(f<0?t.line:t.rest[f]),c=o[e]+u,(u<0||s!=i)&&(c=o[e+(u?1:0)]),n(l,c)}var a=t.text.firstChild,l=!1,y,f,e,o,w,c,b;if(!i||!li(a,i))return hu(n(h(t.line),0),!0);if(i==a&&(l=!0,i=a.childNodes[r],r=0,!i))return y=t.rest?s(t.rest):t.line,hu(n(h(y),y.text.length),l);for(f=3==i.nodeType?i:null,e=i,f||1!=i.childNodes.length||3!=i.firstChild.nodeType||(f=i.firstChild,r&&(r=f.nodeValue.length));e.parentNode!=a;)e=e.parentNode;var k=t.measure,p=k.maps,u=v(f,e,r);if(u)return hu(u,l);for(o=e.nextSibling,w=f?f.nodeValue.length-r:0;o;o=o.nextSibling){if(u=v(o,o.firstChild,0))return hu(n(u.line,u.ch-w),l);w+=o.textContent.length}for(c=e.previousSibling,b=r;c;c=c.previousSibling){if(u=v(c,c.firstChild,-1))return hu(n(u.line,u.ch+b),l);b+=c.textContent.length}}var ut=navigator.userAgent,dw=navigator.platform,wi=/gecko\/\d/i.test(ut),gw=/MSIE \d/.test(ut),nb=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ut),fe=/Edge\/(\d+)/.exec(ut),e=gw||nb||fe,l=e&&(gw?document.documentMode||6:+(fe||nb)[1]),tt=!fe&&/WebKit\//.test(ut),ltt=tt&&/Qt\/\d+\.\d+/.test(ut),rs=!fe&&/Chrome\//.test(ut),bt=/Opera\//.test(ut),tb=/Apple Computer/.test(navigator.vendor),att=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ut),vtt=/PhantomJS/.test(ut),ee=!fe&&/AppleWebKit/.test(ut)&&/Mobile\/\w+/.test(ut),us=/Android/.test(ut),oe=ee||us||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ut),kt=ee||/Mac/.test(dw),ytt=/\bCrOS\b/.test(ut),ptt=/win/i.test(dw),vr=bt&&ut.match(/Version\/(\d*\.\d*)/),lu,bi,ce,ri,ll,pr,pu,ae,st,ht,o,wu,al,hi,bu,sb,ft,ye,ku,ui,hs,yt,c,y,ab,ke;vr&&(vr=Number(vr[1]));vr&&vr>=15&&(bt=!1,tt=!0);var cu,ib=kt&&(ltt||bt&&(null==vr||vr<12.11)),ul=wi||e&&l>=9,yr=function(n,t){var r=n.className,i=gu(t).exec(r),u;i&&(u=r.slice(i.index+i[0].length),n.className=r.slice(0,i.index)+(u?i[1]+u:""))};cu=document.createRange?function(n,t,i,r){var u=document.createRange();return u.setEnd(r||n,i),u.setStart(n,t),u}:function(n,t,i){var r=document.body.createTextRange();try{r.moveToElementText(n.parentNode)}catch(n){return r}return r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r};lu=function(n){n.select()};ee?lu=function(n){n.selectionStart=0;n.selectionEnd=n.value.length}:e&&(lu=function(n){try{n.select()}catch(n){}});bi=function(){this.id=null};bi.prototype.set=function(n,t){clearTimeout(this.id);this.id=setTimeout(t,n)};var fl,el,rb=30,fs={toString:function(){return"CodeMirror.Pass"}},ii={scroll:!1},ol={origin:"*mouse"},se={origin:"+move"},es=[""],wtt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,btt=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,ub=!1,ki=!1,he=null,ktt=function(){function f(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?o.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":8204==n?"b":"L"}function n(n,t,i){this.level=n;this.from=t;this.to=i}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",o="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",h=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,t=/[stwN]/,i=/[LRr]/,r=/[Lb1n]/,u=/[1n]/;return function(e,o){var tt="ltr"==o?"L":"R",ut,at,vt,it,yt,ft,d,g,ot,p,pt,w,kt,st,et,wt,ht,b,k,rt,v,l,gt,nt,ct,y,ni;if(0==e.length||"ltr"==o&&!h.test(e))return!1;for(var a=e.length,c=[],lt=0;lt<a;++lt)c.push(f(e.charCodeAt(lt)));for(ut=0,at=tt;ut<a;++ut)vt=c[ut],"m"==vt?c[ut]=at:at=vt;for(it=0,yt=tt;it<a;++it)ft=c[it],"1"==ft&&"r"==yt?c[it]="n":i.test(ft)&&(yt=ft,"r"==ft&&(c[it]="R"));for(d=1,g=c[0];d<a-1;++d)ot=c[d],"+"==ot&&"1"==g&&"1"==c[d+1]?c[d]="1":","!=ot||g!=c[d+1]||"1"!=g&&"n"!=g||(c[d]=g),g=ot;for(p=0;p<a;++p)if(pt=c[p],","==pt)c[p]="N";else if("%"==pt){for(w=void 0,w=p+1;w<a&&"%"==c[w];++w);for(kt=p&&"!"==c[p-1]||w<a&&"1"==c[w]?"1":"N",st=p;st<w;++st)c[st]=kt;p=w-1}for(et=0,wt=tt;et<a;++et)ht=c[et],"L"==wt&&"1"==ht?c[et]="L":i.test(ht)&&(wt=ht);for(b=0;b<a;++b)if(t.test(c[b])){for(k=void 0,k=b+1;k<a&&t.test(c[k]);++k);for(var dt="L"==(b?c[b-1]:tt),ti=dt==("L"==(k<a?c[k]:tt))?dt?"L":"R":tt,bt=b;bt<k;++bt)c[bt]=ti;b=k-1}for(v=[],l=0;l<a;)if(r.test(c[l])){for(gt=l,++l;l<a&&r.test(c[l]);++l);v.push(new n(0,gt,l))}else{for(nt=l,ct=v.length,++l;l<a&&"L"!=c[l];++l);for(y=nt;y<l;)if(u.test(c[y])){for(nt<y&&v.splice(ct,0,new n(1,nt,y)),ni=y,++y;y<l&&u.test(c[y]);++y);v.splice(ct,0,new n(2,ni,y));nt=y}else++y;nt<l&&v.splice(ct,0,new n(1,nt,l))}return 1==v[0].level&&(rt=e.match(/^\s+/))&&(v[0].from=rt[0].length,v.unshift(new n(0,0,rt[0].length))),1==s(v).level&&(rt=e.match(/\s+$/))&&(s(v).to-=rt[0].length,v.push(new n(0,a-rt[0].length,a))),"rtl"==o?v.reverse():v}}(),fb=[],r=function(n,t,i){if(n.addEventListener)n.addEventListener(t,i,!1);else if(n.attachEvent)n.attachEvent("on"+t,i);else{var r=n._handlers||(n._handlers={});r[t]=(r[t]||fb).concat(i)}},dtt=function(){if(e&&l<9)return!1;var n=i("div");return"draggable"in n||"dragDrop"in n}(),sl=3!="\n\nb".split(/\n/).length?function(n){for(var t,r,u,i=0,f=[],e=n.length;i<=e;)t=n.indexOf("\n",i),-1==t&&(t=n.length),r=n.slice(i,"\r"==n.charAt(t-1)?t-1:t),u=r.indexOf("\r"),-1!=u?(f.push(r.slice(0,u)),i+=u+1):(f.push(r),i=t+1);return f}:function(n){return n.split(/\r\n?|\n/)},gtt=window.getSelection?function(n){try{return n.selectionStart!=n.selectionEnd}catch(n){return!1}}:function(n){var t;try{t=n.ownerDocument.selection.createRange()}catch(n){}return!(!t||t.parentElement()!=n)&&0!=t.compareEndPoints("StartToEnd",t)},nit=function(){var n=i("div");return"oncopy"in n||(n.setAttribute("oncopy","return;"),"function"==typeof n.oncopy)}(),hl=null,cl={},au={},vu={},p=function(n,t,i){this.pos=this.start=0;this.string=n;this.tabSize=t||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;this.lineOracle=i};p.prototype.eol=function(){return this.pos>=this.string.length};p.prototype.sol=function(){return this.pos==this.lineStart};p.prototype.peek=function(){return this.string.charAt(this.pos)||void 0};p.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)};p.prototype.eat=function(n){var t=this.string.charAt(this.pos);if("string"==typeof n?t==n:t&&(n.test?n.test(t):n(t)))return++this.pos,t};p.prototype.eatWhile=function(n){for(var t=this.pos;this.eat(n););return this.pos>t};p.prototype.eatSpace=function(){for(var n=this,t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++n.pos;return this.pos>t};p.prototype.skipToEnd=function(){this.pos=this.string.length};p.prototype.skipTo=function(n){var t=this.string.indexOf(n,this.pos);if(t>-1)return this.pos=t,!0};p.prototype.backUp=function(n){this.pos-=n};p.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=at(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?at(this.string,this.lineStart,this.tabSize):0)};p.prototype.indentation=function(){return at(this.string,null,this.tabSize)-(this.lineStart?at(this.string,this.lineStart,this.tabSize):0)};p.prototype.match=function(n,t,i){var r,u;return"string"!=typeof n?(r=this.string.slice(this.pos).match(n),r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)):(u=function(n){return i?n.toLowerCase():n},u(this.string.substr(this.pos,n.length))==u(n)?(!1!==t&&(this.pos+=n.length),!0):void 0)};p.prototype.current=function(){return this.string.slice(this.start,this.pos)};p.prototype.hideFirstChars=function(n,t){this.lineStart+=n;try{return t()}finally{this.lineStart-=n}};p.prototype.lookAhead=function(n){var t=this.lineOracle;return t&&t.lookAhead(n)};ce=function(n,t){this.state=n;this.lookAhead=t};ri=function(n,t,i,r){this.state=t;this.doc=n;this.line=i;this.maxLookAhead=r||0};ri.prototype.lookAhead=function(n){var t=this.doc.getLine(this.line+n);return null!=t&&n>this.maxLookAhead&&(this.maxLookAhead=n),t};ri.prototype.nextLine=function(){this.line++;this.maxLookAhead>0&&this.maxLookAhead--};ri.fromSaved=function(n,t,i){return t instanceof ce?new ri(n,ur(n.mode,t.state),i,t.lookAhead):new ri(n,ur(n.mode,t),i)};ri.prototype.save=function(n){var t=!1!==n?ur(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ce(t,this.maxLookAhead):t};ll=function(n,t,i){this.start=n.start;this.end=n.pos;this.string=n.current();this.type=t||null;this.state=i};pr=function(n,t,i){this.text=n;ia(this,t);this.height=i?i(this):1};pr.prototype.lineNo=function(){return h(this)};dr(pr);var wr,tit={},iit={},yu=null,le=null,eb={left:0,right:0,top:0,bottom:0},br=function(n,t,u){this.cm=u;var f=this.vert=i("div",[i("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=i("div",[i("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n(f);n(o);r(f,"scroll",function(){f.clientHeight&&t(f.scrollTop,"vertical")});r(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")});this.checkedZeroWidth=!1;e&&l<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};br.prototype.update=function(n){var i=n.scrollWidth>n.clientWidth+1,r=n.scrollHeight>n.clientHeight+1,t=n.nativeBarWidth,u,f;return r?(this.vert.style.display="block",this.vert.style.bottom=i?t+"px":"0",u=n.viewHeight-(i?t:0),this.vert.firstChild.style.height=Math.max(0,n.scrollHeight-n.clientHeight+u)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),i?(this.horiz.style.display="block",this.horiz.style.right=r?t+"px":"0",this.horiz.style.left=n.barLeft+"px",f=n.viewWidth-n.barLeft-(r?t:0),this.horiz.firstChild.style.width=Math.max(0,n.scrollWidth-n.clientWidth+f)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&n.clientHeight>0&&(0==t&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?t:0,bottom:i?t:0}};br.prototype.setScrollLeft=function(n){this.horiz.scrollLeft!=n&&(this.horiz.scrollLeft=n);this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")};br.prototype.setScrollTop=function(n){this.vert.scrollTop!=n&&(this.vert.scrollTop=n);this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")};br.prototype.zeroWidthHack=function(){var n=kt&&!att?"12px":"18px";this.horiz.style.height=this.vert.style.width=n;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new bi;this.disableVert=new bi};br.prototype.enableZeroWidthBar=function(n,t,i){function r(){var u=n.getBoundingClientRect();("vert"==i?document.elementFromPoint(u.right-1,(u.top+u.bottom)/2):document.elementFromPoint((u.right+u.left)/2,u.bottom-1))!=n?n.style.pointerEvents="none":t.set(1e3,r)}n.style.pointerEvents="auto";t.set(1e3,r)};br.prototype.clear=function(){var n=this.horiz.parentNode;n.removeChild(this.horiz);n.removeChild(this.vert)};pu=function(){};pu.prototype.update=function(){return{bottom:0,right:0}};pu.prototype.setScrollLeft=function(){};pu.prototype.setScrollTop=function(){};pu.prototype.clear=function(){};var ob={"native":br,"null":pu},rit=0,os=function(n,t,i){var r=n.display;this.viewport=t;this.visible=uc(r,n.doc,t);this.editorIsHidden=!r.wrapper.offsetWidth;this.wrapperHeight=r.wrapper.clientHeight;this.wrapperWidth=r.wrapper.clientWidth;this.oldDisplayWidth=fr(n);this.force=i;this.dims=gh(n);this.events=[]};os.prototype.signal=function(n,t){vt(n,t)&&this.events.push(arguments)};os.prototype.finish=function(){for(var t=this,n=0;n<this.events.length;n++)v.apply(null,t.events[n])};ae=0;st=null;e?st=-.53:wi?st=15:rs?st=-.7:tb&&(st=-1/3);ht=function(n,t){this.ranges=n;this.primIndex=t};ht.prototype.primary=function(){return this.ranges[this.primIndex]};ht.prototype.equals=function(n){var u=this,t,i,r;if(n==this)return!0;if(n.primIndex!=this.primIndex||n.ranges.length!=this.ranges.length)return!1;for(t=0;t<this.ranges.length;t++)if(i=u.ranges[t],r=n.ranges[t],!ks(i.anchor,r.anchor)||!ks(i.head,r.head))return!1;return!0};ht.prototype.deepCopy=function(){for(var t=this,i=[],n=0;n<this.ranges.length;n++)i[n]=new o(ds(t.ranges[n].anchor),ds(t.ranges[n].head));return new ht(i,this.primIndex)};ht.prototype.somethingSelected=function(){for(var t=this,n=0;n<this.ranges.length;n++)if(!t.ranges[n].empty())return!0;return!1};ht.prototype.contains=function(n,t){var f=this,i,r;for(t||(t=n),i=0;i<this.ranges.length;i++)if(r=f.ranges[i],u(t,r.from())>=0&&u(n,r.to())<=0)return i;return-1};o=function(n,t){this.anchor=n;this.head=t};o.prototype.from=function(){return to(this.anchor,this.head)};o.prototype.to=function(){return no(this.anchor,this.head)};o.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};ne.prototype={chunkSize:function(){return this.lines.length},removeInner:function(n,t){for(var i,u=this,r=n,f=n+t;r<f;++r)i=u.lines[r],u.height-=i.height,vk(i),g(i,"delete");this.lines.splice(n,t)},collapse:function(n){n.push.apply(n,this.lines)},insertInner:function(n,t,i){var u=this,r;for(this.height+=i,this.lines=this.lines.slice(0,n).concat(t).concat(this.lines.slice(n)),r=0;r<t.length;++r)t[r].parent=u},iterN:function(n,t,i){for(var r=this,u=n+t;n<u;++n)if(i(r.lines[n]))return!0}};te.prototype={chunkSize:function(){return this.size},removeInner:function(n,t){var e=this,r,i,u,f,s,o;for(this.size-=t,r=0;r<this.children.length;++r)if(i=e.children[r],u=i.chunkSize(),n<u){if(f=Math.min(t,u-n),s=i.height,i.removeInner(n,f),e.height-=s-i.height,u==f&&(e.children.splice(r--,1),i.parent=null),0==(t-=f))break;n=0}else n-=u;this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof ne))&&(o=[],this.collapse(o),this.children=[new ne(o)],this.children[0].parent=this)},collapse:function(n){for(var i=this,t=0;t<this.children.length;++t)i.children[t].collapse(n)},insertInner:function(n,t,i){var f=this,u,r,s,h,e,o;for(this.size+=t.length,this.height+=i,u=0;u<this.children.length;++u){if(r=f.children[u],s=r.chunkSize(),n<=s){if(r.insertInner(n,t,i),r.lines&&r.lines.length>50){for(h=r.lines.length%25+25,e=h;e<r.lines.length;)o=new ne(r.lines.slice(e,e+=25)),r.height-=o.height,f.children.splice(++u,0,o),o.parent=f;r.lines=r.lines.slice(0,h);f.maybeSpill()}break}n-=s}},maybeSpill:function(){var n,t,r,i;if(!(this.children.length<=10)){n=this;do t=new te(n.children.splice(n.children.length-5,5)),n.parent?(n.size-=t.size,n.height-=t.height,r=d(n.parent.children,n),n.parent.children.splice(r+1,0,t)):(i=new te(n.children),i.parent=n,n.children=[i,t],n=i),t.parent=n.parent;while(n.children.length>10);n.parent.maybeSpill()}},iterN:function(n,t,i){for(var f,u,e,o=this,r=0;r<this.children.length;++r)if(f=o.children[r],u=f.chunkSize(),n<u){if(e=Math.min(t,u-n),f.iterN(n,e,i))return!0;if(0==(t-=e))break;n=0}else n-=u}};wu=function(n,t,i){var u=this,r;if(i)for(r in i)i.hasOwnProperty(r)&&(u[r]=i[r]);this.doc=n;this.node=t};wu.prototype.clear=function(){var e=this,n=this.doc.cm,t=this.line.widgets,i=this.line,u=h(i),r,f;if(null!=u&&t){for(r=0;r<t.length;++r)t[r]==e&&t.splice(r--,1);t.length||(i.widgets=null);f=hf(this);dt(i,Math.max(0,i.height-f));n&&(ot(n,function(){pp(n,i,-f);ai(n,u,"widget")}),g(n,"lineWidgetCleared",n,this,u))}};wu.prototype.changed=function(){var r=this,u=this.height,n=this.doc.cm,t=this.line,i;this.height=null;i=hf(this)-u;i&&(dt(t,t.height+i),n&&ot(n,function(){n.curOp.forceUpdate=!0;pp(n,t,i);g(n,"lineWidgetChanged",n,r,h(t))}))};dr(wu);al=0;hi=function(n,t){this.lines=[];this.type=t;this.doc=n;this.id=++al};hi.prototype.clear=function(){var i=this,n,o,u,t,r,e,l,a;if(!this.explicitlyCleared){n=this.doc.cm;o=n&&!n.curOp;(o&&cr(n),vt(this,"clear"))&&(u=this.find(),u&&g(this,"clear",u.from,u.to));for(var f=null,s=null,c=0;c<this.lines.length;++c)t=i.lines[c],r=rf(t.markedSpans,i),n&&!i.collapsed?ai(n,h(t),"text"):n&&(null!=r.to&&(s=h(t)),null!=r.from&&(f=h(t))),t.markedSpans=kb(t.markedSpans,r),null==r.from&&i.collapsed&&!rr(i.doc,t)&&n&&dt(t,er(n.display));if(n&&this.collapsed&&!n.options.lineWrapping)for(e=0;e<this.lines.length;++e)l=gt(i.lines[e]),a=fo(l),a>n.display.maxLineLength&&(n.display.maxLine=l,n.display.maxLineLength=a,n.display.maxLineChanged=!0);null!=f&&n&&this.collapsed&&et(n,f,s+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,n&&fp(n.doc));n&&g(n,"markerCleared",n,this,f,s);o&&lr(n);this.parent&&this.parent.clear()}};hi.prototype.find=function(t,i){var s=this,f,o,e,r,u;for(null==t&&"bookmark"==this.type&&(t=1),e=0;e<this.lines.length;++e){if(r=s.lines[e],u=rf(r.markedSpans,s),null!=u.from&&(f=n(i?r:h(r),u.from),-1==t))return f;if(null!=u.to&&(o=n(i?r:h(r),u.to),1==t))return o}return f&&{from:f,to:o}};hi.prototype.changed=function(){var r=this,i=this.find(-1,!0),t=this,n=this.doc.cm;i&&n&&ot(n,function(){var u=i.line,s=h(i.line),e=vh(n,s),o,f;(e&&(cv(e),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,rr(t.doc,u)||null==t.height)||(o=t.height,t.height=null,f=hf(t)-o,f&&dt(u,u.height+f));g(n,"markerChanged",n,r)})};hi.prototype.attachLine=function(n){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=d(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(n)};hi.prototype.detachLine=function(n){if(this.lines.splice(d(this.lines,n),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};dr(hi);bu=function(n,t){var r=this,i;for(this.markers=n,this.primary=t,i=0;i<n.length;++i)n[i].parent=r};bu.prototype.clear=function(){var t=this,n;if(!this.explicitlyCleared){for(this.explicitlyCleared=!0,n=0;n<this.markers.length;++n)t.markers[n].clear();g(this,"clear")}};bu.prototype.find=function(n,t){return this.primary.find(n,t)};dr(bu);sb=0;ft=function(t,i,r,u,f){if(!(this instanceof ft))return new ft(t,i,r,u,f);null==r&&(r=0);te.call(this,[new ne([new pr("",null)])]);this.first=r;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=r;var e=n(r,0);this.sel=yi(e);this.history=new yo(null);this.id=++sb;this.modeOption=i;this.lineSep=u;this.direction="rtl"==f?"rtl":"ltr";this.extend=!1;"string"==typeof t&&(t=this.splitLines(t));yc(this,{from:e,to:e,text:t});nt(this,yi(e),ii)};ft.prototype=wl(te.prototype,{constructor:ft,iter:function(n,t,i){i?this.iterN(n-this.first,t-n,i):this.iterN(this.first,this.first+this.size,n)},insert:function(n,t){for(var r=0,i=0;i<t.length;++i)r+=t[i].height;this.insertInner(n-this.first,t,r)},remove:function(n,t){this.removeInner(n-this.first,t)},getValue:function(n){var t=ws(this,this.first,this.first+this.size);return!1===n?t:t.join(n||this.lineSeparator())},setValue:k(function(i){var r=n(this.first,0),u=this.first+this.size-1;uu(this,{from:r,to:n(u,t(this,u).text.length),text:this.splitLines(i),origin:"setValue",full:!0},!0);this.cm&&yf(this.cm,0,0);nt(this,yi(r),ii)}),replaceRange:function(n,t,i,r){fu(this,n,t=f(this,t),i=i?f(this,i):t,r)},getRange:function(n,t,i){var r=tr(this,f(this,n),f(this,t));return!1===i?r:r.join(i||this.lineSeparator())},getLine:function(n){var t=this.getLineHandle(n);return t&&t.text},getLineHandle:function(n){if(tf(this,n))return t(this,n)},getLineNumber:function(n){return h(n)},getLineHandleVisualStart:function(n){return"number"==typeof n&&(n=t(this,n)),gt(n)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(n){return f(this,n)},getCursor:function(n){var t=this.sel.primary();return null==n||"head"==n?t.head:"anchor"==n?t.anchor:"end"==n||"to"==n||!1===n?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:k(function(t,i,r){ip(this,f(this,"number"==typeof t?n(t,i||0):t),null,r)}),setSelection:k(function(n,t,i){ip(this,f(this,n),f(this,t||n),i)}),extendSelection:k(function(n,t,i){wo(this,f(this,n),t&&f(this,t),i)}),extendSelections:k(function(n,t){tp(this,gl(this,n),t)}),extendSelectionsBy:k(function(n,t){tp(this,gl(this,de(this.sel.ranges,n)),t)}),setSelections:k(function(n,t,i){var e=this,u,r;if(n.length){for(u=[],r=0;r<n.length;r++)u[r]=new o(f(e,n[r].anchor),f(e,n[r].head));null==t&&(t=Math.min(n.length-1,this.sel.primIndex));nt(this,wt(u,t),i)}}),addSelection:k(function(n,t,i){var r=this.sel.ranges.slice(0);r.push(new o(f(this,n),f(this,t||n)));nt(this,wt(r,r.length-1),i)}),getSelection:function(n){for(var u,t,f=this,r=this.sel.ranges,i=0;i<r.length;i++)u=tr(f,r[i].from(),r[i].to()),t=t?t.concat(u):u;return!1===n?t:t.join(n||this.lineSeparator())},getSelections:function(n){for(var i,u=this,f=[],r=this.sel.ranges,t=0;t<r.length;t++)i=tr(u,r[t].from(),r[t].to()),!1!==n&&(i=i.join(n||u.lineSeparator())),f[t]=i;return f},replaceSelection:function(n,t,i){for(var u=[],r=0;r<this.sel.ranges.length;r++)u[r]=n;this.replaceSelections(u,t,i||"+input")},replaceSelections:k(function(n,t,i){for(var e,o,f,s=this,u=[],h=this.sel,r=0;r<h.ranges.length;r++)e=h.ranges[r],u[r]={from:e.from(),to:e.to(),text:s.splitLines(n[r]),origin:i};for(o=t&&"end"!=t&&ag(this,u,t),f=u.length-1;f>=0;f--)uu(s,u[f]);o?rp(this,o):this.cm&&nu(this.cm)}),undo:k(function(){ko(this,"undo")}),redo:k(function(){ko(this,"redo")}),undoSelection:k(function(){ko(this,"undo",!0)}),redoSelection:k(function(){ko(this,"redo",!0)}),setExtending:function(n){this.extend=n},getExtending:function(){return this.extend},historySize:function(){for(var t,n=this.history,r=0,u=0,i=0;i<n.done.length;i++)n.done[i].ranges||++r;for(t=0;t<n.undone.length;t++)n.undone[t].ranges||++u;return{undo:r,redo:u}},clearHistory:function(){this.history=new yo(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(n){return n&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(n){return this.history.generation==(n||this.cleanGeneration)},getHistory:function(){return{done:iu(this.history.done),undone:iu(this.history.undone)}},setHistory:function(n){var t=this.history=new yo(this.history.maxGeneration);t.done=iu(n.done.slice(0),null,!0);t.undone=iu(n.undone.slice(0),null,!0)},setGutterMarker:k(function(n,t,i){return gf(this,n,"gutter",function(n){var r=n.gutterMarkers||(n.gutterMarkers={});return r[t]=i,!i&&bl(r)&&(n.gutterMarkers=null),!0})}),clearGutter:k(function(n){var t=this;this.iter(function(i){i.gutterMarkers&&i.gutterMarkers[n]&&gf(t,i,"gutter",function(){return i.gutterMarkers[n]=null,bl(i.gutterMarkers)&&(i.gutterMarkers=null),!0})})}),lineInfo:function(n){var i;if("number"==typeof n){if(!tf(this,n)||(i=n,!(n=t(this,n))))return null}else if(null==(i=h(n)))return null;return{line:i,handle:n,text:n.text,gutterMarkers:n.gutterMarkers,textClass:n.textClass,bgClass:n.bgClass,wrapClass:n.wrapClass,widgets:n.widgets}},addLineClass:k(function(n,t,i){return gf(this,n,"gutter"==t?"gutter":"class",function(n){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(n[r]){if(gu(i).test(n[r]))return!1;n[r]+=" "+i}else n[r]=i;return!0})}),removeLineClass:k(function(n,t,i){return gf(this,n,"gutter"==t?"gutter":"class",function(n){var f="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",u=n[f],r,e;if(!u)return!1;if(null==i)n[f]=null;else{if(r=u.match(gu(i)),!r)return!1;e=r.index+r[0].length;n[f]=u.slice(0,r.index)+(r.index&&e!=u.length?" ":"")+u.slice(e)||null}return!0})}),addLineWidget:k(function(n,t,i){return nn(this,n,t,i)}),removeLineWidget:function(n){n.clear()},markText:function(n,t,i){return eu(this,f(this,n),f(this,t),i,i&&i.type||"range")},setBookmark:function(n,t){var i={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return n=f(this,n),eu(this,n,n,i,"bookmark")},findMarksAt:function(n){var e=[],u=t(this,(n=f(this,n)).line).markedSpans,r,i;if(u)for(r=0;r<u.length;++r)i=u[r],(null==i.from||i.from<=n.ch)&&(null==i.to||i.to>=n.ch)&&e.push(i.marker.parent||i.marker);return e},findMarks:function(n,t,i){n=f(this,n);t=f(this,t);var u=[],r=n.line;return this.iter(n.line,t.line+1,function(f){var s=f.markedSpans,o,e;if(s)for(o=0;o<s.length;o++)e=s[o],null!=e.to&&r==n.line&&n.ch>=e.to||null==e.from&&r!=n.line||null!=e.from&&r==t.line&&e.from>=t.ch||i&&!i(e.marker)||u.push(e.marker.parent||e.marker);++r}),u},getAllMarks:function(){var n=[];return this.iter(function(t){var r=t.markedSpans,i;if(r)for(i=0;i<r.length;++i)null!=r[i].from&&n.push(r[i].marker)}),n},posFromIndex:function(t){var i,r=this.first,u=this.lineSeparator().length;return this.iter(function(n){var f=n.text.length+u;if(f>t)return i=t,!0;t-=f;++r}),f(this,n(r,i))},indexFromPos:function(n){var t=(n=f(this,n)).ch,i;return n.line<this.first||n.ch<0?0:(i=this.lineSeparator().length,this.iter(this.first,n.line,function(n){t+=n.text.length+i}),t)},copy:function(n){var t=new ft(ws(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,n&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(n){var i,r,t;return n||(n={}),i=this.first,r=this.first+this.size,null!=n.from&&n.from>i&&(i=n.from),null!=n.to&&n.to<r&&(r=n.to),t=new ft(ws(this,i,r),n.mode||this.modeOption,i,this.lineSep,this.direction),n.sharedHist&&(t.history=this.history),(this.linked||(this.linked=[])).push({doc:t,sharedHist:n.sharedHist}),t.linked=[{doc:this,isParent:!0,sharedHist:n.sharedHist}],rn(t,wp(this)),t},unlinkDoc:function(n){var i=this,t,r;if(n instanceof a&&(n=n.doc),this.linked)for(t=0;t<this.linked.length;++t)if(i.linked[t].doc==n){i.linked.splice(t,1);n.unlinkDoc(i);un(wp(i));break}n.history==this.history&&(r=[n.id],ar(n,function(n){return r.push(n.id)},!0),n.history=new yo(null),n.history.done=iu(this.history.done,r),n.history.undone=iu(this.history.undone,r))},iterLinkedDocs:function(n){ar(this,n)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(n){return this.lineSep?n.split(this.lineSep):sl(n)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:k(function(n){"rtl"!=n&&(n="ltr");n!=this.direction&&(this.direction=n,this.iter(function(n){return n.order=null}),this.cm&&vg(this.cm))})});ft.prototype.eachLine=ft.prototype.iter;for(var hb=0,cb=!1,di={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},ve=0;ve<10;ve++)di[ve+48]=di[ve+96]=String(ve);for(ye=65;ye<=90;ye++)di[ye]=String.fromCharCode(ye);for(ku=1;ku<=12;ku++)di[ku+111]=di[ku+63235]="F"+ku;ui={};ui.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};ui.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};ui.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};ui.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};ui.default=kt?ui.macDefault:ui.pcDefault;var pe={selectAll:sp,singleSelection:function(n){return n.setSelection(n.getCursor("anchor"),n.getCursor("head"),ii)},killLine:function(i){return su(i,function(r){if(r.empty()){var u=t(i.doc,r.head.line).text.length;return r.head.ch==u&&r.head.line<i.lastLine()?{from:r.head,to:n(r.head.line+1,0)}:{from:r.head,to:n(r.head.line,u)}}return{from:r.from(),to:r.to()}})},deleteLine:function(t){return su(t,function(i){return{from:n(i.from().line,0),to:f(t.doc,n(i.to().line+1,0))}})},delLineLeft:function(t){return su(t,function(t){return{from:n(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(n){return su(n,function(t){var i=n.charCoords(t.head,"div").top+5;return{from:n.coordsChar({left:0,top:i},"div"),to:t.from()}})},delWrappedLineRight:function(n){return su(n,function(t){var i=n.charCoords(t.head,"div").top+5,r=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:r}})},undo:function(n){return n.undo()},redo:function(n){return n.redo()},undoSelection:function(n){return n.undoSelection()},redoSelection:function(n){return n.redoSelection()},goDocStart:function(t){return t.extendSelection(n(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(n(t.lastLine()))},goLineStart:function(n){return n.extendSelectionsBy(function(t){return tw(n,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(n){return n.extendSelectionsBy(function(t){return iw(n,t.head)},{origin:"+move",bias:1})},goLineEnd:function(n){return n.extendSelectionsBy(function(t){return yn(n,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(n){return n.extendSelectionsBy(function(t){var i=n.cursorCoords(t.head,"div").top+5;return n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:i},"div")},se)},goLineLeft:function(n){return n.extendSelectionsBy(function(t){var i=n.cursorCoords(t.head,"div").top+5;return n.coordsChar({left:0,top:i},"div")},se)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(t){var r=n.cursorCoords(t.head,"div").top+5,i=n.coordsChar({left:0,top:r},"div");return i.ch<n.getLine(i.line).search(/\S/)?iw(n,t.head):i},se)},goLineUp:function(n){return n.moveV(-1,"line")},goLineDown:function(n){return n.moveV(1,"line")},goPageUp:function(n){return n.moveV(-1,"page")},goPageDown:function(n){return n.moveV(1,"page")},goCharLeft:function(n){return n.moveH(-1,"char")},goCharRight:function(n){return n.moveH(1,"char")},goColumnLeft:function(n){return n.moveH(-1,"column")},goColumnRight:function(n){return n.moveH(1,"column")},goWordLeft:function(n){return n.moveH(-1,"word")},goGroupRight:function(n){return n.moveH(1,"group")},goGroupLeft:function(n){return n.moveH(-1,"group")},goWordRight:function(n){return n.moveH(1,"word")},delCharBefore:function(n){return n.deleteH(-1,"char")},delCharAfter:function(n){return n.deleteH(1,"char")},delWordBefore:function(n){return n.deleteH(-1,"word")},delWordAfter:function(n){return n.deleteH(1,"word")},delGroupBefore:function(n){return n.deleteH(-1,"group")},delGroupAfter:function(n){return n.deleteH(1,"group")},indentAuto:function(n){return n.indentSelection("smart")},indentMore:function(n){return n.indentSelection("add")},indentLess:function(n){return n.indentSelection("subtract")},insertTab:function(n){return n.replaceSelection("\t")},insertSoftTab:function(n){for(var r,e,u=[],f=n.listSelections(),t=n.options.tabSize,i=0;i<f.length;i++)r=f[i].from(),e=at(n.getLine(r.line),r.ch,t),u.push(vs(t-e%t));n.replaceSelections(u)},defaultTab:function(n){n.somethingSelected()?n.indentSelection("add"):n.execCommand("insertTab")},transposeChars:function(i){return ot(i,function(){for(var r,u,f,s=i.listSelections(),h=[],e=0;e<s.length;e++)s[e].empty()&&(r=s[e].head,u=t(i.doc,r.line).text,u&&((r.ch==u.length&&(r=new n(r.line,r.ch-1)),r.ch>0)?(r=new n(r.line,r.ch+1),i.replaceRange(u.charAt(r.ch-1)+u.charAt(r.ch-2),n(r.line,r.ch-2),r,"+transpose")):r.line>i.doc.first&&(f=t(i.doc,r.line-1).text,f&&(r=new n(r.line,1),i.replaceRange(u.charAt(0)+i.doc.lineSeparator()+f.charAt(f.length-1),n(r.line-1,f.length-1),r,"+transpose")))),h.push(new o(r,r)));i.setSelections(h)})},newlineAndIndent:function(n){return ot(n,function(){for(var r,t=n.listSelections(),i=t.length-1;i>=0;i--)n.replaceRange(n.doc.lineSeparator(),t[i].anchor,t[i].head,"+input");for(t=n.listSelections(),r=0;r<t.length;r++)n.indentLine(t[r].from().line,null,!0);nu(n)})},openLine:function(n){return n.replaceSelection("\n","start")},toggleOverwrite:function(n){return n.toggleOverwrite()}},uit=new bi,vl=null,yl=function(n,t,i){this.time=n;this.pos=t;this.button=i};yl.prototype.compare=function(n,t,i){return this.time+400>n&&0==u(t,this.pos)&&i==this.button};var we,be,du={toString:function(){return"CodeMirror.Init"}},lb={},ss={};a.defaults=lb;a.optionHandlers=ss;hs=[];a.defineInitHook=function(n){return hs.push(n)};yt=null;c=function(n){this.cm=n;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new bi;this.composing=null;this.gracePeriod=!1;this.readDOMTimeout=null};c.prototype.init=function(n){function e(n){var r,e,i,o,s;if(!w(t,n)){if(t.somethingSelected())ts({lineWise:!1,text:t.getSelections()}),"cut"==n.type&&t.replaceSelection("",null,"cut");else{if(!t.options.lineWiseCopyCut)return;r=yw(t);ts({lineWise:!0,text:r.text});"cut"==n.type&&t.operation(function(){t.setSelections(r.ranges,0,ii);t.replaceSelection("",null,"cut")})}if(n.clipboardData&&(n.clipboardData.clearData(),e=yt.text.join("\n"),n.clipboardData.setData("Text",e),n.clipboardData.getData("Text")==e))return void n.preventDefault();i=ww();o=i.firstChild;t.display.lineSpace.insertBefore(i,t.display.lineSpace.firstChild);o.value=yt.text.join("\n");s=document.activeElement;lu(o);setTimeout(function(){t.display.lineSpace.removeChild(i);s.focus();s==u&&f.showPrimarySelection()},50)}}var i=this,f=this,t=f.cm,u=f.div=n.lineDiv;pw(u,t.options.spellcheck);r(u,"paste",function(n){w(t,n)||aw(n,t)||l<=11&&setTimeout(b(t,function(){return i.updateFromDOM()}),20)});r(u,"compositionstart",function(n){i.composing={data:n.data,done:!1}});r(u,"compositionupdate",function(n){i.composing||(i.composing={data:n.data,done:!1})});r(u,"compositionend",function(n){i.composing&&(n.data!=i.composing.data&&i.readFromDOMSoon(),i.composing.done=!0)});r(u,"touchstart",function(){return f.forceCompositionEnd()});r(u,"input",function(){i.composing||i.readFromDOMSoon()});r(u,"copy",e);r(u,"cut",e)};c.prototype.prepareSelection=function(){var n=kv(this.cm,!1);return n.focus=this.cm.state.focused,n};c.prototype.showSelection=function(n,t){n&&this.cm.display.view.length&&((n.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(n))};c.prototype.showPrimarySelection=function(){var n=window.getSelection(),t=this.cm,y=t.doc.sel.primary(),c=y.from(),l=y.to(),r,f,s,i,h,v;if(t.display.viewTo==t.display.viewFrom||c.line>=t.display.viewTo||l.line<t.display.viewFrom)n.removeAllRanges();else if(r=is(t,n.anchorNode,n.anchorOffset),f=is(t,n.focusNode,n.focusOffset),!r||r.bad||!f||f.bad||0!=u(to(r,f),c)||0!=u(no(r,f),l)){var a=t.display.view,e=c.line>=t.display.viewFrom&&kw(t,c)||{node:a[0].measure.map[2],offset:0},o=l.line<t.display.viewTo&&kw(t,l);if(o||(s=a[a.length-1].measure,i=s.maps?s.maps[s.maps.length-1]:s.map,o={node:i[i.length-1],offset:i[i.length-2]-i[i.length-3]}),e&&o){v=n.rangeCount&&n.getRangeAt(0);try{h=cu(e.node,e.offset,o.offset,o.node)}catch(n){}h&&(!wi&&t.state.focused?(n.collapse(e.node,e.offset),h.collapsed||(n.removeAllRanges(),n.addRange(h))):(n.removeAllRanges(),n.addRange(h)),v&&null==n.anchorNode?n.addRange(v):wi&&this.startGracePeriod());this.rememberSelection()}else n.removeAllRanges()}};c.prototype.startGracePeriod=function(){var n=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){n.gracePeriod=!1;n.selectionChanged()&&n.cm.operation(function(){return n.cm.curOp.selectionChanged=!0})},20)};c.prototype.showMultipleSelections=function(n){ct(this.cm.display.cursorDiv,n.cursors);ct(this.cm.display.selectionDiv,n.selection)};c.prototype.rememberSelection=function(){var n=window.getSelection();this.lastAnchorNode=n.anchorNode;this.lastAnchorOffset=n.anchorOffset;this.lastFocusNode=n.focusNode;this.lastFocusOffset=n.focusOffset};c.prototype.selectionInEditor=function(){var n=window.getSelection(),t;return n.rangeCount?(t=n.getRangeAt(0).commonAncestorContainer,li(this.div,t)):!1};c.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())};c.prototype.blur=function(){this.div.blur()};c.prototype.getField=function(){return this.div};c.prototype.supportsTouch=function(){return!0};c.prototype.receivedFocus=function(){function t(){n.cm.state.focused&&(n.pollSelection(),n.polling.set(n.cm.options.pollInterval,t))}var n=this;this.selectionInEditor()?this.pollSelection():ot(this.cm,function(){return n.cm.curOp.selectionChanged=!0});this.polling.set(this.cm.options.pollInterval,t)};c.prototype.selectionChanged=function(){var n=window.getSelection();return n.anchorNode!=this.lastAnchorNode||n.anchorOffset!=this.lastAnchorOffset||n.focusNode!=this.lastFocusNode||n.focusOffset!=this.lastFocusOffset};c.prototype.pollSelection=function(){var n,t,i,r;if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){if(n=window.getSelection(),t=this.cm,us&&rs&&this.cm.options.gutters.length&&stt(n.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();this.composing||(this.rememberSelection(),i=is(t,n.anchorNode,n.anchorOffset),r=is(t,n.focusNode,n.focusOffset),i&&r&&ot(t,function(){nt(t.doc,yi(i,r),ii);(i.bad||r.bad)&&(t.curOp.selectionChanged=!0)}))}};c.prototype.pollContent=function(){var d,v,b,y,g,k,i,e,nt,tt;null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var r=this.cm,f=r.display,it=r.doc.sel.primary(),c=it.from(),a=it.to();if((0==c.ch&&c.line>r.firstLine()&&(c=n(c.line-1,t(r.doc,c.line-1).length)),a.ch==t(r.doc,a.line).text.length&&a.line<r.lastLine()&&(a=n(a.line+1,0)),c.line<f.viewFrom||a.line>f.viewTo-1)||(c.line==f.viewFrom||0==(d=sr(r,c.line))?(v=h(f.view[0].line),b=f.view[0].node):(v=h(f.view[d].line),b=f.view[d-1].node.nextSibling),k=sr(r,a.line),k==f.view.length-1?(y=f.viewTo-1,g=f.lineDiv.lastChild):(y=h(f.view[k+1].line)-1,g=f.view[k+1].node.previousSibling),!b))return!1;for(i=r.doc.splitLines(htt(r,b,g,v,y)),e=tr(r.doc,n(v,0),n(y,t(r.doc,y).text.length));i.length>1&&e.length>1;)if(s(i)==s(e))i.pop(),e.pop(),y--;else{if(i[0]!=e[0])break;i.shift();e.shift();v++}for(var o=0,l=0,rt=i[0],ut=e[0],ft=Math.min(rt.length,ut.length);o<ft&&rt.charCodeAt(o)==ut.charCodeAt(o);)++o;for(var p=s(i),w=s(e),et=Math.min(p.length-(1==i.length?o:0),w.length-(1==e.length?o:0));l<et&&p.charCodeAt(p.length-l-1)==w.charCodeAt(w.length-l-1);)++l;if(1==i.length&&1==e.length&&v==c.line)for(;o&&o>c.ch&&p.charCodeAt(p.length-l-1)==w.charCodeAt(w.length-l-1);)o--,l++;return i[i.length-1]=p.slice(0,p.length-l).replace(/^\u200b+/,""),i[0]=i[0].slice(o).replace(/\u200b+$/,""),nt=n(v,o),tt=n(y,e.length?s(e).length-l:0),i.length>1||i[0]||u(nt,tt)?(fu(r.doc,i,nt,tt,"+input"),!0):void 0};c.prototype.ensurePolled=function(){this.forceCompositionEnd()};c.prototype.reset=function(){this.forceCompositionEnd()};c.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())};c.prototype.readFromDOMSoon=function(){var n=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(n.readDOMTimeout=null,n.composing){if(!n.composing.done)return;n.composing=null}n.updateFromDOM()},80))};c.prototype.updateFromDOM=function(){var n=this;!this.cm.isReadOnly()&&this.pollContent()||ot(this.cm,function(){return et(n.cm)})};c.prototype.setUneditable=function(n){n.contentEditable="false"};c.prototype.onKeyPress=function(n){0!=n.charCode&&(n.preventDefault(),this.cm.isReadOnly()||b(this.cm,il)(this.cm,String.fromCharCode(null==n.charCode?n.keyCode:n.charCode),0))};c.prototype.readOnlyChanged=function(n){this.div.contentEditable=String("nocursor"!=n)};c.prototype.onContextMenu=function(){};c.prototype.resetPosition=function(){};c.prototype.needsContentAttribute=!0;y=function(n){this.cm=n;this.prevInput="";this.pollingFast=!1;this.polling=new bi;this.hasSelection=!1;this.composing=null};y.prototype.init=function(n){function f(n){if(!w(t,n)){if(t.somethingSelected())ts({lineWise:!1,text:t.getSelections()});else{if(!t.options.lineWiseCopyCut)return;var r=yw(t);ts({lineWise:!0,text:r.text});"cut"==n.type?t.setSelections(r.ranges,null,ii):(i.prevInput="",u.value=r.text.join("\n"),lu(u))}"cut"==n.type&&(t.state.cutIncoming=!0)}}var o=this,i=this,t=this.cm,s=this.wrapper=ww(),u=this.textarea=s.firstChild;n.wrapper.insertBefore(s,n.wrapper.firstChild);ee&&(u.style.width="0px");r(u,"input",function(){e&&l>=9&&o.hasSelection&&(o.hasSelection=null);i.poll()});r(u,"paste",function(n){w(t,n)||aw(n,t)||(t.state.pasteIncoming=!0,i.fastPoll())});r(u,"cut",f);r(u,"copy",f);r(n.scroller,"paste",function(r){si(n,r)||w(t,r)||(t.state.pasteIncoming=!0,i.focus())});r(n.lineSpace,"selectstart",function(t){si(n,t)||it(t)});r(u,"compositionstart",function(){var n=t.getCursor("from");i.composing&&i.composing.range.clear();i.composing={start:n,range:t.markText(n,t.getCursor("to"),{className:"CodeMirror-composing"})}});r(u,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})};y.prototype.prepareSelection=function(){var n=this.cm,t=n.display,e=n.doc,i=kv(n);if(n.options.moveInputWithCursor){var r=pt(n,e.sel.primary().head,"div"),u=t.wrapper.getBoundingClientRect(),f=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+f.top-u.top));i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+f.left-u.left))}return i};y.prototype.showSelection=function(n){var t=this.cm.display;ct(t.cursorDiv,n.cursors);ct(t.selectionDiv,n.selection);null!=n.teTop&&(this.wrapper.style.top=n.teTop+"px",this.wrapper.style.left=n.teLeft+"px")};y.prototype.reset=function(n){var t,i;this.contextMenuPending||this.composing||(t=this.cm,t.somethingSelected()?(this.prevInput="",i=t.getSelection(),this.textarea.value=i,t.state.focused&&lu(this.textarea),e&&l>=9&&(this.hasSelection=i)):n||(this.prevInput=this.textarea.value="",e&&l>=9&&(this.hasSelection=null)))};y.prototype.getField=function(){return this.textarea};y.prototype.supportsTouch=function(){return!1};y.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!oe||fi()!=this.textarea))try{this.textarea.focus()}catch(n){}};y.prototype.blur=function(){this.textarea.blur()};y.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};y.prototype.receivedFocus=function(){this.slowPoll()};y.prototype.slowPoll=function(){var n=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){n.poll();n.cm.state.focused&&n.slowPoll()})};y.prototype.fastPoll=function(){function t(){n.poll()||i?(n.pollingFast=!1,n.slowPoll()):(i=!0,n.polling.set(60,t))}var i=!1,n=this;n.pollingFast=!0;n.polling.set(20,t)};y.prototype.poll=function(){var i=this,n=this.cm,f=this.textarea,r=this.prevInput,t,o,u,s;if(this.contextMenuPending||!n.state.focused||gtt(f)&&!r&&!this.composing||n.isReadOnly()||n.options.disableInput||n.state.keySeq||(t=f.value,t==r&&!n.somethingSelected()))return!1;if(e&&l>=9&&this.hasSelection===t||kt&&/[\uf700-\uf7ff]/.test(t))return n.display.input.reset(),!1;if(n.doc.sel==n.display.selForContextMenu&&(o=t.charCodeAt(0),8203!=o||r||(r="​"),8666==o))return this.reset(),this.cm.execCommand("undo");for(u=0,s=Math.min(r.length,t.length);u<s&&r.charCodeAt(u)==t.charCodeAt(u);)++u;return ot(n,function(){il(n,t.slice(u),r.length-u,null,i.composing?"*compose":null);t.length>1e3||t.indexOf("\n")>-1?f.value=i.prevInput="":i.prevInput=t;i.composing&&(i.composing.range.clear(),i.composing.range=n.markText(i.composing.start,n.getCursor("to"),{className:"CodeMirror-composing"}))}),!0};y.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)};y.prototype.onKeyPress=function(){e&&l>=9&&(this.hasSelection=null);this.fastPoll()};y.prototype.onContextMenu=function(n){function c(){if(null!=u.selectionStart){var n=t.somethingSelected(),r="​"+(n?u.value:"");u.value="⇚";u.value=r;f.prevInput=n?"":"​";u.selectionStart=1;u.selectionEnd=r.length;i.selForContextMenu=t.doc.sel}}function a(){if(f.contextMenuPending=!1,f.wrapper.style.cssText=y,u.style.cssText=v,e&&l<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=w),null!=u.selectionStart){(!e||e&&l<9)&&c();var r=0,n=function(){i.selForContextMenu==t.doc.sel&&0==u.selectionStart&&u.selectionEnd>0&&"​"==f.prevInput?b(t,sp)(t):r++<10?i.detectingSelectAll=setTimeout(n,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(n,200)}}var f=this,t=f.cm,i=t.display,u=f.textarea,o=or(t,n),w=i.scroller.scrollTop,v,y,s,p,h;o&&!bt&&(t.options.resetSelectionOnContextMenu&&-1==t.doc.sel.contains(o)&&b(t,nt)(t.doc,yi(o),ii),v=u.style.cssText,y=f.wrapper.style.cssText,f.wrapper.style.cssText="position: absolute",s=f.wrapper.getBoundingClientRect(),u.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(n.clientY-s.top-5)+"px; left: "+(n.clientX-s.left-5)+"px;\n      z-index: 1000; background: "+(e?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",(tt&&(p=window.scrollY),i.input.focus(),tt&&window.scrollTo(null,p),i.input.reset(),t.somethingSelected()||(u.value=f.prevInput=" "),f.contextMenuPending=!0,i.selForContextMenu=t.doc.sel,clearTimeout(i.detectingSelectAll),e&&l>=9&&c(),ul)?(ef(n),h=function(){lt(window,"mouseup",h);setTimeout(a,20)},r(window,"mouseup",h)):setTimeout(a,50))};y.prototype.readOnlyChanged=function(n){n||this.reset();this.textarea.disabled="nocursor"==n};y.prototype.setUneditable=function(){};y.prototype.needsContentAttribute=!1,function(t){function i(n,i,u,f){t.defaults[n]=i;u&&(r[n]=f?function(n,t,i){i!=du&&u(n,t,i)}:u)}var r=t.optionHandlers;t.defineOption=i;t.Init=du;i("value","",function(n,t){return n.setValue(t)},!0);i("mode",null,function(n,t){n.doc.modeOption=t;vc(n)},!0);i("indentUnit",2,vc,!0);i("indentWithTabs",!1);i("smartIndent",!0);i("tabSize",4,function(n){kf(n);cf(n);et(n)},!0);i("lineSeparator",null,function(t,i){var r,f,u;if(t.doc.lineSep=i,i)for(r=[],f=t.doc.first,t.doc.iter(function(t){for(var u,e=0;;){if(u=t.text.indexOf(i,e),-1==u)break;e=u+i.length;r.push(n(f,u))}f++}),u=r.length-1;u>=0;u--)fu(t.doc,i,r[u],n(r[u].line,r[u].ch+i.length))});i("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(n,t,i){n.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g");i!=du&&n.refresh()});i("specialCharPlaceholder",yk,function(n){return n.refresh()},!0);i("electricChars",!0);i("inputStyle",oe?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor");},!0);i("spellcheck",!1,function(n,t){return n.getInputField().spellcheck=t},!0);i("rtlMoveVisually",!ptt);i("wholeLineUpdateBefore",!0);i("theme","default",function(n){lw(n);re(n)},!0);i("keyMap","default",function(n,t,i){var u=go(t),r=i!=du&&go(i);r&&r.detach&&r.detach(n,u);u.attach&&u.attach(n,r||null)});i("extraKeys",null);i("configureMouse",null);i("lineWrapping",!1,ett,!0);i("gutters",[],function(n){lc(n.options);re(n)},!0);i("fixedGutter",!0,function(n,t){n.display.gutters.style.left=t?nc(n.display)+"px":"0";n.refresh()},!0);i("coverGutterNextToScrollbar",!1,function(n){return tu(n)},!0);i("scrollbarStyle","native",function(n){oy(n);tu(n);n.display.scrollbars.setScrollTop(n.doc.scrollTop);n.display.scrollbars.setScrollLeft(n.doc.scrollLeft)},!0);i("lineNumbers",!1,function(n){lc(n.options);re(n)},!0);i("firstLineNumber",1,re,!0);i("lineNumberFormatter",function(n){return n},re,!0);i("showCursorWhenSelecting",!1,af,!0);i("resetSelectionOnContextMenu",!0);i("lineWiseCopyCut",!0);i("pasteLinesPerSelection",!0);i("readOnly",!1,function(n,t){"nocursor"==t&&(vf(n),n.display.input.blur());n.display.input.readOnlyChanged(t)});i("disableInput",!1,function(n,t){t||n.display.input.reset()},!0);i("dragDrop",!0,ftt);i("allowDropFileTypes",null);i("cursorBlinkRate",530);i("cursorScrollMargin",0);i("cursorHeight",1,af,!0);i("singleCursorHeightPerLine",!0,af,!0);i("workTime",100);i("workDelay",100);i("flattenSpans",!0,kf,!0);i("addModeClass",!1,kf,!0);i("pollInterval",100);i("undoDepth",200,function(n,t){return n.doc.history.undoDepth=t});i("historyEventDelay",1250);i("viewportMargin",10,function(n){return n.refresh()},!0);i("maxHighlightLength",1e4,kf,!0);i("moveInputWithCursor",!0,function(n,t){t||n.display.input.resetPosition()});i("tabindex",null,function(n,t){return n.display.input.getField().tabIndex=t||""});i("autofocus",null);i("direction","ltr",function(n,t){return n.doc.setDirection(t)},!0)}(a),function(i){var u=i.optionHandlers,r=i.helpers={};i.prototype={constructor:i,focus:function(){window.focus();this.display.input.focus()},setOption:function(n,t){var i=this.options,r=i[n];i[n]==t&&"mode"!=n||(i[n]=t,u.hasOwnProperty(n)&&b(this,u[n])(this,t,r),v(this,"optionChange",this,n))},getOption:function(n){return this.options[n]},getDoc:function(){return this.doc},addKeyMap:function(n,t){this.state.keyMaps[t?"push":"unshift"](go(n))},removeKeyMap:function(n){for(var i=this.state.keyMaps,t=0;t<i.length;++t)if(i[t]==n||i[t].name==n)return i.splice(t,1),!0},addOverlay:rt(function(n,t){var r=n.token?n:i.getMode(this.options,n);if(r.startState)throw new Error("Overlays may not be stateful.");vb(this.state.overlays,{mode:r,modeSpec:n,opaque:t&&t.opaque,priority:t&&t.priority||0},function(n){return n.priority});this.state.modeGen++;et(this)}),removeOverlay:rt(function(n){for(var r,u=this,i=this.state.overlays,t=0;t<i.length;++t)if(r=i[t].modeSpec,r==n||"string"==typeof n&&r.name==n)return i.splice(t,1),u.state.modeGen++,void et(u)}),indentLine:rt(function(n,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract");tf(this.doc,n)&&ue(this,n,t,i)}),indentSelection:rt(function(n){for(var r,f,e,t=this,s=this.doc.sel.ranges,u=-1,i=0;i<s.length;i++)if(r=s[i],r.empty())r.head.line>u&&(ue(t,r.head.line,n,!0),u=r.head.line,i==t.doc.sel.primIndex&&nu(t));else{var h=r.from(),c=r.to(),l=Math.max(u,h.line);for(u=Math.min(t.lastLine(),c.line-(c.ch?0:1))+1,f=l;f<u;++f)ue(t,f,n);e=t.doc.sel.ranges;0==h.ch&&s.length==e.length&&e[i].from().ch>0&&bc(t.doc,i,new o(h,e[i].to()),ii)}}),getTokenAt:function(n,t){return pa(this,n,t)},getLineTokens:function(t,i){return pa(this,n(t),i,!0)},getTokenTypeAt:function(n){var i,e;n=f(this.doc,n);var r,u=va(this,t(this.doc,n.line)),s=0,h=(u.length-1)/2,o=n.ch;if(0==o)r=u[2];else for(;;)if(i=s+h>>1,(i?u[2*i-1]:0)>=o)h=i;else{if(!(u[2*i+1]<o)){r=u[2*i+2];break}s=i+1}return e=r?r.indexOf("overlay "):-1,e<0?r:0==e?null:r.slice(0,e-1)},getModeAt:function(n){var t=this.doc.mode;return t.innerMode?i.innerMode(t,this.getTokenAt(n).state).mode:t},getHelper:function(n,t){return this.getHelpers(n,t)[0]},getHelpers:function(n,t){var c=this,f=[],u,i,e,h,o,s;if(!r.hasOwnProperty(t))return f;if(u=r[t],i=this.getModeAt(n),"string"==typeof i[t])u[i[t]]&&f.push(u[i[t]]);else if(i[t])for(e=0;e<i[t].length;e++)h=u[i[t][e]],h&&f.push(h);else i.helperType&&u[i.helperType]?f.push(u[i.helperType]):u[i.name]&&f.push(u[i.name]);for(o=0;o<u._global.length;o++)s=u._global[o],s.pred(i,c)&&-1==d(f,s.val)&&f.push(s.val);return f},getStateAfter:function(n,t){var i=this.doc;return n=dl(i,null==n?i.first+i.size-1:n),of(this,n+1,t).state},cursorCoords:function(n,t){var r,i=this.doc.sel.primary();return r=null==n?i.head:"object"==typeof n?f(this.doc,n):n?i.from():i.to(),pt(this,r,t||"page")},charCoords:function(n,t){return ph(this,f(this.doc,n),t||"page")},coordsChar:function(n,t){return n=yv(this,n,t||"page"),bh(this,n.left,n.top)},lineAtHeight:function(n,t){return n=yv(this,{top:n,left:0},t||"page").top,ir(this.doc,n+this.display.viewOffset)},heightAtLine:function(n,i,r){var u,f=!1,e;return"number"==typeof n?(e=this.doc.first+this.doc.size-1,n<this.doc.first?n=this.doc.first:n>e&&(n=e,f=!0),u=t(this.doc,n)):u=n,ho(this,u,{top:0,left:0},i||"page",r||f).top+(f?this.doc.height-ei(u):0)},defaultTextHeight:function(){return er(this.display)},defaultCharWidth:function(){return lf(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(n,t,i,r,u){var o=this.display,s=(n=pt(this,f(this.doc,n))).bottom,e=n.left,h,c;(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==r)?s=n.top:("above"==r||"near"==r)&&(h=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth),("above"==r||n.bottom+t.offsetHeight>h)&&n.top>t.offsetHeight?s=n.top-t.offsetHeight:n.bottom+t.offsetHeight<=h&&(s=n.bottom),e+t.offsetWidth>c&&(e=c-t.offsetWidth));t.style.top=s+"px";t.style.left=t.style.right="";"right"==u?(e=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==u?e=0:"middle"==u&&(e=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=e+"px");i&&kd(this,{left:e,top:s,right:e+t.offsetWidth,bottom:s+t.offsetHeight})},triggerOnKeyDown:rt(uw),triggerOnKeyPress:rt(ew),triggerOnKeyUp:fw,triggerOnMouseDown:rt(ow),execCommand:function(n){if(pe.hasOwnProperty(n))return pe[n].call(null,this)},triggerElectric:rt(function(n){vw(this,n)}),findPosH:function(n,t,i,r){var s=this,o=1,u,e;for(t<0&&(o=-1,t=-t),u=f(this.doc,n),e=0;e<t&&!(u=rl(s.doc,u,o,i,r)).hitSide;++e);return u},moveH:rt(function(n,t){var i=this;this.extendSelectionsBy(function(r){return i.display.shift||i.doc.extend||r.empty()?rl(i.doc,r.head,n,t,i.options.rtlMoveVisually):n<0?r.from():r.to()},se)}),deleteH:rt(function(n,t){var r=this.doc.sel,i=this.doc;r.somethingSelected()?i.replaceSelection("",null,"+delete"):su(this,function(r){var u=rl(i,r.head,n,t,!1);return n<0?{from:u,to:r.head}:{from:r.head,to:u}})}),findPosV:function(n,t,i,r){var h=this,c=1,o=r,u,s,e;for(t<0&&(c=-1,t=-t),u=f(this.doc,n),s=0;s<t;++s)if(e=pt(h,u,"div"),null==o?o=e.left:e.left=o,(u=bw(h,e,c,i)).hitSide)break;return u},moveV:rt(function(n,t){var u=this,i=this.doc,f=[],e=!this.display.shift&&!i.extend&&i.sel.somethingSelected(),r;if(i.extendSelectionsBy(function(r){var o,s;return e?n<0?r.from():r.to():(o=pt(u,r.head,"div"),null!=r.goalColumn&&(o.left=r.goalColumn),f.push(o.left),s=bw(u,o,n,t),"page"==t&&r==i.sel.primary()&&ec(u,ph(u,s,"div").top-o.top),s)},se),f.length)for(r=0;r<i.sel.ranges.length;r++)i.sel.ranges[r].goalColumn=f[r]}),findWordAt:function(i){var u=t(this.doc,i.line).text,r=i.ch,f=i.ch,e,s,h;if(u){for(e=this.getHelper(i,"wordChars"),"before"!=i.sticky&&f!=u.length||!r?++f:--r,s=u.charAt(r),h=ge(s,e)?function(n){return ge(n,e)}:/\s/.test(s)?function(n){return/\s/.test(n)}:function(n){return!/\s/.test(n)&&!ge(n)};r>0&&h(u.charAt(r-1));)--r;for(;f<u.length&&h(u.charAt(f));)++f}return new o(n(i.line,r),n(i.line,f))},toggleOverwrite:function(n){null!=n&&n==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?gi(this.display.cursorDiv,"CodeMirror-overwrite"):yr(this.display.cursorDiv,"CodeMirror-overwrite"),v(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==fi()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:rt(function(n,t){yf(this,n,t)}),getScrollInfo:function(){var n=this.display.scroller;return{left:n.scrollLeft,top:n.scrollTop,height:n.scrollHeight-ni(this)-this.display.barHeight,width:n.scrollWidth-ni(this)-this.display.barWidth,clientHeight:ah(this),clientWidth:fr(this)}},scrollIntoView:rt(function(t,i){null==t?(t={from:this.doc.sel.primary().head,to:null},null==i&&(i=this.options.cursorScrollMargin)):"number"==typeof t?t={from:n(t,0),to:null}:null==t.from&&(t={from:t,to:null});t.to||(t.to=t.from);t.margin=i||0;null!=t.from.line?dd(this,t):uy(this,t.from,t.to,t.margin)}),setSize:rt(function(n,t){var u=this,r=function(n){return"number"==typeof n||/^\d+$/.test(String(n))?n+"px":n},i;null!=n&&(this.display.wrapper.style.width=r(n));null!=t&&(this.display.wrapper.style.height=r(t));this.options.lineWrapping&&lv(this);i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,function(n){if(n.widgets)for(var t=0;t<n.widgets.length;t++)if(n.widgets[t].noHScroll){ai(u,i,"widget");break}++i});this.curOp.forceUpdate=!0;v(this,"refresh",this)}),operation:function(n){return ot(this,n)},startOperation:function(){return cr(this)},endOperation:function(){return lr(this)},refresh:rt(function(){var n=this.display.cachedTextHeight;et(this);this.curOp.forceUpdate=!0;cf(this);yf(this,this.doc.scrollLeft,this.doc.scrollTop);hc(this);(null==n||Math.abs(n-er(this.display))>.5)&&tc(this);v(this,"refresh",this)}),swapDoc:rt(function(n){var t=this.doc;return t.cm=null,wy(this,n),cf(this),this.display.input.reset(),yf(this,n.scrollLeft,n.scrollTop),this.curOp.forceScroll=!0,g(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};dr(i);i.registerHelper=function(n,t,u){r.hasOwnProperty(n)||(r[n]=i[n]={_global:[]});r[n][t]=u};i.registerGlobalHelper=function(n,t,u,f){i.registerHelper(n,t,f);r[n]._global.push({pred:u,val:f})}}(a);ab="iter insert remove copy getEditor constructor".split(" ");for(ke in ft.prototype)ft.prototype.hasOwnProperty(ke)&&d(ab,ke)<0&&(a.prototype[ke]=function(n){return function(){return n.apply(this.doc,arguments)}}(ft.prototype[ke]));return dr(ft),a.inputStyles={textarea:y,contenteditable:c},a.defineMode=function(n){a.defaults.mode||"null"==n||(a.defaults.mode=n);sk.apply(this,arguments)},a.defineMIME=function(n,t){au[n]=t},a.defineMode("null",function(){return{token:function(n){return n.skipToEnd()}}}),a.defineMIME("text/plain","null"),a.defineExtension=function(n,t){a.prototype[n]=t},a.defineDocExtension=function(n,t){ft.prototype[n]=t},a.fromTextArea=function(n,t){function u(){n.value=s.getValue()}var f,e,i,o,s;if((t=t?nr(t):{},t.value=n.value,!t.tabindex&&n.tabIndex&&(t.tabindex=n.tabIndex),!t.placeholder&&n.placeholder&&(t.placeholder=n.placeholder),null==t.autofocus)&&(f=fi(),t.autofocus=f==n||null!=n.getAttribute("autofocus")&&f==document.body),n.form&&(r(n.form,"submit",u),!t.leaveSubmitMethodAlone)){i=n.form;e=i.submit;try{o=i.submit=function(){u();i.submit=e;i.submit();i.submit=o}}catch(n){}}return t.finishInit=function(t){t.save=u;t.getTextArea=function(){return n};t.toTextArea=function(){t.toTextArea=isNaN;u();n.parentNode.removeChild(t.getWrapperElement());n.style.display="";n.form&&(lt(n.form,"submit",u),"function"==typeof n.form.submit&&(n.form.submit=e))}},n.style.display="none",s=a(function(t){return n.parentNode.insertBefore(t,n.nextSibling)},t)},function(t){t.off=lt;t.on=r;t.wheelEventPixels=lg;t.Doc=ft;t.splitLines=sl;t.countColumn=at;t.findColumn=as;t.isWordChar=ys;t.Pass=fs;t.signal=v;t.Line=pr;t.changeEnd=pi;t.scrollbarModel=ob;t.Pos=n;t.cmpPos=u;t.modes=cl;t.mimeModes=au;t.resolveMode=eo;t.getMode=eh;t.modeExtensions=vu;t.extendMode=hk;t.copyState=ur;t.startState=la;t.innerMode=oh;t.commands=pe;t.keyMap=ui;t.keyName=nw;t.isModifierKey=dp;t.lookupKey=ou;t.normalizeKeyMap=an;t.StringStream=p;t.SharedTextMarker=bu;t.TextMarker=hi;t.LineWidget=wu;t.e_preventDefault=it;t.e_stopPropagation=ha;t.e_stop=ef;t.addClass=gi;t.contains=li;t.rmClass=yr;t.keyNames=di}(a),a.version="5.30.0",a});!function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)}(function(n){"use strict";n.defineMode("xml",function(t,i){function f(n,t){function i(i){return t.tokenize=i,i(n,t)}var r=n.next(),u;return"<"==r?n.eat("!")?n.eat("[")?n.match("CDATA[")?i(c("atom","]\]>")):null:n.match("-")?i(c("comment","->")):n.match("DOCTYPE",!0,!0)?(n.eatWhile(/[\w\._\-]/),i(l(1))):null:n.eat("?")?(n.eatWhile(/[\w\._\-]/),t.tokenize=c("meta","?>"),"meta"):(o=n.eat("/")?"closeTagBlog":"openTagBlog",t.tokenize=h,"tag bracket"):"&"==r?(u=n.eat("#")?n.eat("x")?n.eatWhile(/[a-fA-F\d]/)&&n.eat(";"):n.eatWhile(/[\d]/)&&n.eat(";"):n.eatWhile(/[\w\.\-:]/)&&n.eat(";"),u?"atom":"error"):(n.eatWhile(/[^&<]/),null)}function h(n,t){var i=n.next(),r;return">"==i||"/"==i&&n.eat(">")?(t.tokenize=f,o=">"==i?"endTagBlog":"selfcloseTagBlog","tag bracket"):"="==i?(o="equals",null):"<"==i?(t.tokenize=f,t.state=s,t.tagName=t.tagStart=null,r=t.tokenize(n,t),r?r+" tag error":"tag error"):/[\'\"]/.test(i)?(t.tokenize=nt(i),t.stringStartCol=n.column(),t.tokenize(n,t)):(n.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function nt(n){var t=function(t,i){for(;!t.eol();)if(t.next()==n){i.tokenize=h;break}return"string"};return t.isInAttribute=!0,t}function c(n,t){return function(i,r){for(;!i.eol();){if(i.match(t)){r.tokenize=f;break}i.next()}return n}}function l(n){return function(t,i){for(var r;null!=(r=t.next());){if("<"==r)return i.tokenize=l(n+1),i.tokenize(t,i);if(">"==r){if(1==n){i.tokenize=f;break}return i.tokenize=l(n-1),i.tokenize(t,i)}}return"meta"}}function tt(n,t,i){this.prev=n.context;this.tagName=t;this.indent=n.indented;this.startOfLine=i;(u.doNotIndent.hasOwnProperty(t)||n.context&&n.context.noIndent)&&(this.noIndent=!0)}function a(n){n.context&&(n.context=n.context.prev)}function w(n,t){for(var i;;){if(!n.context)return;if(i=n.context.tagName,!u.contextGrabbers.hasOwnProperty(i)||!u.contextGrabbers[i].hasOwnProperty(t))return;a(n)}}function s(n,t,i){return"openTagBlog"==n?(i.tagStart=t.column(),b):"closeTagBlog"==n?it:s}function b(n,t,i){return"word"==n?(i.tagName=t.current(),r="tag",e):(r="error",b)}function it(n,t,i){if("word"==n){var f=t.current();return i.context&&i.context.tagName!=f&&u.implicitlyClosed.hasOwnProperty(i.context.tagName)&&a(i),i.context&&i.context.tagName==f?(r="tag",v):(r="tag error",k)}return r="error",k}function v(n,t,i){return"endTagBlog"!=n?(r="error",v):(a(i),s)}function k(n,t,i){return r="error",v(n,t,i)}function e(n,t,i){if("word"==n)return r="attribute",rt;if("endTagBlog"==n||"selfcloseTagBlog"==n){var f=i.tagName,o=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTagBlog"==n||u.autoSelfClosers.hasOwnProperty(f)?w(i,f):(w(i,f),i.context=new tt(i,f,o==i.indented)),s}return r="error",e}function rt(n,t,i){return"equals"==n?ut:(u.allowMissing||(r="error"),e(n,t,i))}function ut(n,t,i){return"string"==n?d:"word"==n&&u.allowUnquoted?(r="string",e):(r="error",e(n,t,i))}function d(n,t,i){return"string"==n?d:e(n,t,i)}var y=t.indentUnit,ft=i.multilineTagBlogIndentFactor||1,p=i.multilineTagBlogIndentPastTagBlog,o,r,u,g;return null==p&&(p=!0),u=i.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},g=i.alignCDATA,{startState:function(){return{tokenize:f,state:s,indented:0,tagName:null,tagStart:null,context:null}},token:function(n,t){if(!t.tagName&&n.sol()&&(t.indented=n.indentation()),n.eatSpace())return null;o=null;var i=t.tokenize(n,t);return(i||o)&&"comment"!=i&&(r=null,t.state=t.state(o||i,n,t),r&&(i="error"==r?i+" error":r)),i},indent:function(t,i,r){var e=t.context,o,s;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+y;if(e&&e.noIndent)return n.Pass;if(t.tokenize!=h&&t.tokenize!=f)return r?r.match(/^(\s*)/)[0].length:0;if(t.tagName)return p?t.tagStart+t.tagName.length+2:t.tagStart+y*ft;if(g&&/<!\[CDATA\[/.test(i))return 0;if(o=i&&/^<(\/)?([\w_:\.-]*)/.exec(i),o&&o[1])for(;e;){if(e.tagName==o[2]){e=e.prev;break}if(!u.implicitlyClosed.hasOwnProperty(e.tagName))break;e=e.prev}else if(o)for(;e;){if(s=u.contextGrabbers[e.tagName],!s||!s.hasOwnProperty(o[2]))break;e=e.prev}for(;e&&!e.startOfLine;)e=e.prev;return e?e.indent+y:0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!-",blockCommentEnd:"->",configuration:i.htmlMode?"html":"xml",helperType:i.htmlMode?"html":"xml"}});n.defineMIME("text/xml","xml");n.defineMIME("application/xml","xml");n.mimeModes.hasOwnProperty("text/html")||n.defineMIME("text/html",{name:"xml",htmlMode:!0})}),function(n,t){typeof define=="function"&&define.amd?define(["jquery"],function(n){return t(n)}):typeof exports=="object"?module.exports=t(require("jquery")):t(jQuery)}(this,function(n){var i,t,o,r,s,h,c,u,f,l,a,e;t={ESC:27,TAB:9,ENTER:13,CTRL:17,A:65,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32};i={beforeSave:function(n){return r.arrayToDefaultHash(n)},matcher:function(n,t,i,r){var f,e,u,o,s;return n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i&&(n="(?:^|\\s)"+n),f=decodeURI("%C3%80"),e=decodeURI("%C3%BF"),s=r?" ":"",o=new RegExp(n+"([A-Za-z"+f+"-"+e+"0-9_"+s+"'.+-]*)$|"+n+"([^\\x00-\\xff]*)$","gi"),u=o.exec(t),u?u[2]||u[1]:null},filter:function(n,t,i){var u,r,f,e;for(u=[],r=0,e=t.length;r<e;r++)f=t[r],~new String(f[i]).toLowerCase().indexOf(n.toLowerCase())&&u.push(f);return u},remoteFilter:null,sorter:function(n,t,i){var f,u,r,e;if(!n)return t;for(f=[],u=0,e=t.length;u<e;u++)r=t[u],r.atwho_order=new String(r[i]).toLowerCase().indexOf(n.toLowerCase()),r.atwho_order>-1&&f.push(r);return f.sort(function(n,t){return n.atwho_order-t.atwho_order})},tplEval:function(n,t){var r,u,i=n;try{return typeof n!="string"&&(i=n(t)),i.replace(/\$\{([^\}]*)\}/g,function(n,i){return t[i]})}catch(u){return r=u,""}},highlighter:function(n,t){var i;return t?(i=new RegExp(">\\s*([^<]*?)("+t.replace("+","\\+")+")([^<]*)\\s*<","ig"),n.replace(i,function(n,t,i,r){return"> "+t+"<strong>"+i+"<\/strong>"+r+" <"})):n},beforeInsert:function(n){return n},beforeReposition:function(n){return n},afterMatchFailed:function(){}};o=function(){function i(t){this.currentFlag=null;this.controllers={};this.aliasMaps={};this.$inputor=n(t);this.setupRootElement();this.listen()}return i.prototype.createContainer=function(t){var i;return(i=this.$el)!=null&&i.remove(),n(t.body).append(this.$el=n("<div class='atwho-container'><\/div>"))},i.prototype.setupRootElement=function(t,i){var r,u;if(i==null&&(i=!1),t)this.window=t.contentWindow,this.document=t.contentDocument||this.window.document,this.iframe=t;else{this.document=this.$inputor[0].ownerDocument;this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(u){if(r=u,this.iframe=null,n.fn.atwho.debug)throw new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.\n"+r);}}return this.createContainer((this.iframeAsRoot=i)?this.document:document)},i.prototype.controller=function(n){var u,t,i,r;if(this.aliasMaps[n])t=this.controllers[this.aliasMaps[n]];else{r=this.controllers;for(i in r)if(u=r[i],i===n){t=u;break}}return t?t:this.controllers[this.currentFlag]},i.prototype.setContextFor=function(n){return this.currentFlag=n,this},i.prototype.reg=function(n,t){var i,r;return r=(i=this.controllers)[n]||(i[n]=this.$inputor.is("[contentEditable]")?new c(this,n):new h(this,n)),t.alias&&(this.aliasMaps[t.alias]=n),r.init(t),this},i.prototype.listen=function(){return this.$inputor.on("compositionstart",function(n){return function(){var t;return(t=n.controller())!=null&&t.view.hide(),n.isComposing=!0,null}}(this)).on("compositionend",function(n){return function(){return n.isComposing=!1,setTimeout(function(t){return n.dispatch(t)}),null}}(this)).on("keyup.atwhoInner",function(n){return function(t){return n.onKeyup(t)}}(this)).on("keydown.atwhoInner",function(n){return function(t){return n.onKeydown(t)}}(this)).on("blur.atwhoInner",function(n){return function(t){var i;if(i=n.controller())return i.expectedQueryCBId=null,i.view.hide(t,i.getOpt("displayTimeout"))}}(this)).on("click.atwhoInner",function(n){return function(t){return n.dispatch(t)}}(this)).on("scroll.atwhoInner",function(n){return function(){var t;return t=n.$inputor.scrollTop(),function(i){var r,u;return r=i.target.scrollTop,t!==r&&(u=n.controller())!=null&&u.view.hide(i),t=r,!0}}}(this)())},i.prototype.shutdown=function(){var n,t,i=this.controllers;for(n in i)t=i[n],t.destroy(),delete this.controllers[n];return this.$inputor.off(".atwhoInner"),this.$el.remove()},i.prototype.dispatch=function(n){var r,u,t,i;t=this.controllers;i=[];for(r in t)u=t[r],i.push(u.lookUp(n));return i},i.prototype.onKeyup=function(i){var r;switch(i.keyCode){case t.ESC:i.preventDefault();(r=this.controller())!=null&&r.view.hide();break;case t.DOWN:case t.UP:case t.CTRL:case t.ENTER:n.noop();break;case t.P:case t.N:i.ctrlKey||this.dispatch(i);break;default:this.dispatch(i)}},i.prototype.onKeydown=function(i){var u,r;if(r=(u=this.controller())!=null?u.view:void 0,r&&r.visible())switch(i.keyCode){case t.ESC:i.preventDefault();r.hide(i);break;case t.UP:i.preventDefault();r.prev();break;case t.DOWN:i.preventDefault();r.next();break;case t.P:if(!i.ctrlKey)return;i.preventDefault();r.prev();break;case t.N:if(!i.ctrlKey)return;i.preventDefault();r.next();break;case t.TAB:case t.ENTER:case t.SPACE:if(!r.visible())return;if(!this.controller().getOpt("spaceSelectsMatch")&&i.keyCode===t.SPACE)return;if(!this.controller().getOpt("tabSelectsMatch")&&i.keyCode===t.TAB)return;r.highlighted()?(i.preventDefault(),r.choose(i)):r.hide(i);break;default:n.noop()}},i}();s=[].slice;r=function(){function t(t,i){this.app=t;this.at=i;this.$inputor=this.app.$inputor;this.id=this.$inputor[0].id||this.uid();this.expectedQueryCBId=null;this.setting=null;this.query=null;this.pos=0;this.range=null;(this.$el=n("#atwho-ground-"+this.id,this.app.$el)).length===0&&this.app.$el.append(this.$el=n("<div id='atwho-ground-"+this.id+"'><\/div>"));this.model=new l(this);this.view=new a(this)}return t.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},t.prototype.init=function(t){return this.setting=n.extend({},this.setting||n.fn.atwho["default"],t),this.view.init(),this.model.reload(this.setting.data)},t.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},t.prototype.callDefault=function(){var r,u,f,t;t=arguments[0];r=2<=arguments.length?s.call(arguments,1):[];try{return i[t].apply(this,r)}catch(f){return u=f,n.error(u+" Or maybe At.js doesn't have function "+t)}},t.prototype.trigger=function(n,t){var i,r;return t==null&&(t=[]),t.push(this),i=this.getOpt("alias"),r=i?n+"-"+i+".atwho":n+".atwho",this.$inputor.trigger(r,t)},t.prototype.callbacks=function(n){return this.getOpt("callbacks")[n]||i[n]},t.prototype.getOpt=function(n){var t,i;try{return this.setting[n]}catch(i){return t=i,null}},t.prototype.insertContentFor=function(t){var i,r;return r=this.getOpt("insertTpl"),i=n.extend({},t.data("item-data"),{"atwho-at":this.at}),this.callbacks("tplEval").call(this,r,i,"onInsert")},t.prototype.renderView=function(n){var t;return t=this.getOpt("searchKey"),n=this.callbacks("sorter").call(this,this.query.text,n.slice(0,1001),t),this.view.render(n.slice(0,this.getOpt("limit")))},t.arrayToDefaultHash=function(t){var i,r,f,u;if(!n.isArray(t))return t;for(u=[],i=0,f=t.length;i<f;i++)r=t[i],n.isPlainObject(r)?u.push(r):u.push({name:r});return u},t.prototype.lookUp=function(n){var t,i;if(!n||n.type!=="click"||this.getOpt("lookUpOnClick"))return this.getOpt("suspendOnComposing")&&this.app.isComposing?void 0:(t=this.catchQuery(n),!t)?(this.expectedQueryCBId=null,t):(this.app.setContextFor(this.at),(i=this.getOpt("delay"))?this._delayLookUp(t,i):this._lookUp(t),t)},t.prototype._delayLookUp=function(n,t){var i,r;return i=Date.now?Date.now():(new Date).getTime(),this.previousCallTime||(this.previousCallTime=i),r=t-(i-this.previousCallTime),0<r&&r<t?(this.previousCallTime=i,this._stopDelayedCall(),this.delayedCallTimeout=setTimeout(function(t){return function(){return t.previousCallTime=0,t.delayedCallTimeout=null,t._lookUp(n)}}(this),t)):(this._stopDelayedCall(),this.previousCallTime!==i&&(this.previousCallTime=0),this._lookUp(n))},t.prototype._stopDelayedCall=function(){if(this.delayedCallTimeout)return clearTimeout(this.delayedCallTimeout),this.delayedCallTimeout=null},t.prototype._generateQueryCBId=function(){return{}},t.prototype._lookUp=function(t){var i;return i=function(n,t){if(n===this.expectedQueryCBId)return t&&t.length>0?this.renderView(this.constructor.arrayToDefaultHash(t)):this.view.hide()},this.expectedQueryCBId=this._generateQueryCBId(),this.model.query(t.text,n.proxy(i,this,this.expectedQueryCBId))},t}();u=function(n,t){function r(){this.constructor=n}for(var i in t)f.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n};f={}.hasOwnProperty;h=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return u(i,t),i.prototype.catchQuery=function(){var i,u,f,r,n,t,e;if(u=this.$inputor.val(),i=this.$inputor.caret("pos",{iframe:this.app.iframe}),e=u.slice(0,i),n=this.callbacks("matcher").call(this,this.at,e,this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),r=typeof n=="string",!r||!(n.length<this.getOpt("minLen",0)))return r&&n.length<=this.getOpt("maxLen",20)?(t=i-n.length,f=t+n.length,this.pos=t,n={text:n,headPos:t,endPos:f},this.trigger("matched",[this.at,n.text])):(n=null,this.view.hide()),this.query=n},i.prototype.rect=function(){var t,i,r;if((t=this.$inputor.caret("offset",this.pos-1,{iframe:this.app.iframe})))return this.app.iframe&&!this.app.iframeAsRoot&&(i=n(this.app.iframe).offset(),t.left+=i.left,t.top+=i.top),r=this.app.document.selection?0:2,{left:t.left,top:t.top,bottom:t.top+t.height+r}},i.prototype.insert=function(n){var t,r,u,i,f;return t=this.$inputor,r=t.val(),u=r.slice(0,Math.max(this.query.headPos-this.at.length,0)),i=(i=this.getOpt("suffix"))===""?i:i||" ",n+=i,f=""+u+n+r.slice(this.query.endPos||0),t.val(f),t.caret("pos",u.length+n.length,{iframe:this.app.iframe}),t.is(":focus")||t.focus(),t.change()},i}(r);u=function(n,t){function r(){this.constructor=n}for(var i in t)f.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n};f={}.hasOwnProperty;c=function(i){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,i),r.prototype._getRange=function(){var n;return n=this.app.window.getSelection(),n.rangeCount>0?n.getRangeAt(0):void 0},r.prototype._setRange=function(t,i,r){if(r==null&&(r=this._getRange()),r&&i)return i=n(i)[0],t==="after"?(r.setEndAfter(i),r.setStartAfter(i)):(r.setEndBefore(i),r.setStartBefore(i)),r.collapse(!1),this._clearRange(r)},r.prototype._clearRange=function(n){var t;return n==null&&(n=this._getRange()),t=this.app.window.getSelection(),this.ctrl_a_pressed==null?(t.removeAllRanges(),t.addRange(n)):void 0},r.prototype._movingEvent=function(n){var i;return n.type==="click"||(i=n.which)===t.RIGHT||i===t.LEFT||i===t.UP||i===t.DOWN},r.prototype._unwrap=function(t){var i;return t=n(t).unwrap().get(0),(i=t.nextSibling)&&i.nodeValue&&(t.nodeValue+=i.nodeValue,n(i).remove()),t},r.prototype.catchQuery=function(i){var h,r,e,a,v,s,f,o,c,l,y,u;if((u=this._getRange())&&u.collapsed){if(i.which===t.ENTER){(r=n(u.startContainer).closest(".atwho-query")).contents().unwrap();r.is(":empty")&&r.remove();(r=n(".atwho-query",this.app.document)).text(r.text()).contents().last().unwrap();this._clearRange();return}if(/firefox/i.test(navigator.userAgent)){if(n(u.startContainer).is(this.$inputor)){this._clearRange();return}i.which===t.BACKSPACE&&u.startContainer.nodeType===document.ELEMENT_NODE&&(c=u.startOffset-1)>=0?(e=u.cloneRange(),e.setStart(u.startContainer,c),n(e.cloneContents()).contents().last().is(".atwho-inserted")&&(v=n(u.startContainer).contents().get(c),this._setRange("after",n(v).contents().last()))):i.which===t.LEFT&&u.startContainer.nodeType===document.TEXT_NODE&&(h=n(u.startContainer.previousSibling),h.is(".atwho-inserted")&&u.startOffset===0&&this._setRange("after",h.contents().last()))}if(n(u.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),(r=n(".atwho-query",this.app.document)).length>0&&r.is(":empty")&&r.text().length===0&&r.remove(),this._movingEvent(i)||r.removeClass("atwho-inserted"),r.length>0)switch(i.which){case t.LEFT:this._setRange("before",r.get(0),u);r.removeClass("atwho-query");return;case t.RIGHT:this._setRange("after",r.get(0).nextSibling,u);r.removeClass("atwho-query");return}if(r.length>0&&(y=r.attr("data-atwho-at-query"))&&(r.empty().html(y).attr("data-atwho-at-query",null),this._setRange("after",r.get(0),u)),e=u.cloneRange(),e.setStart(u.startContainer,0),o=this.callbacks("matcher").call(this,this.at,e.toString(),this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),s=typeof o=="string",r.length===0&&s&&(a=u.startOffset-this.at.length-o.length)>=0&&(u.setStart(u.startContainer,a),r=n("<span/>",this.app.document).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),u.surroundContents(r.get(0)),f=r.contents().last().get(0),f&&(/firefox/i.test(navigator.userAgent)?(u.setStart(f,f.length),u.setEnd(f,f.length),this._clearRange(u)):this._setRange("after",f,u))),!s||!(o.length<this.getOpt("minLen",0)))return s&&o.length<=this.getOpt("maxLen",20)?(l={text:o,el:r},this.trigger("matched",[this.at,l.text]),this.query=l):(this.view.hide(),this.query={el:r},r.text().indexOf(this.at)>=0&&(this._movingEvent(i)&&r.hasClass("atwho-inserted")?r.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,r)&&this._setRange("after",this._unwrap(r.text(r.text()).contents().first()))),null)}},r.prototype.rect=function(){var r,i,t;if(t=this.query.el.offset(),t)return this.app.iframe&&!this.app.iframeAsRoot&&(i=(r=n(this.app.iframe)).offset(),t.left+=i.left-this.$inputor.scrollLeft(),t.top+=i.top-this.$inputor.scrollTop()),t.bottom=t.top+this.query.el.height(),t},r.prototype.insert=function(n,t){var u,i,r,f;return this.$inputor.is(":focus")||this.$inputor.focus(),r=(r=this.getOpt("suffix"))===""?r:r||" ",u=t.data("item-data"),this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(n).attr("data-atwho-at-query",""+u["atwho-at"]+this.query.text).attr("contenteditable","false"),(i=this._getRange())&&(this.query.el.length&&i.setEndAfter(this.query.el[0]),i.collapse(!1),i.insertNode(f=this.app.document.createTextNode(""+r)),this._setRange("after",f,i)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change()},r}(r);l=function(){function t(n){this.context=n;this.at=this.context.at;this.storage=this.context.$inputor}return t.prototype.destroy=function(){return this.storage.data(this.at,null)},t.prototype.saved=function(){return this.fetch()>0},t.prototype.query=function(n,t){var r,i,u;return i=this.fetch(),u=this.context.getOpt("searchKey"),i=this.context.callbacks("filter").call(this.context,n,i,u)||[],r=this.context.callbacks("remoteFilter"),i.length>0||!r&&i.length===0?t(i):r.call(this.context,n,t)},t.prototype.fetch=function(){return this.storage.data(this.at)||[]},t.prototype.save=function(n){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,n||[]))},t.prototype.load=function(n){if(!this.saved()&&n)return this._load(n)},t.prototype.reload=function(n){return this._load(n)},t.prototype._load=function(t){return typeof t=="string"?n.ajax(t,{dataType:"json"}).done(function(n){return function(t){return n.save(t)}}(this)):this.save(t)},t}();a=function(){function t(t){this.context=t;this.$el=n("<div class='atwho-view'><ul class='atwho-view-ul'><\/ul><\/div>");this.$elUl=this.$el.children();this.timeoutID=null;this.context.$el.append(this.$el);this.bindEvent()}return t.prototype.init=function(){var n,t;return t=this.context.getOpt("alias")||this.context.at.charCodeAt(0),n=this.context.getOpt("headerTpl"),n&&this.$el.children().length===1&&this.$el.prepend(n),this.$el.attr({id:"at-view-"+t})},t.prototype.destroy=function(){return this.$el.remove()},t.prototype.bindEvent=function(){var t,i,r;t=this.$el.find("ul");i=0;r=0;return t.on("mousemove.atwho-view","li",function(){return function(u){var f;if(i!==u.clientX||r!==u.clientY)return(i=u.clientX,r=u.clientY,f=n(u.currentTarget),f.hasClass("cur"))?void 0:(t.find(".cur").removeClass("cur"),f.addClass("cur"))}}(this)).on("click.atwho-view","li",function(i){return function(r){return t.find(".cur").removeClass("cur"),n(r.currentTarget).addClass("cur"),i.choose(r),r.preventDefault()}}(this))},t.prototype.visible=function(){return n.expr.filters.visible(this.$el[0])},t.prototype.highlighted=function(){return this.$el.find(".cur").length>0},t.prototype.choose=function(n){var t,i;return(t=this.$el.find(".cur")).length&&(i=this.context.insertContentFor(t),this.context._stopDelayedCall(),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,i,t,n),t),this.context.trigger("inserted",[t,n]),this.hide(n)),this.context.getOpt("hideWithoutSuffix")?this.stopShowing=!0:void 0},t.prototype.reposition=function(t){var i,r,u,f;return i=this.context.app.iframeAsRoot?this.context.app.window:window,t.bottom+this.$el.height()-n(i).scrollTop()>n(i).height()&&(t.bottom=t.top-this.$el.height()),t.left>(u=n(i).width()-this.$el.width()-5)&&(t.left=u),r={left:t.left,top:t.bottom},(f=this.context.callbacks("beforeReposition"))!=null&&f.call(this.context,r),this.$el.offset(r),this.context.trigger("reposition",[r])},t.prototype.next=function(){var i,n,t,r;return i=this.$el.find(".cur").removeClass("cur"),n=i.next(),n.length||(n=this.$el.find("li:first")),n.addClass("cur"),t=n[0],r=t.offsetTop+t.offsetHeight+(t.nextSibling?t.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,r-this.$el.height()))},t.prototype.prev=function(){var i,r,n,t;return i=this.$el.find(".cur").removeClass("cur"),n=i.prev(),n.length||(n=this.$el.find("li:last")),n.addClass("cur"),t=n[0],r=t.offsetTop+t.offsetHeight+(t.nextSibling?t.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,r-this.$el.height()))},t.prototype.scrollTop=function(n){var t;return t=this.context.getOpt("scrollDuration"),t?this.$elUl.animate({scrollTop:n},t):this.$elUl.scrollTop(n)},t.prototype.show=function(){var n;if(this.stopShowing){this.stopShowing=!1;return}return this.visible()||(this.$el.show(),this.$el.scrollTop(0),this.context.trigger("shown")),(n=this.context.rect())?this.reposition(n):void 0},t.prototype.hide=function(n,t){var i;if(this.visible())return isNaN(t)?(this.$el.hide(),this.context.trigger("hidden",[n])):(i=function(n){return function(){return n.hide()}}(this),clearTimeout(this.timeoutID),this.timeoutID=setTimeout(i,t))},t.prototype.render=function(t){var u,f,r,i,e,o,s;if(!(n.isArray(t)&&t.length>0)){this.hide();return}for(this.$el.find("ul").empty(),f=this.$el.find("ul"),s=this.context.getOpt("displayTpl"),r=0,e=t.length;r<e;r++)i=t[r],i=n.extend({},i,{"atwho-at":this.context.at}),o=this.context.callbacks("tplEval").call(this.context,s,i,"onDisplay"),u=n(this.context.callbacks("highlighter").call(this.context,o,this.context.query.text)),u.data("item-data",i),f.append(u);return this.show(),this.context.getOpt("highlightFirst")?f.find("li:first").addClass("cur"):void 0},t}();e={load:function(n,t){var i;if(i=this.controller(n))return i.model.load(t)},isSelecting:function(){var n;return!!((n=this.controller())!=null?n.view.visible():void 0)},hide:function(){var n;if((n=this.controller())!=null)return n.view.hide()},reposition:function(){var n;if(n=this.controller())return n.view.reposition(n.rect())},setIframe:function(n,t){return this.setupRootElement(n,t),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}};n.fn.atwho=function(t){var r,i;return r=arguments,i=null,this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each(function(){var f,u;return(u=(f=n(this)).data("atwho"))||f.data("atwho",u=new o(this)),typeof t!="object"&&t?e[t]&&u?i=e[t].apply(u,Array.prototype.slice.call(r,1)):n.error("Method "+t+" does not exist on jQuery.atwho"):u.reg(t.at,t)}),i!=null?i:this};n.fn.atwho["default"]={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}<\/li>",insertTpl:"${atwho-at}${name}",headerTpl:null,callbacks:i,searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,acceptSpaceBar:!1,highlightFirst:!0,limit:5,maxLen:20,minLen:0,displayTimeout:300,delay:null,spaceSelectsMatch:!1,tabSelectsMatch:!0,editableAtwhoQueryAttrs:{},scrollDuration:150,suspendOnComposing:!0,lookUpOnClick:!0};n.fn.atwho.debug=!1});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){var t=function(i,r){var u,f;this.id=++n.FE.ID;this.opts=n.extend(!0,{},n.extend({},t.DEFAULTS,"object"==typeof r&&r));u=JSON.stringify(this.opts);n.FE.OPTS_MAPPING[u]=n.FE.OPTS_MAPPING[u]||this.id;this.sid=n.FE.OPTS_MAPPING[u];n.FE.SHARED[this.sid]=n.FE.SHARED[this.sid]||{};this.shared=n.FE.SHARED[this.sid];this.shared.count=(this.shared.count||0)+1;this.$oel=n(i);this.$oel.data("froala.editor",this);this.o_doc=i.ownerDocument;this.o_win="defaultView"in this.o_doc?this.o_doc.defaultView:this.o_doc.parentWindow;f=n(this.o_win).scrollTop();this.$oel.on("froala.doInit",n.proxy(function(){this.$oel.off("froala.doInit");this.doc=this.$el.get(0).ownerDocument;this.win="defaultView"in this.doc?this.doc.defaultView:this.doc.parentWindow;this.$doc=n(this.doc);this.$win=n(this.win);this.opts.pluginsEnabled||(this.opts.pluginsEnabled=Object.keys(n.FE.PLUGINS));this.opts.initOnClick?(this.load(n.FE.MODULES),this.$el.on("touchstart.init",function(){n(this).data("touched",!0)}),this.$el.on("touchmove.init",function(){n(this).removeData("touched")}),this.$el.on("mousedown.init touchend.init dragenter.init focus.init",n.proxy(function(t){if("touchend"==t.type&&!this.$el.data("touched"))return!0;if(1===t.which||!t.which){this.$el.off("mousedown.init touchstart.init touchmove.init touchend.init dragenter.init focus.init");this.load(n.FE.MODULES);this.load(n.FE.PLUGINS);var i=t.originalEvent&&t.originalEvent.originalTarget;i&&"IMG"==i.tagName&&n(i).trigger("mousedown");void 0===this.ul&&this.destroy();"touchend"==t.type&&this.image&&t.originalEvent&&t.originalEvent.target&&n(t.originalEvent.target).is("img")&&setTimeout(n.proxy(function(){this.image.edit(n(t.originalEvent.target))},this),100);this.ready=!0;this.events.trigger("initialized")}},this)),this.events.trigger("initializationDelayed")):(this.load(n.FE.MODULES),this.load(n.FE.PLUGINS),n(this.o_win).scrollTop(f),void 0===this.ul&&this.destroy(),this.ready=!0,this.events.trigger("initialized"))},this));this._init()},i;t.DEFAULTS={initOnClick:!1,pluginsEnabled:null};t.MODULES={};t.PLUGINS={};t.VERSION="2.7.0";t.INSTANCES=[];t.OPTS_MAPPING={};t.SHARED={};t.ID=0;t.prototype._init=function(){var t=this.$oel.prop("tagName");this.$oel.closest("label").length;var i=n.proxy(function(){"TEXTAREA"!=t&&(this._original_html=this._original_html||this.$oel.html());this.$box=this.$box||this.$oel;this.opts.fullPage&&(this.opts.iframe=!0);this.opts.iframe?(this.$iframe=n('<iframe src="about:blank" frameBorder="0">'),this.$wp=n("<div><\/div>"),this.$box.html(this.$wp),this.$wp.append(this.$iframe),this.$iframe.get(0).contentWindow.document.open(),this.$iframe.get(0).contentWindow.document.write("<!DOCTYPE html>"),this.$iframe.get(0).contentWindow.document.write("<html><head><\/head><body><\/body><\/html>"),this.$iframe.get(0).contentWindow.document.close(),this.$el=this.$iframe.contents().find("body"),this.el=this.$el.get(0),this.$head=this.$iframe.contents().find("head"),this.$html=this.$iframe.contents().find("html"),this.iframe_document=this.$iframe.get(0).contentWindow.document,this.$oel.trigger("froala.doInit")):(this.$el=n("<div><\/div>"),this.el=this.$el.get(0),this.$wp=n("<div><\/div>").append(this.$el),this.$box.html(this.$wp),this.$oel.trigger("froala.doInit"))},this),u=n.proxy(function(){this.$box=n("<div>");this.$oel.before(this.$box).hide();this._original_html=this.$oel.val();this.$oel.parents("form").on("submit."+this.id,n.proxy(function(){this.events.trigger("form.submit")},this));this.$oel.parents("form").on("reset."+this.id,n.proxy(function(){this.events.trigger("form.reset")},this));i()},this),f=n.proxy(function(){this.$el=this.$oel;this.el=this.$el.get(0);this.$el.attr("contenteditable",!0).css("outline","none").css("display","inline-block");this.opts.multiLine=!1;this.opts.toolbarInline=!1;this.$oel.trigger("froala.doInit")},this),e=n.proxy(function(){this.$el=this.$oel;this.el=this.$el.get(0);this.opts.toolbarInline=!1;this.$oel.trigger("froala.doInit")},this),r=n.proxy(function(){this.$el=this.$oel;this.el=this.$el.get(0);this.opts.toolbarInline=!1;this.$oel.on("click.popup",function(n){n.preventDefault()});this.$oel.trigger("froala.doInit")},this);this.opts.editInPopup?r():"TEXTAREA"==t?u():"A"==t?f():"IMG"==t?e():"BUTTON"==t||"INPUT"==t?(this.opts.editInPopup=!0,this.opts.toolbarInline=!1,r()):i()};t.prototype.load=function(t){for(var i in t)if(t.hasOwnProperty(i)){if(this[i])continue;if(n.FE.PLUGINS[i]&&this.opts.pluginsEnabled.indexOf(i)<0)continue;if(this[i]=new t[i](this),this[i]._init&&(this[i]._init(),this.opts.initOnClick&&"core"==i))return!1}};t.prototype.destroy=function(){var i,t;if(this.shared.count--,this.events.$off(),i=this.html.get(),this.events.trigger("destroy",[],!0),this.events.trigger("shared.destroy",void 0,!0),0===this.shared.count){for(t in this.shared)this.shared.hasOwnProperty(t)&&(this.shared[t],n.FE.SHARED[this.sid][t]=null);n.FE.SHARED[this.sid]={}}this.$oel.parents("form").off("."+this.id);this.$oel.off("click.popup");this.$oel.removeData("froala.editor");this.$oel.off("froalaEditor");this.core.destroy(i);n.FE.INSTANCES.splice(n.FE.INSTANCES.indexOf(this),1)};n.fn.froalaEditor=function(i){for(var r,f=[],u=0;u<arguments.length;u++)f.push(arguments[u]);return"string"==typeof i?(r=[],this.each(function(){var s=n(this),t=s.data("froala.editor"),u,e,o;if(t){if(i.indexOf(".")>0&&t[i.split(".")[0]]?(t[i.split(".")[0]]&&(u=t[i.split(".")[0]]),e=i.split(".")[1]):(u=t,e=i.split(".")[0]),!u[e])return n.error("Method "+i+" does not exist in Froala Editor.");o=u[e].apply(t,f.slice(1));void 0===o?r.push(this):0===r.length&&r.push(o)}}),1==r.length?r[0]:r):"object"==typeof i||!i?this.each(function(){n(this).data("froala.editor")||new t(this,i)}):void 0};n.fn.froalaEditor.Constructor=t;n.FroalaEditor=t;n.FE=t;n.FE.XS=0;n.FE.SM=1;n.FE.MD=2;n.FE.LG=3;i="a-z\\u0080-\\u009f\\u00a1-\\uffff0-9";n.FE.LinkRegExCommon="((["+i+"])|(["+i+"](\\.|-|_))){1,}["+i+"]{1,}";n.FE.LinkRegExEnd="((:[0-9]{1,5})|)(((\\/|\\?|#)[a-z\\u00a1-\\uffff0-9@?!^=%&amp;/~+#-_{}]*)|())";n.FE.LinkRegExTLD="(("+n.FE.LinkRegExCommon+")(\\.(com|net|org|edu|mil|gov|co|biz|info|me|dev)))";n.FE.LinkRegExHTTP="((ftp|http|https):\\/\\/"+n.FE.LinkRegExCommon+")";n.FE.LinkRegExAuth="((ftp|http|https):\\/\\/[\\u0021-\\uffff]{1,}@"+n.FE.LinkRegExCommon+")";n.FE.LinkRegExWWW="(www\\."+n.FE.LinkRegExCommon+"\\.[a-z0-9-]{2,24})";n.FE.LinkRegEx="("+n.FE.LinkRegExTLD+"|"+n.FE.LinkRegExHTTP+"|"+n.FE.LinkRegExWWW+"|"+n.FE.LinkRegExAuth+")"+n.FE.LinkRegExEnd;n.FE.LinkProtocols=["mailto","tel","sms","notes","data"];n.FE.MAIL_REGEX=/.+@.+\..+/i;n.FE.MODULES.helpers=function(t){function c(){var n,t,i=-1;return"Microsoft Internet Explorer"==navigator.appName?(n=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),null!==t.exec(n)&&(i=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(n=navigator.userAgent,t=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),null!==t.exec(n)&&(i=parseFloat(RegExp.$1))),i}function l(){var n={},r=c();if(r>0)n.msie=!0;else{var t=navigator.userAgent.toLowerCase(),i=/(edge)[ \/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],u={browser:i[1]||"",version:i[2]||"0"};i[1]&&(n[u.browser]=!0);n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0)}return n.msie&&(n.version=r),n}function e(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&!i()}function o(){return/(Android)/g.test(navigator.userAgent)&&!i()}function s(){return/(Blackberry)/g.test(navigator.userAgent)}function i(){return/(Windows Phone)/gi.test(navigator.userAgent)}function a(){return o()||e()||s()}function v(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}function h(n){return parseInt(n,10)||0}function y(){var t=n('<div class="fr-visibility-helper"><\/div>').appendTo("body:first"),i=h(t.css("margin-left"));return t.remove(),i}function p(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}function r(t){return!!/^(https?:|ftps?:|)\/\//i.test(t)&&(t=String(t).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20"),new RegExp("^"+n.FE.LinkRegEx+"$","gi").test(t))}function w(t){if(/^([A-Za-z]:(\\){1,2}|[A-Za-z]:((\\){1,2}[^\\]+)+)(\\)?$/i.test(t))return t;if(/^(https?:|ftps?:|)\/\//i.test(t)){if(!r(t)&&!r("http:"+t))return""}else{if(new RegExp("^("+n.FE.LinkProtocols.join("|")+"):\\/\\/","i").test(t))return t;t=encodeURIComponent(t).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/gi,"mailto:").replace(/file%3A/gi,"file:").replace(/sms%3A/gi,"sms:").replace(/tel%3A/gi,"tel:").replace(/notes%3A/gi,"notes:").replace(/data%3Aimage/gi,"data:image").replace(/blob%3A/gi,"blob:").replace(/webkit-fake-url%3A/gi,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@").replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%7B/g,"{").replace(/%7D/g,"}")}return t}function b(n){return n&&!n.propertyIsEnumerable("length")&&"object"==typeof n&&"number"==typeof n.length}function k(n){function t(n){return("0"+parseInt(n,10).toString(16)).slice(-2)}try{return n&&"transparent"!==n?/^#[0-9A-F]{6}$/i.test(n)?n:(n=n.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),("#"+t(n[1])+t(n[2])+t(n[3])).toUpperCase()):""}catch(i){return null}}function d(n){var t;return n=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(n,t,i,r){return t+t+i+i+r+r}),t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),t?"rgb("+parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16)+")":""}function g(i){var f=(i.css("text-align")||"").replace(/-(.*)-/g,""),r,e,o;return["left","right","justify","center"].indexOf(f)<0&&(u||(r=n('<div dir="'+("rtl"==t.opts.direction?"rtl":"auto")+'" style="text-align: '+t.$el.css("text-align")+'; position: fixed; left: -3000px;"><span id="s1">.<\/span><span id="s2">.<\/span><\/div>'),n("body:first").append(r),e=r.find("#s1").get(0).getBoundingClientRect().left,o=r.find("#s2").get(0).getBoundingClientRect().left,r.remove(),u=e<o?"left":"right"),f=u),f}function nt(){return null==f&&(f=navigator.platform.toUpperCase().indexOf("MAC")>=0),f}function tt(){function n(n,t){var u=n[t];n[t]=function(n){var t,f=!1,e=!1,o;return n&&n.match(r)?(n=n.replace(r,""),this.parentNode||(i.appendChild(this),e=!0),o=this.parentNode,this.id||(this.id="rootedQuerySelector_id_"+(new Date).getTime(),f=!0),t=u.call(o,"#"+this.id+" "+n),f&&(this.id=""),e&&i.removeChild(this),t):u.call(this,n)}}var i=t.o_doc.createElement("div"),r;try{i.querySelectorAll(":scope *")}catch(u){r=/^\s*:scope/gi;n(Element.prototype,"querySelector");n(Element.prototype,"querySelectorAll");n(HTMLElement.prototype,"querySelector");n(HTMLElement.prototype,"querySelectorAll")}}function it(){return t.o_win.pageYOffset?t.o_win.pageYOffset:t.o_doc.documentElement&&t.o_doc.documentElement.scrollTop?t.o_doc.documentElement.scrollTop:t.o_doc.body.scrollTop?t.o_doc.body.scrollTop:0}function rt(){return t.o_win.pageXOffset?t.o_win.pageXOffset:t.o_doc.documentElement&&t.o_doc.documentElement.scrollLeft?t.o_doc.documentElement.scrollLeft:t.o_doc.body.scrollLeft?t.o_doc.body.scrollLeft:0}function ut(){t.browser=l();tt()}var u,f=null;return{_init:ut,isIOS:e,isMac:nt,isAndroid:o,isBlackberry:s,isWindowsPhone:i,isMobile:a,requestAnimationFrame:v,getPX:h,screenSize:y,isTouch:p,sanitizeURL:w,isArray:b,RGBToHex:k,HEXtoRGB:d,isURL:r,getAlignment:g,scrollTop:it,scrollLeft:rt}};n.FE.MODULES.events=function(t){function r(n,t,i){o(n,t,i)}function p(){r(t.$el,"cut copy paste beforepaste",function(n){i(n.type,[n])})}function w(){r(t.$el,"click mouseup mousedown touchstart touchend dragenter dragover dragleave dragend drop dragstart",function(n){i(n.type,[n])});u("mousedown",function(){for(var i=0;i<n.FE.INSTANCES.length;i++)n.FE.INSTANCES[i]!=t&&n.FE.INSTANCES[i].popups&&n.FE.INSTANCES[i].popups.areVisible()&&n.FE.INSTANCES[i].$el.find(".fr-marker").remove()})}function b(){r(t.$el,"keydown keypress keyup input",function(n){i(n.type,[n])})}function k(){r(t.$win,t._mousedown,function(n){i("window.mousedown",[n]);e()});r(t.$win,t._mouseup,function(n){i("window.mouseup",[n])});r(t.$win,"cut copy keydown keyup touchmove touchend",function(n){i("window."+n.type,[n])})}function d(){r(t.$doc,"dragend drop",function(n){i("document."+n.type,[n])})}function a(i){var u,r,f;if(void 0===i&&(i=!0),!t.$wp)return!1;if(t.helpers.isIOS()&&t.$win.get(0).focus(),!t.core.hasFocus()&&i)return u=t.$win.scrollTop(),t.browser.msie&&t.$box&&t.$box.css("position","fixed"),t.browser.msie&&t.$wp&&t.$wp.css("overflow","visible"),v(),t.$el.focus(),e(),t.browser.msie&&t.$box&&t.$box.css("position",""),t.browser.msie&&t.$wp&&t.$wp.css("overflow","auto"),u!=t.$win.scrollTop()&&t.$win.scrollTop(u),!1;if(!t.core.hasFocus()||t.$el.find(".fr-marker").length>0)return!1;t.selection.info(t.el).atStart&&t.selection.isCollapsed()&&null!=t.html.defaultTag()&&(r=t.markers.insert(),r&&!t.node.blockParent(r)?(n(r).remove(),f=t.$el.find(t.html.blockTagsQuery()).get(0),f&&(n(f).prepend(n.FE.MARKERS),t.selection.restore())):r&&n(r).remove())}function g(){r(t.$el,"focus",function(n){h()&&(a(!1),!1===s&&i(n.type,[n]))});r(t.$el,"blur",function(n){h()&&!0===s&&(i(n.type,[n]),e())});u("focus",function(){s=!0});u("blur",function(){s=!1})}function nt(){t.helpers.isMobile()?(t._mousedown="touchstart",t._mouseup="touchend",t._move="touchmove",t._mousemove="touchmove"):(t._mousedown="mousedown",t._mouseup="mouseup",t._move="",t._mousemove="mousemove")}function tt(i){var r=n(i.currentTarget);return t.edit.isDisabled()||t.node.hasClass(r.get(0),"fr-disabled")?(i.preventDefault(),!1):"mousedown"===i.type&&1!==i.which||(t.helpers.isMobile()||i.preventDefault(),(t.helpers.isAndroid()||t.helpers.isWindowsPhone())&&0===r.parents(".fr-dropdown-menu").length&&(i.preventDefault(),i.stopPropagation()),r.addClass("fr-selected"),void t.events.trigger("commands.mousedown",[r]))}function it(i,r){var u=n(i.currentTarget),f;if(t.edit.isDisabled()||t.node.hasClass(u.get(0),"fr-disabled"))return i.preventDefault(),!1;if("mouseup"===i.type&&1!==i.which||!t.node.hasClass(u.get(0),"fr-selected"))return!0;if("touchmove"!=i.type){if(i.stopPropagation(),i.stopImmediatePropagation(),i.preventDefault(),!t.node.hasClass(u.get(0),"fr-selected"))return t.button.getButtons(".fr-selected",!0).removeClass("fr-selected"),!1;if(t.button.getButtons(".fr-selected",!0).removeClass("fr-selected"),u.data("dragging")||u.attr("disabled"))return u.removeData("dragging"),!1;f=u.data("timeout");f&&(clearTimeout(f),u.removeData("timeout"));r.apply(t,[i])}else u.data("timeout")||u.data("timeout",setTimeout(function(){u.data("dragging",!0)},100))}function e(){c=!0}function v(){c=!1}function h(){return c}function rt(n,i,r){o(n,t._mousedown,i,function(n){t.edit.isDisabled()||tt(n)},!0);o(n,t._mouseup+" "+t._move,i,function(n){t.edit.isDisabled()||it(n,r)},!0);o(n,"mousedown click mouseup",i,function(n){t.edit.isDisabled()||n.stopPropagation()},!0);u("window.mouseup",function(){t.edit.isDisabled()||(n.find(i).removeClass("fr-selected"),e())})}function u(n,i,r){var o=n.split(" "),e,s;if(o.length>1){for(e=0;e<o.length;e++)u(o[e],i,r);return!0}void 0===r&&(r=!1);s=0!==n.indexOf("shared.")?f[n]=f[n]||[]:t.shared._events[n]=t.shared._events[n]||[];r?s.unshift(i):s.push(i)}function o(n,i,r,u,f){"function"==typeof r&&(f=u,u=r,r=!1);var o=f?t.shared.$_events:l,e=f?t.sid:t.id;r?n.on(i.split(" ").join(".ed"+e+" ")+".ed"+e,r,u):n.on(i.split(" ").join(".ed"+e+" ")+".ed"+e,u);o.push([n,i.split(" ").join(".ed"+e+" ")+".ed"+e])}function y(n){for(var t=0;t<n.length;t++)n[t][0].off(n[t][1])}function ut(){y(l);l=[];0===t.shared.count&&(y(t.shared.$_events),t.shared.$_events=[])}function i(i,r,u){var e,s,o;if(!t.edit.isDisabled()||u){if(0!==i.indexOf("shared."))e=f[i];else{if(t.shared.count>0)return!1;e=t.shared._events[i]}if(e)for(o=0;o<e.length;o++)if(!1===(s=e[o].apply(t,r)))return!1;return!1!==(s=t.$oel.triggerHandler("froalaEditor."+i,n.merge([t],r||[])))&&s}}function ft(i,r,u){var e,o,s;if(!t.edit.isDisabled()||u){if(0!==i.indexOf("shared."))e=f[i];else{if(t.shared.count>0)return!1;e=t.shared._events[i]}if(e)for(s=0;s<e.length;s++)void 0!==(o=e[s].apply(t,[r]))&&(r=o);return o=t.$oel.triggerHandler("froalaEditor."+i,n.merge([t],[r])),void 0!==o&&(r=o),r}}function et(){for(var n in f)f.hasOwnProperty(n)&&delete f[n]}function ot(){for(var n in t.shared._events)t.shared._events.hasOwnProperty(n)&&delete t.shared._events[n]}function st(){t.shared.$_events=t.shared.$_events||[];t.shared._events={};nt();w();k();d();b();g();e();p();u("destroy",et);u("shared.destroy",ot)}var c,f={},s=!1,l=[];return{_init:st,on:u,trigger:i,bindClick:rt,disableBlur:v,enableBlur:e,blurActive:h,focus:a,chainTrigger:ft,$on:o,$off:ut}};n.FE.MODULES.node=function(t){function r(n){return n&&"IFRAME"!=n.tagName?Array.prototype.slice.call(n.childNodes||[]):[]}function i(t){return!!t&&t.nodeType==Node.ELEMENT_NODE&&n.FE.BLOCK_TAGS.indexOf(t.tagName.toLowerCase())>=0}function h(n){return!!n&&n.nodeType==Node.ELEMENT_NODE&&"a"==n.tagName.toLowerCase()}function c(u,f){var e,h,s,o;if(!u)return!0;if(u.querySelector("table"))return!1;for(e=r(u),1==e.length&&i(e[0])&&(e=r(e[0])),h=!1,s=0;s<e.length;s++)if(o=e[s],(!f||!t.node.hasClass(o,"fr-marker"))&&(o.nodeType!=Node.TEXT_NODE||0!==o.textContent.length)){if("BR"!=o.tagName&&(o.textContent||"").replace(/\u200B/gi,"").replace(/\n/g,"").length>0||h)return!1;"BR"==o.tagName&&(h=!0)}return!(u.querySelectorAll(n.FE.VOID_ELEMENTS.join(",")).length-u.querySelectorAll("br").length)&&!u.querySelector(t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)")&&!(u.querySelectorAll(n.FE.BLOCK_TAGS.join(",")).length>1)&&!u.querySelector(t.opts.htmlDoNotWrapTags.join(":not(.fr-marker),")+":not(.fr-marker)")}function l(n){for(;n&&n.parentNode!==t.el&&(!n.parentNode||!t.node.hasClass(n.parentNode,"fr-inner"));)if(n=n.parentNode,i(n))return n;return null}function a(r,u,f){if(void 0===u&&(u=[]),void 0===f&&(f=!0),u.push(t.el),u.indexOf(r.parentNode)>=0||r.parentNode&&t.node.hasClass(r.parentNode,"fr-inner")||r.parentNode&&n.FE.SIMPLE_ENTER_TAGS.indexOf(r.parentNode.tagName)>=0&&f)return null;for(;u.indexOf(r.parentNode)<0&&r.parentNode&&!t.node.hasClass(r.parentNode,"fr-inner")&&(n.FE.SIMPLE_ENTER_TAGS.indexOf(r.parentNode.tagName)<0||!f)&&(!i(r)||!i(r.parentNode)||!f);)r=r.parentNode;return r}function u(n){var u={},i=n.attributes,t,r;if(i)for(t=0;t<i.length;t++)r=i[t],u[r.nodeName]=r.value;return u}function f(n){for(var i,t,r="",e=u(n),o=Object.keys(e).sort(),f=0;f<o.length;f++)i=o[f],t=e[i],t.indexOf("'")<0&&t.indexOf('"')>=0?r+=" "+i+"='"+t+"'":t.indexOf('"')>=0&&t.indexOf("'")>=0?(t=t.replace(/"/g,"&quot;"),r+=" "+i+'="'+t+'"'):r+=" "+i+'="'+t+'"';return r}function v(n){for(var r,i=n.attributes,t=i.length-1;t>=0;t--)r=i[t],n.removeAttribute(r.nodeName)}function y(n){return"<"+n.tagName.toLowerCase()+f(n)+">"}function p(n){return"<\/"+n.tagName.toLowerCase()+">"}function e(n,i){void 0===i&&(i=!0);for(var r=n.previousSibling;r&&i&&t.node.hasClass(r,"fr-marker");)r=r.previousSibling;return!r||r.nodeType==Node.TEXT_NODE&&""===r.textContent&&e(r)}function o(n,i){void 0===i&&(i=!0);for(var r=n.nextSibling;r&&i&&t.node.hasClass(r,"fr-marker");)r=r.nextSibling;return!r||r.nodeType==Node.TEXT_NODE&&""===r.textContent&&o(r)}function w(t){return t&&t.nodeType==Node.ELEMENT_NODE&&n.FE.VOID_ELEMENTS.indexOf((t.tagName||"").toLowerCase())>=0}function b(n){return!!n&&["UL","OL"].indexOf(n.tagName)>=0}function s(n){return n===t.el}function k(n){return n&&n.nodeType==Node.ELEMENT_NODE&&n.getAttribute("class")&&(n.getAttribute("class")||"").indexOf("fr-deletable")>=0}function d(n){return n===t.doc.activeElement&&(!t.doc.hasFocus||t.doc.hasFocus())&&!!(s(n)||n.type||n.href||~n.tabIndex)}function g(n){return(!n.getAttribute||"false"!=n.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(n.tagName)<0}function nt(t,i){return t instanceof n&&(t=t.get(0)),t&&t.classList&&t.classList.contains(i)}function tt(n){return t.browser.msie?n:{acceptNode:n}}return{isBlock:i,isEmpty:c,blockParent:l,deepestParent:a,rawAttributes:u,attributes:f,clearAttributes:v,openTagString:y,closeTagString:p,isFirstSibling:e,isLastSibling:o,isList:b,isLink:h,isElement:s,contents:r,isVoid:w,hasFocus:d,isEditable:g,isDeletable:k,hasClass:nt,filter:tt}};n.FE.INVISIBLE_SPACE="&#8203;";n.FE.START_MARKER='<span class="fr-marker" data-id="0" data-type="true" style="display: none; line-height: 0;">'+n.FE.INVISIBLE_SPACE+"<\/span>";n.FE.END_MARKER='<span class="fr-marker" data-id="0" data-type="false" style="display: none; line-height: 0;">'+n.FE.INVISIBLE_SPACE+"<\/span>";n.FE.MARKERS=n.FE.START_MARKER+n.FE.END_MARKER;n.FE.MODULES.markers=function(t){function u(i,r){return n('<span class="fr-marker" data-id="'+r+'" data-type="'+i+'" style="display: '+(t.browser.safari?"none":"inline-block")+'; line-height: 0;">'+n.FE.INVISIBLE_SPACE+"<\/span>",t.doc)[0]}function f(i,r,f){var o,s,e,c,h;try{if(c=i.cloneRange(),c.collapse(r),c.insertNode(u(r,f)),!0===r)for(o=t.$el.find('span.fr-marker[data-type="true"][data-id="'+f+'"]').get(0),e=o.nextSibling;e&&e.nodeType===Node.TEXT_NODE&&0===e.textContent.length;)n(e).remove(),e=o.nextSibling;if(!0===r&&!i.collapsed){for(;!t.node.isElement(o.parentNode)&&!e;)n(o.parentNode).after(o),e=o.nextSibling;if(e&&e.nodeType===Node.ELEMENT_NODE&&t.node.isBlock(e)){s=[e];do e=s[0],s=t.node.contents(e);while(s[0]&&t.node.isBlock(s[0]));n(e).prepend(n(o))}}if(!1===r&&!i.collapsed){if(o=t.$el.find('span.fr-marker[data-type="false"][data-id="'+f+'"]').get(0),(e=o.previousSibling)&&e.nodeType===Node.ELEMENT_NODE&&t.node.isBlock(e)){s=[e];do e=s[s.length-1],s=t.node.contents(e);while(s[s.length-1]&&t.node.isBlock(s[s.length-1]));n(e).append(n(o))}o.parentNode&&["TD","TH"].indexOf(o.parentNode.tagName)>=0&&o.parentNode.previousSibling&&!o.previousSibling&&n(o.parentNode.previousSibling).append(o)}return h=t.$el.find('span.fr-marker[data-type="'+r+'"][data-id="'+f+'"]').get(0),h&&(h.style.display="none"),h}catch(l){return null}}function i(){var u,f,e,o,r,i;if(!t.$wp)return null;try{if(u=t.selection.ranges(0),f=u.commonAncestorContainer,f!=t.el&&0===t.$el.find(f).length)return null;if(e=u.cloneRange(),o=u.cloneRange(),e.collapse(!0),r=n('<span class="fr-marker" style="display: none; line-height: 0;">'+n.FE.INVISIBLE_SPACE+"<\/span>",t.doc)[0],e.insertNode(r),r=t.$el.find("span.fr-marker").get(0)){for(i=r.nextSibling;i&&i.nodeType===Node.TEXT_NODE&&0===i.textContent.length;)n(i).remove(),i=t.$el.find("span.fr-marker").get(0).nextSibling;return t.selection.clear(),t.selection.get().addRange(o),r}return null}catch(s){}}function e(){var u,r,e;if(t.selection.isCollapsed()||t.selection.remove(),u=t.$el.find(".fr-marker").get(0),null==u&&(u=i()),null==u)return null;if(r=t.node.deepestParent(u),r||(r=t.node.blockParent(u))&&"LI"!=r.tagName&&(r=null),r)if(t.node.isBlock(r)&&t.node.isEmpty(r))"LI"!=r.tagName||r.parentNode.firstElementChild!=r||t.node.isEmpty(r.parentNode)?n(r).replaceWith('<span class="fr-marker"><\/span>'):n(r).append('<span class="fr-marker"><\/span>');else if(t.cursor.isAtStart(u,r))n(r).before('<span class="fr-marker"><\/span>'),n(u).remove();else if(t.cursor.isAtEnd(u,r))n(r).after('<span class="fr-marker"><\/span>'),n(u).remove();else{var f=u,s="",o="";do f=f.parentNode,s+=t.node.closeTagString(f),o=t.node.openTagString(f)+o;while(f!=r);n(u).replaceWith('<span id="fr-break"><\/span>');e=t.node.openTagString(r)+n(r).html()+t.node.closeTagString(r);e=e.replace(/<span id="fr-break"><\/span>/g,s+'<span class="fr-marker"><\/span>'+o);n(r).replaceWith(e)}return t.$el.find(".fr-marker").get(0)}function o(n){var e=n.clientX,o=n.clientY,f,u,s,h;if(r(),u=null,void 0!==t.doc.caretPositionFromPoint?(f=t.doc.caretPositionFromPoint(e,o),u=t.doc.createRange(),u.setStart(f.offsetNode,f.offset),u.setEnd(f.offsetNode,f.offset)):void 0!==t.doc.caretRangeFromPoint&&(f=t.doc.caretRangeFromPoint(e,o),u=t.doc.createRange(),u.setStart(f.startContainer,f.startOffset),u.setEnd(f.startContainer,f.startOffset)),null!==u&&void 0!==t.win.getSelection)s=t.win.getSelection(),s.removeAllRanges(),s.addRange(u);else if(void 0!==t.doc.body.createTextRange)try{u=t.doc.body.createTextRange();u.moveToPoint(e,o);h=u.duplicate();h.moveToPoint(e,o);u.setEndPoint("EndToEnd",h);u.select()}catch(c){return!1}i()}function r(){t.$el.find(".fr-marker").remove()}return{place:f,insert:i,split:e,insertAtPoint:o,remove:r}};n.FE.MODULES.selection=function(t){function i(){var n="";return t.win.getSelection?n=t.win.getSelection():t.doc.getSelection?n=t.doc.getSelection():t.doc.selection&&(n=t.doc.selection.createRange().text),n.toString()}function r(){return t.win.getSelection?t.win.getSelection():t.doc.getSelection?t.doc.getSelection():t.doc.selection.createRange()}function u(n){var i=r(),u=[],f;if(i&&i.getRangeAt&&i.rangeCount)for(u=[],f=0;f<i.rangeCount;f++)u.push(i.getRangeAt(f));else u=t.doc.createRange?[t.doc.createRange()]:[];return void 0!==n?u[n]:u}function l(){var n=r();try{n.removeAllRanges?n.removeAllRanges():n.empty?n.empty():n.clear&&n.clear()}catch(t){}}function b(){var c=r(),e,o,f,s,h;try{if(c.rangeCount){if(o=u(0),f=o.startContainer,f.nodeType==Node.TEXT_NODE&&o.startOffset==(f.textContent||"").length&&f.nextSibling&&(f=f.nextSibling),f.nodeType==Node.ELEMENT_NODE){if(s=!1,f.childNodes.length>0&&f.childNodes[o.startOffset]){for(e=f.childNodes[o.startOffset];e&&e.nodeType==Node.TEXT_NODE&&0===e.textContent.length;)e=e.nextSibling;if(e&&e.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(f=e,s=!0),!s&&f.childNodes.length>1&&o.startOffset>0&&f.childNodes[o.startOffset-1]){for(e=f.childNodes[o.startOffset-1];e&&e.nodeType==Node.TEXT_NODE&&0===e.textContent.length;)e=e.nextSibling;e&&e.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(f=e,s=!0)}}else!o.collapsed&&f.nextSibling&&f.nextSibling.nodeType==Node.ELEMENT_NODE&&(e=f.nextSibling)&&e.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(f=e,s=!0);!s&&f.childNodes.length>0&&n(f.childNodes[0]).text().replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&["BR","IMG","HR"].indexOf(f.childNodes[0].tagName)<0&&(f=f.childNodes[0])}for(;f.nodeType!=Node.ELEMENT_NODE&&f.parentNode;)f=f.parentNode;for(h=f;h&&"HTML"!=h.tagName;){if(h==t.el)return f;h=n(h).parent()[0]}}}catch(l){}return t.el}function k(){var c=r(),o,e,f,h,s;try{if(c.rangeCount){for(e=u(0),f=e.endContainer,f.nodeType==Node.ELEMENT_NODE&&(h=!1,f.childNodes.length>0&&f.childNodes[e.endOffset]&&n(f.childNodes[e.endOffset]).text()===i()?(f=f.childNodes[e.endOffset],h=!0):!e.collapsed&&f.previousSibling&&f.previousSibling.nodeType==Node.ELEMENT_NODE?(o=f.previousSibling)&&o.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(f=o,h=!0):!e.collapsed&&f.childNodes.length>0&&f.childNodes[e.endOffset]&&(o=f.childNodes[e.endOffset].previousSibling,o.nodeType==Node.ELEMENT_NODE&&o&&o.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(f=o,h=!0)),!h&&f.childNodes.length>0&&n(f.childNodes[f.childNodes.length-1]).text()===i()&&["BR","IMG","HR"].indexOf(f.childNodes[f.childNodes.length-1].tagName)<0&&(f=f.childNodes[f.childNodes.length-1])),f.nodeType==Node.TEXT_NODE&&0===e.endOffset&&f.previousSibling&&f.previousSibling.nodeType==Node.ELEMENT_NODE&&(f=f.previousSibling);f.nodeType!=Node.ELEMENT_NODE&&f.parentNode;)f=f.parentNode;for(s=f;s&&"HTML"!=s.tagName;){if(s==t.el)return f;s=n(s).parent()[0]}}}catch(l){}return t.el}function e(n,t){var i=n;return i.nodeType==Node.ELEMENT_NODE&&i.childNodes.length>0&&i.childNodes[t]&&(i=i.childNodes[t]),i.nodeType==Node.TEXT_NODE&&(i=i.parentNode),i}function d(){var o,f=[],y=r(),v,a,i;if(w()&&y.rangeCount)for(v=u(),o=0;o<v.length;o++){var s,h=v[o],l=e(h.startContainer,h.startOffset),c=e(h.endContainer,h.endOffset);for(t.node.isBlock(l)&&f.indexOf(l)<0&&f.push(l),s=t.node.blockParent(l),s&&f.indexOf(s)<0&&f.push(s),a=[],i=l;i!==c&&i!==t.el;)a.indexOf(i)<0&&i.children&&i.children.length?(a.push(i),i=i.children[0]):i.nextSibling?i=i.nextSibling:i.parentNode&&(i=i.parentNode,a.push(i)),t.node.isBlock(i)&&a.indexOf(i)<0&&f.indexOf(i)<0&&(i!==c||h.endOffset>0)&&f.push(i);t.node.isBlock(c)&&f.indexOf(c)<0&&h.endOffset>0&&f.push(c);s=t.node.blockParent(c);s&&f.indexOf(s)<0&&f.push(s)}for(o=f.length-1;o>0;o--)n(f[o]).find(f).length&&("LI"!=f[o].tagName||f[o].children.length>0&&f.indexOf(f[o].children[0])>=0)&&f.splice(o,1);return f}function a(){var r,i,e,f;if(t.$wp){for(t.markers.remove(),e=u(),f=[],i=0;i<e.length;i++)if(e[i].startContainer!==t.doc||t.browser.msie){r=e[i];var s=r.collapsed,o=t.markers.place(r,!0,i),h=t.markers.place(r,!1,i);void 0!==o&&o||!s||(n(".fr-marker").remove(),t.selection.setAtEnd(t.el));t.el.normalize();t.browser.safari&&!s&&(r=t.doc.createRange(),r.setStartAfter(o),r.setEndBefore(h),f.push(r))}if(t.browser.safari&&f.length)for(t.selection.clear(),i=0;i<f.length;i++)t.selection.get().addRange(f[i])}}function v(){var c,p=t.el.querySelectorAll('.fr-marker[data-type="true"]'),g,h,a,w,v,y,u,d,b,k;if(!t.$wp)return t.markers.remove(),!1;if(0===p.length)return!1;if(t.browser.msie||t.browser.edge)for(c=0;c<p.length;c++)p[c].style.display="inline-block";for(t.core.hasFocus()||t.browser.msie||t.browser.webkit||t.$el.focus(),l(),g=r(),c=0;c<p.length;c++){var tt=n(p[c]).data("id"),o=p[c],s=t.doc.createRange(),e=t.$el.find('.fr-marker[data-type="false"][data-id="'+tt+'"]');if((t.browser.msie||t.browser.edge)&&e.css("display","inline-block"),h=null,e.length>0){e=e[0];try{for(w=!1,v=o.nextSibling;v&&v.nodeType==Node.TEXT_NODE&&0===v.textContent.length;)a=v,v=v.nextSibling,n(a).remove();for(y=e.nextSibling;y&&y.nodeType==Node.TEXT_NODE&&0===y.textContent.length;)a=y,y=y.nextSibling,n(a).remove();if(o.nextSibling==e||e.nextSibling==o){for(var nt=o.nextSibling==e?o:e,it=nt==o?e:o,i=nt.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&0===i.length;)a=i,i=i.previousSibling,n(a).remove();if(i&&i.nodeType==Node.TEXT_NODE)for(;i&&i.previousSibling&&i.previousSibling.nodeType==Node.TEXT_NODE;)i.previousSibling.textContent=i.previousSibling.textContent+i.textContent,i=i.previousSibling,n(i.nextSibling).remove();for(u=it.nextSibling;u&&u.nodeType==Node.TEXT_NODE&&0===u.length;)a=u,u=u.nextSibling,n(a).remove();if(u&&u.nodeType==Node.TEXT_NODE)for(;u&&u.nextSibling&&u.nextSibling.nodeType==Node.TEXT_NODE;)u.nextSibling.textContent=u.textContent+u.nextSibling.textContent,u=u.nextSibling,n(u.previousSibling).remove();(i&&(t.node.isVoid(i)||t.node.isBlock(i))&&(i=null),u&&(t.node.isVoid(u)||t.node.isBlock(u))&&(u=null),i&&u&&i.nodeType==Node.TEXT_NODE&&u.nodeType==Node.TEXT_NODE)?(n(o).remove(),n(e).remove(),d=i.textContent.length,i.textContent=i.textContent+u.textContent,n(u).remove(),t.spaces.normalize(i),s.setStart(i,d),s.setEnd(i,d),w=!0):!i&&u&&u.nodeType==Node.TEXT_NODE?(n(o).remove(),n(e).remove(),t.spaces.normalize(u),h=n(t.doc.createTextNode("​")),n(u).before(h),s.setStart(u,0),s.setEnd(u,0),w=!0):!u&&i&&i.nodeType==Node.TEXT_NODE&&(n(o).remove(),n(e).remove(),t.spaces.normalize(i),h=n(t.doc.createTextNode("​")),n(i).after(h),s.setStart(i,i.textContent.length),s.setEnd(i,i.textContent.length),w=!0)}w||((t.browser.chrome||t.browser.edge)&&o.nextSibling==e?(b=f(e,s,!0)||s.setStartAfter(e),k=f(o,s,!1)||s.setEndBefore(o)):(o.previousSibling==e&&(o=e,e=o.nextSibling),e.nextSibling&&"BR"===e.nextSibling.tagName||!e.nextSibling&&t.node.isBlock(o.previousSibling)||o.previousSibling&&"BR"==o.previousSibling.tagName||(o.style.display="inline",e.style.display="inline",h=n(t.doc.createTextNode("​"))),b=f(o,s,!0)||n(o).before(h)&&s.setStartBefore(o),k=f(e,s,!1)||n(e).after(h)&&s.setEndAfter(e)),"function"==typeof b&&b(),"function"==typeof k&&k())}catch(rt){}}h&&h.remove();try{g.addRange(s)}catch(rt){}}t.markers.remove()}function f(i,r,u){var o,f=i.previousSibling,e=i.nextSibling;return f&&e&&f.nodeType==Node.TEXT_NODE&&e.nodeType==Node.TEXT_NODE?(o=f.textContent.length,u?(e.textContent=f.textContent+e.textContent,n(f).remove(),n(i).remove(),t.spaces.normalize(e),function(){r.setStart(e,o)}):(f.textContent=f.textContent+e.textContent,n(e).remove(),n(i).remove(),t.spaces.normalize(f),function(){r.setEnd(f,o)})):f&&!e&&f.nodeType==Node.TEXT_NODE?(o=f.textContent.length,u?(t.spaces.normalize(f),function(){r.setStart(f,o)}):(t.spaces.normalize(f),function(){r.setEnd(f,o)})):!(!e||f||e.nodeType!=Node.TEXT_NODE)&&(u?(t.spaces.normalize(e),function(){r.setStart(e,0)}):(t.spaces.normalize(e),function(){r.setEnd(e,0)}))}function g(){return!0}function o(){for(var t=u(),n=0;n<t.length;n++)if(!t[n].collapsed)return!1;return!0}function y(n){var r,i,u=!1,f=!1,e;return t.win.getSelection?(e=t.win.getSelection(),e.rangeCount&&(r=e.getRangeAt(0),i=r.cloneRange(),i.selectNodeContents(n),i.setEnd(r.startContainer,r.startOffset),u=""===i.toString(),i.selectNodeContents(n),i.setStart(r.endContainer,r.endOffset),f=""===i.toString())):t.doc.selection&&"Control"!=t.doc.selection.type&&(r=t.doc.selection.createRange(),i=r.duplicate(),i.moveToElementText(n),i.setEndPoint("EndToStart",r),u=""===i.text,i.moveToElementText(n),i.setEndPoint("StartToEnd",r),f=""===i.text),{atStart:u,atEnd:f}}function nt(){if(o())return!1;t.$el.find("td, th, img, br:not(:last)").prepend('<span class="fr-mk">'+n.FE.INVISIBLE_SPACE+"<\/span>");var i=!1,r=y(t.el);return r.atStart&&r.atEnd&&(i=!0),t.$el.find(".fr-mk").remove(),i}function p(i,r){var f,e,u;for(void 0===r&&(r=!0),f=n(i).html(),f&&f.replace(/\u200b/g,"").length!=f.length&&n(i).html(f.replace(/\u200b/g,"")),e=t.node.contents(i),u=0;u<e.length;u++)e[u].nodeType!=Node.ELEMENT_NODE?n(e[u]).remove():(p(e[u],0===u),0===u&&(r=!1));i.nodeType==Node.TEXT_NODE?n(i).replaceWith('<span data-first="true" data-text="true"><\/span>'):r&&n(i).attr("data-first",!0)}function tt(){return 0===n(this).find("fr-inner").length}function s(i,r){var e=t.node.contents(i.get(0)),f,u;for(["TD","TH"].indexOf(i.get(0).tagName)>=0&&1==i.find(".fr-marker").length&&t.node.hasClass(e[0],"fr-marker")&&i.attr("data-del-cell",!0),f=0;f<e.length;f++)u=e[f],t.node.hasClass(u,"fr-marker")?r=(r+1)%2:r?n(u).find(".fr-marker").length>0?r=s(n(u),r):["TD","TH"].indexOf(u.tagName)<0&&!t.node.hasClass(u,"fr-inner")?!t.opts.keepFormatOnDelete||t.$el.find("[data-first]").length>0?n(u).remove():p(u):t.node.hasClass(u,"fr-inner")?0===n(u).find(".fr-inner").length?n(u).html("<br>"):n(u).find(".fr-inner").filter(tt).html("<br>"):(n(u).empty(),n(u).attr("data-del-cell",!0)):n(u).find(".fr-marker").length>0&&(r=s(n(u),r));return r}function w(){try{if(!t.$wp)return!1;for(var i=u(0),n=i.commonAncestorContainer;n&&!t.node.isElement(n);)n=n.parentNode;return!!t.node.isElement(n)}catch(r){return!1}}function it(){var f,c,k,r,l,it,d,b,w;if(o())return!0;a();var rt=function(t){for(var r,i=t.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&0===i.textContent.length;)r=i,i=i.previousSibling,n(r).remove();return i},ut=function(t){for(var r,i=t.nextSibling;i&&i.nodeType==Node.TEXT_NODE&&0===i.textContent.length;)r=i,i=i.nextSibling,n(r).remove();return i},p=t.$el.find('.fr-marker[data-type="true"]');for(f=0;f<p.length;f++)for(c=p[f];!(rt(c)||t.node.isBlock(c.parentNode)||t.$el.is(c.parentNode)||t.node.hasClass(c.parentNode,"fr-inner"));)n(c.parentNode).before(c);for(k=t.$el.find('.fr-marker[data-type="false"]'),f=0;f<k.length;f++){for(r=k[f];!(ut(r)||t.node.isBlock(r.parentNode)||t.$el.is(r.parentNode)||t.node.hasClass(r.parentNode,"fr-inner"));)n(r.parentNode).after(r);r.parentNode&&t.node.isBlock(r.parentNode)&&t.node.isEmpty(r.parentNode)&&!t.$el.is(r.parentNode)&&!t.node.hasClass(r.parentNode,"fr-inner")&&t.opts.keepFormatOnDelete&&n(r.parentNode).after(r)}if(g())if(s(t.$el,0),l=t.$el.find('[data-first="true"]'),l.length)t.$el.find(".fr-marker").remove(),l.append(n.FE.INVISIBLE_SPACE+n.FE.MARKERS).removeAttr("data-first"),l.attr("data-text")&&l.replaceWith(l.html());else for(t.$el.find("table").filter(function(){return n(this).find("[data-del-cell]").length>0&&n(this).find("[data-del-cell]").length==n(this).find("td, th").length}).remove(),t.$el.find("[data-del-cell]").removeAttr("data-del-cell"),p=t.$el.find('.fr-marker[data-type="true"]'),f=0;f<p.length;f++){var h=p[f],i=h.nextSibling,y=t.$el.find('.fr-marker[data-type="false"][data-id="'+n(h).data("id")+'"]').get(0);if(y){if(h&&(!i||i!=y)){var e=t.node.blockParent(h),u=t.node.blockParent(y),nt=!1,tt=!1;if(e&&["UL","OL"].indexOf(e.tagName)>=0&&(e=null,nt=!0),u&&["UL","OL"].indexOf(u.tagName)>=0&&(u=null,tt=!0),n(h).after(y),e!=u)if(null!=e||nt)if(null!=u||tt||0!==n(e).parentsUntil(t.$el,"table").length)e&&u&&0===n(e).parentsUntil(t.$el,"table").length&&0===n(u).parentsUntil(t.$el,"table").length&&(n(e).append(n(u).html()),n(u).remove());else{for(i=e;!i.nextSibling&&i.parentNode!=t.el;)i=i.parentNode;for(i=i.nextSibling;i&&"BR"!=i.tagName;)it=i.nextSibling,n(e).append(i),i=it;i&&"BR"==i.tagName&&n(i).remove()}else d=t.node.deepestParent(h),d?(n(d).after(n(u).html()),n(u).remove()):0===n(u).parentsUntil(t.$el,"table").length&&(n(h).next().after(n(u).html()),n(u).remove())}}else y=n(h).clone().attr("data-type",!1),n(h).after(y)}t.opts.keepFormatOnDelete||t.html.fillEmptyBlocks();t.html.cleanEmptyTags(!0);t.clean.lists();t.spaces.normalize();b=t.$el.find(".fr-marker:last").get(0);w=t.$el.find(".fr-marker:first").get(0);void 0!==b&&void 0!==w&&!b.nextSibling&&w.previousSibling&&"BR"==w.previousSibling.tagName&&t.node.isElement(b.parentNode)&&t.node.isElement(w.parentNode)&&t.$el.append("<br>");v()}function h(i,r){if(!i||i.getElementsByClassName("fr-marker").length>0)return!1;for(var u=i.firstChild;u&&(t.node.isBlock(u)||r&&!t.node.isVoid(u)&&u.nodeType==Node.ELEMENT_NODE);)i=u,u=u.firstChild;i.innerHTML=n.FE.MARKERS+i.innerHTML}function c(i,r){var u,f,e;if(!i||i.getElementsByClassName("fr-marker").length>0)return!1;for(u=i.lastChild;u&&(t.node.isBlock(u)||r&&!t.node.isVoid(u)&&u.nodeType==Node.ELEMENT_NODE);)i=u,u=u.lastChild;f=t.doc.createElement("SPAN");f.setAttribute("id","fr-sel-markers");f.innerHTML=n.FE.MARKERS;i.appendChild(f);e=i.querySelector("#fr-sel-markers");e.outerHTML=e.innerHTML}function rt(i,r){void 0===r&&(r=!0);for(var u=i.previousSibling;u&&u.nodeType==Node.TEXT_NODE&&0===u.textContent.length;)u=u.previousSibling;return u?(t.node.isBlock(u)?c(u):"BR"==u.tagName?n(u).before(n.FE.MARKERS):n(u).after(n.FE.MARKERS),!0):!!r&&(t.node.isBlock(i)?h(i):n(i).before(n.FE.MARKERS),!0)}function ut(i,r){void 0===r&&(r=!0);for(var u=i.nextSibling;u&&u.nodeType==Node.TEXT_NODE&&0===u.textContent.length;)u=u.nextSibling;return u?(t.node.isBlock(u)?h(u):n(u).before(n.FE.MARKERS),!0):!!r&&(t.node.isBlock(i)?c(i):n(i).after(n.FE.MARKERS),!0)}return{text:i,get:r,ranges:u,clear:l,element:b,endElement:k,save:a,restore:v,isCollapsed:o,isFull:nt,inEditor:w,remove:it,blocks:d,info:y,setAtEnd:c,setAtStart:h,setBefore:rt,setAfter:ut,rangeElement:e}};n.extend(n.FE.DEFAULTS,{htmlAllowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","style","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"],htmlRemoveTags:["script","style"],htmlAllowedAttrs:["accept","accept-charset","accesskey","action","align","allowfullscreen","allowtransparency","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","frameborder","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","mozallowfullscreen","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","webkitallowfullscreen","width","wrap"],htmlAllowedStyleProps:[".*"],htmlAllowComments:!0,htmlUntouched:!1,fullPage:!1});n.FE.HTML5Map={B:"STRONG",I:"EM",STRIKE:"S"};n.FE.MODULES.clean=function(t){function o(n){if(n.nodeType==Node.ELEMENT_NODE&&n.getAttribute("class")&&n.getAttribute("class").indexOf("fr-marker")>=0)return!1;for(var r=t.node.contents(n),u=[],i=0;i<r.length;i++)r[i].nodeType!=Node.ELEMENT_NODE||t.node.isVoid(r[i])?r[i].nodeType==Node.TEXT_NODE&&(r[i].textContent=r[i].textContent.replace(/\u200b/g,"")):r[i].textContent.replace(/\u200b/g,"").length!=r[i].textContent.length&&o(r[i]);if(n.nodeType==Node.ELEMENT_NODE&&!t.node.isVoid(n)&&(n.normalize(),r=t.node.contents(n),u=n.querySelectorAll(".fr-marker"),r.length-u.length==0)){for(i=0;i<r.length;i++)if((r[i].getAttribute("class")||"").indexOf("fr-marker")<0)return!1;for(i=0;i<u.length;i++)n.parentNode.insertBefore(u[i].cloneNode(!0),n);return n.parentNode.removeChild(n),!1}}function s(n,i){var f,o,r,e,u;if(n.nodeType==Node.COMMENT_NODE)return"<!-"+n.nodeValue+"->";if(n.nodeType==Node.TEXT_NODE)return i?n.textContent.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n.textContent.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00A0/g,"&nbsp;").replace(/\u0009/g,"");if(n.nodeType!=Node.ELEMENT_NODE||n.nodeType==Node.ELEMENT_NODE&&["STYLE","SCRIPT","NOSCRIPT"].indexOf(n.tagName)>=0)return n.outerHTML;if(n.nodeType==Node.ELEMENT_NODE&&"svg"==n.tagName)return f=document.createElement("div"),o=n.cloneNode(!0),f.appendChild(o),f.innerHTML;if("IFRAME"==n.tagName)return n.outerHTML.replace(/\&lt;/g,"<").replace(/\&gt;/g,">");if(r=n.childNodes,0===r.length)return n.outerHTML;for(e="",u=0;u<r.length;u++)"PRE"==n.tagName&&(i=!0),e+=s(r[u],i);return t.node.openTagString(n)+e+t.node.closeTagString(n)}function p(n){return i=[],n=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,function(n){return i.push(n),"[FROALA.EDITOR.SCRIPT "+(i.length-1)+"]"}),n=n.replace(/<noscript\b[^<]*(?:(?!<\/noscript>)<[^<]*)*<\/noscript>/gi,function(n){return i.push(n),"[FROALA.EDITOR.NOSCRIPT "+(i.length-1)+"]"}),n=n.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,function(n){return i.push(n),"[FROALA.EDITOR.IFRAME "+(i.length-1)+"]"}),n=n.replace(/<img((?:[\w\W]*?)) src="/g,'<img$1 data-fr-src="')}function w(n){return n=n.replace(/\[FROALA\.EDITOR\.SCRIPT ([\d]*)\]/gi,function(n,r){return t.opts.htmlRemoveTags.indexOf("script")>=0?"":i[parseInt(r,10)]}),n=n.replace(/\[FROALA\.EDITOR\.NOSCRIPT ([\d]*)\]/gi,function(n,r){return t.opts.htmlRemoveTags.indexOf("noscript")>=0?"":i[parseInt(r,10)].replace(/\&lt;/g,"<").replace(/\&gt;/g,">")}),n=n.replace(/\[FROALA\.EDITOR\.IFRAME ([\d]*)\]/gi,function(n,r){return t.opts.htmlRemoveTags.indexOf("iframe")>=0?"":i[parseInt(r,10)].replace(/\&lt;/g,"<").replace(/\&gt;/g,">")}),n=n.replace(/<img((?:[\w\W]*?)) data-fr-src="/g,'<img$1 src="')}function h(n){var t=n.replace(/;;/gi,";");return t=t.replace(/^;/gi,""),";"!=t.charAt(t.length)&&(t+=";"),t}function r(n){var i,u,r;for(i in n)n.hasOwnProperty(i)&&(u=i.match(f),r=null,"style"==i&&t.opts.htmlAllowedStyleProps.length&&(r=n[i].match(e)),u&&r?n[i]=h(r.join(";")):u&&("style"!=i||r)||delete n[i]);for(var s="",c=Object.keys(n).sort(),o=0;o<c.length;o++)i=c[o],s+=n[i].indexOf('"')<0?" "+i+'="'+n[i]+'"':" "+i+"='"+n[i]+"'";return s}function b(n,i,u){if(t.opts.fullPage){var f=t.html.extractDoctype(u),e=r(t.html.extractNodeAttrs(u,"html"));return i=null==i?t.html.extractNode(u,"head")||"<title><\/title>":i,f+"<html"+e+"><head"+r(t.html.extractNodeAttrs(u,"head"))+">"+i+"<\/head><body"+r(t.html.extractNodeAttrs(u,"body"))+">"+n+"<\/body><\/html>"}return n}function c(i,r){var u,e=n("<div>"+i+"<\/div>"),o="",f;if(e){for(f=t.node.contents(e.get(0)),u=0;u<f.length;u++)r(f[u]);for(f=t.node.contents(e.get(0)),u=0;u<f.length;u++)o+=s(f[u])}return o}function l(n,i,r){n=p(n);var f=n,u=null;return t.opts.fullPage&&(f=t.html.extractNode(n,"body")||(n.indexOf("<body")>=0?"":n),r&&(u=t.html.extractNode(n,"head")||"")),f=c(f,i),u&&(u=c(u,i)),w(b(f,u,n))}function k(n){return n.replace(/\u200b/g,"").length==n.length?n:t.clean.exec(n,o)}function d(){var r=t.el.querySelectorAll(Object.keys(n.FE.HTML5Map).join(",")),u,i;if(r.length){for(u=!1,t.el.querySelector(".fr-marker")||(t.selection.save(),u=!0),i=0;i<r.length;i++)""===t.node.attributes(r[i])&&n(r[i]).replaceWith("<"+n.FE.HTML5Map[r[i].tagName]+">"+r[i].innerHTML+"<\/"+n.FE.HTML5Map[r[i].tagName]+">");u&&t.selection.restore()}}function u(n){var i=t.doc.createElement("DIV");return i.innerText=n,i.textContent}function g(i){var l,a,o,s;if("SPAN"==i.tagName&&(i.getAttribute("class")||"").indexOf("fr-marker")>=0)return!1;if("PRE"==i.tagName&&nt(i),i.nodeType==Node.ELEMENT_NODE&&(i.getAttribute("data-fr-src")&&0!==i.getAttribute("data-fr-src").indexOf("blob:")&&i.setAttribute("data-fr-src",t.helpers.sanitizeURL(u(i.getAttribute("data-fr-src")))),i.getAttribute("href")&&i.setAttribute("href",t.helpers.sanitizeURL(u(i.getAttribute("href")))),i.getAttribute("src")&&i.setAttribute("src",t.helpers.sanitizeURL(u(i.getAttribute("src")))),["TABLE","TBODY","TFOOT","TR"].indexOf(i.tagName)>=0&&(i.innerHTML=i.innerHTML.trim())),!t.opts.pasteAllowLocalImages&&i.nodeType==Node.ELEMENT_NODE&&"IMG"==i.tagName&&i.getAttribute("data-fr-src")&&0===i.getAttribute("data-fr-src").indexOf("file://"))return i.parentNode.removeChild(i),!1;if(i.nodeType==Node.ELEMENT_NODE&&n.FE.HTML5Map[i.tagName]&&""===t.node.attributes(i)&&(l=n.FE.HTML5Map[i.tagName],a="<"+l+">"+i.innerHTML+"<\/"+l+">",i.insertAdjacentHTML("beforebegin",a),i=i.previousSibling,i.parentNode.removeChild(i.nextSibling)),t.opts.htmlAllowComments||i.nodeType!=Node.COMMENT_NODE){if(i.tagName&&i.tagName.match(y))i.parentNode.removeChild(i);else if(i.tagName&&!i.tagName.match(v))"svg"===i.tagName?i.parentNode.removeChild(i):t.browser.safari&&"path"==i.tagName&&i.parentNode&&"svg"==i.parentNode.tagName||(i.outerHTML=i.innerHTML);else if(o=i.attributes,o)for(s=o.length-1;s>=0;s--){var r=o[s],p=r.nodeName.match(f),c=null;"style"==r.nodeName&&t.opts.htmlAllowedStyleProps.length&&(c=r.value.match(e));p&&c?r.value=h(c.join(";")):p&&("style"!=r.nodeName||c)||i.removeAttribute(r.nodeName)}}else 0!==i.data.indexOf("[FROALA.EDITOR")&&i.parentNode.removeChild(i)}function a(n){for(var r=t.node.contents(n),i=0;i<r.length;i++)r[i].nodeType!=Node.TEXT_NODE&&a(r[i]);g(n)}function nt(n){var t=n.innerHTML;t.indexOf("\n")>=0&&(n.innerHTML=t.replace(/\n/g,"<br>"))}function tt(i,r,u,o){var s,c,h;for(void 0===r&&(r=[]),void 0===u&&(u=[]),void 0===o&&(o=!1),i=i.replace(/<br> */g,"<br>"),c=n.merge([],t.opts.htmlAllowedTags),s=0;s<r.length;s++)c.indexOf(r[s])>=0&&c.splice(c.indexOf(r[s]),1);for(h=n.merge([],t.opts.htmlAllowedAttrs),s=0;s<u.length;s++)h.indexOf(u[s])>=0&&h.splice(h.indexOf(u[s]),1);return h.push("data-fr-.*"),h.push("fr-.*"),v=new RegExp("^"+c.join("$|^")+"$","gi"),f=new RegExp("^"+h.join("$|^")+"$","gi"),y=new RegExp("^"+t.opts.htmlRemoveTags.join("$|^")+"$","gi"),e=t.opts.htmlAllowedStyleProps.length?new RegExp("((^|;|\\s)"+t.opts.htmlAllowedStyleProps.join(":.+?(?=;|$))|((^|;|\\s)")+":.+?(?=(;)|$))","gi"):null,i=l(i,a,!0)}function it(){for(var i,u=t.el.querySelectorAll("blockquote + blockquote"),r=0;r<u.length;r++)i=u[r],t.node.attributes(i)==t.node.attributes(i.previousSibling)&&(n(i).prev().append(n(i).html()),n(i).remove())}function rt(){for(var n,u,r=t.el.querySelectorAll("tr"),i=0;i<r.length;i++){for(var f=r[i].children,o=!0,e=0;e<f.length;e++)if("TH"!=f[e].tagName){o=!1;break}if(!1!==o&&0!==f.length){for(n=r[i];n&&"TABLE"!=n.tagName&&"THEAD"!=n.tagName;)n=n.parentNode;u=n;"THEAD"!=u.tagName&&(u=t.doc.createElement("THEAD"),n.insertBefore(u,n.firstChild));u.appendChild(r[i])}}}function ut(){var u=t.html.defaultTag(),r,i;if(u)for(r=t.el.querySelectorAll("td > "+u+", th > "+u),i=0;i<r.length;i++)""===t.node.attributes(r[i])&&n(r[i]).replaceWith(r[i].innerHTML+"<br>")}function ft(){rt();ut()}function et(){var i=[],o=function(n){return!t.node.isList(n.parentNode)},n,f,e,u,r;do{if(i.length){n=i[0];f=t.doc.createElement("ul");n.parentNode.insertBefore(f,n);do e=n,n=n.nextSibling,f.appendChild(e);while(n&&"LI"==n.tagName)}for(i=[],u=t.el.querySelectorAll("li"),r=0;r<u.length;r++)o(u[r])&&i.push(u[r])}while(i.length>0)}function ot(){for(var n,f,r,u=t.el.querySelectorAll("ol + ol, ul + ul"),i=0;i<u.length;i++)if(n=u[i],t.node.isList(n.previousSibling)&&t.node.openTagString(n)==t.node.openTagString(n.previousSibling)){for(f=t.node.contents(n),r=0;r<f.length;r++)n.previousSibling.appendChild(f[r]);n.parentNode.removeChild(n)}}function st(){var n,r,f=function(n){n.querySelector("LI")||(r=!0,n.parentNode.removeChild(n))},i,u;do{for(r=!1,i=t.el.querySelectorAll("li:empty"),n=0;n<i.length;n++)i[n].parentNode.removeChild(i[n]);for(u=t.el.querySelectorAll("ul, ol"),n=0;n<u.length;n++)f(u[n])}while(!0===r)}function ht(){for(var r,u,f=t.el.querySelectorAll("ul > ul, ol > ol, ul > ol, ol > ul"),i=0;i<f.length;i++)r=f[i],u=r.previousSibling,u&&("LI"==u.tagName?u.appendChild(r):n(r).wrap("<li><\/li>"))}function ct(){for(var u,i,e,o,f=t.el.querySelectorAll("li > ul, li > ol"),r=0;r<f.length;r++)if(u=f[r],u.nextSibling){i=u.nextSibling;e=n("<li>");n(u.parentNode).after(e);do o=i,i=i.nextSibling,e.append(o);while(i)}}function lt(){for(var i,r,f=t.el.querySelectorAll("li > ul, li > ol"),u=0;u<f.length;u++)if(i=f[u],t.node.isFirstSibling(i))n(i).before("<br/>");else if(i.previousSibling&&"BR"==i.previousSibling.tagName){for(r=i.previousSibling.previousSibling;r&&t.node.hasClass(r,"fr-marker");)r=r.previousSibling;r&&"BR"!=r.tagName&&n(i.previousSibling).remove()}}function at(){for(var r=t.el.querySelectorAll("li:empty"),i=0;i<r.length;i++)n(r[i]).remove()}function vt(){for(var e=t.el.querySelectorAll("ul, ol"),u=0;u<e.length;u++)for(var f=t.node.contents(e[u]),i=null,r=f.length-1;r>=0;r--)"LI"!=f[r].tagName?(i||(i=n("<li>"),i.insertBefore(f[r])),i.prepend(f[r])):i=null}function yt(){et();ot();vt();st();ht();ct();lt();at()}function pt(){t.opts.fullPage&&n.merge(t.opts.htmlAllowedTags,["head","title","style","link","base","body","html","meta"])}var v,y,f,e,i=[];return{_init:pt,html:tt,toHTML5:d,tables:ft,lists:yt,quotes:it,invisibleSpaces:k,exec:l}};n.FE.MODULES.spaces=function(t){function i(i,r){var o=i.previousSibling,u=i.nextSibling,e=i.textContent,h=i.parentNode,f,s;if(!t.html.isPreformatted(h)){for(r&&(e=e.replace(/[\f\n\r\t\v ]{2,}/g," "),u&&"BR"!==u.tagName&&!t.node.isBlock(u)||!t.node.isBlock(h)&&!t.node.isLink(h)||(e=e.replace(/[\f\n\r\t\v ]{1,}$/g,"")),o&&"BR"!==o.tagName&&!t.node.isBlock(o)||!t.node.isBlock(h)&&!t.node.isLink(h)||(e=e.replace(/^[\f\n\r\t\v ]{1,}/g,""))," "===e&&(o&&o.nodeType!=Node.TEXT_NODE||u&&u.nodeType!=Node.TEXT_NODE)&&(e="")),e=e.replace(new RegExp(n.FE.UNICODE_NBSP,"g")," "),f="",s=0;s<e.length;s++)f+=32!=e.charCodeAt(s)||0!==s&&32!=f.charCodeAt(s-1)?e[s]:n.FE.UNICODE_NBSP;(!u||u&&t.node.isBlock(u)||u&&u.nodeType==Node.ELEMENT_NODE&&t.win.getComputedStyle(u)&&"block"==t.win.getComputedStyle(u).display)&&(f=f.replace(/ $/,n.FE.UNICODE_NBSP));!o||t.node.isVoid(o)||t.node.isBlock(o)||(f=f.replace(/^\u00A0([^ $])/," $1"),1!==f.length||160!==f.charCodeAt(0)||!u||t.node.isVoid(u)||t.node.isBlock(u)||(f=" "));f=f.replace(/([^ \u00A0])\u00A0([^ \u00A0])/g,"$1 $2");i.textContent!=f&&(i.textContent=f)}}function r(n,r){if(void 0!==n&&n||(n=t.el),void 0===r&&(r=!1),!n.getAttribute||"false"!=n.getAttribute("contenteditable"))if(n.nodeType==Node.TEXT_NODE)i(n,r);else if(n.nodeType==Node.ELEMENT_NODE)for(var u=t.doc.createTreeWalker(n,NodeFilter.SHOW_TEXT,t.node.filter(function(n){for(var i=n.parentNode;i&&i!==t.el;){if("STYLE"==i.tagName||"IFRAME"==i.tagName||"PRE"===i.tagName)return!1;i=i.parentNode}return null!=n.textContent.match(/([ \u00A0\f\n\r\t\v]{2,})|(^[ \u00A0\f\n\r\t\v]{1,})|([ \u00A0\f\n\r\t\v]{1,}$)/g)&&!t.node.hasClass(n.parentNode,"fr-marker")}),!1);u.nextNode();)i(u.currentNode,r)}function u(){for(var f,h,i,u,o,n=[],s=t.el.querySelectorAll(".fr-marker"),e=0;e<s.length;e++){for(f=null,h=t.node.blockParent(s[e]),f=h||s[e],i=f.nextSibling,u=f.previousSibling;i&&"BR"==i.tagName;)i=i.nextSibling;for(;u&&"BR"==u.tagName;)u=u.previousSibling;f&&n.indexOf(f)<0&&n.push(f);u&&n.indexOf(u)<0&&n.push(u);i&&n.indexOf(i)<0&&n.push(i)}for(o=0;o<n.length;o++)r(n[o])}return{normalize:r,normalizeAroundCursor:u}};n.FE.UNICODE_NBSP=String.fromCharCode(160);n.FE.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];n.FE.BLOCK_TAGS=["address","article","aside","audio","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video"];n.extend(n.FE.DEFAULTS,{htmlAllowedEmptyTags:["textarea","a","iframe","object","video","style","script",".fa",".fr-emoticon",".fr-inner"],htmlDoNotWrapTags:["script","style"],htmlSimpleAmpersand:!1,htmlIgnoreCSSProperties:[],htmlExecuteScripts:!0});n.FE.MODULES.html=function(t){function i(){return t.opts.enter==n.FE.ENTER_P?"p":t.opts.enter==n.FE.ENTER_DIV?"div":t.opts.enter==n.FE.ENTER_BR?null:void 0}function f(n,i){return!(!n||n===t.el)&&(i?-1!=["PRE","SCRIPT","STYLE"].indexOf(n.tagName)||f(n.parentNode,i):-1!=["PRE","SCRIPT","STYLE"].indexOf(n.tagName))}function v(i){var u,v=[],f=[],l,e,o,s,h;if(i)for(l=t.el.querySelectorAll(".fr-marker"),u=0;u<l.length;u++)e=t.node.blockParent(l[u])||l[u],e&&(o=e.nextSibling,s=e.previousSibling,e&&f.indexOf(e)<0&&t.node.isBlock(e)&&f.push(e),s&&t.node.isBlock(s)&&f.indexOf(s)<0&&f.push(s),o&&t.node.isBlock(o)&&f.indexOf(o)<0&&f.push(o));else f=t.el.querySelectorAll(r());for(h=r(),h+=","+n.FE.VOID_ELEMENTS.join(","),h+=", .fr-inner",h+=","+t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)",u=f.length-1;u>=0;u--)if(!(f[u].textContent&&f[u].textContent.replace(/\u200B|\n/g,"").length>0||f[u].querySelectorAll(h).length>0)){for(var a=t.node.contents(f[u]),y=!1,c=0;c<a.length;c++)if(a[c].nodeType!=Node.COMMENT_NODE&&a[c].textContent&&a[c].textContent.replace(/\u200B|\n/g,"").length>0){y=!0;break}y||v.push(f[u])}return v}function tt(){return n.FE.BLOCK_TAGS.join(":empty, ")+":empty"}function r(){return n.FE.BLOCK_TAGS.join(", ")}function y(i){var f=n.merge([],n.FE.VOID_ELEMENTS),r,e,u;f=n.merge(f,t.opts.htmlAllowedEmptyTags);void 0===i&&(f=n.merge(f,n.FE.BLOCK_TAGS));r=t.el.querySelectorAll("*:empty:not("+f.join("):not(")+"):not(.fr-marker)");do{for(e=!1,u=0;u<r.length;u++)0!==r[u].attributes.length&&void 0===r[u].getAttribute("href")||(r[u].parentNode.removeChild(r[u]),e=!0);r=t.el.querySelectorAll("*:empty:not("+f.join("):not(")+"):not(.fr-marker)")}while(r.length&&e)}function p(n,r){var o=i(),l,c;if(r&&(o="div"),o){for(var e=t.doc.createDocumentFragment(),f=null,s=!1,u=n.firstChild,h=!1;u;)l=u.nextSibling,u.nodeType==Node.ELEMENT_NODE&&(t.node.isBlock(u)||t.opts.htmlDoNotWrapTags.indexOf(u.tagName.toLowerCase())>=0&&!t.node.hasClass(u,"fr-marker"))?(f=null,e.appendChild(u.cloneNode(!0))):u.nodeType!=Node.ELEMENT_NODE&&u.nodeType!=Node.TEXT_NODE?(f=null,e.appendChild(u.cloneNode(!0))):"BR"==u.tagName?(null==f?(f=t.doc.createElement(o),r&&f.setAttribute("class","fr-temp-div"),f.setAttribute("data-empty",!0),f.appendChild(u.cloneNode(!0)),e.appendChild(f),h=!0):!1===s&&(f.appendChild(t.doc.createElement("br")),r&&f.setAttribute("class","fr-temp-div"),f.setAttribute("data-empty",!0)),f=null):(c=u.textContent,u.nodeType==Node.TEXT_NODE&&0===c.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length||(null==f&&(f=t.doc.createElement(o),r&&f.setAttribute("class","fr-temp-div"),e.appendChild(f),s=!1,h=!0),f.appendChild(u.cloneNode(!0)),s||t.node.hasClass(u,"fr-marker")||u.nodeType==Node.TEXT_NODE&&0===c.replace(/ /g,"").length||(s=!0))),u=l;h&&(n.innerHTML="",n.appendChild(e))}}function e(n,t){for(var i=0;i<n.length;i++)p(n[i],t)}function w(n,i,r,u){if(!t.$wp)return!1;void 0===n&&(n=!1);void 0===i&&(i=!1);void 0===r&&(r=!1);void 0===u&&(u=!1);var f=t.$wp.scrollTop();p(t.el,n);u&&e(t.el.querySelectorAll(".fr-inner"),n);i&&e(t.el.querySelectorAll("td, th"),n);r&&e(t.el.querySelectorAll("blockquote"),n);f!=t.$wp.scrollTop()&&t.$wp.scrollTop(f)}function it(){t.$el.find("div.fr-temp-div").each(function(){n(this).attr("data-empty")||["LI"].indexOf(this.parentNode.tagName)>=0||t.node.isBlock(this.nextSibling)&&!n(this.nextSibling).hasClass("fr-temp-div")?n(this).replaceWith(n(this).html()):n(this).replaceWith(n(this).html()+"<br>")});t.$el.find(".fr-temp-div").removeClass("fr-temp-div").filter(function(){return""===n(this).attr("class")}).removeAttr("class")}function rt(i){for(var r,f,e=v(i),u=0;u<e.length;u++)r=e[u],"false"===r.getAttribute("contenteditable")||r.querySelector(t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)")||t.node.isVoid(r)||"TABLE"!=r.tagName&&"TBODY"!=r.tagName&&"TR"!=r.tagName&&"UL"!=r.tagName&&"OL"!=r.tagName&&r.appendChild(t.doc.createElement("br"));t.browser.msie&&t.opts.enter==n.FE.ENTER_BR&&(f=t.node.contents(t.el),f.length&&f[f.length-1].nodeType==Node.TEXT_NODE&&t.$el.append("<br>"))}function ut(){return t.$el.get(0).querySelectorAll(r())}function b(n){var o,i,s,r,u,e;if(void 0===n&&(n=t.el),n&&["SCRIPT","STYLE","PRE"].indexOf(n.tagName)>=0)return!1;for(o=t.doc.createTreeWalker(n,NodeFilter.SHOW_TEXT,t.node.filter(function(n){return null!=n.textContent.match(/([ \n]{2,})|(^[ \n]{1,})|([ \n]{1,}$)/g)}),!1);o.nextNode();)i=o.currentNode,f(i.parentNode,!0)||(s=t.node.isBlock(i.parentNode)||t.node.isElement(i.parentNode),r=i.textContent.replace(/(?!^)( ){2,}(?!$)/g," ").replace(/\n/g," ").replace(/^[ ]{2,}/g," ").replace(/[ ]{2,}$/g," "),s&&(u=i.previousSibling,e=i.nextSibling,u&&e&&" "==r?r=t.node.isBlock(u)&&t.node.isBlock(e)?"":"\n":(u||(r=r.replace(/^ */,"")),e||(r=r.replace(/ *$/,"")))),i.textContent=r)}function o(n,t,i){var u=new RegExp(t,"gi"),r=u.exec(n);return r?r[i]:null}function ft(n,t){var i=n.match(/<!DOCTYPE ?([^ ]*) ?([^ ]*) ?"?([^"]*)"? ?"?([^"]*)"?>/i);return i?t.implementation.createDocumentType(i[1],i[3],i[4]):t.implementation.createDocumentType("html")}function s(n){var t=n.doctype,i="<!DOCTYPE html>";return t&&(i="<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"),i}function h(i,r){var f=i.parentNode,u,e;if(f&&(t.node.isBlock(f)||t.node.isElement(f))&&["TD","TH"].indexOf(f.tagName)<0){for(u=i.previousSibling,e=i.nextSibling;u&&u.nodeType==Node.TEXT_NODE&&0===u.textContent.replace(/\n|\r/g,"").length;)u=u.previousSibling;u&&f&&"BR"!=u.tagName&&!t.node.isBlock(u)&&!e&&f.textContent.replace(/\u200B/g,"").length>0&&u.textContent.length>0&&!t.node.hasClass(u,"fr-marker")&&(t.el==f&&!e&&t.opts.enter==n.FE.ENTER_BR&&t.browser.msie||(r&&t.selection.save(),i.parentNode.removeChild(i),r&&t.selection.restore()))}else!f||t.node.isBlock(f)||t.node.isElement(f)||i.previousSibling||i.nextSibling||h(i.parentNode,r)}function et(){var r,n,h=t.selection.element(),i,f,e,u,c,o,s;for(r=t.node.isBlock(h)?h:t.node.blockParent(h),i=[],r&&(f=r.nextSibling,e=r.previousSibling,r&&i.indexOf(r)<0&&i.push(r),e&&t.node.isBlock(e)&&i.indexOf(e)<0&&i.push(e),f&&t.node.isBlock(f)&&i.indexOf(f)<0&&i.push(f)),u=[],n=0;n<i.length;n++)for(c=i[n].querySelectorAll("br"),o=0;o<c.length;o++)u.indexOf(c[o])<0&&u.push(c[o]);if(h.parentNode==t.el)for(s=t.el.children,n=0;n<s.length;n++)"BR"==s[n].tagName&&u.indexOf(s[n])<0&&u.push(s[n]);return u}function ot(n,i){var r,u=null;if(n)for(u=et(),r=0;r<u.length;r++)h(u[r],i);else for(u=t.el.getElementsByTagName("br"),r=0;r<u.length;r++)h(u[r],i)}function k(){t.opts.htmlUntouched||(y(),w());b();t.opts.htmlUntouched||(t.spaces.normalize(null,!0),t.html.fillEmptyBlocks(),t.clean.quotes(),t.clean.lists(),t.clean.tables(),t.clean.toHTML5(),t.html.cleanBRs());t.selection.restore();c();t.placeholder.refresh()}function c(){t.core.isEmpty()&&(null!=i()?t.el.querySelector(r())||t.el.querySelector(t.opts.htmlDoNotWrapTags.join(":not(.fr-marker),")+":not(.fr-marker)")||(t.core.hasFocus()?(t.$el.html("<"+i()+">"+n.FE.MARKERS+"<br/><\/"+i()+">"),t.selection.restore()):t.$el.html("<"+i()+"><br/><\/"+i()+">")):t.el.querySelector("*:not(.fr-marker):not(br)")||(t.core.hasFocus()?(t.$el.html(n.FE.MARKERS+"<br/>"),t.selection.restore()):t.$el.html("<br/>")))}function l(n,t){return o(n,"<"+t+"[^>]*?>([\\w\\W]*)<\/"+t+">",1)}function u(i,r){var u=n("<div "+(o(i,"<"+r+"([^>]*?)>",1)||"")+">");return t.node.rawAttributes(u.get(0))}function d(n){return o(n,"<!DOCTYPE([^>]*?)>",0)||"<!DOCTYPE html>"}function a(n,i){t.opts.htmlExecuteScripts?n.html(i):n.get(0).innerHTML=i}function st(i){var r=t.clean.html(i||"",[],[],t.opts.fullPage),e,o,s;if(t.opts.fullPage){var h=l(r,"body")||(r.indexOf("<body")>=0?"":r),c=u(r,"body"),f=l(r,"head")||"<title><\/title>",v=u(r,"head"),y=n("<div>").append(f).contents().each(function(){(this.nodeType==Node.COMMENT_NODE||["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"].indexOf(this.tagName)>=0)&&this.parentNode.removeChild(this)}).end().html().trim();f=n("<div>").append(f).contents().map(function(){return this.nodeType==Node.COMMENT_NODE?"<!-"+this.nodeValue+"->":["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"].indexOf(this.tagName)>=0?this.outerHTML:""}).toArray().join("");e=d(r);o=u(r,"html");a(t.$el,y+"\n"+h);t.node.clearAttributes(t.el);t.$el.attr(c);t.$el.addClass("fr-view");t.$el.attr("spellcheck",t.opts.spellcheck);t.$el.attr("dir",t.opts.direction);a(t.$head,f);t.node.clearAttributes(t.$head.get(0));t.$head.attr(v);t.node.clearAttributes(t.$html.get(0));t.$html.attr(o);t.iframe_document.doctype.parentNode.replaceChild(ft(e,t.iframe_document),t.iframe_document.doctype)}else a(t.$el,r);s=t.edit.isDisabled();t.edit.on();t.core.injectStyle(t.opts.iframeStyle);k();t.opts.useClasses||(t.$el.find("[fr-original-class]").each(function(){this.setAttribute("class",this.getAttribute("fr-original-class"));this.removeAttribute("fr-original-class")}),t.$el.find("[fr-original-style]").each(function(){this.setAttribute("style",this.getAttribute("fr-original-style"));this.removeAttribute("fr-original-style")}));s&&t.edit.off();t.events.trigger("html.set")}function ht(n){var t;return!function(){var t=/:not\(([^\)]*)\)/g;t.test(n)&&(n=n.replace(t,"     $1 "))}(),t=100*(n.match(/(#[^\s\+>~\.\[:]+)/g)||[]).length+10*(n.match(/(\[[^\]]+\])/g)||[]).length+10*(n.match(/(\.[^\s\+>~\.\[:]+)/g)||[]).length+10*(n.match(/(:[\w-]+\([^\)]*\))/gi)||[]).length+10*(n.match(/(:[^\s\+>~\.\[:]+)/g)||[]).length+(n.match(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi)||[]).length,n=n.replace(/[\*\s\+>~]/g," "),n=n.replace(/[#\.]/g," "),t+(n.match(/([^\s\+>~\.\[:]+)/g)||[]).length}function ct(n){var u,r,i;if(t.events.trigger("html.processGet",[n]),n&&n.getAttribute&&""===n.getAttribute("class")&&n.removeAttribute("class"),n&&n.getAttribute&&""===n.getAttribute("style")&&n.removeAttribute("style"),n&&n.nodeType==Node.ELEMENT_NODE)for(u=n.querySelectorAll('[class=""],[style=""]'),r=0;r<u.length;r++)i=u[r],""===i.getAttribute("class")&&i.removeAttribute("class"),""===i.getAttribute("style")&&i.removeAttribute("style")}function lt(n,t){return n[3]-t[3]}function at(n,i){var r,nt,c,k,l,tt,o,it,h,b,y,g;if(!t.$wp)return t.$oel.clone().removeClass("fr-view").removeAttr("contenteditable").get(0).outerHTML;r="";t.events.trigger("html.beforeGet");var u,f,e=[],a={},p=[];if(!t.opts.useClasses&&!i){for(nt=new RegExp("^"+t.opts.htmlIgnoreCSSProperties.join("$|^")+"$","gi"),u=0;u<t.doc.styleSheets.length;u++){k=0;try{c=t.doc.styleSheets[u].cssRules;t.doc.styleSheets[u].ownerNode&&"STYLE"==t.doc.styleSheets[u].ownerNode.nodeType&&(k=1)}catch(rt){}if(c)for(l=0,tt=c.length;l<tt;l++)if(c[l].selectorText&&c[l].style.cssText.length>0){it=c[l].selectorText.replace(/body |\.fr-view /g,"").replace(/::/g,":");try{o=t.el.querySelectorAll(it)}catch(rt){o=[]}for(f=0;f<o.length;f++){!o[f].getAttribute("fr-original-style")&&o[f].getAttribute("style")?(o[f].setAttribute("fr-original-style",o[f].getAttribute("style")),e.push(o[f])):o[f].getAttribute("fr-original-style")||e.push(o[f]);a[o[f]]||(a[o[f]]={});for(var d=1e3*k+ht(c[l].selectorText),w=c[l].style.cssText.split(";"),v=0;v<w.length;v++)h=w[v].trim().split(":")[0],h.match(nt)||(a[o[f]][h]||(a[o[f]][h]=0,(o[f].getAttribute("fr-original-style")||"").indexOf(h+":")>=0&&(a[o[f]][h]=1e4)),d>=a[o[f]][h]&&(a[o[f]][h]=d,w[v].trim().length&&p.push([o[f],h.trim(),w[v].trim().split(":")[1].trim(),d])))}}}for(p.sort(lt),u=0;u<p.length;u++)b=p[u],b[0].style[b[1]]=b[2];for(u=0;u<e.length;u++)if(e[u].getAttribute("class")&&(e[u].setAttribute("fr-original-class",e[u].getAttribute("class")),e[u].removeAttribute("class")),(e[u].getAttribute("fr-original-style")||"").trim().length>0)for(y=e[u].getAttribute("fr-original-style").split(";"),f=0;f<y.length;f++)y[f].indexOf(":")>0&&(e[u].style[y[f].split(":")[0].trim()]=y[f].split(":")[1].trim())}if(t.core.isEmpty()?t.opts.fullPage&&(r=s(t.iframe_document),r+="<html"+t.node.attributes(t.$html.get(0))+">"+t.$html.find("head").get(0).outerHTML+"<body><\/body><\/html>"):(void 0===n&&(n=!1),t.opts.fullPage?(r=s(t.iframe_document),t.$el.removeClass("fr-view"),r+="<html"+t.node.attributes(t.$html.get(0))+">"+t.$html.html()+"<\/html>",t.$el.addClass("fr-view")):r=t.$el.html()),!t.opts.useClasses&&!i)for(u=0;u<e.length;u++)e[u].getAttribute("fr-original-class")&&(e[u].setAttribute("class",e[u].getAttribute("fr-original-class")),e[u].removeAttribute("fr-original-class")),e[u].getAttribute("fr-original-style")?(e[u].setAttribute("style",e[u].getAttribute("fr-original-style")),e[u].removeAttribute("fr-original-style")):e[u].removeAttribute("style");return t.opts.fullPage&&(r=r.replace(/<style data-fr-style="true">(?:[\w\W]*?)<\/style>/g,""),r=r.replace(/<link([^>]*)data-fr-style="true"([^>]*)>/g,""),r=r.replace(/<style(?:[\w\W]*?)class="firebugResetStyles"(?:[\w\W]*?)>(?:[\w\W]*?)<\/style>/g,""),r=r.replace(/<body((?:[\w\W]*?)) spellcheck="true"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$2>$3<\/body>"),r=r.replace(/<body((?:[\w\W]*?)) contenteditable="(true|false)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$3>$4<\/body>"),r=r.replace(/<body((?:[\w\W]*?)) dir="([\w]*)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$3>$4<\/body>"),r=r.replace(/<body((?:[\w\W]*?))class="([\w\W]*?)(fr-rtl|fr-ltr)([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,'<body$1class="$2$4"$5>$6<\/body>'),r=r.replace(/<body((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$2>$3<\/body>")),t.opts.htmlSimpleAmpersand&&(r=r.replace(/\&amp;/gi,"&")),t.events.trigger("html.afterGet"),n||(r=r.replace(/<span[^>]*? class\s*=\s*["']?fr-marker["']?[^>]+>\u200b<\/span>/gi,"")),r=t.clean.invisibleSpaces(r),r=t.clean.exec(r,ct),g=t.events.chainTrigger("html.get",r),"string"==typeof g&&(r=g),r=r.replace(/<pre(?:[\w\W]*?)>(?:[\w\W]*?)<\/pre>/g,function(n){return n.replace(/<br>/g,"\n")})}function vt(){var s=function(i,r){for(;r&&(r.nodeType==Node.TEXT_NODE||!t.node.isBlock(r))&&!t.node.isElement(r);)r&&r.nodeType!=Node.TEXT_NODE&&n(i).wrapInner(t.node.openTagString(r)+t.node.closeTagString(r)),r=r.parentNode;r&&i.innerHTML==r.innerHTML&&(i.innerHTML=r.outerHTML)},h=function(){var r,i=null;return t.win.getSelection?(r=t.win.getSelection())&&r.rangeCount&&(i=r.getRangeAt(0).commonAncestorContainer,i.nodeType!=Node.ELEMENT_NODE&&(i=i.parentNode)):(r=t.doc.selection)&&"Control"!=r.type&&(i=r.createRange().parentElement()),null!=i&&(n.inArray(t.el,n(i).parents())>=0||i==t.el)?i:null},e="",o,u,i,f,r;if(void 0!==t.win.getSelection)for(t.browser.mozilla&&(t.selection.save(),t.$el.find('.fr-marker[data-type="false"]').length>1&&(t.$el.find('.fr-marker[data-type="false"][data-id="0"]').remove(),t.$el.find('.fr-marker[data-type="false"]:last').attr("data-id","0"),t.$el.find(".fr-marker").not('[data-id="0"]').remove()),t.selection.restore()),o=t.selection.ranges(),u=0;u<o.length;u++)i=document.createElement("div"),i.appendChild(o[u].cloneContents()),f=i.children,f.length&&(r=f[f.length-1],("P"==r.tagName&&t.opts.enter==n.FroalaEditor.ENTER_P||"DIV"==r.tagName&&t.opts.enter==n.FroalaEditor.ENTER_DIV)&&t.node.isEmpty(r)&&i.removeChild(r)),s(i,h()),n(i).find(".fr-element").length>0&&(i=t.el),e+=i.innerHTML;else void 0!==t.doc.selection&&"Text"==t.doc.selection.type&&(e=t.doc.selection.createRange().htmlText);return e}function g(n){var i=t.doc.createElement("div");return i.innerHTML=n,null!==i.querySelector(r())}function yt(n){var i=t.doc.createElement("div");return i.innerHTML=n,t.selection.setAtEnd(i),i.innerHTML}function pt(n){return n.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&#39;")}function wt(i){var u,e,f,r;if(!t.html.defaultTag())return i;for(u=t.doc.createElement("div"),u.innerHTML=i,e=u.querySelectorAll(":scope > "+t.html.defaultTag()),f=e.length-1;f>=0;f--)r=e[f],t.node.isBlock(r.previousSibling)||(r.previousSibling&&!t.node.isEmpty(r)&&n("<br>").insertAfter(r.previousSibling),r.outerHTML=r.innerHTML);return u.innerHTML}function bt(i,r,u){var f,e,o;if(t.selection.isCollapsed()||t.selection.remove(),f=r?i:t.clean.html(i),f=f.replace(/\r|\n/g," "),i.indexOf('class="fr-marker"')<0&&(f=yt(f)),t.core.isEmpty()&&!t.opts.keepFormatOnDelete&&g(f))t.el.innerHTML=f;else if(e=t.markers.insert(),e)if(t.node.isLastSibling(e)&&n(e).parent().hasClass("fr-deletable")&&n(e).insertAfter(n(e).parent()),o=t.node.blockParent(e),(g(f)||u)&&(t.node.deepestParent(e)||o&&"LI"==o.tagName)){if(o&&"LI"==o.tagName&&(f=wt(f)),!(e=t.markers.split()))return!1;e.outerHTML=f}else e.outerHTML=f;else t.el.innerHTML=t.el.innerHTML+f;k();t.keys.positionCaret();t.events.trigger("html.inserted")}function nt(i){var u=null,h,e,o,f,r,s;if((void 0===i&&(u=t.selection.element()),t.opts.keepFormatOnDelete)||(h=u?(u.textContent.match(/\u200B/g)||[]).length-u.querySelectorAll(".fr-marker").length:0,(t.el.textContent.match(/\u200B/g)||[]).length-t.el.querySelectorAll(".fr-marker").length==h))return!1;do for(o=!1,e=t.el.querySelectorAll("*:not(.fr-marker)"),f=0;f<e.length;f++)r=e[f],u!=r&&(s=r.textContent,0===r.children.length&&1===s.length&&8203==s.charCodeAt(0)&&"TD"!==r.tagName&&(n(r).remove(),o=!0));while(o)}function kt(){if(t.$wp){var n=function(){nt();t.placeholder&&setTimeout(t.placeholder.refresh,0)};t.events.on("mouseup",n);t.events.on("keydown",n);t.events.on("contentChanged",c)}}return{defaultTag:i,isPreformatted:f,emptyBlocks:v,emptyBlockTagsQuery:tt,blockTagsQuery:r,fillEmptyBlocks:rt,cleanEmptyTags:y,cleanWhiteTags:nt,cleanBlankSpaces:b,blocks:ut,getDoctype:s,set:st,get:at,getSelected:vt,insert:bt,wrap:w,unwrap:it,escapeEntities:pt,checkIfEmpty:c,extractNode:l,extractNodeAttrs:u,extractDoctype:d,cleanBRs:ot,_init:kt}};n.extend(n.FE.DEFAULTS,{height:null,heightMax:null,heightMin:null,width:null});n.FE.MODULES.size=function(n){function t(){i();n.opts.height&&n.$el.css("minHeight",n.opts.height-n.helpers.getPX(n.$el.css("padding-top"))-n.helpers.getPX(n.$el.css("padding-bottom")));n.$iframe.height(n.$el.outerHeight(!0))}function i(){n.opts.heightMin?n.$el.css("minHeight",n.opts.heightMin):n.$el.css("minHeight","");n.opts.heightMax?(n.$wp.css("maxHeight",n.opts.heightMax),n.$wp.css("overflow","auto")):(n.$wp.css("maxHeight",""),n.$wp.css("overflow",""));n.opts.height?(n.$wp.height(n.opts.height),n.$wp.css("overflow","auto"),n.$el.css("minHeight",n.opts.height-n.helpers.getPX(n.$el.css("padding-top"))-n.helpers.getPX(n.$el.css("padding-bottom")))):(n.$wp.css("height",""),n.opts.heightMin||n.$el.css("minHeight",""),n.opts.heightMax||n.$wp.css("overflow",""));n.opts.width&&n.$box.width(n.opts.width)}function r(){if(!n.$wp)return!1;i();n.$iframe&&(n.events.on("keyup keydown",function(){setTimeout(t,0)},!0),n.events.on("commands.after html.set init initialized paste.after",t))}return{_init:r,syncIframe:t,refresh:i}};n.extend(n.FE.DEFAULTS,{language:null});n.FE.LANGUAGE={};n.FE.MODULES.language=function(t){function r(n){return i&&i.translation[n]?i.translation[n]:n}function u(){n.FE.LANGUAGE&&(i=n.FE.LANGUAGE[t.opts.language]);i&&i.direction&&(t.opts.direction=i.direction)}var i;return{_init:u,translate:r}};n.extend(n.FE.DEFAULTS,{placeholderText:"Type something"});n.FE.MODULES.placeholder=function(t){function i(){var i;t.$placeholder||e();var l=t.opts.iframe?t.$iframe.prev().outerHeight(!0):t.$el.prev().outerHeight(!0),u=0,f=0,o=0,s=0,h=0,c=0,r=t.node.contents(t.el),a=n(t.selection.element()).css("text-align");r.length&&r[0].nodeType==Node.ELEMENT_NODE?(i=n(r[0]),(!t.opts.toolbarInline||t.$el.prev().length>0)&&t.ready&&(u=t.helpers.getPX(i.css("margin-top")),s=t.helpers.getPX(i.css("padding-top")),f=t.helpers.getPX(i.css("margin-left")),o=t.helpers.getPX(i.css("margin-right")),h=t.helpers.getPX(i.css("padding-left")),c=t.helpers.getPX(i.css("padding-right"))),t.$placeholder.css("font-size",i.css("font-size")),t.$placeholder.css("line-height",i.css("line-height"))):(t.$placeholder.css("font-size",t.$el.css("font-size")),t.$placeholder.css("line-height",t.$el.css("line-height")));t.$wp.addClass("show-placeholder");t.$placeholder.css({marginTop:Math.max(t.helpers.getPX(t.$el.css("margin-top")),u)+l,paddingTop:Math.max(t.helpers.getPX(t.$el.css("padding-top")),s),paddingLeft:Math.max(t.helpers.getPX(t.$el.css("padding-left")),h),marginLeft:Math.max(t.helpers.getPX(t.$el.css("margin-left")),f),paddingRight:Math.max(t.helpers.getPX(t.$el.css("padding-right")),c),marginRight:Math.max(t.helpers.getPX(t.$el.css("margin-right")),o),textAlign:a}).text(t.language.translate(t.opts.placeholderText||t.$oel.attr("placeholder")||""));t.$placeholder.html(t.$placeholder.text().replace(/\n/g,"<br>"))}function r(){t.$wp.removeClass("show-placeholder")}function f(){return!t.$wp||t.node.hasClass(t.$wp.get(0),"show-placeholder")}function u(){if(!t.$wp)return!1;t.core.isEmpty()?i():r()}function e(){t.$placeholder=n('<span class="fr-placeholder"><\/span>');t.$wp.append(t.$placeholder)}function o(){if(!t.$wp)return!1;t.events.on("init input keydown keyup contentChanged initialized",u)}return{_init:o,show:i,hide:r,refresh:u,isVisible:f}};n.FE.MODULES.edit=function(n){function i(){if(n.browser.mozilla)try{n.doc.execCommand("enableObjectResizing",!1,"false");n.doc.execCommand("enableInlineTableEditing",!1,"false")}catch(t){}if(n.browser.msie)try{n.doc.body.addEventListener("mscontrolselect",function(n){return n.preventDefault(),!1})}catch(t){}}function u(){n.$wp?(n.$el.attr("contenteditable",!0),n.$el.removeClass("fr-disabled").attr("aria-disabled",!1),n.$tb&&n.$tb.removeClass("fr-disabled").attr("aria-disabled",!1),i()):n.$el.is("a")&&n.$el.attr("contenteditable",!0);t=!1}function f(){n.$wp?(n.$el.attr("contenteditable",!1),n.$el.addClass("fr-disabled").attr("aria-disabled",!0),n.$tb&&n.$tb.addClass("fr-disabled").attr("aria-disabled",!0)):n.$el.is("a")&&n.$el.attr("contenteditable",!1);t=!0}function r(){return t}function e(){n.events.on("focus",function(){r()?n.edit.off():n.edit.on()})}var t=!1;return{_init:e,on:u,off:f,disableDesign:i,isDisabled:r}};n.extend(n.FE.DEFAULTS,{editorClass:null,typingTimer:500,iframe:!1,requestWithCORS:!0,requestWithCredentials:!1,requestHeaders:{},useClasses:!0,spellcheck:!0,iframeStyle:'html{margin:0px;height:auto;}body{height:auto;padding:10px;background:transparent;color:#000000;position:relative;z-index: 2;-webkit-user-select:auto;margin:0px;overflow:hidden;min-height:20px;}body:after{content:"";display:block;clear:both;}',iframeStyleFiles:[],direction:"auto",zIndex:1,tabIndex:null,disableRightClick:!1,scrollableContainer:"body",keepFormatOnDelete:!1,theme:null});n.FE.MODULES.core=function(t){function i(i){var r,u;if(t.opts.iframe)for(t.$head.find("style[data-fr-style], link[data-fr-style]").remove(),t.$head.append('<style data-fr-style="true">'+i+"<\/style>"),r=0;r<t.opts.iframeStyleFiles.length;r++)u=n('<link data-fr-style="true" rel="stylesheet" href="'+t.opts.iframeStyleFiles[r]+'">'),u.get(0).addEventListener("load",t.size.syncIframe),t.$head.append(u)}function r(){t.opts.iframe||t.$el.addClass("fr-element fr-view ignore")}function u(){var u,n,i,f;if(t.$box.addClass("fr-box"+(t.opts.editorClass?" "+t.opts.editorClass:"")),t.$wp.addClass("fr-wrapper"),r(),t.opts.iframe)for(t.$iframe.addClass("fr-iframe"),t.$el.addClass("fr-view"),u=0;u<t.o_doc.styleSheets.length;u++){try{n=t.o_doc.styleSheets[u].cssRules}catch(e){}if(n)for(i=0,f=n.length;i<f;i++)n[i].selectorText&&(0===n[i].selectorText.indexOf(".fr-view")||0===n[i].selectorText.indexOf(".fr-element"))&&n[i].style.cssText.length>0&&(t.opts.iframeStyle+=0===n[i].selectorText.indexOf(".fr-view")?n[i].selectorText.replace(/\.fr-view/g,"body")+"{"+n[i].style.cssText+"}":n[i].selectorText.replace(/\.fr-element/g,"body")+"{"+n[i].style.cssText+"}")}"auto"!=t.opts.direction&&t.$box.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction);t.$el.attr("dir",t.opts.direction);t.$wp.attr("dir",t.opts.direction);t.opts.zIndex>1&&t.$box.css("z-index",t.opts.zIndex);t.opts.theme&&t.$box.addClass(t.opts.theme+"-theme");t.opts.tabIndex=t.opts.tabIndex||t.$oel.attr("tabIndex");t.opts.tabIndex&&t.$el.attr("tabIndex",t.opts.tabIndex)}function f(){return t.node.isEmpty(t.el)}function e(){t.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!t.win.FormData,progress:"upload"in new XMLHttpRequest}}function o(n,i){var r=new XMLHttpRequest,u;r.open(i,n,!0);t.opts.requestWithCredentials&&(r.withCredentials=!0);for(u in t.opts.requestHeaders)t.opts.requestHeaders.hasOwnProperty(u)&&r.setRequestHeader(u,t.opts.requestHeaders[u]);return r}function s(n){"TEXTAREA"==t.$oel.get(0).tagName&&t.$oel.val(n);t.$wp&&("TEXTAREA"==t.$oel.get(0).tagName?(t.$el.html(""),t.$wp.html(""),t.$box.replaceWith(t.$oel),t.$oel.show()):(t.$wp.replaceWith(n),t.$el.html(""),t.$box.removeClass("fr-view fr-ltr fr-box "+(t.opts.editorClass||"")),t.opts.theme&&t.$box.addClass(t.opts.theme+"-theme")));this.$wp=null;this.$el=null;this.el=null;this.$box=null}function h(){return t.browser.mozilla&&t.helpers.isMobile()?t.selection.inEditor():t.node.hasFocus(t.el)||t.$el.find("*:focus").length>0}function c(n){if(!n)return!1;var i=n.data("instance");return!!i&&i.id==t.id}function l(){if(n.FE.INSTANCES.push(t),e(),t.$wp){u();t.html.set(t._original_html);t.$el.attr("spellcheck",t.opts.spellcheck);t.helpers.isMobile()&&(t.$el.attr("autocomplete",t.opts.spellcheck?"on":"off"),t.$el.attr("autocorrect",t.opts.spellcheck?"on":"off"),t.$el.attr("class","ignore"),t.$el.attr("autocapitalize",t.opts.spellcheck?"on":"off"));t.opts.disableRightClick&&t.events.$on(t.$el,"contextmenu",function(n){if(2==n.button)return!1});try{t.doc.execCommand("styleWithCSS",!1,!1)}catch(i){}}"TEXTAREA"==t.$oel.get(0).tagName&&(t.events.on("contentChanged",function(){t.$oel.val(t.html.get())}),t.events.on("form.submit",function(){t.$oel.val(t.html.get())}),t.events.on("form.reset",function(){t.html.set(t._original_html)}),t.$oel.val(t.html.get()));t.helpers.isIOS()&&t.events.$on(t.$doc,"selectionchange",function(){t.$doc.get(0).hasFocus()||t.$win.get(0).focus()});t.events.trigger("init")}return{_init:l,destroy:s,isEmpty:f,getXHR:o,injectStyle:i,hasFocus:h,sameInstance:c}};n.FE.MODULES.cursorLists=function(t){function i(n){for(var t=n;"LI"!=t.tagName;)t=t.parentNode;return t}function r(n){for(var i=n;!t.node.isList(i);)i=i.parentNode;return i}function u(u){var e,o=i(u),w=o.nextSibling,k=o.previousSibling,s=t.html.defaultTag(),b,y,p,c,a,l;if(t.node.isEmpty(o,!0)&&w){for(var h="",v="",f=u.parentNode;!t.node.isList(f)&&f.parentNode&&"LI"!==f.parentNode.tagName;)h=t.node.openTagString(f)+h,v+=t.node.closeTagString(f),f=f.parentNode;for(h=t.node.openTagString(f)+h,v+=t.node.closeTagString(f),b="",b=f.parentNode&&"LI"==f.parentNode.tagName?v+"<li>"+n.FE.MARKERS+"<br>"+h:s?v+"<"+s+">"+n.FE.MARKERS+"<br><\/"+s+">"+h:v+n.FE.MARKERS+"<br>"+h,n(o).html('<span id="fr-break"><\/span>');["UL","OL"].indexOf(f.tagName)<0||f.parentNode&&"LI"===f.parentNode.tagName;)f=f.parentNode;y=t.node.openTagString(f)+n(f).html()+t.node.closeTagString(f);y=y.replace(/<span id="fr-break"><\/span>/g,b);n(f).replaceWith(y);t.$el.find("li:empty").remove()}else if(k&&w||!t.node.isEmpty(o,!0)){for(p="<br>",c=u.parentNode;c&&"LI"!=c.tagName;)p=t.node.openTagString(c)+p+t.node.closeTagString(c),c=c.parentNode;n(o).before("<li>"+p+"<\/li>");n(u).remove()}else if(k){for(e=r(o),a=n.FE.MARKERS+"<br>",l=u.parentNode;l&&"LI"!=l.tagName;)a=t.node.openTagString(l)+a+t.node.closeTagString(l),l=l.parentNode;e.parentNode&&"LI"==e.parentNode.tagName?n(e.parentNode).after("<li>"+a+"<\/li>"):s?n(e).after("<"+s+">"+a+"<\/"+s+">"):n(e).after(a);n(o).remove()}else e=r(o),e.parentNode&&"LI"==e.parentNode.tagName?w?n(e.parentNode).before(t.node.openTagString(o)+n.FE.MARKERS+"<br><\/li>"):n(e.parentNode).after(t.node.openTagString(o)+n.FE.MARKERS+"<br><\/li>"):s?n(e).before("<"+s+">"+n.FE.MARKERS+"<br><\/"+s+">"):n(e).before(n.FE.MARKERS+"<br>"),n(o).remove()}function f(r){for(var c,e,f=i(r),o="",u=r,s="",h="";u!=f;)u=u.parentNode,c="A"==u.tagName&&t.cursor.isAtEnd(r,u)?"fr-to-remove":"",s=t.node.openTagString(n(u).clone().addClass(c).get(0))+s,h=t.node.closeTagString(u)+h;o=h+o+s+n.FE.MARKERS;n(r).replaceWith('<span id="fr-break"><\/span>');e=t.node.openTagString(f)+n(f).html()+t.node.closeTagString(f);e=e.replace(/<span id="fr-break"><\/span>/g,o);n(f).replaceWith(e)}function e(r){for(var h,c,e=i(r),o=n.FE.MARKERS,f="",u=r,s=!1;u!=e;)u=u.parentNode,h="A"==u.tagName&&t.cursor.isAtEnd(r,u)?"fr-to-remove":"",s||u==e||t.node.isBlock(u)||(s=!0,f+=n.FE.INVISIBLE_SPACE),f=t.node.openTagString(n(u).clone().addClass(h).get(0))+f,o+=t.node.closeTagString(u);c=f+o;n(r).remove();n(e).after(c)}function o(u){var f=i(u),s=f.previousSibling,h,c,e,o,a,l;if(s){for(s=n(s).find(t.html.blockTagsQuery()).get(-1)||s,n(u).replaceWith(n.FE.MARKERS),h=t.node.contents(s),h.length&&"BR"==h[h.length-1].tagName&&n(h[h.length-1]).remove(),n(f).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==f&&n(this).replaceWith(n(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),e=t.node.contents(f)[0];e&&!t.node.isList(e);)c=e.nextSibling,n(s).append(e),e=c;for(s=f.previousSibling;e;)c=e.nextSibling,n(s).append(e),e=c;n(f).remove()}else o=r(f),(n(u).replaceWith(n.FE.MARKERS),o.parentNode&&"LI"==o.parentNode.tagName)?(a=o.previousSibling,t.node.isBlock(a)?(n(f).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==f&&n(this).replaceWith(n(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),n(a).append(n(f).html())):n(o).before(n(f).html())):(l=t.html.defaultTag(),l&&0===n(f).find(t.html.blockTagsQuery()).length?n(o).before("<"+l+">"+n(f).html()+"<\/"+l+">"):(n(o).before(n(f).html()),t.html.wrap())),n(f).remove(),0===n(o).find("li").length&&n(o).remove()}function s(r){var f,o=i(r),s=o.nextSibling,h,c,e,u;if(s){for(f=t.node.contents(s),f.length&&"BR"==f[0].tagName&&n(f[0]).remove(),n(s).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==s&&n(this).replaceWith(n(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),c=r,e=t.node.contents(s)[0];e&&!t.node.isList(e);)h=e.nextSibling,n(c).after(e),c=e,e=h;for(;e;)h=e.nextSibling,n(o).append(e),e=h;n(r).replaceWith(n.FE.MARKERS);n(s).remove()}else{for(u=o;!u.nextSibling&&u!=t.el;)u=u.parentNode;if(u==t.el)return!1;if(u=u.nextSibling,t.node.isBlock(u))n.FE.NO_DELETE_TAGS.indexOf(u.tagName)<0&&(n(r).replaceWith(n.FE.MARKERS),f=t.node.contents(o),f.length&&"BR"==f[f.length-1].tagName&&n(f[f.length-1]).remove(),n(o).append(n(u).html()),n(u).remove());else for(f=t.node.contents(o),f.length&&"BR"==f[f.length-1].tagName&&n(f[f.length-1]).remove(),n(r).replaceWith(n.FE.MARKERS);u&&!t.node.isBlock(u)&&"BR"!=u.tagName;)n(o).append(n(u)),u=u.nextSibling}}return{_startEnter:u,_middleEnter:f,_endEnter:e,_backspace:o,_del:s}};n.FE.NO_DELETE_TAGS=["TH","TD","TR","TABLE","FORM"];n.FE.SIMPLE_ENTER_TAGS=["TH","TD","LI","DL","DT","FORM"];n.FE.MODULES.cursor=function(t){function r(n){return!!n&&(!!t.node.isBlock(n)||(n.nextSibling&&n.nextSibling.nodeType==Node.TEXT_NODE&&0===n.nextSibling.textContent.replace(/\u200b/g,"").length?r(n.nextSibling):!(n.nextSibling&&(!n.previousSibling||"BR"!=n.nextSibling.tagName||n.nextSibling.nextSibling))&&r(n.parentNode)))}function e(n){return!!n&&(!!t.node.isBlock(n)||(n.previousSibling&&n.previousSibling.nodeType==Node.TEXT_NODE&&0===n.previousSibling.textContent.replace(/\u200b/g,"").length?e(n.previousSibling):!n.previousSibling&&(!(n.previousSibling||!t.node.hasClass(n.parentNode,"fr-inner"))||e(n.parentNode))))}function u(n,i){return!!n&&n!=t.$wp.get(0)&&(n.previousSibling&&n.previousSibling.nodeType==Node.TEXT_NODE&&0===n.previousSibling.textContent.replace(/\u200b/g,"").length?u(n.previousSibling,i):!n.previousSibling&&(n.parentNode==i||u(n.parentNode,i)))}function i(n,r){return!!n&&n!=t.$wp.get(0)&&(n.nextSibling&&n.nextSibling.nodeType==Node.TEXT_NODE&&0===n.nextSibling.textContent.replace(/\u200b/g,"").length?i(n.nextSibling,r):!(n.nextSibling&&(!n.previousSibling||"BR"!=n.nextSibling.tagName||n.nextSibling.nextSibling))&&(n.parentNode==r||i(n.parentNode,r)))}function f(i){return n(i).parentsUntil(t.$el,"LI").length>0&&0===n(i).parentsUntil("LI","TABLE").length}function o(n,t){var r=new RegExp("([\\uD83C-\\uDBFF\\uDC00-\\uDFFF\\u200D]+)"+(t?"":"$"),"i"),i=n.match(r);return i?i[0].length:1}function y(i){var o=n(i).parentsUntil(t.$el,"BLOCKQUOTE").length>0,u=t.node.deepestParent(i,[],!o),e,f,r;if(u&&"BLOCKQUOTE"==u.tagName&&(e=t.node.deepestParent(i,[n(i).parentsUntil(t.$el,"BLOCKQUOTE").get(0)]),e&&e.previousSibling&&(u=e)),null!==u&&(r=u.previousSibling,t.node.isBlock(u)&&t.node.isEditable(u)&&r&&n.FE.NO_DELETE_TAGS.indexOf(r.tagName)<0))if(t.node.isDeletable(r))n(r).remove(),n(i).replaceWith(n.FE.MARKERS);else if(t.node.isEditable(r))if(t.node.isBlock(r))if(t.node.isEmpty(r)&&!t.node.isList(r))n(r).remove(),n(i).after(t.opts.keepFormatOnDelete?n.FE.INVISIBLE_SPACE:"");else{if(t.node.isList(r)&&(r=n(r).find("li:last").get(0)),f=t.node.contents(r),f.length&&"BR"==f[f.length-1].tagName&&n(f[f.length-1]).remove(),"BLOCKQUOTE"==r.tagName&&"BLOCKQUOTE"!=u.tagName)for(f=t.node.contents(r);f.length&&t.node.isBlock(f[f.length-1]);)r=f[f.length-1],f=t.node.contents(r);else if("BLOCKQUOTE"!=r.tagName&&"BLOCKQUOTE"==u.tagName)for(f=t.node.contents(u);f.length&&t.node.isBlock(f[0]);)u=f[0],f=t.node.contents(u);t.node.isEmpty(u)?(n(i).remove(),t.selection.setAtEnd(r,t.opts.keepFormatOnDelete)):(n(i).replaceWith(n.FE.MARKERS),n(r).append(u.innerHTML));n(u).remove()}else n(i).replaceWith(n.FE.MARKERS),"BLOCKQUOTE"==u.tagName&&r.nodeType==Node.ELEMENT_NODE?n(r).remove():(n(r).after(t.node.isEmpty(u)?"":n(u).html()),n(u).remove(),"BR"==r.tagName&&n(r).remove())}function c(i){for(var u,e,s,h,f,c,r=i;!r.previousSibling;)if(r=r.parentNode,t.node.isElement(r))return!1;if(r=r.previousSibling,!t.node.isBlock(r)&&t.node.isEditable(r)){for(u=t.node.contents(r);r.nodeType!=Node.TEXT_NODE&&!t.node.isDeletable(r)&&u.length&&t.node.isEditable(r);)r=u[u.length-1],u=t.node.contents(r);r.nodeType==Node.TEXT_NODE?(e=r.textContent,s=e.length,t.opts.tabSpaces&&e.length>=t.opts.tabSpaces&&0===e.substr(e.length-t.opts.tabSpaces,e.length-1).replace(/ /g,"").replace(new RegExp(n.FE.UNICODE_NBSP,"g"),"").length&&(s=e.length-t.opts.tabSpaces),r.textContent=e.substring(0,s-o(e)),h=e.length!=r.textContent.length,0===r.textContent.length?h&&t.opts.keepFormatOnDelete?n(r).after(n.FE.INVISIBLE_SPACE+n.FE.MARKERS):(2!=r.parentNode.childNodes.length||r.parentNode!=i.parentNode)&&1!=r.parentNode.childNodes.length||t.node.isBlock(r.parentNode)||t.node.isElement(r.parentNode)?(n(r).after(n.FE.MARKERS),t.node.isElement(r.parentNode)&&!i.nextSibling&&r.previousSibling&&"BR"==r.previousSibling.tagName&&n(i).after("<br>"),r.parentNode.removeChild(r)):(n(r.parentNode).after(n.FE.MARKERS),n(r.parentNode).remove()):n(r).after(n.FE.MARKERS)):t.node.isDeletable(r)?(n(r).after(n.FE.MARKERS),n(r).remove()):i.nextSibling&&"BR"==i.nextSibling.tagName&&t.node.isVoid(r)&&"BR"!=r.tagName?(n(i.nextSibling).remove(),n(i).replaceWith(n.FE.MARKERS)):!1!==t.events.trigger("node.remove",[n(r)])&&(n(r).after(n.FE.MARKERS),n(r).remove())}else if(n.FE.NO_DELETE_TAGS.indexOf(r.tagName)<0&&(t.node.isEditable(r)||t.node.isDeletable(r)))if(t.node.isDeletable(r))n(i).replaceWith(n.FE.MARKERS),n(r).remove();else if(t.node.isEmpty(r)&&!t.node.isList(r))n(r).remove(),n(i).replaceWith(n.FE.MARKERS);else{for(t.node.isList(r)&&(r=n(r).find("li:last").get(0)),u=t.node.contents(r),u&&"BR"==u[u.length-1].tagName&&n(u[u.length-1]).remove(),u=t.node.contents(r);u&&t.node.isBlock(u[u.length-1]);)r=u[u.length-1],u=t.node.contents(r);for(n(r).append(n.FE.MARKERS),f=i;!f.previousSibling;)f=f.parentNode;for(;f&&"BR"!==f.tagName&&!t.node.isBlock(f);)c=f,f=f.nextSibling,n(r).append(c);f&&"BR"==f.tagName&&n(f).remove();n(i).remove()}else i.nextSibling&&"BR"==i.nextSibling.tagName&&n(i.nextSibling).remove()}function p(){var v=!1,i=t.markers.insert(),h,l,s;if(!i)return!0;for(h=i.parentNode;h&&!t.node.isElement(h);){if("false"===h.getAttribute("contenteditable"))return n(i).replaceWith(n.FE.MARKERS),t.selection.restore(),!1;if("true"===h.getAttribute("contenteditable"))break;h=h.parentNode}return t.el.normalize(),l=i.previousSibling,l&&(s=l.textContent,s&&s.length&&8203==s.charCodeAt(s.length-1)&&(1==s.length?n(l).remove():l.textContent=l.textContent.substr(0,s.length-o(s)))),r(i)?v=c(i):e(i)?f(i)&&u(i,n(i).parents("li:first").get(0))?t.cursorLists._backspace(i):y(i):v=c(i),n(i).remove(),a(),t.html.fillEmptyBlocks(!0),t.opts.htmlUntouched||(t.html.cleanEmptyTags(),t.clean.quotes(),t.clean.lists()),t.spaces.normalizeAroundCursor(),t.selection.restore(),v}function l(i){var h=n(i).parentsUntil(t.$el,"BLOCKQUOTE").length>0,f=t.node.deepestParent(i,[],!h),o,u,r,e,s;if(f&&"BLOCKQUOTE"==f.tagName&&(o=t.node.deepestParent(i,[n(i).parentsUntil(t.$el,"BLOCKQUOTE").get(0)]),o&&o.nextSibling&&(f=o)),null!==f&&(r=f.nextSibling,t.node.isBlock(f)&&(t.node.isEditable(f)||t.node.isDeletable(f))&&r&&n.FE.NO_DELETE_TAGS.indexOf(r.tagName)<0))if(t.node.isDeletable(r))n(r).remove(),n(i).replaceWith(n.FE.MARKERS);else if(t.node.isBlock(r)&&t.node.isEditable(r))if(t.node.isList(r))t.node.isEmpty(f,!0)?(n(f).remove(),n(r).find("li:first").prepend(n.FE.MARKERS)):(e=n(r).find("li:first"),"BLOCKQUOTE"==f.tagName&&(u=t.node.contents(f),u.length&&t.node.isBlock(u[u.length-1])&&(f=u[u.length-1])),0===e.find("ul, ol").length&&(n(i).replaceWith(n.FE.MARKERS),e.find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==e.get(0)&&n(this).replaceWith(n(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),n(f).append(t.node.contents(e.get(0))),e.remove(),0===n(r).find("li").length&&n(r).remove()));else{if(u=t.node.contents(r),u.length&&"BR"==u[0].tagName&&n(u[0]).remove(),"BLOCKQUOTE"!=r.tagName&&"BLOCKQUOTE"==f.tagName)for(u=t.node.contents(f);u.length&&t.node.isBlock(u[u.length-1]);)f=u[u.length-1],u=t.node.contents(f);else if("BLOCKQUOTE"==r.tagName&&"BLOCKQUOTE"!=f.tagName)for(u=t.node.contents(r);u.length&&t.node.isBlock(u[0]);)r=u[0],u=t.node.contents(r);n(i).replaceWith(n.FE.MARKERS);n(f).append(r.innerHTML);n(r).remove()}else{for(n(i).replaceWith(n.FE.MARKERS);r&&"BR"!==r.tagName&&!t.node.isBlock(r)&&t.node.isEditable(r);)s=r,r=r.nextSibling,n(f).append(s);r&&"BR"==r.tagName&&t.node.isEditable(r)&&n(r).remove()}}function w(i){for(var h,e,s,c,u=i;!u.nextSibling;)if(u=u.parentNode,t.node.isElement(u))return!1;if(u=u.nextSibling,"BR"==u.tagName&&t.node.isEditable(u))if(u.nextSibling){if(t.node.isBlock(u.nextSibling)&&t.node.isEditable(u.nextSibling)){if(!(n.FE.NO_DELETE_TAGS.indexOf(u.nextSibling.tagName)<0))return void n(u).remove();u=u.nextSibling;n(u.previousSibling).remove()}}else if(r(u)){f(i)?t.cursorLists._del(i):(h=t.node.deepestParent(u),h&&((!t.node.isEmpty(t.node.blockParent(u))||(t.node.blockParent(u).nextSibling&&n.FE.NO_DELETE_TAGS.indexOf(t.node.blockParent(u).nextSibling.tagName))<0)&&n(u).remove(),l(i)));return}if(!t.node.isBlock(u)&&t.node.isEditable(u)){for(e=t.node.contents(u);u.nodeType!=Node.TEXT_NODE&&e.length&&!t.node.isDeletable(u)&&t.node.isEditable(u);)u=e[0],e=t.node.contents(u);u.nodeType==Node.TEXT_NODE?(n(u).before(n.FE.MARKERS),u.textContent.length&&(u.textContent=u.textContent.substring(o(u.textContent,!0),u.textContent.length))):t.node.isDeletable(u)?(n(u).before(n.FE.MARKERS),n(u).remove()):!1!==t.events.trigger("node.remove",[n(u)])&&(n(u).before(n.FE.MARKERS),n(u).remove());n(i).remove()}else if(n.FE.NO_DELETE_TAGS.indexOf(u.tagName)<0&&(t.node.isEditable(u)||t.node.isDeletable(u)))if(t.node.isDeletable(u))n(i).replaceWith(n.FE.MARKERS),n(u).remove();else if(t.node.isList(u))i.previousSibling?(n(u).find("li:first").prepend(i),t.cursorLists._backspace(i)):(n(u).find("li:first").prepend(n.FE.MARKERS),n(i).remove());else if(e=t.node.contents(u),e&&"BR"==e[0].tagName&&n(e[0]).remove(),e&&"BLOCKQUOTE"==u.tagName){for(s=e[0],n(i).before(n.FE.MARKERS);s&&"BR"!=s.tagName;)c=s,s=s.nextSibling,n(i).before(c);s&&"BR"==s.tagName&&n(s).remove()}else n(i).after(n(u).html()).after(n.FE.MARKERS),n(u).remove()}function b(){var i=t.markers.insert(),u;if(!i)return!1;(t.el.normalize(),r(i))?f(i)?0===n(i).parents("li:first").find("ul, ol").length?t.cursorLists._del(i):(u=n(i).parents("li:first").find("ul:first, ol:first").find("li:first"),u=u.find(t.html.blockTagsQuery()).get(-1)||u,u.prepend(i),t.cursorLists._backspace(i)):l(i):w(e(i)?i:i);n(i).remove();a();t.html.fillEmptyBlocks(!0);t.opts.htmlUntouched||(t.html.cleanEmptyTags(),t.clean.quotes(),t.clean.lists());t.spaces.normalizeAroundCursor();t.selection.restore()}function a(){for(var i=t.el.querySelectorAll("blockquote:empty"),n=0;n<i.length;n++)i[n].parentNode.removeChild(i[n])}function k(){t.$el.find(".fr-to-remove").each(function(){for(var r=t.node.contents(this),i=0;i<r.length;i++)r[i].nodeType==Node.TEXT_NODE&&(r[i].textContent=r[i].textContent.replace(/\u200B/g,""));n(this).replaceWith(this.innerHTML)})}function s(r,u,f){var o,e=t.node.deepestParent(r,[],!f),s,l,y,c,a,p,w,v;if(e&&"BLOCKQUOTE"==e.tagName)return i(r,e)?(o=t.html.defaultTag(),o?n(e).after("<"+o+">"+n.FE.MARKERS+"<br><\/"+o+">"):n(e).after(n.FE.MARKERS+"<br>"),n(r).remove(),!1):(h(r,u,f),!1);if(null==e)o=t.html.defaultTag(),o&&t.node.isElement(r.parentNode)?n(r).replaceWith("<"+o+">"+n.FE.MARKERS+"<br><\/"+o+">"):!r.previousSibling||n(r.previousSibling).is("br")||r.nextSibling?n(r).replaceWith("<br>"+n.FE.MARKERS):n(r).replaceWith("<br>"+n.FE.MARKERS+"<br>");else{s=r;l="";t.node.isBlock(e)&&!u||(l="<br/>");y="";c="";o=t.html.defaultTag();a="";p="";o&&t.node.isBlock(e)&&(a="<"+o+">",p="<\/"+o+">",e.tagName==o.toUpperCase()&&(a=t.node.openTagString(n(e).clone().removeAttr("id").get(0))));do(s=s.parentNode,u&&s==e&&(!u||t.node.isBlock(e)))||((y+=t.node.closeTagString(s),s==e&&t.node.isBlock(e))?c=a+c:(w="A"==s.tagName&&i(r,s)?"fr-to-remove":"",c=t.node.openTagString(n(s).clone().addClass(w).get(0))+c));while(s!=e);l=y+l+c+(r.parentNode==e&&t.node.isBlock(e)?"":n.FE.INVISIBLE_SPACE)+n.FE.MARKERS;t.node.isBlock(e)&&!n(e).find("*:last").is("br")&&n(e).append("<br/>");n(r).after('<span id="fr-break"><\/span>');n(r).remove();e.nextSibling&&!t.node.isBlock(e.nextSibling)||t.node.isBlock(e)||n(e).after("<br>");v=!u&&t.node.isBlock(e)?t.node.openTagString(e)+n(e).html()+p:t.node.openTagString(e)+n(e).html()+t.node.closeTagString(e);v=v.replace(/<span id="fr-break"><\/span>/g,l);n(e).replaceWith(v)}}function v(r,f,e){var c,o=t.node.deepestParent(r,[],!e),l,a;if(o&&"TABLE"==o.tagName)return n(o).find("td:first, th:first").prepend(r),v(r,f,e);if(o&&"BLOCKQUOTE"==o.tagName){if(u(r,o))return c=t.html.defaultTag(),c?n(o).before("<"+c+">"+n.FE.MARKERS+"<br><\/"+c+">"):n(o).before(n.FE.MARKERS+"<br>"),n(r).remove(),!1;i(r,o)?s(r,f,!0):h(r,f,!0)}if(null==o)c=t.html.defaultTag(),c&&t.node.isElement(r.parentNode)?n(r).replaceWith("<"+c+">"+n.FE.MARKERS+"<br><\/"+c+">"):n(r).replaceWith("<br>"+n.FE.MARKERS);else{if(t.node.isBlock(o))if(f)n(r).remove(),n(o).prepend("<br>"+n.FE.MARKERS);else{if(t.node.isEmpty(o,!0))return s(r,f,e);if(t.opts.keepFormatOnDelete){for(l=r,a=n.FE.INVISIBLE_SPACE;l!=o&&!t.node.isElement(l);)l=l.parentNode,a=t.node.openTagString(l)+a+t.node.closeTagString(l);n(o).before(a)}else n(o).before(t.node.openTagString(n(o).clone().removeAttr("id").get(0))+"<br>"+t.node.closeTagString(o))}else n(o).before("<br>");n(r).remove()}}function h(r,f,e){var o=t.node.deepestParent(r,[],!e),s,h,v,c,l,p,w,a,y;if(null==o)t.html.defaultTag()&&r.parentNode===t.el?n(r).replaceWith("<"+t.html.defaultTag()+">"+n.FE.MARKERS+"<br><\/"+t.html.defaultTag()+">"):(r.nextSibling&&!t.node.isBlock(r.nextSibling)||n(r).after("<br>"),n(r).replaceWith("<br>"+n.FE.MARKERS));else{s=r;h="";"PRE"==o.tagName&&(f=!0);t.node.isBlock(o)&&!f||(h="<br>");v="";c="";do l=s,(s=s.parentNode,"BLOCKQUOTE"==o.tagName&&t.node.isEmpty(l)&&!t.node.hasClass(l,"fr-marker")&&n(l).find(r).length>0&&n(l).after(r),"BLOCKQUOTE"==o.tagName&&(i(r,s)||u(r,s))||f&&s==o&&(!f||t.node.isBlock(o)))||(v+=t.node.closeTagString(s),p="A"==s.tagName&&i(r,s)?"fr-to-remove":"",c=t.node.openTagString(n(s).clone().addClass(p).removeAttr("id").get(0))+c);while(s!=o);w=o==r.parentNode&&t.node.isBlock(o)||r.nextSibling;"BLOCKQUOTE"==o.tagName?(r.previousSibling&&t.node.isBlock(r.previousSibling)&&r.nextSibling&&"BR"==r.nextSibling.tagName&&(n(r.nextSibling).after(r),r.nextSibling&&"BR"==r.nextSibling.tagName&&n(r.nextSibling).remove()),a=t.html.defaultTag(),h=v+h+(a?"<"+a+">":"")+n.FE.MARKERS+"<br>"+(a?"<\/"+a+">":"")+c):h=v+h+c+(w?"":n.FE.INVISIBLE_SPACE)+n.FE.MARKERS;n(r).replaceWith('<span id="fr-break"><\/span>');y=t.node.openTagString(o)+n(o).html()+t.node.closeTagString(o);y=y.replace(/<span id="fr-break"><\/span>/g,h);n(o).replaceWith(y)}}function d(i){var u=t.markers.insert(),o;if(!u)return!0;t.el.normalize();o=!1;n(u).parentsUntil(t.$el,"BLOCKQUOTE").length>0&&(i=!1,o=!0);n(u).parentsUntil(t.$el,"TD, TH").length&&(o=!1);r(u)?!f(u)||i||o?s(u,i,o):t.cursorLists._endEnter(u):e(u)?!f(u)||i||o?v(u,i,o):t.cursorLists._startEnter(u):!f(u)||i||o?h(u,i,o):t.cursorLists._middleEnter(u);k();t.html.fillEmptyBlocks(!0);t.opts.htmlUntouched||(t.html.cleanEmptyTags(),t.clean.lists());t.spaces.normalizeAroundCursor();t.selection.restore()}return{enter:d,backspace:p,del:b,isAtEnd:i,isAtStart:u}};n.FE.ENTER_P=0;n.FE.ENTER_DIV=1;n.FE.ENTER_BR=2;n.FE.KEYCODE={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,FF_HYPHEN:173,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,HYPHEN:189,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,IME:229};n.extend(n.FE.DEFAULTS,{enter:n.FE.ENTER_P,multiLine:!0,tabSpaces:0});n.FE.MODULES.keys=function(t){function a(n){f=null;t.opts.multiLine?t.helpers.isIOS()?f=t.snapshot.get():(n.preventDefault(),n.stopPropagation(),t.selection.isCollapsed()||t.selection.remove(),t.cursor.enter()):(n.preventDefault(),n.stopPropagation())}function v(n){n.preventDefault();n.stopPropagation();t.opts.multiLine&&(t.selection.isCollapsed()||t.selection.remove(),t.cursor.enter(!0))}function y(){setTimeout(function(){t.events.disableBlur();t.events.focus()},0)}function p(n){f=null;t.selection.isCollapsed()?t.helpers.isIOS()?f=t.snapshot.get():(t.cursor.backspace(),n.preventDefault(),n.stopPropagation()):(n.preventDefault(),n.stopPropagation(),t.selection.remove(),t.html.fillEmptyBlocks());t.placeholder.refresh()}function w(n){n.preventDefault();n.stopPropagation();""===t.selection.text()?t.cursor.del():t.selection.remove();t.placeholder.refresh()}function b(i){var f=t.selection.element(),r,u;!t.helpers.isMobile()&&f&&"A"==f.tagName&&(i.preventDefault(),i.stopPropagation(),t.selection.isCollapsed()||t.selection.remove(),r=t.markers.insert(),r&&(u=r.previousSibling,!r.nextSibling&&r.parentNode&&"A"==r.parentNode.tagName?(r.parentNode.insertAdjacentHTML("afterend","&nbsp;"+n.FE.MARKERS),r.parentNode.removeChild(r)):(u&&u.nodeType==Node.TEXT_NODE&&1==u.textContent.length&&160==u.textContent.charCodeAt(0)?u.textContent=u.textContent+" ":r.insertAdjacentHTML("beforebegin","&nbsp;"),r.outerHTML=n.FE.MARKERS),t.selection.restore()))}function k(){if(t.browser.mozilla&&t.selection.isCollapsed()&&!i){var u=t.selection.ranges(0),n=u.startContainer,r=u.startOffset;n&&n.nodeType==Node.TEXT_NODE&&r<=n.textContent.length&&r>0&&32==n.textContent.charCodeAt(r-1)&&(t.selection.save(),t.spaces.normalize(),t.selection.restore())}}function d(){t.selection.isFull()&&setTimeout(function(){var i=t.html.defaultTag();i?t.$el.html("<"+i+">"+n.FE.MARKERS+"<br/><\/"+i+">"):t.$el.html(n.FE.MARKERS+"<br/>");t.selection.restore();t.placeholder.refresh();t.button.bulkRefresh();t.undo.saveStep()},0)}function g(n){if(t.opts.tabSpaces>0)if(t.selection.isCollapsed()){t.undo.saveStep();n.preventDefault();n.stopPropagation();for(var i="",r=0;r<t.opts.tabSpaces;r++)i+="&nbsp;";t.html.insert(i);t.placeholder.refresh();t.undo.saveStep()}else n.preventDefault(),n.stopPropagation(),n.shiftKey?t.commands.outdent():t.commands.indent()}function nt(){i=!1}function tt(){i=!1}function it(){return i}function rt(u){var f,h,s,e;if(t.events.disableBlur(),f=u.which,16===f)return!0;if(f===n.FE.KEYCODE.IME)return i=!0,!0;if(i=!1,h=o(f)&&!r(u),s=f==n.FE.KEYCODE.BACKSPACE||f==n.FE.KEYCODE.DELETE,(t.selection.isFull()&&!t.opts.keepFormatOnDelete&&!t.placeholder.isVisible()||s&&t.placeholder.isVisible()&&t.opts.keepFormatOnDelete)&&(h||s)&&(e=t.html.defaultTag(),e?t.$el.html("<"+e+">"+n.FE.MARKERS+"<br/><\/"+e+">"):t.$el.html(n.FE.MARKERS+"<br/>"),t.selection.restore(),!o(f)))return u.preventDefault(),!0;f==n.FE.KEYCODE.ENTER?u.shiftKey?v(u):a(u):f===n.FE.KEYCODE.BACKSPACE&&(u.metaKey||u.ctrlKey)?y():f!=n.FE.KEYCODE.BACKSPACE||r(u)||u.altKey?f!=n.FE.KEYCODE.DELETE||r(u)||u.altKey||u.shiftKey?f==n.FE.KEYCODE.SPACE?b(u):f==n.FE.KEYCODE.TAB?g(u):r(u)||!o(u.which)||t.selection.isCollapsed()||u.ctrlKey||t.selection.remove():t.placeholder.isVisible()?(u.preventDefault(),u.stopPropagation()):w(u):t.placeholder.isVisible()?(u.preventDefault(),u.stopPropagation()):p(u);t.events.enableBlur()}function ut(n){for(var r,i=t.doc.createTreeWalker(n,NodeFilter.SHOW_TEXT,t.node.filter(function(n){return/\u200B/gi.test(n.textContent)}),!1);i.nextNode();)r=i.currentNode,r.textContent=r.textContent.replace(/\u200B/gi,"")}function s(){if(!t.$wp)return!0;var i;t.opts.height||t.opts.heightMax?(i=t.position.getBoundingRect().top,(t.helpers.isIOS()||t.helpers.isAndroid())&&(i-=t.helpers.scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),i>t.$wp.offset().top-t.helpers.scrollTop()+t.$wp.height()-20&&t.$wp.scrollTop(i+t.$wp.scrollTop()-(t.$wp.height()+t.$wp.offset().top)+t.helpers.scrollTop()+20)):(i=t.position.getBoundingRect().top,t.opts.toolbarBottom&&(i+=t.opts.toolbarStickyOffset),(t.helpers.isIOS()||t.helpers.isAndroid())&&(i-=t.helpers.scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top,i-=t.helpers.scrollTop()),i+=t.opts.toolbarStickyOffset,i>t.o_win.innerHeight-20&&n(t.o_win).scrollTop(i+t.helpers.scrollTop()-t.o_win.innerHeight+20),i=t.position.getBoundingRect().top,t.opts.toolbarBottom||(i-=t.opts.toolbarStickyOffset),(t.helpers.isIOS()||t.helpers.isAndroid())&&(i-=t.helpers.scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top,i-=t.helpers.scrollTop()),i<t.$tb.height()+20&&i>=0&&n(t.o_win).scrollTop(i+t.helpers.scrollTop()-t.$tb.height()-20))}function ft(){var u=t.selection.element(),i=t.node.blockParent(u),r;i&&"DIV"==i.tagName&&t.selection.info(i).atStart&&(r=t.html.defaultTag(),i.previousSibling&&"DIV"!=i.previousSibling.tagName&&r&&"div"!=r&&(t.selection.save(),n(i).replaceWith("<"+r+">"+i.innerHTML+"<\/"+r+">"),t.selection.restore()))}function h(r){var e;if(t.helpers.isIOS()&&r&&f&&(r.which==n.FE.KEYCODE.ENTER?(t.snapshot.restore(f),t.cursor.enter()):r.which==n.FE.KEYCODE.BACKSPACE&&(e=t.snapshot.get(),t.snapshot.restore(f),t.cursor.backspace(),t.el.innerHTML!==e.html&&t.snapshot.restore(e))),t.helpers.isAndroid()&&t.browser.mozilla)return!0;if(i)return!1;if(!t.selection.isCollapsed()||r&&(r.which===n.FE.KEYCODE.META||r.which==n.FE.KEYCODE.CTRL)||r&&c(r.which))return!0;r&&r.which==n.FE.KEYCODE.ENTER&&t.helpers.isIOS()&&ft();r&&(r.which==n.FE.KEYCODE.ENTER||r.which==n.FE.KEYCODE.BACKSPACE||r.which>=37&&r.which<=40&&!t.browser.msie)&&s();t.html.cleanBRs(!0,!0);var o=function(n){if(!n)return!1;var t=n.innerHTML;return!!((t=t.replace(/<span[^>]*? class\s*=\s*["']?fr-marker["']?[^>]+>\u200b<\/span>/gi,""))&&/\u200B/.test(t)&&t.replace(/\u200B/gi,"").length>0)},h=function(n){return!t.helpers.isIOS()||0===((n.textContent||"").match(/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi)||[]).length},u=t.selection.element();o(u)&&!t.node.hasClass(u,"fr-marker")&&"IFRAME"!=u.tagName&&h(u)&&(t.selection.save(),ut(u),t.selection.restore())}function r(n){if(-1!=navigator.userAgent.indexOf("Mac OS X")){if(n.metaKey&&!n.altKey)return!0}else if(n.ctrlKey&&!n.altKey)return!0;return!1}function c(t){if(t>=n.FE.KEYCODE.ARROW_LEFT&&t<=n.FE.KEYCODE.ARROW_DOWN)return!0}function o(i){if(i>=n.FE.KEYCODE.ZERO&&i<=n.FE.KEYCODE.NINE||i>=n.FE.KEYCODE.NUM_ZERO&&i<=n.FE.KEYCODE.NUM_MULTIPLY||i>=n.FE.KEYCODE.A&&i<=n.FE.KEYCODE.Z||t.browser.webkit&&0===i)return!0;switch(i){case n.FE.KEYCODE.SPACE:case n.FE.KEYCODE.QUESTION_MARK:case n.FE.KEYCODE.NUM_PLUS:case n.FE.KEYCODE.NUM_MINUS:case n.FE.KEYCODE.NUM_PERIOD:case n.FE.KEYCODE.NUM_DIVISION:case n.FE.KEYCODE.SEMICOLON:case n.FE.KEYCODE.FF_SEMICOLON:case n.FE.KEYCODE.DASH:case n.FE.KEYCODE.EQUALS:case n.FE.KEYCODE.FF_EQUALS:case n.FE.KEYCODE.COMMA:case n.FE.KEYCODE.PERIOD:case n.FE.KEYCODE.SLASH:case n.FE.KEYCODE.APOSTROPHE:case n.FE.KEYCODE.SINGLE_QUOTE:case n.FE.KEYCODE.OPEN_SQUARE_BRACKET:case n.FE.KEYCODE.BACKSLASH:case n.FE.KEYCODE.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}function et(i){var f=i.which;if(r(i)||f>=37&&f<=40||!o(f)&&f!=n.FE.KEYCODE.DELETE&&f!=n.FE.KEYCODE.BACKSPACE&&f!=n.FE.KEYCODE.ENTER&&f!=n.FE.KEYCODE.IME)return!0;u||(e=t.snapshot.get(),t.undo.canDo()||t.undo.saveStep());clearTimeout(u);u=setTimeout(function(){u=null;t.undo.saveStep()},Math.max(250,t.opts.typingTimer))}function ot(n){var i=n.which;if(r(n)||i>=37&&i<=40)return!0;e&&u?(t.undo.saveStep(e),e=null):void 0!==i&&0!==i||e||u||t.undo.saveStep()}function st(){u&&(clearTimeout(u),t.undo.saveStep(),e=null)}function ht(t){var i=t.which;return r(t)||i==n.FE.KEYCODE.F5}function l(n){return(!n||"BR"!=n.tagName)&&0===(n.textContent||"").length&&n.querySelector&&!n.querySelector(":scope > br")}function ct(i){var u=t.el.childNodes,r=t.html.defaultTag();return!(!i.target||i.target===t.el)||0===u.length||void(t.$el.outerHeight()-i.offsetY<=10?l(u[u.length-1])&&(r?t.$el.append("<"+r+">"+n.FE.MARKERS+"<br><\/"+r+">"):t.$el.append(n.FE.MARKERS+"<br>"),t.selection.restore(),s()):i.offsetY<=10&&l(u[0])&&(r?t.$el.prepend("<"+r+">"+n.FE.MARKERS+"<br><\/"+r+">"):t.$el.prepend(n.FE.MARKERS+"<br>"),t.selection.restore(),s()))}function lt(){if(t.events.on("keydown",et),t.events.on("input",k),t.events.on("mousedown",tt),t.events.on("keyup input",ot),t.events.on("keypress",nt),t.events.on("keydown",rt),t.events.on("keyup",h),t.events.on("html.inserted",h),t.events.on("cut",d),t.events.on("click",ct),!t.browser.edge&&t.el.msGetInputContext)try{t.el.msGetInputContext().addEventListener("MSCandidateWindowShow",function(){i=!0});t.el.msGetInputContext().addEventListener("MSCandidateWindowHide",function(){i=!1;h()})}catch(n){}}var u,e,i=!1,f=null;return{_init:lt,ctrlKey:r,isCharacter:o,isArrow:c,forceUndo:st,isIME:it,isBrowserAction:ht,positionCaret:s}};n.FE.MODULES.accessibility=function(t){function i(n){n&&n.length&&(n.data("blur-event-set")||n.parents(".fr-popup").length||(t.events.$on(n,"blur",function(){var i=n.parents(".fr-toolbar, .fr-popup").data("instance")||t;i.events.blurActive()&&i.events.trigger("blur");i.events.enableBlur()},!0),n.data("blur-event-set",!0)),(n.parents(".fr-toolbar, .fr-popup").data("instance")||t).events.disableBlur(),n.focus(),t.shared.$f_el=n)}function r(n,t){var u=t?"last":"first",r=n.find("button:visible:not(.fr-disabled),.fr-group span.fr-command:visible")[u]();if(r.length)return i(r),!0}function s(n){return n.is("input, textarea")&&c(),t.events.disableBlur(),n.focus(),!0}function f(n,i){var f=n.find("input, textarea, button, select").filter(":visible").not(":disabled").filter(i?":last":":first"),r,u;if(f.length)return s(f);if(t.shared.with_kb){if(r=n.find(".fr-active-item:visible:first"),r.length)return s(r);if(u=n.find("[tabIndex]:visible:first"),u.length)return s(u)}}function c(){0===t.$el.find(".fr-marker").length&&t.core.hasFocus()&&t.selection.save()}function e(n){n.$el.find(".fr-marker").length&&(n.events.disableBlur(),n.selection.restore(),n.events.enableBlur())}function nt(n){var i=n.children().not(".fr-buttons");i.data("mouseenter-event-set")||(t.events.$on(i,"mouseenter","[tabIndex]",function(r){var f=n.data("instance")||t,u;if(!o)return r.stopPropagation(),void r.preventDefault();u=i.find(":focus:first");u.length&&!u.is("input, button, textarea")&&(f.events.disableBlur(),u.blur(),f.events.disableBlur(),f.events.focus())}),i.data("mouseenter-event-set",!0));!f(i)&&t.shared.with_kb&&r(n.find(".fr-buttons"))}function tt(n){t.core.hasFocus()||(t.events.disableBlur(),t.events.focus());t.accessibility.saveSelection();t.events.disableBlur();t.$el.blur();t.selection.clear();t.events.disableBlur();t.shared.with_kb?n.find(".fr-command[tabIndex], [tabIndex]").first().focus():n.find("[tabIndex]:first").focus()}function l(){var n=t.popups.areVisible(),i;return n?(i=n.find(".fr-buttons"),i.find("button:focus, .fr-group span:focus").length?!r(n.data("instance").$tb):!r(i)):!r(t.$tb)}function a(){var n=null;return t.shared.$f_el.is(".fr-dropdown.fr-active")?n=t.shared.$f_el:t.shared.$f_el.closest(".fr-dropdown-menu").prev().is(".fr-dropdown.fr-active")&&(n=t.shared.$f_el.closest(".fr-dropdown-menu").prev()),n}function v(u,e,o){var s,h,c,l;if(t.shared.$f_el)return s=a(),s&&(t.button.click(s),t.shared.$f_el=s),h=u.find("button:visible:not(.fr-disabled),.fr-group span.fr-command:visible"),c=h.index(t.shared.$f_el),0===c&&!o||c==h.length-1&&o?(e&&(u.parent().is(".fr-popup")&&(l=!f(u.parent().children().not(".fr-buttons"),!o)),!1===l&&(t.shared.$f_el=null)),e&&!1===l||r(u,!o)):i(n(h.get(c+(o?1:-1)))),!1}function y(n,t){return v(n,t,!0)}function p(n,t){return v(n,t)}function w(n){if(t.shared.$f_el){var r;if(t.shared.$f_el.is(".fr-dropdown.fr-active"))return r=n?t.shared.$f_el.next().find(".fr-command:not(.fr-disabled)").first():t.shared.$f_el.next().find(".fr-command:not(.fr-disabled)").last(),i(r),!1;if(t.shared.$f_el.is("a.fr-command"))return r=n?t.shared.$f_el.closest("li").nextAll(":visible:first").find(".fr-command:not(.fr-disabled)").first():t.shared.$f_el.closest("li").prevAll(":visible:first").find(".fr-command:not(.fr-disabled)").first(),r.length||(r=n?t.shared.$f_el.closest(".fr-dropdown-menu").find(".fr-command:not(.fr-disabled)").first():t.shared.$f_el.closest(".fr-dropdown-menu").find(".fr-command:not(.fr-disabled)").last()),i(r),!1}}function it(){return t.shared.$f_el&&t.shared.$f_el.is(".fr-dropdown:not(.fr-active)")?b():w(!0)}function rt(){return w()}function b(){var n,i,r;if(t.shared.$f_el)return t.shared.$f_el.hasClass("fr-dropdown")?t.button.click(t.shared.$f_el):t.shared.$f_el.is("button.fr-back")?(t.opts.toolbarInline&&(t.events.disableBlur(),t.events.focus()),n=t.popups.areVisible(t),n&&(t.shared.with_kb=!1),t.button.click(t.shared.$f_el),u(n)):((t.events.disableBlur(),t.button.click(t.shared.$f_el),t.shared.$f_el.attr("data-popup"))?(i=t.popups.areVisible(t),i&&i.data("popup-button",t.shared.$f_el)):t.shared.$f_el.attr("data-modal")&&(r=t.modals.areVisible(t),r&&r.data("modal-button",t.shared.$f_el)),t.shared.$f_el=null),!1}function k(){t.shared.$f_el&&(t.events.disableBlur(),t.shared.$f_el.blur(),t.shared.$f_el=null);!1!==t.events.trigger("toolbar.focusEditor")&&(t.events.disableBlur(),t.events.focus())}function ut(n){if(t.shared.$f_el){var r=a();return r?(t.button.click(r),i(r)):n.parent().find(".fr-back:visible").length?(t.shared.with_kb=!1,t.opts.toolbarInline&&(t.events.disableBlur(),t.events.focus()),t.button.exec(n.parent().find(".fr-back:visible:first")),u(n.parent())):t.shared.$f_el.is("button, .fr-group span")&&(n.parent().is(".fr-popup")?(e(t),t.shared.$f_el=null,!1!==t.events.trigger("toolbar.esc")&&(t.popups.hide(n.parent()),t.opts.toolbarInline&&t.toolbar.showInline(null,!0),u(n.parent()))):k()),!1}}function ft(i,r){var f=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,e=i.which,u=!1;return e!=n.FE.KEYCODE.TAB||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.ARROW_RIGHT||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.TAB||f||!i.shiftKey||i.altKey?e!=n.FE.KEYCODE.ARROW_LEFT||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.ARROW_UP||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.ARROW_DOWN||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.ENTER||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.ESC||f||i.shiftKey||i.altKey?e!=n.FE.KEYCODE.F10||f||i.shiftKey||!i.altKey||(u=l()):u=ut(r):u=b():u=it():u=rt():u=p(r):u=p(r,!0):u=y(r):u=y(r,!0),t.shared.$f_el||void 0!==u||(u=!0),!u&&t.keys.isBrowserAction(i)&&(u=!0),!!u||(i.preventDefault(),i.stopPropagation(),!1)}function d(i){i&&i.length&&(t.events.$on(i,"keydown",function(r){var u,f;return n(r.target).is("a.fr-command, button.fr-command, .fr-group span.fr-command")?(u=i.parents(".fr-popup").data("instance")||i.data("instance")||t,t.shared.with_kb=!0,f=u.accessibility.exec(r,i),t.shared.with_kb=!1,f):!0},!0),t.events.$on(i,"mouseenter","[tabIndex]",function(r){var u=i.parents(".fr-popup").data("instance")||i.data("instance")||t,f;if(!o)return r.stopPropagation(),void r.preventDefault();f=n(r.currentTarget);u.shared.$f_el&&u.shared.$f_el.not(f)&&u.accessibility.focusEditor()},!0))}function et(n){var i=t.popups.get(n),r=ot(n);d(i.find(".fr-buttons"));t.events.$on(i,"mouseenter","tabIndex",r._tiMouseenter,!0);t.events.$on(i.children().not(".fr-buttons"),"keydown","[tabIndex]",r._tiKeydown,!0);t.popups.onHide(n,function(){e(i.data("instance")||t)});t.popups.onShow(n,function(){o=!1;setTimeout(function(){o=!0},0)})}function ot(i){var o=t.popups.get(i);return{_tiKeydown:function(s){var h=o.data("instance")||t,l,c,p,a;if(!1===h.events.trigger("popup.tab",[s]))return!1;if(l=s.which,c=o.find(":focus:first"),n.FE.KEYCODE.TAB==l){s.preventDefault();var w=o.children().not(".fr-buttons"),v=w.find("input, textarea, button, select").filter(":visible").not(".fr-no-touch input, .fr-no-touch textarea, .fr-no-touch button, .fr-no-touch select, :disabled").toArray(),y=v.indexOf(this)+(s.shiftKey?-1:1);if(0<=y&&y<v.length)return h.events.disableBlur(),n(v[y]).focus(),s.stopPropagation(),!1;if((p=o.find(".fr-buttons"),p.length&&r(p,!!s.shiftKey))||f(w))return s.stopPropagation(),!1}else{if(n.FE.KEYCODE.ENTER!=l)return n.FE.KEYCODE.ESC==l?(s.preventDefault(),s.stopPropagation(),e(h),h.popups.isVisible(i)&&o.find(".fr-back:visible").length?(h.opts.toolbarInline&&(h.events.disableBlur(),h.events.focus()),h.button.exec(o.find(".fr-back:visible:first")),u(o)):h.popups.isVisible(i)&&o.find(".fr-dismiss:visible").length?h.button.exec(o.find(".fr-dismiss:visible:first")):(h.popups.hide(i),h.opts.toolbarInline&&h.toolbar.showInline(null,!0),u(o)),!1):n.FE.KEYCODE.SPACE==l&&(c.is(".fr-submit")||c.is(".fr-dismiss"))?(s.preventDefault(),s.stopPropagation(),h.events.disableBlur(),h.button.exec(c),!0):h.keys.isBrowserAction(s)?void s.stopPropagation():c.is("input[type=text], textarea")?void s.stopPropagation():n.FE.KEYCODE.SPACE==l&&(c.is(".fr-link-attr")||c.is("input[type=file]"))?void s.stopPropagation():(s.stopPropagation(),s.preventDefault(),!1);a=null;o.find(".fr-submit:visible").length>0?a=o.find(".fr-submit:visible:first"):o.find(".fr-dismiss:visible").length&&(a=o.find(".fr-dismiss:visible:first"));a&&(s.preventDefault(),s.stopPropagation(),h.events.disableBlur(),h.button.exec(a))}},_tiMouseenter:function(){h(o.data("instance")||t)}}}function u(n){var t=n.data("popup-button");t&&setTimeout(function(){i(t);n.data("popup-button",null)},0)}function st(n){var t=n.data("modal-button");t&&setTimeout(function(){i(t);n.data("modal-button",null)},0)}function ht(){return null!=t.shared.$f_el}function h(n){var i=t.popups.areVisible(n);i&&i.data("popup-button",null)}function g(i){var e=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,r,u;return i.which==n.FE.KEYCODE.F10&&!e&&!i.shiftKey&&i.altKey?(t.shared.with_kb=!0,r=t.popups.areVisible(t),u=!1,r&&(u=f(r.children().not(".fr-buttons"))),u||l(),t.shared.with_kb=!1,i.preventDefault(),i.stopPropagation(),!1):!0}function ct(){t.$wp?t.events.on("keydown",g,!0):t.events.$on(t.$win,"keydown",g,!0);t.events.on("mousedown",function(n){h(t);t.shared.$f_el&&(e(t),n.stopPropagation(),t.events.disableBlur(),t.shared.$f_el=null)},!0);t.events.on("blur",function(){t.shared.$f_el=null;h(t)},!0)}var o=!0;return{_init:ct,registerPopup:et,registerToolbar:d,focusToolbarElement:i,focusToolbar:r,focusContent:f,focusPopup:nt,focusModal:tt,focusEditor:k,focusPopupButton:u,focusModalButton:st,hasFocus:ht,exec:ft,saveSelection:c,restoreSelection:e}};n.FE.MODULES.format=function(t){function o(n,t){var r="<"+n;for(var i in t)t.hasOwnProperty(i)&&(r+=" "+i+'="'+t[i]+'"');return r+">"}function a(n){return"<\/"+n+">"}function i(n,t){var r=n;for(var i in t)t.hasOwnProperty(i)&&(r+="id"==i?"#"+t[i]:"class"==i?"."+t[i]:"["+i+'="'+t[i]+'"]');return r}function r(n,t){return!(!n||n.nodeType!=Node.ELEMENT_NODE)&&(n.matches||n.matchesSelector||n.msMatchesSelector||n.mozMatchesSelector||n.webkitMatchesSelector||n.oMatchesSelector).call(n,t)}function u(i,r,f){var h,e,l,s,c;if(i){if(t.node.isBlock(i))return u(i.firstChild,r,f),!1;for(h=n(o(r,f)).insertBefore(i),e=i;e&&!n(e).is(".fr-marker")&&0===n(e).find(".fr-marker").length&&"UL"!=e.tagName&&"OL"!=e.tagName;)l=e,e=e.nextSibling,h.append(l);if(e)(n(e).find(".fr-marker").length||"UL"==e.tagName||"OL"==e.tagName)&&u(e.firstChild,r,f);else{for(s=h.get(0).parentNode;s&&!s.nextSibling&&!t.node.isElement(s);)s=s.parentNode;s&&(c=s.nextSibling,c&&(t.node.isBlock(c)?u(c.firstChild,r,f):u(c,r,f)))}h.is(":empty")&&h.remove()}}function s(f,e){var s,c,l,h;if(void 0===e&&(e={}),e.style&&delete e.style,t.selection.isCollapsed())t.markers.insert(),t.$el.find(".fr-marker").replaceWith(o(f,e)+n.FE.INVISIBLE_SPACE+n.FE.MARKERS+a(f)),t.selection.restore();else{t.selection.save();u(t.$el.find('.fr-marker[data-type="true"]').get(0).nextSibling,f,e);do for(c=t.$el.find(i(f,e)+" > "+i(f,e)),s=0;s<c.length;s++)c[s].outerHTML=c[s].innerHTML;while(c.length);for(t.el.normalize(),l=t.el.querySelectorAll(".fr-marker"),s=0;s<l.length;s++)h=n(l[s]),!0===h.data("type")?r(h.get(0).nextSibling,i(f,e))&&h.next().prepend(h):r(h.get(0).previousSibling,i(f,e))&&h.prev().append(h);t.selection.restore()}}function f(n,u,f,e){var s,l,a;if(!e){if(s=!1,!0===n.data("type"))for(;t.node.isFirstSibling(n.get(0))&&!n.parent().is(t.$el)&&!n.parent().is("ol")&&!n.parent().is("ul");)n.parent().before(n),s=!0;else if(!1===n.data("type"))for(;t.node.isLastSibling(n.get(0))&&!n.parent().is(t.$el)&&!n.parent().is("ol")&&!n.parent().is("ul");)n.parent().after(n),s=!0;if(s)return!0}if(n.parents(u).length||void 0===u){var c="",h="",o=n.parent();if(o.is(t.$el)||t.node.isBlock(o.get(0)))return!1;for(;!t.node.isBlock(o.parent().get(0))&&(void 0===u||void 0!==u&&!r(o.get(0),i(u,f)));)c+=t.node.closeTagString(o.get(0)),h=t.node.openTagString(o.get(0))+h,o=o.parent();return l=n.get(0).outerHTML,n.replaceWith('<span id="mark"><\/span>'),a=o.html().replace(/<span id="mark"><\/span>/,c+t.node.closeTagString(o.get(0))+h+l+c+t.node.openTagString(o.get(0))+h),o.replaceWith(t.node.openTagString(o.get(0))+a+t.node.closeTagString(o.get(0))),!0}return!1}function e(u,f,o,s){for(var h,y,a,c,v=t.node.contents(u.get(0)),l=0;l<v.length;l++)if(h=v[l],t.node.hasClass(h,"fr-marker"))f=(f+1)%2;else if(f)if(n(h).find(".fr-marker").length>0)f=e(n(h),f,o,s);else{for(y=n(h).find(o||"*"),a=y.length-1;a>=0;a--)c=y[a],t.node.isBlock(c)||t.node.isVoid(c)||void 0!==o&&!r(c,i(o,s))||(c.outerHTML=c.innerHTML);void 0===o&&h.nodeType==Node.ELEMENT_NODE&&!t.node.isVoid(h)&&!t.node.isBlock(h)||r(h,i(o,s))?n(h).replaceWith(h.innerHTML):void 0===o&&h.nodeType==Node.ELEMENT_NODE&&t.node.isBlock(h)&&t.node.clearAttributes(h)}else n(h).find(".fr-marker").length>0&&(f=e(n(h),f,o,s));return f}function h(i,r){var o,s,l,h,u,c;for(void 0===r&&(r={}),r.style&&delete r.style,o=t.selection.isCollapsed(),t.selection.save(),s=!0;s;)for(s=!1,l=t.$el.find(".fr-marker"),h=0;h<l.length;h++)if(u=n(l[h]),c=null,u.attr("data-cloned")||o||(c=u.clone().removeClass("fr-marker").addClass("fr-clone"),!0===u.data("type")?u.attr("data-cloned",!0).after(c):u.attr("data-cloned",!0).before(c)),f(u,i,r,o)){s=!0;break}e(t.$el,0,i,r);o||(t.$el.find(".fr-marker").remove(),t.$el.find(".fr-clone").removeClass("fr-clone").addClass("fr-marker"));o&&t.$el.find(".fr-marker").before(n.FE.INVISIBLE_SPACE).after(n.FE.INVISIBLE_SPACE);t.html.cleanEmptyTags();t.el.normalize();t.selection.restore()}function v(n,t){l(n,t)?h(n,t):s(n,t)}function y(t,i){var r=n(t);r.css(i,"");""===r.attr("style")&&r.replaceWith(r.html())}function p(t,i){return 0===n(t).attr("style").indexOf(i+":")||n(t).attr("style").indexOf(";"+i+":")>=0||n(t).attr("style").indexOf("; "+i+":")>=0}function c(i,r){var o,e,l,b,k,ut,d,s,g,nt,h,tt,ot,st,v,w,a;if(t.selection.isCollapsed())t.markers.insert(),e=t.$el.find(".fr-marker"),l=e.parent(),t.node.openTagString(l.get(0))=='<span style="'+i+": "+l.css(i)+';">'?(t.node.isEmpty(l.get(0))?l.replaceWith('<span style="'+i+": "+r+';">'+n.FE.INVISIBLE_SPACE+n.FE.MARKERS+"<\/span>"):(b={},b[i]=r,f(e,"span",b,!0),e=t.$el.find(".fr-marker"),e.replaceWith('<span style="'+i+": "+r+';">'+n.FE.INVISIBLE_SPACE+n.FE.MARKERS+"<\/span>")),t.html.cleanEmptyTags()):t.node.isEmpty(l.get(0))&&l.is("span")?(e.replaceWith(n.FE.MARKERS),l.css(i,r)):e.replaceWith('<span style="'+i+": "+r+';">'+n.FE.INVISIBLE_SPACE+n.FE.MARKERS+"<\/span>"),t.selection.restore();else{if(t.selection.save(),null==r||"color"==i&&t.$el.find(".fr-marker").parents("u, a").length>0)for(k=t.$el.find(".fr-marker"),o=0;o<k.length;o++)if(e=n(k[o]),!0===e.data("type"))for(;t.node.isFirstSibling(e.get(0))&&!e.parent().is(t.$el)&&!t.node.isElement(e.parent().get(0))&&!t.node.isBlock(e.parent().get(0));)e.parent().before(e);else for(;t.node.isLastSibling(e.get(0))&&!e.parent().is(t.$el)&&!t.node.isElement(e.parent().get(0))&&!t.node.isBlock(e.parent().get(0));)e.parent().after(e);for(ut=t.$el.find('.fr-marker[data-type="true"]').get(0).nextSibling,d={"class":"fr-unprocessed"},r&&(d.style=i+": "+r+";"),u(ut,"span",d),t.$el.find(".fr-marker + .fr-unprocessed").each(function(){n(this).prepend(n(this).prev())}),t.$el.find(".fr-unprocessed + .fr-marker").each(function(){n(this).prev().append(this)}),(r||"").match(/\dem$/)&&t.$el.find("span.fr-unprocessed").removeClass("fr-unprocessed");t.$el.find("span.fr-unprocessed").length>0;){for(s=t.$el.find("span.fr-unprocessed:first").removeClass("fr-unprocessed"),(s.parent().get(0).normalize(),s.parent().is("span")&&1==s.parent().get(0).childNodes.length)&&(s.parent().css(i,r),g=s,s=s.parent(),g.replaceWith(g.html())),nt=s.find("span"),o=nt.length-1;o>=0;o--)y(nt[o],i);for(h=s.parentsUntil(t.$el,"span[style]"),tt=[],o=h.length-1;o>=0;o--)p(h[o],i)||tt.push(h[o]);if(h=h.not(tt),h.length){var ft="",it="",et="",rt="",c=s.get(0);do c=c.parentNode,n(c).addClass("fr-split"),ft+=t.node.closeTagString(c),it=t.node.openTagString(n(c).clone().addClass("fr-split").get(0))+it,h.get(0)!=c&&(et+=t.node.closeTagString(c),rt=t.node.openTagString(n(c).clone().addClass("fr-split").get(0))+rt);while(h.get(0)!=c);ot=ft+t.node.openTagString(n(h.get(0)).clone().css(i,r||"").get(0))+rt+s.css(i,"").get(0).outerHTML+et+"<\/span>"+it;s.replaceWith('<span id="fr-break"><\/span>');st=h.get(0).outerHTML;n(h.get(0)).replaceWith(st.replace(/<span id="fr-break"><\/span>/g,ot))}}for(;t.$el.find(".fr-split:empty").length>0;)t.$el.find(".fr-split:empty").remove();for(t.$el.find(".fr-split").removeClass("fr-split"),t.$el.find('span[style=""]').removeAttr("style"),t.$el.find('span[class=""]').removeAttr("class"),t.html.cleanEmptyTags(),n(t.$el.find("span").get().reverse()).each(function(){this.attributes&&0!==this.attributes.length||n(this).replaceWith(this.innerHTML)}),t.el.normalize(),v=t.$el.find("span[style] + span[style]"),o=0;o<v.length;o++)w=n(v[o]),a=n(v[o]).prev(),w.get(0).previousSibling==a.get(0)&&t.node.openTagString(w.get(0))==t.node.openTagString(a.get(0))&&(w.prepend(a.html()),a.remove());t.$el.find("span[style] span[style]").each(function(){if(n(this).attr("style").indexOf("font-size")>=0){var t=n(this).parents("span[style]");t.attr("style").indexOf("background-color")>=0&&(n(this).attr("style",n(this).attr("style")+";"+t.attr("style")),f(n(this),"span[style]",{},!1))}});t.el.normalize();t.selection.restore()}}function w(n){c(n,null)}function l(n,u){var s,f,o,e;if(void 0===u&&(u={}),u.style&&delete u.style,s=t.selection.ranges(0),f=s.startContainer,f.nodeType==Node.ELEMENT_NODE&&f.childNodes.length>0&&f.childNodes[s.startOffset]&&(f=f.childNodes[s.startOffset]),!s.collapsed&&f.nodeType==Node.TEXT_NODE&&s.startOffset==(f.textContent||"").length){for(;!t.node.isBlock(f.parentNode)&&!f.nextSibling;)f=f.parentNode;f.nextSibling&&(f=f.nextSibling)}for(o=f;o&&o.nodeType==Node.ELEMENT_NODE&&!r(o,i(n,u));)o=o.firstChild;if(o&&o.nodeType==Node.ELEMENT_NODE&&r(o,i(n,u)))return!0;for(e=f,e&&e.nodeType!=Node.ELEMENT_NODE&&(e=e.parentNode);e&&e.nodeType==Node.ELEMENT_NODE&&e!=t.el&&!r(e,i(n,u));)e=e.parentNode;return!(!e||e.nodeType!=Node.ELEMENT_NODE||e==t.el||!r(e,i(n,u)))}return{is:l,toggle:v,apply:s,remove:h,applyStyle:c,removeStyle:w}};n.extend(n.FE.DEFAULTS,{indentMargin:20});n.FE.COMMANDS={bold:{title:"Bold",toggle:!0,refresh:function(n){var t=this.format.is("strong");n.toggleClass("fr-active",t).attr("aria-pressed",t)}},italic:{title:"Italic",toggle:!0,refresh:function(n){var t=this.format.is("em");n.toggleClass("fr-active",t).attr("aria-pressed",t)}},underline:{title:"Underline",toggle:!0,refresh:function(n){var t=this.format.is("u");n.toggleClass("fr-active",t).attr("aria-pressed",t)}},strikeThrough:{title:"Strikethrough",toggle:!0,refresh:function(n){var t=this.format.is("s");n.toggleClass("fr-active",t).attr("aria-pressed",t)}},subscript:{title:"Subscript",toggle:!0,refresh:function(n){var t=this.format.is("sub");n.toggleClass("fr-active",t).attr("aria-pressed",t)}},superscript:{title:"Superscript",toggle:!0,refresh:function(n){var t=this.format.is("sup");n.toggleClass("fr-active",t).attr("aria-pressed",t)}},outdent:{title:"Decrease Indent"},indent:{title:"Increase Indent"},undo:{title:"Undo",undo:!1,forcedRefresh:!0,disabled:!0},redo:{title:"Redo",undo:!1,forcedRefresh:!0,disabled:!0},insertHR:{title:"Insert Horizontal Line"},clearFormatting:{title:"Clear Formatting"},selectAll:{title:"Select All",undo:!1}};n.FE.RegisterCommand=function(t,i){n.FE.COMMANDS[t]=i};n.FE.MODULES.commands=function(t){function f(n){return t.html.defaultTag()&&(n="<"+t.html.defaultTag()+">"+n+"<\/"+t.html.defaultTag()+">"),n}function e(i,u){if(!1!==t.events.trigger("commands.before",n.merge([i],u||[]))){var f=n.FE.COMMANDS[i]&&n.FE.COMMANDS[i].callback||r[i],e=!0,o=!1;n.FE.COMMANDS[i]&&(void 0!==n.FE.COMMANDS[i].focus&&(e=n.FE.COMMANDS[i].focus),void 0!==n.FE.COMMANDS[i].accessibilityFocus&&(o=n.FE.COMMANDS[i].accessibilityFocus));(!t.core.hasFocus()&&e&&!t.popups.areVisible()||!t.core.hasFocus()&&o&&t.accessibility.hasFocus())&&t.events.focus(!0);n.FE.COMMANDS[i]&&!1!==n.FE.COMMANDS[i].undo&&(t.$el.find(".fr-marker").length&&(t.events.disableBlur(),t.selection.restore()),t.undo.saveStep());f&&f.apply(t,n.merge([i],u||[]));t.events.trigger("commands.after",n.merge([i],u||[]));n.FE.COMMANDS[i]&&!1!==n.FE.COMMANDS[i].undo&&t.undo.saveStep()}}function i(n,i){t.format.toggle(i)}function o(i){var u,r;for(t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore(),u=t.selection.blocks(),r=0;r<u.length;r++)if("LI"!=u[r].tagName&&"LI"!=u[r].parentNode.tagName){var f=n(u[r]),e="rtl"==t.opts.direction||"rtl"==f.css("direction")?"margin-right":"margin-left",o=t.helpers.getPX(f.css(e));f.css(e,Math.max(o+i*t.opts.indentMargin,0)||"");f.removeClass("fr-temp-div")}t.selection.save();t.html.unwrap();t.selection.restore()}function h(n){return function(){e(n)}}function c(){t.events.on("keydown",function(n){var i=t.selection.element();if(i&&"HR"==i.tagName&&!t.keys.isArrow(n.which))return n.preventDefault(),!1});t.events.on("keyup",function(i){var r=t.selection.element();if(r&&"HR"==r.tagName)if(i.which==n.FE.KEYCODE.ARROW_LEFT||i.which==n.FE.KEYCODE.ARROW_UP){if(r.previousSibling)return t.node.isBlock(r.previousSibling)?t.selection.setAtEnd(r.previousSibling):n(r).before(n.FE.MARKERS),t.selection.restore(),!1}else if((i.which==n.FE.KEYCODE.ARROW_RIGHT||i.which==n.FE.KEYCODE.ARROW_DOWN)&&r.nextSibling)return t.node.isBlock(r.nextSibling)?t.selection.setAtStart(r.nextSibling):n(r).after(n.FE.MARKERS),t.selection.restore(),!1});t.events.on("mousedown",function(n){if(n.target&&"HR"==n.target.tagName)return n.preventDefault(),n.stopPropagation(),!1});t.events.on("mouseup",function(){var i=t.selection.element();i==t.selection.endElement()&&i&&"HR"==i.tagName&&(i.nextSibling&&(t.node.isBlock(i.nextSibling)?t.selection.setAtStart(i.nextSibling):n(i).after(n.FE.MARKERS)),t.selection.restore())})}var r={bold:function(){i("bold","strong")},subscript:function(){t.format.is("sup")&&t.format.remove("sup");i("subscript","sub")},superscript:function(){t.format.is("sub")&&t.format.remove("sub");i("superscript","sup")},italic:function(){i("italic","em")},strikeThrough:function(){i("strikeThrough","s")},underline:function(){i("underline","u")},undo:function(){t.undo.run()},redo:function(){t.undo.redo()},indent:function(){o(1)},outdent:function(){o(-1)},show:function(){t.opts.toolbarInline&&t.toolbar.showInline(null,!0)},insertHR:function(){var r,i,u,e;t.selection.remove();r="";t.core.isEmpty()&&(r="<br>",r=f(r));t.html.insert('<hr id="fr-just">'+r);i=t.$el.find("hr#fr-just");i.removeAttr("id");0===i.next().length&&(e=t.html.defaultTag(),e?i.after(n("<"+e+">").append("<br>")):i.after("<br>"));i.prev().is("hr")?u=t.selection.setAfter(i.get(0),!1):i.next().is("hr")?u=t.selection.setBefore(i.get(0),!1):t.selection.setAfter(i.get(0),!1)||t.selection.setBefore(i.get(0),!1);u||void 0===u||(r=n.FE.MARKERS+"<br>",r=f(r),i.after(r));t.selection.restore()},clearFormatting:function(){t.format.remove()},selectAll:function(){t.doc.execCommand("selectAll",!1,!1)}},s={};for(var u in r)r.hasOwnProperty(u)&&(s[u]=h(u));return n.extend(s,{exec:e,_init:c})};n.FE.MODULES.data=function(n){function i(n){return n}function o(n){if(!n)return n;for(var f="",o=i("charCodeAt"),c=i("fromCharCode"),e=v.indexOf(n[0]),t=1;t<n.length-2;t++){for(var l=s(++e),r=n[o](t),u="";/[0-9-]/.test(n[t+1]);)u+=n[++t];u=parseInt(u,10)||0;r=h(r,l,u);r^=e-1&31;f+=String[c](r)}return f}function s(n){for(var r=n.toString(),t=0,i=0;i<r.length;i++)t+=parseInt(r.charAt(i),10);return t>10?t%9+1:t}function h(n,t,i){for(var r=Math.abs(i);r-->0;)n-=t;return i<0&&(n+=123),n}function f(n){return!(!n||"block"===n.css("display")||(n.remove(),0))}function c(){return f(r)||f(a)}function e(){return!1}function l(){var f=n.o_win.FEK,h,o,s,l;try{f=f||localStorage&&localStorage.FEK}catch(a){}for(f=f||n.opts.key||[""],h=t(i("ziRA1E3B9pA5B-11D-11xg1A3ZB5D1D4B-11ED2EG2pdeoC1clIH4wB-22yQD5uF4YE3E3A9==")),"string"==typeof f&&(f=[f]),n.ul=!0,o=0;o<f.length;o++)if(s=t(f[o])||"",!(s!==t(i(t("mcVRDoB1BGILD7YFe1BTXBA7B6==")))&&s.indexOf(u,s.length-u.length)<0&&[t("9qqG-7amjlwq=="),t("KA3B3C2A6D1D5H5H1A3=="),t("QzbzvxyB2yA-9m=="),t("ji1kacwmgG5bc=="),t("naamngiA3dA-16xtE-11C-9B1H-8sc==")].indexOf(u)<0)){n.ul=!1;break}l=new Image;0&&n.ul&&(e(),l.src=i(t(h))+"u");n.events.on("contentChanged",function(){!0===n.ul&&c()&&e()});n.events.on("destroy",function(){r&&r.length&&r.remove()},!0)}var r,a,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",u=function(){for(var i=0,n=document.domain,r=n.split("."),t="_gd"+(new Date).getTime();i<r.length-1&&-1==document.cookie.indexOf(t+"="+t);)n=r.slice(-1-++i).join("."),document.cookie=t+"="+t+";domain="+n+";";return document.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+n+";",(n||"").replace(/(^\.*)|(\.*$)/g,"")}(),t=i(o);return{_init:l}};n.extend(n.FE.DEFAULTS,{pastePlain:!1,pasteDeniedTags:["colgroup","col"],pasteDeniedAttrs:["class","id","style"],pasteAllowedStyleProps:[],pasteAllowLocalImages:!1});n.FE.MODULES.paste=function(t){function c(n,i){try{t.win.localStorage.setItem("fr-copied-html",n);t.win.localStorage.setItem("fr-copied-text",i)}catch(r){}}function f(i){var r=t.html.getSelected();c(r,n("<div>").html(r).text());"cut"==i.type&&(t.undo.saveStep(),setTimeout(function(){t.selection.save();t.html.wrap();t.selection.restore();t.events.focus();t.undo.saveStep()},0))}function e(n){var r,f,e;if(h)return!1;if(n.originalEvent&&(n=n.originalEvent),!1===t.events.trigger("paste.before",[n]))return n.preventDefault(),!1;if(nt=t.$win.scrollTop(),n&&n.clipboardData&&n.clipboardData.getData){if(r="",f=n.clipboardData.types,t.helpers.isArray(f))for(e=0;e<f.length;e++)r+=f[e]+";";else r=f;if(i="",/text\/rtf/.test(r)&&(u=n.clipboardData.getData("text/rtf")),/text\/html/.test(r)?i=n.clipboardData.getData("text/html"):/text\/rtf/.test(r)&&t.browser.safari?i=u:/text\/plain/.test(r)&&!t.browser.mozilla&&(i=t.html.escapeEntities(n.clipboardData.getData("text/plain")).replace(/\n/g,"<br>")),""!==i)return o(),n.preventDefault&&(n.stopPropagation(),n.preventDefault()),!1;i=null}return y(),!1}function v(r){var f,e,s,h;if(r.originalEvent&&(r=r.originalEvent),r&&r.dataTransfer&&r.dataTransfer.getData){if(f="",e=r.dataTransfer.types,t.helpers.isArray(e))for(s=0;s<e.length;s++)f+=e[s]+";";else f=e;if(i="",/text\/rtf/.test(f)&&(u=r.dataTransfer.getData("text/rtf")),/text\/html/.test(f)?i=r.dataTransfer.getData("text/html"):/text\/rtf/.test(f)&&t.browser.safari?i=u:/text\/plain/.test(f)&&!this.browser.mozilla&&(i=t.html.escapeEntities(r.dataTransfer.getData("text/plain")).replace(/\n/g,"<br>")),""!==i){if(!1!==t.markers.insertAtPoint(r))return h=t.el.querySelector(".fr-marker"),n(h).replaceWith(n.FE.MARKERS),o(),r.preventDefault&&(r.stopPropagation(),r.preventDefault()),!1}else i=null}}function y(){t.selection.save();t.events.disableBlur();i=null;r?(r.html(""),t.browser.edge&&t.opts.iframe&&t.$el.append(r)):(r=n('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; word-break: break-all; overflow:hidden; z-index: 2147483647; line-height: 140%;" tabIndex="-1"><\/div>'),t.browser.safari?(r.css("top",t.$sc.scrollTop()),t.$el.after(r)):t.browser.edge&&t.opts.iframe?t.$el.append(r):t.$box.after(r),t.events.on("destroy",function(){r.remove()}));r.focus();t.win.setTimeout(o,1)}function p(n){var i,e,h,c,r,s,o,u,f;for(n=n.replace(/<p(.*?)class="?'?MsoListParagraph"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li>$3<\/li><\/ul>"),n=n.replace(/<p(.*?)class="?'?NumberedText"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li>$3<\/li><\/ol>"),n=n.replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li$3>$5<\/li>"),n=n.replace(/<p(.*?)class="?'?NumberedTextCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li$3>$5<\/li>"),n=n.replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5<\/li>"),n=n.replace(/<p(.*?)class="?'?NumberedTextCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5<\/li>"),n=n.replace(/<p(.*?)class="?'?MsoListBullet"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5<\/li>"),n=n.replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5<\/li><\/ul>"),n=n.replace(/<p(.*?)class="?'?NumberedTextCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5<\/li><\/ol>"),n=n.replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span"),n=n.replace(/<!-\[if \!supportLists\]->([\s\S]*?)<!-\[endif\]->/gi,""),n=n.replace(/<!\[if \!supportLists\]>([\s\S]*?)<!\[endif\]>/gi,""),n=n.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),n=n.replace(/<!-[\s\S]*?->/gi,""),n=n.replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,""),e=["style","script","applet","embed","noframes","noscript"],i=0;i<e.length;i++)h=new RegExp("<"+e[i]+".*?"+e[i]+"(.*?)>","gi"),n=n.replace(h,"");n=n.replace(/&nbsp;/gi," ");n=n.replace(/<td([^>]*)><\/td>/g,"<td$1><br><\/td>");n=n.replace(/<th([^>]*)><\/th>/g,"<th$1><br><\/th>");do c=n,n=n.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"");while(n!=c);for(n=n.replace(/<lilevel([^1])([^>]*)>/gi,'<li data-indent="true"$2>'),n=n.replace(/<lilevel1([^>]*)>/gi,"<li$1>"),n=t.clean.html(n,t.opts.pasteDeniedTags,t.opts.pasteDeniedAttrs),n=n.replace(/<a>(.[^<]+)<\/a>/gi,"$1"),n=n.replace(/<br> */g,"<br>"),r=t.o_doc.createElement("div"),r.innerHTML=n,s=r.querySelectorAll("li[data-indent]"),i=0;i<s.length;i++)o=s[i],u=o.previousElementSibling,u&&"LI"==u.tagName?(f=u.querySelector(":scope > ul, :scope > ol"),f||(f=document.createElement("ul"),u.appendChild(f)),f.appendChild(o)):o.removeAttribute("data-indent");return t.html.cleanBlankSpaces(r),n=r.innerHTML}function w(n){var i,r=null,f=t.doc.createElement("div"),u,e;for(f.innerHTML=n,u=f.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote"),i=0;i<u.length;i++)r=u[i],r.outerHTML="<"+(t.html.defaultTag()||"DIV")+">"+r.innerHTML+"<\/"+(t.html.defaultTag()||"DIV")+">";for(u=f.querySelectorAll("*:not("+"p, div, h1, h2, h3, h4, h5, h6, pre, blockquote, ul, ol, li, table, tbody, thead, tr, td, br, img".split(",").join("):not(")+")"),i=u.length-1;i>=0;i--)r=u[i],r.outerHTML=r.innerHTML;return e=function(n){for(var r=t.node.contents(n),i=0;i<r.length;i++)r[i].nodeType!=Node.TEXT_NODE&&r[i].nodeType!=Node.ELEMENT_NODE?r[i].parentNode.removeChild(r[i]):e(r[i])},e(f),f.innerHTML}function o(){t.browser.edge&&t.opts.iframe&&t.$box.after(r);t.keys.forceUndo();a=t.snapshot.get();null===i&&(i=r.get(0).innerHTML,t.selection.restore(),t.events.enableBlur());var n=i.match(/(class=\"?Mso|class=\'?Mso|class="?Xl|class='?Xl|class=Xl|style=\"[^\"]*\bmso\-|style=\'[^\']*\bmso\-|w:WordDocument)/gi),u=t.events.chainTrigger("paste.beforeCleanup",i);u&&"string"==typeof u&&(i=u);(!n||n&&!1!==t.events.trigger("paste.wordPaste",[i]))&&l(i,n)}function l(i,r,u){var f,h=null,e=null,k,ft,d,g,l,nt,o,tt,v,it,rt,c,ut,y;if(i.toLowerCase().indexOf("<body")>=0&&(i=i.replace(/[.\s\S\w\W<>]*<body[^>]*>[\s]*([.\s\S\w\W<>]*)[\s]*<\/body>[.\s\S\w\W<>]*/gi,"$1"),i=i.replace(/ \n/g," ").replace(/\n /g," ").replace(/([^>])\n([^<])/g,"$1 $2")),k=!1,i.indexOf('id="docs-internal-guid')>=0&&(i=i.replace(/^[\w\W\s\S]* id="docs-internal-guid[^>]*>([\w\W\s\S]*)<\/b>[\w\W\s\S]*$/g,"$1"),k=!0),!r){ft=t.opts.htmlAllowedStyleProps;t.opts.htmlAllowedStyleProps=t.opts.pasteAllowedStyleProps;t.opts.htmlAllowComments=!1;i=t.clean.html(i,t.opts.pasteDeniedTags,t.opts.pasteDeniedAttrs);t.opts.htmlAllowedStyleProps=ft;t.opts.htmlAllowComments=!0;i=s(i);i=i.replace(/\r|\n|\t/g,"");d=t.doc.createElement("div");d.innerHTML=i;g=null;l=null;try{g=t.win.localStorage.getItem("fr-copied-html");l=t.win.localStorage.getItem("fr-copied-text")}catch(et){}l&&d.textContent.replace(/(\u00A0)/gi," ").replace(/\r|\n/gi,"")==l.replace(/(\u00A0)/gi," ").replace(/(\r|\n)+([ ]+[\r\n]+)*/gi," ")&&(i=g);i=i.replace(/^ */g,"").replace(/ *$/g,"")}if(!r||t.wordPaste&&u||(i=i.replace(/^\n*/g,"").replace(/^ /g,""),0===i.indexOf("<colgroup>")&&(i="<table>"+i+"<\/table>"),i=p(i),i=s(i)),t.opts.pastePlain&&(i=w(i)),nt=t.events.chainTrigger("paste.afterCleanup",i),"string"==typeof nt&&(i=nt),""!==i){for(o=t.o_doc.createElement("div"),o.innerHTML=i,t.spaces.normalize(o),tt=o.getElementsByTagName("span"),f=tt.length-1;f>=0;f--)v=tt[f],0===v.attributes.length&&(v.outerHTML=v.innerHTML);if(it=t.selection.element(),rt=!1,(it&&n(it).parentsUntil(t.el,"ul, ol").length&&(rt=!0),rt)&&(c=o.children,1==c.length&&["OL","UL"].indexOf(c[0].tagName)>=0&&(c[0].outerHTML=c[0].innerHTML)),!k)for(ut=o.getElementsByTagName("br"),f=ut.length-1;f>=0;f--)y=ut[f],t.node.isBlock(y.previousSibling)&&y.parentNode.removeChild(y);if(t.opts.enter==n.FE.ENTER_BR)for(h=o.querySelectorAll("p, div"),f=h.length-1;f>=0;f--)e=h[f],0===e.attributes.length&&(e.outerHTML=e.innerHTML+(e.nextSibling&&!t.node.isEmpty(e)?"<br>":""));else if(t.opts.enter==n.FE.ENTER_DIV)for(h=o.getElementsByTagName("p"),f=h.length-1;f>=0;f--)e=h[f],e.outerHTML="<div>"+e.innerHTML+"<\/div>";i=o.innerHTML;t.html.insert(i,!0)}b();t.undo.saveStep(a);t.undo.saveStep()}function b(){t.events.trigger("paste.after")}function k(){return u}function s(i){var f,e=t.o_doc.createElement("div"),o,r,u,s,h,c;for(e.innerHTML=i,o=e.querySelectorAll("*:empty:not(td):not(th):not(iframe):not(svg):not("+n.FE.VOID_ELEMENTS.join("):not(")+")");o.length;){for(f=0;f<o.length;f++)o[f].parentNode.removeChild(o[f]);o=e.querySelectorAll("*:empty:not(td):not(th):not(iframe):not(svg):not("+n.FE.VOID_ELEMENTS.join("):not(")+")")}for(r=e.querySelectorAll(":scope > div:not([style]),td > div:not([style]),th > div:not([style]),li > div:not([style])");r.length;)u=r[r.length-1],t.html.defaultTag()&&"div"!=t.html.defaultTag()?u.outerHTML=u.querySelector(t.html.blockTagsQuery())?u.innerHTML:"<"+t.html.defaultTag()+">"+u.innerHTML+"<\/"+t.html.defaultTag()+">":(s=u.querySelectorAll("*"),u.outerHTML=!s.length||"BR"!==s[s.length-1].tagName&&0===u.innerText.length?u.innerHTML+"<br>":u.innerHTML),r=e.querySelectorAll(":scope > div:not([style]),td > div:not([style]),th > div:not([style]),li > div:not([style])");for(r=e.querySelectorAll("div:not([style])");r.length;){for(f=0;f<r.length;f++)h=r[f],c=h.innerHTML.replace(/\u0009/gi,"").trim(),h.outerHTML=c;r=e.querySelectorAll("div:not([style])")}return e.innerHTML}function d(){t.el.addEventListener("copy",f);t.el.addEventListener("cut",f);t.el.addEventListener("paste",e);t.events.on("drop",v);t.browser.msie&&t.browser.version<11&&(t.events.on("mouseup",function(n){2==n.button&&(setTimeout(function(){h=!1},50),h=!0)},!0),t.events.on("beforepaste",e));t.events.on("destroy",g)}function g(){t.el.removeEventListener("copy",f);t.el.removeEventListener("cut",f);t.el.removeEventListener("paste",e)}var nt,i,u,r,a,h=!1;return{_init:d,removeEmptyTags:s,getRtfClipboard:k,saveCopiedText:c,clean:l}};n.extend(n.FE.DEFAULTS,{shortcutsEnabled:[],shortcutsHint:!0});n.FE.SHORTCUTS_MAP={};n.FE.RegisterShortcut=function(t,i,r,u,f,e){n.FE.SHORTCUTS_MAP[(f?"^":"")+(e?"@":"")+t]={cmd:i,val:r,letter:u,shift:f,option:e};n.FE.DEFAULTS.shortcutsEnabled.push(i)};n.FE.RegisterShortcut(n.FE.KEYCODE.E,"show",null,"E",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.B,"bold",null,"B",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.I,"italic",null,"I",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.U,"underline",null,"U",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.S,"strikeThrough",null,"S",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.CLOSE_SQUARE_BRACKET,"indent",null,"]",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.OPEN_SQUARE_BRACKET,"outdent",null,"[",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.Z,"undo",null,"Z",!1,!1);n.FE.RegisterShortcut(n.FE.KEYCODE.Z,"redo",null,"Z",!0,!1);n.FE.MODULES.shortcuts=function(t){function f(i){var u,f;if(!t.opts.shortcutsHint)return null;if(!r){r={};for(u in n.FE.SHORTCUTS_MAP)n.FE.SHORTCUTS_MAP.hasOwnProperty(u)&&t.opts.shortcutsEnabled.indexOf(n.FE.SHORTCUTS_MAP[u].cmd)>=0&&(r[n.FE.SHORTCUTS_MAP[u].cmd+"."+(n.FE.SHORTCUTS_MAP[u].val||"")]={shift:n.FE.SHORTCUTS_MAP[u].shift,option:n.FE.SHORTCUTS_MAP[u].option,letter:n.FE.SHORTCUTS_MAP[u].letter})}return f=r[i],f?(t.helpers.isMac()?String.fromCharCode(8984):"Ctrl+")+(f.shift?t.helpers.isMac()?String.fromCharCode(8679):"Shift+":"")+(f.option?t.helpers.isMac()?String.fromCharCode(8997):"Alt+":"")+f.letter:null}function u(r){var s,h,e,u,f,o;if(!t.core.hasFocus())return!0;if(s=r.which,h=-1!=navigator.userAgent.indexOf("Mac OS X")?r.metaKey:r.ctrlKey,"keyup"==r.type&&i&&s!=n.FE.KEYCODE.META)return i=!1,!1;if("keydown"==r.type&&(i=!1),e=(r.shiftKey?"^":"")+(r.altKey?"@":"")+s,h&&n.FE.SHORTCUTS_MAP[e]&&(u=n.FE.SHORTCUTS_MAP[e].cmd,u&&t.opts.shortcutsEnabled.indexOf(u)>=0)){if(o=n.FE.SHORTCUTS_MAP[e].val,u&&!o?f=t.$tb.find('.fr-command[data-cmd="'+u+'"]'):u&&o&&(f=t.$tb.find('.fr-command[data-cmd="'+u+'"][data-param1="'+o+'"]')),f.length)return r.preventDefault(),r.stopPropagation(),f.parents(".fr-toolbar").data("instance",t),"keydown"==r.type&&(t.button.exec(f),i=!0),!1;if(u&&t.commands[u])return r.preventDefault(),r.stopPropagation(),"keydown"==r.type&&(t.commands[u](),i=!0),!1}}function e(){t.events.on("keydown",u,!0);t.events.on("keyup",u,!0)}var r=null,i=!1;return{_init:e,get:f}};n.FE.MODULES.snapshot=function(n){function u(n){for(var f,e,i=n.parentNode.childNodes,u=0,r=null,t=0;t<i.length;t++){if(r&&(f=i[t].nodeType===Node.TEXT_NODE&&""===i[t].textContent,e=r.nodeType===Node.TEXT_NODE&&i[t].nodeType===Node.TEXT_NODE,f||e||u++),i[t]==n)return u;r=i[t]}}function t(t){var i=[];if(!t.parentNode)return[];for(;!n.node.isElement(t);)i.push(u(t)),t=t.parentNode;return i.reverse()}function i(n,t){for(;n&&n.nodeType===Node.TEXT_NODE;){var i=n.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&(t+=i.textContent.length);n=i}return t}function f(n){return{scLoc:t(n.startContainer),scOffset:i(n.startContainer,n.startOffset),ecLoc:t(n.endContainer),ecOffset:i(n.endContainer,n.endOffset)}}function e(){var t={},r,i;if(n.events.trigger("snapshot.before"),t.html=(n.$wp?n.$el.html():n.$oel.get(0).outerHTML).replace(/ style=""/g,""),t.ranges=[],n.$wp&&n.selection.inEditor()&&n.core.hasFocus())for(r=n.selection.ranges(),i=0;i<r.length;i++)t.ranges.push(f(r[i]));return n.events.trigger("snapshot.after",[t]),t}function r(t){for(var i=n.el,r=0;r<t.length;r++)i=i.childNodes[t[r]];return i}function o(t,i){try{var f=r(i.scLoc),e=i.scOffset,o=r(i.ecLoc),s=i.ecOffset,u=n.doc.createRange();u.setStart(f,e);u.setEnd(o,s);t.addRange(u)}catch(h){}}function s(t){var r,i;for(n.$el.html()!=t.html&&(n.opts.htmlExecuteScripts?n.$el.html(t.html):n.el.innerHTML=t.html),r=n.selection.get(),n.selection.clear(),n.events.focus(!0),i=0;i<t.ranges.length;i++)o(r,t.ranges[i])}function h(t,i){return t.html==i.html&&(!n.core.hasFocus()||JSON.stringify(t.ranges)==JSON.stringify(i.ranges))}return{get:e,restore:s,equal:h}};n.FE.MODULES.undo=function(n){function u(t){var i=t.which;n.keys.ctrlKey(t)&&(90==i&&t.shiftKey&&t.preventDefault(),90==i&&t.preventDefault())}function f(){return!(0===n.undo_stack.length||n.undo_index<=1)}function e(){return n.undo_index!=n.undo_stack.length}function o(r){if(!n.undo_stack||n.undoing||n.el.querySelector(".fr-marker"))return!1;void 0===r?(r=n.snapshot.get(),n.undo_stack[n.undo_index-1]&&n.snapshot.equal(n.undo_stack[n.undo_index-1],r)||(i(),n.undo_stack.push(r),n.undo_index++,r.html!=t&&(n.events.trigger("contentChanged"),t=r.html))):(i(),n.undo_index>0?n.undo_stack[n.undo_index-1]=r:(n.undo_stack.push(r),n.undo_index++))}function i(){if(!n.undo_stack||n.undoing)return!1;for(;n.undo_stack.length>n.undo_index;)n.undo_stack.pop()}function s(){if(n.undo_index>1){n.undoing=!0;var i=n.undo_stack[-n.undo_index-1];clearTimeout(n._content_changed_timer);n.snapshot.restore(i);t=i.html;n.popups.hideAll();n.toolbar.enable();n.events.trigger("contentChanged");n.events.trigger("commands.undo");n.undoing=!1}}function h(){if(n.undo_index<n.undo_stack.length){n.undoing=!0;var i=n.undo_stack[n.undo_index++];clearTimeout(n._content_changed_timer);n.snapshot.restore(i);t=i.html;n.popups.hideAll();n.toolbar.enable();n.events.trigger("contentChanged");n.events.trigger("commands.redo");n.undoing=!1}}function r(){n.undo_index=0;n.undo_stack=[]}function c(){n.undo_stack=[]}function l(){r();n.events.on("initialized",function(){t=(n.$wp?n.$el.html():n.$oel.get(0).outerHTML).replace(/ style=""/g,"")});n.events.on("blur",function(){n.el.querySelector(".fr-dragging")||n.undo.saveStep()});n.events.on("keydown",u);n.events.on("destroy",c)}var t=null;return{_init:l,run:s,redo:h,canDo:f,canRedo:e,dropRedo:i,reset:r,saveStep:o}};n.FE.ICON_DEFAULT_TEMPLATE="font_awesome";n.FE.ICON_TEMPLATES={font_awesome:'<i class="fa fa-[NAME]" aria-hidden="true"><\/i>',text:'<span style="text-align: center;">[NAME]<\/span>',image:"<img src=[SRC] alt=[ALT] />",svg:'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">[PATH]<\/svg>'};n.FE.ICONS={bold:{NAME:"bold"},italic:{NAME:"italic"},underline:{NAME:"underline"},strikeThrough:{NAME:"strikethrough"},subscript:{NAME:"subscript"},superscript:{NAME:"superscript"},color:{NAME:"tint"},outdent:{NAME:"outdent"},indent:{NAME:"indent"},undo:{NAME:"rotate-left"},redo:{NAME:"rotate-right"},insertHR:{NAME:"minus"},clearFormatting:{NAME:"eraser"},selectAll:{NAME:"mouse-pointer"}};n.FE.DefineIconTemplate=function(t,i){n.FE.ICON_TEMPLATES[t]=i};n.FE.DefineIcon=function(t,i){n.FE.ICONS[t]=i};n.FE.MODULES.icon=function(){function t(t){var u=null,r=n.FE.ICONS[t],i;return void 0!==r&&(i=r.template||n.FE.ICON_DEFAULT_TEMPLATE,i&&(i=n.FE.ICON_TEMPLATES[i])&&(u=i.replace(/\[([a-zA-Z]*)\]/g,function(n,i){return"NAME"==i?r[i]||t:r[i]}))),u||t}function i(t){var i=n.FE.ICONS[t],r=n.FE.ICON_DEFAULT_TEMPLATE;return void 0!==i?r=i.template||n.FE.ICON_DEFAULT_TEMPLATE:r}return{create:t,getTemplate:i}};n.extend(n.FE.DEFAULTS,{tooltips:!0});n.FE.MODULES.tooltip=function(t){function i(){t.$tooltip&&t.$tooltip.removeClass("fr-visible").css("left","-3000px").css("position","fixed")}function r(i,r){var u,e;if(i.data("title")||i.data("title",i.attr("title")),!i.data("title"))return!1;t.$tooltip||f();i.removeAttr("title");t.$tooltip.text(t.language.translate(i.data("title")));t.$tooltip.addClass("fr-visible");u=i.offset().left+(i.outerWidth()-t.$tooltip.outerWidth())/2;u<0&&(u=0);u+t.$tooltip.outerWidth()>n(t.o_win).width()&&(u=n(t.o_win).width()-t.$tooltip.outerWidth());void 0===r&&(r=t.opts.toolbarBottom);e=r?i.offset().top-t.$tooltip.height():i.offset().top+i.outerHeight();t.$tooltip.css("position","");t.$tooltip.css("left",u);t.$tooltip.css("top",Math.ceil(e));"static"!=n(t.o_doc).find("body:first").css("position")?(t.$tooltip.css("margin-left",-n(t.o_doc).find("body:first").offset().left),t.$tooltip.css("margin-top",-n(t.o_doc).find("body:first").offset().top)):(t.$tooltip.css("margin-left",""),t.$tooltip.css("margin-top",""))}function u(u,f,e){t.opts.tooltips&&!t.helpers.isMobile()&&(t.events.$on(u,"mouseenter",f,function(i){t.node.hasClass(i.currentTarget,"fr-disabled")||t.edit.isDisabled()||r(n(i.currentTarget),e)},!0),t.events.$on(u,"mouseleave "+t._mousedown+" "+t._mouseup,f,function(){i()},!0))}function f(){t.opts.tooltips&&!t.helpers.isMobile()&&(t.shared.$tooltip?t.$tooltip=t.shared.$tooltip:(t.shared.$tooltip=n('<div class="fr-tooltip"><\/div>'),t.$tooltip=t.shared.$tooltip,t.opts.theme&&t.$tooltip.addClass(t.opts.theme+"-theme"),n(t.o_doc).find("body:first").append(t.$tooltip)),t.events.on("shared.destroy",function(){t.$tooltip.html("").removeData().remove();t.$tooltip=null},!0))}return{hide:i,to:r,bind:u}};n.FE.MODULES.button=function(t){function s(t,i,r){for(var f,o,u=n(),e=0;e<t.length;e++)f=n(t[e]),(f.is(i)&&(u=u.add(f)),r&&f.is(".fr-dropdown"))&&(o=f.next().find(i),u=u.add(o));return u}function e(r,f){var o,e=n(),h,c,l,a;if(!r)return e;e=e.add(s(u,r,f));e=e.add(s(i,r,f));for(o in t.shared.popups)t.shared.popups.hasOwnProperty(o)&&(h=t.shared.popups[o],c=h.children().find(r),e=e.add(c));for(o in t.shared.modals)t.shared.modals.hasOwnProperty(o)&&(l=t.shared.modals[o],a=l.$modal.find(r),e=e.add(a));return e}function v(i){var r=i.next(),c=t.node.hasClass(i.get(0),"fr-active"),s=e(".fr-dropdown.fr-active").not(i),u=i.parents(".fr-toolbar, .fr-popup").data("instance")||t,f,h,o;(u.helpers.isIOS()&&!u.el.querySelector(".fr-marker")&&(u.selection.save(),u.selection.clear(),u.selection.restore()),c)||(f=i.data("cmd"),r.find(".fr-command").removeClass("fr-active").attr("aria-selected",!1),n.FE.COMMANDS[f]&&n.FE.COMMANDS[f].refreshOnShow&&n.FE.COMMANDS[f].refreshOnShow.apply(u,[i,r]),r.css("left",i.offset().left-i.parent().offset().left-("rtl"==t.opts.direction?r.width()-i.outerWidth():0)),r.addClass("test-height"),h=r.outerHeight(),r.removeClass("test-height"),r.css("top","").css("bottom",""),!t.opts.toolbarBottom&&r.offset().top+i.outerHeight()+h<n(t.o_doc).height()?r.css("top",i.position().top+i.outerHeight()):r.css("bottom",t.$tb.height()-i.position().top));i.addClass("fr-blink").toggleClass("fr-active");i.hasClass("fr-active")?(r.attr("aria-hidden",!1),i.attr("aria-expanded",!0)):(r.attr("aria-hidden",!0),i.attr("aria-expanded",!1));setTimeout(function(){i.removeClass("fr-blink")},300);r.css("margin-left","");r.offset().left+r.outerWidth()>t.$sc.offset().left+t.$sc.width()&&r.css("margin-left",-(r.offset().left+r.outerWidth()-t.$sc.offset().left-t.$sc.width()));s.removeClass("fr-active").attr("aria-expanded",!1).next().attr("aria-hidden",!0);s.parent(".fr-toolbar:not(.fr-inline)").css("zIndex","");0!==i.parents(".fr-popup").length||t.opts.toolbarInline||(t.node.hasClass(i.get(0),"fr-active")?t.$tb.css("zIndex",(t.opts.zIndex||1)+4):t.$tb.css("zIndex",""));o=r.find("a.fr-command.fr-active:first");t.helpers.isMobile()||(o.length?t.accessibility.focusToolbarElement(o):t.accessibility.focusToolbarElement(i))}function h(n){var r,t,i;for(n.addClass("fr-blink"),setTimeout(function(){n.removeClass("fr-blink")},500),r=n.data("cmd"),t=[];void 0!==n.data("param"+(t.length+1));)t.push(n.data("param"+(t.length+1)));i=e(".fr-dropdown.fr-active");i.length&&(i.removeClass("fr-active").attr("aria-expanded",!1).next().attr("aria-hidden",!0),i.parent(".fr-toolbar:not(.fr-inline)").css("zIndex",""));n.parents(".fr-popup, .fr-toolbar").data("instance").commands.exec(r,t)}function y(n){h(n)}function c(i){var r=i.parents(".fr-popup, .fr-toolbar").data("instance"),u;if(0!==i.parents(".fr-popup").length||i.data("popup")||r.popups.hideAll(),r.popups.areVisible()&&!r.popups.areVisible(r)){for(u=0;u<n.FE.INSTANCES.length;u++)n.FE.INSTANCES[u]!=r&&n.FE.INSTANCES[u].popups&&n.FE.INSTANCES[u].popups.areVisible()&&n.FE.INSTANCES[u].$el.find(".fr-marker").remove();r.popups.hideAll()}t.node.hasClass(i.get(0),"fr-dropdown")?v(i):(y(i),n.FE.COMMANDS[i.data("cmd")]&&!1!==n.FE.COMMANDS[i.data("cmd")].refreshAfterCallback&&r.button.bulkRefresh())}function p(t){c(n(t.currentTarget))}function l(n){var t=n.find(".fr-dropdown.fr-active");t.length&&(t.removeClass("fr-active").attr("aria-expanded",!1).next().attr("aria-hidden",!0),t.parent(".fr-toolbar:not(.fr-inline)").css("zIndex",""))}function w(n){n.preventDefault();n.stopPropagation()}function b(n){if(n.stopPropagation(),!t.helpers.isMobile())return!1}function k(r,f){t.events.bindClick(r,".fr-command:not(.fr-disabled)",p);t.events.$on(r,t._mousedown+" "+t._mouseup+" "+t._move,".fr-dropdown-menu",w,!0);t.events.$on(r,t._mousedown+" "+t._mouseup+" "+t._move,".fr-dropdown-menu .fr-dropdown-wrapper",b,!0);var e=r.get(0).ownerDocument,s="defaultView"in e?e.defaultView:e.parentWindow,o=function(i){i&&(i.type!=t._mouseup||i.target==n("html").get(0))&&("keydown"!=i.type||(!t.keys.isCharacter(i.which)||t.keys.ctrlKey(i))&&i.which!=n.FE.KEYCODE.ESC)||l(r)};t.events.$on(n(s),t._mouseup+" resize keydown",o,!0);t.opts.iframe&&t.events.$on(t.$win,t._mouseup,o,!0);t.node.hasClass(r.get(0),"fr-popup")?n.merge(i,r.find(".fr-btn").toArray()):n.merge(u,r.find(".fr-btn").toArray());t.tooltip.bind(r,".fr-btn, .fr-title",f)}function d(n,i){var f="",r,u,e;if(i.html)f+="function"==typeof i.html?i.html.call(t):i.html;else{r=i.options;"function"==typeof r&&(r=r());f+='<ul class="fr-dropdown-list" role="presentation">';for(u in r)r.hasOwnProperty(u)&&(e=t.shortcuts.get(n+"."+u),e=e?'<span class="fr-shortcut">'+e+"<\/span>":"",f+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="'+n+'" data-param1="'+u+'" title="'+r[u]+'">'+t.language.translate(r[u])+"<\/a><\/li>");f+="<\/ul>"}return f}function g(n,i,r){var u,f,h,o;if(t.helpers.isMobile()&&!1===i.showOnMobile)return"";u=i.displaySelection;"function"==typeof u&&(u=u(t));u?(h="function"==typeof i.defaultSelection?i.defaultSelection(t):i.defaultSelection,f='<span style="width:'+(i.displaySelectionWidth||100)+'px">'+t.language.translate(h||i.title)+"<\/span>"):(f=t.icon.create(i.icon||n),f+='<span class="fr-sr-only">'+(t.language.translate(i.title)||"")+"<\/span>");var a=i.popup?' data-popup="true"':"",v=i.modal?' data-modal="true"':"",e=t.shortcuts.get(n+".");e=e?" ("+e+")":"";var s=n+"-"+t.id,c="dropdown-menu-"+s,l='<button id="'+s+'"type="button" tabIndex="-1" role="button"'+(i.toggle?' aria-pressed="false"':"")+("dropdown"==i.type?' aria-controls="'+c+'" aria-expanded="false" aria-haspopup="true"':"")+(i.disabled?' aria-disabled="true"':"")+' title="'+(t.language.translate(i.title)||"")+e+'" class="fr-command fr-btn'+("dropdown"==i.type?" fr-dropdown":"")+" fr-btn-"+t.icon.getTemplate(i.icon)+(i.displaySelection?" fr-selection":"")+(i.back?" fr-back":"")+(i.disabled?" fr-disabled":"")+(r?"":" fr-hidden")+'" data-cmd="'+n+'"'+a+v+">"+f+"<\/button>";return"dropdown"==i.type&&(o='<div id="'+c+'" class="fr-dropdown-menu" role="listbox" aria-labelledby="'+s+'" aria-hidden="true"><div class="fr-dropdown-wrapper" role="presentation"><div class="fr-dropdown-content" role="presentation">',o+=d(n,i),o+="<\/div><\/div><\/div>",l+=o),l}function nt(i,r){for(var u,f,s,e="",o=0;o<i.length;o++)u=i[o],f=n.FE.COMMANDS[u],f&&void 0!==f.plugin&&t.opts.pluginsEnabled.indexOf(f.plugin)<0||(f?(s=void 0===r||r.indexOf(u)>=0,e+=g(u,f,s)):"|"==u?e+='<div class="fr-separator fr-vs" role="separator" aria-orientation="vertical"><\/div>':"-"==u&&(e+='<div class="fr-separator fr-hs" role="separator" aria-orientation="horizontal"><\/div>'));return e}function tt(i){var u,f=i.parents(".fr-popup, .fr-toolbar").data("instance")||t,r=i.data("cmd");t.node.hasClass(i.get(0),"fr-dropdown")?u=i.next():(i.removeClass("fr-active"),i.attr("aria-pressed")&&i.attr("aria-pressed",!1));n.FE.COMMANDS[r]&&n.FE.COMMANDS[r].refresh?n.FE.COMMANDS[r].refresh.apply(f,[i,u]):t.refresh[r]&&f.refresh[r](i,u)}function a(i){var r=t.$tb?t.$tb.data("instance")||t:t;if(!1===t.events.trigger("buttons.refresh"))return!0;setTimeout(function(){for(var u,e,o=r.selection.inEditor()&&r.core.hasFocus(),f=0;f<i.length;f++)u=n(i[f]),e=u.data("cmd"),0===u.parents(".fr-popup").length?o||n.FE.COMMANDS[e]&&n.FE.COMMANDS[e].forcedRefresh?r.button.refresh(u):t.node.hasClass(u.get(0),"fr-dropdown")||(u.removeClass("fr-active"),u.attr("aria-pressed")&&u.attr("aria-pressed",!1)):u.parents(".fr-popup").is(":visible")&&r.button.refresh(u)},0)}function f(){a(u);a(i)}function it(){u=[];i=[]}function r(){clearTimeout(o);o=setTimeout(f,50)}function rt(){t.opts.toolbarInline?t.events.on("toolbar.show",f):(t.events.on("mouseup",r),t.events.on("keyup",r),t.events.on("blur",r),t.events.on("focus",r),t.events.on("contentChanged",r),t.helpers.isMobile()&&t.events.$on(t.$doc,"selectionchange",f));t.events.on("shared.destroy",it)}var u=[],i,o;return(t.opts.toolbarInline||t.opts.toolbarContainer)&&(t.shared.buttons||(t.shared.buttons=[]),u=t.shared.buttons),i=[],t.shared.popup_buttons||(t.shared.popup_buttons=[]),i=t.shared.popup_buttons,o=null,{_init:rt,buildList:nt,bindCommands:k,refresh:tt,bulkRefresh:f,exec:h,click:c,hideActiveDropdowns:l,getButtons:e}};n.FE.MODULES.modals=function(t){function e(n){return i[n]}function o(i,r){var u='<div tabIndex="-1" class="fr-modal'+(t.opts.theme?" "+t.opts.theme+"-theme":"")+'"><div class="fr-modal-wrapper">';return u+='<div class="fr-modal-head">'+i+'<i title="'+t.language.translate("Cancel")+'" class="fa fa-times fr-modal-close"><\/i><\/div>',u+='<div tabIndex="-1" class="fr-modal-body">'+r+"<\/div>",u+="<\/div><\/div>",n(u)}function s(f,e,s){if(t.shared.$overlay||(t.shared.$overlay=n('<div class="fr-overlay">').appendTo("body:first")),r=t.shared.$overlay,t.opts.theme&&r.addClass(t.opts.theme+"-theme"),!i[f]){var h=o(e,s);i[f]={$modal:h,$head:h.find(".fr-modal-head"),$body:h.find(".fr-modal-body")};t.helpers.isMobile()||h.addClass("fr-desktop");h.appendTo("body:first");t.events.bindClick(h,"i.fr-modal-close",function(){u(f)});i[f].$body.css("margin-top",i[f].$head.outerHeight());t.events.$on(h,"keydown",function(i){var r=i.which;return r==n.FE.KEYCODE.ESC?(u(f),t.accessibility.focusModalButton(h),!1):!(!n(i.currentTarget).is("input[type=text], textarea")&&r!=n.FE.KEYCODE.ARROW_UP&&r!=n.FE.KEYCODE.ARROW_DOWN&&!t.keys.isBrowserAction(i))||(i.preventDefault(),i.stopPropagation(),!1)},!0);u(f,!0)}return i[f]}function h(){var t,n;for(t in i)n=i[t],n&&n.$modal&&n.$modal.removeData().remove();r&&r.removeData().remove();i={}}function c(u){if(i[u]){var f=i[u].$modal;f.data("instance",t);f.show();r.show();n(t.o_doc).find("body:first").addClass("prevent-scroll");t.helpers.isMobile()&&n(t.o_doc).find("body:first").addClass("fr-mobile");f.addClass("fr-active");t.accessibility.focusModal(f)}}function u(u,f){if(i[u]){var e=i[u].$modal,o=e.data("instance")||t;o.events.enableBlur();e.hide();r.hide();n(o.o_doc).find("body:first").removeClass("prevent-scroll fr-mobile");e.removeClass("fr-active");f||(t.accessibility.restoreSelection(o),t.events.trigger("modals.hide"))}}function l(r){if(i[r]){var f=i[r],h=f.$modal,u=f.$body,c=n(t.o_win).height(),e=h.find(".fr-modal-wrapper"),l=e.outerHeight(!0),a=e.height()-(u.outerHeight(!0)-u.height()),o=c-l+a,v=u.get(0).scrollHeight,s="auto";v>o&&(s=o);u.height(s)}}function f(n){var r;if("string"==typeof n){if(!i[n])return;r=i[n].$modal}else r=n;return r&&t.node.hasClass(r,"fr-active")&&t.core.sameInstance(r)||!1}function a(n){for(var t in i)if(i.hasOwnProperty(t)&&f(t)&&(void 0===n||i[t].$modal.data("instance")==n))return i[t].$modal;return!1}function v(){t.events.on("shared.destroy",h,!0)}t.shared.modals||(t.shared.modals={});var r,i=t.shared.modals;return{_init:v,get:e,create:s,show:c,hide:u,resize:l,isVisible:f,areVisible:a}};n.FE.POPUP_TEMPLATES={"text.edit":"[_EDIT_]"};n.FE.RegisterTemplate=function(t,i){n.FE.POPUP_TEMPLATES[t]=i};n.FE.MODULES.popups=function(t){function s(n,r){r.is(":visible")||(r=t.$sc);r.is(i[n].data("container"))||(i[n].data("container",r),r.append(i[n]))}function v(n,h,c,l){var v,p,y,a;if(u()&&t.$el.find(".fr-marker").length>0?(t.events.disableBlur(),t.selection.restore()):(t.events.disableBlur(),t.events.focus(),t.events.enableBlur()),e([n]),!i[n])return!1;v=t.button.getButtons(".fr-dropdown.fr-active");v.removeClass("fr-active").attr("aria-expanded",!1).parent(".fr-toolbar").css("zIndex","");v.next().attr("aria-hidden",!0);i[n].data("instance",t);t.$tb&&t.$tb.data("instance",t);p=i[n].outerWidth();y=r(n);i[n].addClass("fr-active").removeClass("fr-hidden").find("input, textarea").removeAttr("disabled");a=i[n].data("container");t.opts.toolbarInline&&a&&t.$tb&&a.get(0)==t.$tb.get(0)&&(s(n,t.$sc),c=t.$tb.offset().top-t.helpers.getPX(t.$tb.css("margin-top")),h=t.$tb.offset().left+t.$tb.outerWidth()/2+(parseFloat(t.$tb.find(".fr-arrow").css("margin-left"))||0)+t.$tb.find(".fr-arrow").outerWidth()/2,t.node.hasClass(t.$tb.get(0),"fr-above")&&c&&(c+=t.$tb.outerHeight()),l=0);a=i[n].data("container");!t.opts.iframe||l||y||(h&&(h-=t.$iframe.offset().left),c&&(c-=t.$iframe.offset().top));a.is(t.$tb)?t.$tb.css("zIndex",(t.opts.zIndex||1)+4):i[n].css("zIndex",(t.opts.zIndex||1)+4);h&&(h-=p/2);t.opts.toolbarBottom&&a&&t.$tb&&a.get(0)==t.$tb.get(0)&&(i[n].addClass("fr-above"),c&&(c-=i[n].outerHeight()));i[n].removeClass("fr-active");t.position.at(h,c,i[n],l||0);i[n].addClass("fr-active");y||t.accessibility.focusPopup(i[n]);t.opts.toolbarInline&&t.toolbar.hide();t.events.trigger("popups.show."+n);o(n)._repositionPopup();f()}function y(n,i){t.events.on("popups.show."+n,i)}function r(n){return i[n]&&t.node.hasClass(i[n],"fr-active")&&t.core.sameInstance(i[n])||!1}function u(n){for(var t in i)if(i.hasOwnProperty(t)&&r(t)&&(void 0===n||i[t].data("instance")==n))return i[t];return!1}function h(n){var r=null;(r="string"!=typeof n?n:i[n])&&t.node.hasClass(r,"fr-active")&&(r.removeClass("fr-active fr-above"),t.events.trigger("popups.hide."+n),t.$tb&&(t.opts.zIndex>1?t.$tb.css("zIndex",t.opts.zIndex+1):t.$tb.css("zIndex","")),t.events.disableBlur(),r.find("input, textarea, button").filter(":focus").blur(),r.find("input, textarea").attr("disabled","disabled"))}function p(n,i){t.events.on("popups.hide."+n,i)}function w(n){var r=i[n];return r&&!r.data("inst"+t.id)&&a(o(n),n),r}function b(n,i){t.events.on("popups.refresh."+n,i)}function k(r){var f,u,e;for(i[r].data("instance",t),t.events.trigger("popups.refresh."+r),f=i[r].find(".fr-command"),u=0;u<f.length;u++)e=n(f[u]),0===e.parents(".fr-dropdown-menu").length&&t.button.refresh(e)}function e(n){void 0===n&&(n=[]);for(var t in i)i.hasOwnProperty(t)&&n.indexOf(t)<0&&h(t)}function c(){t.shared.exit_flag=!0}function f(){t.shared.exit_flag=!1}function l(){return t.shared.exit_flag}function d(i,r){var u=n.FE.POPUP_TEMPLATES[i],f;"function"==typeof u&&(u=u.apply(t));for(f in r)r.hasOwnProperty(f)&&(u=u.replace("[_"+f.toUpperCase()+"_]",r[f]));return u}function g(r,u){var o=d(r,u),f=n('<div class="fr-popup'+(t.helpers.isMobile()?" fr-mobile":" fr-desktop")+(t.opts.toolbarInline?" fr-inline":"")+'"><span class="fr-arrow"><\/span>'+o+"<\/div>"),e;return t.opts.theme&&f.addClass(t.opts.theme+"-theme"),t.opts.zIndex>1&&t.$tb.css("z-index",t.opts.zIndex+2),"auto"!=t.opts.direction&&f.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),f.find("input, textarea").attr("dir",t.opts.direction).attr("disabled","disabled"),e=n("body:first"),e.append(f),f.data("container",e),i[r]=f,t.button.bindCommands(f,!1),f}function o(u){var e=i[u];return{_windowResize:function(){var n=e.data("instance")||t;!n.helpers.isMobile()&&e.is(":visible")&&(n.events.disableBlur(),n.popups.hide(u),n.events.enableBlur())},_inputFocus:function(i){var r=e.data("instance")||t,u=n(i.currentTarget),f;(u.is("input:file")&&u.closest(".fr-layer").addClass("fr-input-focus"),i.preventDefault(),i.stopPropagation(),setTimeout(function(){r.events.enableBlur()},100),r.helpers.isMobile())&&(f=n(r.o_win).scrollTop(),setTimeout(function(){n(r.o_win).scrollTop(f)},0))},_inputBlur:function(i){var r=e.data("instance")||t,u=n(i.currentTarget);u.is("input:file")&&u.closest(".fr-layer").removeClass("fr-input-focus");document.activeElement!=this&&n(this).is(":visible")&&(r.events.blurActive()&&r.events.trigger("blur"),r.events.enableBlur())},_editorKeydown:function(i){var f=e.data("instance")||t;f.keys.ctrlKey(i)||i.which==n.FE.KEYCODE.ALT||i.which==n.FE.KEYCODE.ESC||(r(u)&&e.find(".fr-back:visible").length?f.button.exec(e.find(".fr-back:visible:first")):i.which!=n.FE.KEYCODE.ALT&&f.popups.hide(u))},_preventFocus:function(i){var o=e.data("instance")||t,r=i.originalEvent?i.originalEvent.target||i.originalEvent.originalTarget:null,u;if("mouseup"==i.type||n(r).is(":focus")||o.events.disableBlur(),"mouseup"!=i.type||n(r).hasClass("fr-command")||n(r).parents(".fr-command").length>0||t.button.hideActiveDropdowns(e),(t.browser.safari||t.browser.mozilla)&&"mousedown"==i.type&&n(r).is("input[type=file]")&&o.events.disableBlur(),u="input, textarea, button, select, label, .fr-command",r&&!n(r).is(u)&&0===n(r).parents(u).length)return i.stopPropagation(),!1;r&&n(r).is(u)&&i.stopPropagation();f()},_editorMouseup:function(){e.is(":visible")&&l()&&e.find("input:focus, textarea:focus, button:focus, select:focus").filter(":visible").length>0&&t.events.disableBlur()},_windowMouseup:function(n){if(!t.core.sameInstance(e))return!0;var i=e.data("instance")||t;e.is(":visible")&&l()&&(n.stopPropagation(),i.markers.remove(),i.popups.hide(u),f())},_windowKeydown:function(i){if(!t.core.sameInstance(e))return!0;var r=e.data("instance")||t,f=i.which;if(n.FE.KEYCODE.ESC==f){if(r.popups.isVisible(u)&&r.opts.toolbarInline)return i.stopPropagation(),r.popups.isVisible(u)&&(e.find(".fr-back:visible").length?(r.button.exec(e.find(".fr-back:visible:first")),r.accessibility.focusPopupButton(e)):e.find(".fr-dismiss:visible").length?r.button.exec(e.find(".fr-dismiss:visible:first")):(r.popups.hide(u),r.toolbar.showInline(null,!0),r.accessibility.FocusPopupButton(e))),!1;if(r.popups.isVisible(u))return e.find(".fr-back:visible").length?(r.button.exec(e.find(".fr-back:visible:first")),r.accessibility.focusPopupButton(e)):e.find(".fr-dismiss:visible").length?r.button.exec(e.find(".fr-dismiss:visible:first")):(r.popups.hide(u),r.accessibility.focusPopupButton(e)),!1}},_doPlaceholder:function(){0===n(this).next().length&&n(this).attr("placeholder")&&n(this).after('<label for="'+n(this).attr("id")+'">'+n(this).attr("placeholder")+"<\/label>");n(this).toggleClass("fr-not-empty",""!==n(this).val())},_repositionPopup:function(){if(!t.opts.height&&!t.opts.heightMax||t.opts.toolbarInline)return!0;if(t.$wp&&r(u)&&e.parent().get(0)==t.$sc.get(0)){var n=e.offset().top-t.$wp.offset().top,i=t.$wp.outerHeight();t.node.hasClass(e.get(0),"fr-above")&&(n+=e.outerHeight());n>i||n<0?e.addClass("fr-hidden"):e.removeClass("fr-hidden")}}}}function a(n,r){t.events.on("mouseup",n._editorMouseup,!0);t.$wp&&t.events.on("keydown",n._editorKeydown);t.events.on("blur",function(){u()&&t.markers.remove();e()});t.$wp&&!t.helpers.isMobile()&&t.events.$on(t.$wp,"scroll.popup"+r,n._repositionPopup);t.events.on("window.mouseup",n._windowMouseup,!0);t.events.on("window.keydown",n._windowKeydown,!0);i[r].data("inst"+t.id,!0);t.events.on("destroy",function(){t.core.sameInstance(i[r])&&i[r].removeClass("fr-active").appendTo("body:first")},!0)}function nt(i,r){var u=g(i,r),f=o(i);return a(f,i),t.events.$on(u,"mousedown mouseup touchstart touchend touch","*",f._preventFocus,!0),t.events.$on(u,"focus","input, textarea, button, select",f._inputFocus,!0),t.events.$on(u,"blur","input, textarea, button, select",f._inputBlur,!0),t.accessibility.registerPopup(i),t.events.$on(u,"keydown keyup change input","input, textarea",f._doPlaceholder,!0),t.helpers.isIOS()&&t.events.$on(u,"touchend","label",function(){n("#"+n(this).attr("for")).prop("checked",function(n,t){return!t})},!0),t.events.$on(n(t.o_win),"resize",f._windowResize,!0),u}function tt(){var n,t;for(n in i)i.hasOwnProperty(n)&&(t=i[n],t&&(t.html("").removeData().remove(),i[n]=null));i=[]}function it(){t.events.on("shared.destroy",tt,!0);t.events.on("window.mousedown",c);t.events.on("window.touchmove",f);t.events.on("mousedown",function(n){u()&&(n.stopPropagation(),t.$el.find(".fr-marker").remove(),c(),t.events.disableBlur())})}t.shared.popups||(t.shared.popups={});var i=t.shared.popups;return t.shared.exit_flag=!1,{_init:it,create:nt,get:w,show:v,hide:h,onHide:p,hideAll:e,setContainer:s,refresh:k,onRefresh:b,onShow:y,isVisible:r,areVisible:u}};n.FE.MODULES.position=function(t){function r(){var e=t.selection.ranges(0),n=e.getBoundingClientRect(),r,i,u,f;return(0===n.top&&0===n.left&&0===n.width||0===n.height)&&(r=!1,0===t.$el.find(".fr-marker").length&&(t.selection.save(),r=!0),i=t.$el.find(".fr-marker:first"),i.css("display","inline"),i.css("line-height",""),u=i.offset(),f=i.outerHeight(),i.css("display","none"),i.css("line-height",0),n={},n.left=u.left,n.width=0,n.height=f,n.top=u.top-(t.helpers.isMobile()?0:t.helpers.scrollTop()),n.right=1,n.bottom=1,n.ok=!0,r&&t.selection.restore()),n}function e(n,i,r){var e=n.outerHeight(!0),f,u,o;return!t.helpers.isMobile()&&t.$tb&&n.parent().get(0)!=t.$tb.get(0)&&(f=n.parent().offset().top,u=i-e-(r||0),n.parent().get(0)==t.$sc.get(0)&&(f-=n.parent().position().top),o=t.$sc.get(0).scrollHeight,f+i+e>t.$sc.offset().top+o&&n.parent().offset().top+u>0&&u>0?(i=u,n.addClass("fr-above")):n.removeClass("fr-above")),i}function o(n,i){var r=n.outerWidth(!0);return n.parent().offset().left+i+r>t.$sc.get(0).clientWidth-t.$sc.position().left-10&&(i=t.$sc.get(0).clientWidth-n.parent().offset().left-r-10),i<0&&(i=10),i}function s(n){var i=r(),f,e;n.css({top:0,left:0});f=i.top+i.height;e=i.left+i.width/2-n.get(0).offsetWidth/2+t.helpers.scrollLeft();t.opts.iframe||(f+=t.helpers.scrollTop());u(e,f,n,i.height)}function u(n,i,r,u){var f=r.data("container"),h,s;f&&("BODY"!==f.get(0).tagName||"static"!=f.css("position"))&&(n&&(n-=f.offset().left),i&&(i-=f.offset().top),"BODY"!=f.get(0).tagName?(n&&(n+=f.get(0).scrollLeft),i&&(i+=f.get(0).scrollTop)):"absolute"==f.css("position")&&(n&&(n+=f.position().left),i&&(i+=f.position().top)));t.opts.iframe&&f&&t.$tb&&f.get(0)!=t.$tb.get(0)&&(n&&(n+=t.$iframe.offset().left),i&&(i+=t.$iframe.offset().top));h=o(r,n);n&&(r.css("left",h),s=r.data("fr-arrow"),s||(s=r.find(".fr-arrow"),r.data("fr-arrow",s)),s.data("margin-left")||s.data("margin-left",t.helpers.getPX(s.css("margin-left"))),s.css("margin-left",n-h+s.data("margin-left")));i&&r.css("top",e(r,i,u))}function h(i){var r=n(i),s=r.is(".fr-sticky-on"),f=r.data("sticky-top"),h=r.data("sticky-scheduled"),o,e,u;void 0===f?(r.data("sticky-top",0),o=n('<div class="fr-sticky-dummy" style="height: '+r.outerHeight()+'px;"><\/div>'),t.$box.prepend(o)):t.$box.find(".fr-sticky-dummy").css("height",r.outerHeight());t.core.hasFocus()||t.$tb.find("input:visible:focus").length>0?(e=t.helpers.scrollTop(),u=Math.min(Math.max(e-t.$tb.parent().offset().top,0),t.$tb.parent().outerHeight()-r.outerHeight()),u!=f&&u!=h&&(clearTimeout(r.data("sticky-timeout")),r.data("sticky-scheduled",u),r.outerHeight()<e-t.$tb.parent().offset().top&&r.addClass("fr-opacity-0"),r.data("sticky-timeout",setTimeout(function(){var i=t.helpers.scrollTop(),n=Math.min(Math.max(i-t.$tb.parent().offset().top,0),t.$tb.parent().outerHeight()-r.outerHeight());n>0&&"BODY"==t.$tb.parent().get(0).tagName&&(n+=t.$tb.parent().position().top);n!=f&&(r.css("top",Math.max(n,0)),r.data("sticky-top",n),r.data("sticky-scheduled",n));r.removeClass("fr-opacity-0")},100))),s||(r.css("top","0"),r.width(t.$tb.parent().width()),r.addClass("fr-sticky-on"),t.$box.addClass("fr-sticky-box"))):(clearTimeout(n(i).css("sticky-timeout")),r.css("top","0"),r.css("position",""),r.width(""),r.data("sticky-top",0),r.removeClass("fr-sticky-on"),t.$box.removeClass("fr-sticky-box"))}function c(i){var f,p,v,b,k,d,g;if(i.offsetWidth){var s,h,r=n(i),c=r.outerHeight(),u=r.data("sticky-position"),l=n("body"==t.opts.scrollableContainer?t.o_win:t.opts.scrollableContainer).outerHeight(),e=0,y=0;"body"!==t.opts.scrollableContainer&&(e=t.$sc.offset().top,y=n(t.o_win).outerHeight()-e-l);f="body"==t.opts.scrollableContainer?t.helpers.scrollTop():e;p=r.is(".fr-sticky-on");r.data("sticky-parent")||r.data("sticky-parent",r.parent());var a=r.data("sticky-parent"),o=a.offset().top,w=a.outerHeight();(r.data("sticky-offset")||(r.data("sticky-offset",!0),r.after('<div class="fr-sticky-dummy" style="height: '+c+'px;"><\/div>')),u)||(v="auto"!==r.css("top")||"auto"!==r.css("bottom"),v||r.css("position","fixed"),u={top:t.node.hasClass(r.get(0),"fr-top"),bottom:t.node.hasClass(r.get(0),"fr-bottom")},v||r.css("position",""),r.data("sticky-position",u),r.data("top",t.node.hasClass(r.get(0),"fr-top")?r.css("top"):"auto"),r.data("bottom",t.node.hasClass(r.get(0),"fr-bottom")?r.css("bottom"):"auto"));b=function(){return o<f+s&&o+w-c>=f+s};k=function(){return o+c<f+l-h&&o+w>f+l-h};s=t.helpers.getPX(r.data("top"));h=t.helpers.getPX(r.data("bottom"));d=u.top&&b();g=u.bottom&&k();d||g?(r.css("width",a.get(0).getBoundingClientRect().width+"px"),p||(r.addClass("fr-sticky-on"),r.removeClass("fr-sticky-off"),r.css("top")&&("auto"!=r.data("top")?r.css("top",t.helpers.getPX(r.data("top"))+e):r.data("top","auto")),r.css("bottom")&&("auto"!=r.data("bottom")?r.css("bottom",t.helpers.getPX(r.data("bottom"))+y):r.css("bottom","auto")))):t.node.hasClass(r.get(0),"fr-sticky-off")||(r.width(""),r.removeClass("fr-sticky-on"),r.addClass("fr-sticky-off"),r.css("top")&&"auto"!=r.data("top")&&u.top&&r.css("top",0),r.css("bottom")&&"auto"!=r.data("bottom")&&u.bottom&&r.css("bottom",0))}}function f(){var i=document.createElement("test"),n=i.style;return n.cssText="position:"+["-webkit-","-moz-","-ms-","-o-",""].join("sticky; position:")+" sticky;",-1!==n.position.indexOf("sticky")&&!t.helpers.isIOS()&&!t.helpers.isAndroid()&&!t.browser.chrome}function l(){if(!f())if(t._stickyElements=[],t.helpers.isIOS()){var r=function(){t.helpers.requestAnimationFrame()(r);for(var n=0;n<t._stickyElements.length;n++)h(t._stickyElements[n])};r();t.events.$on(n(t.o_win),"scroll",function(){var r;if(t.core.hasFocus())for(r=0;r<t._stickyElements.length;r++){var i=n(t._stickyElements[r]),u=i.parent(),f=t.helpers.scrollTop();i.outerHeight()<f-u.offset().top&&(i.addClass("fr-opacity-0"),i.data("sticky-top",-1),i.data("sticky-scheduled",-1))}},!0)}else t.events.$on(n("body"==t.opts.scrollableContainer?t.o_win:t.opts.scrollableContainer),"scroll",i,!0),t.events.$on(n(t.o_win),"resize",i,!0),t.events.on("initialized",i),t.events.on("focus",i),t.events.$on(n(t.o_win),"resize","textarea",i,!0);t.events.on("destroy",function(){t._stickyElements=[]})}function i(){if(t._stickyElements)for(var n=0;n<t._stickyElements.length;n++)c(t._stickyElements[n])}function a(n){n.addClass("fr-sticky");t.helpers.isIOS()&&n.addClass("fr-sticky-ios");f()||(n.removeClass("fr-sticky"),t._stickyElements.push(n.get(0)))}function v(){l()}return{_init:v,forSelection:s,addSticky:a,refresh:i,at:u,getBoundingRect:r}};n.FE.MODULES.refresh=function(t){function r(n){i(n,!t.undo.canDo())}function u(n){i(n,!t.undo.canRedo())}function f(n){var f,u,r;if(t.node.hasClass(n.get(0),"fr-no-refresh"))return!1;for(f=t.selection.blocks(),u=0;u<f.length;u++){for(r=f[u].previousSibling;r&&r.nodeType==Node.TEXT_NODE&&0===r.textContent.length;)r=r.previousSibling;if("LI"!=f[u].tagName||r)return i(n,!1),!0;i(n,!0)}}function e(r){var f,u,e;if(t.node.hasClass(r.get(0),"fr-no-refresh"))return!1;for(f=t.selection.blocks(),u=0;u<f.length;u++)if((e="rtl"==t.opts.direction||"rtl"==n(f[u]).css("direction")?"margin-right":"margin-left","LI"==f[u].tagName||"LI"==f[u].parentNode.tagName)||t.helpers.getPX(n(f[u]).css(e))>0)return i(r,!1),!0;i(r,!0)}function i(n,t){n.toggleClass("fr-disabled",t).attr("aria-disabled",t)}return{undo:r,redo:u,outdent:e,indent:f}};n.extend(n.FE.DEFAULTS,{editInPopup:!1});n.FE.MODULES.textEdit=function(n){function t(){var t='<div id="fr-text-edit-'+n.id+'" class="fr-layer fr-text-edit-layer"><div class="fr-input-line"><input type="text" placeholder="'+n.language.translate("Text")+'" tabIndex="1"><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="updateText" tabIndex="2">'+n.language.translate("Update")+"<\/button><\/div><\/div>",i={edit:t};n.popups.create("text.edit",i)}function i(){var t,i=n.popups.get("text.edit");t="INPUT"===n.$el.prop("tagName")?n.$el.attr("placeholder"):n.$el.text();i.find("input").val(t).trigger("change");n.popups.setContainer("text.edit",n.$sc);n.popups.show("text.edit",n.$el.offset().left+n.$el.outerWidth()/2,n.$el.offset().top+n.$el.outerHeight(),n.$el.outerHeight())}function r(){n.events.$on(n.$el,n._mouseup,function(){setTimeout(function(){i()},10)})}function u(){var i=n.popups.get("text.edit"),t=i.find("input").val();0===t.length&&(t=n.opts.placeholderText);"INPUT"===n.$el.prop("tagName")?n.$el.attr("placeholder",t):n.$el.text(t);n.events.trigger("contentChanged");n.popups.hide("text.edit")}function f(){n.opts.editInPopup&&(t(),r())}return{_init:f,update:u}};n.FE.RegisterCommand("updateText",{focus:!1,undo:!1,callback:function(){this.textEdit.update()}});n.extend(n.FE.DEFAULTS,{toolbarBottom:!1,toolbarButtons:["fullscreen","bold","italic","underline","strikeThrough","subscript","superscript","|","fontFamily","fontSize","color","inlineStyle","paragraphStyle","|","paragraphFormat","align","formatOL","formatUL","outdent","indent","quote","-","insertLink","insertImage","insertVideo","embedly","insertFile","insertTable","|","emoticons","specialCharacters","insertHR","selectAll","clearFormatting","|","print","spellChecker","help","html","|","undo","redo"],toolbarButtonsXS:["bold","italic","fontFamily","fontSize","|","undo","redo"],toolbarButtonsSM:["bold","italic","underline","|","fontFamily","fontSize","insertLink","insertImage","table","|","undo","redo"],toolbarButtonsMD:null,toolbarContainer:null,toolbarInline:!1,toolbarSticky:!0,toolbarStickyOffset:0,toolbarVisibleWithoutSelection:!1});n.FE.MODULES.toolbar=function(t){function e(n,t){for(var i=0;i<t.length;i++)"-"!=t[i]&&"|"!=t[i]&&n.indexOf(t[i])<0&&n.push(t[i])}function y(){var i=n.merge([],h()),r,u;for(e(i,t.opts.toolbarButtonsXS||[]),e(i,t.opts.toolbarButtonsSM||[]),e(i,t.opts.toolbarButtonsMD||[]),e(i,t.opts.toolbarButtons),r=i.length-1;r>=0;r--)"-"!=i[r]&&"|"!=i[r]&&i.indexOf(i[r])<r&&i.splice(r,1);u=t.button.buildList(i,h());t.$tb.append(u);t.button.bindCommands(t.$tb)}function h(){var n=t.helpers.screenSize();return u[n]}function a(){var i=h(),n,r,u;for(t.$tb.find(".fr-separator").remove(),t.$tb.find("> .fr-command").addClass("fr-hidden"),n=0;n<i.length;n++)"|"==i[n]||"-"==i[n]?t.$tb.append(t.button.buildList([i[n]])):(r=t.$tb.find('> .fr-command[data-cmd="'+i[n]+'"]'),u=null,t.node.hasClass(r.next().get(0),"fr-dropdown-menu")&&(u=r.next()),r.removeClass("fr-hidden").appendTo(t.$tb),u&&u.appendTo(t.$tb))}function p(){t.events.$on(n(t.o_win),"resize",a);t.events.$on(n(t.o_win),"orientationchange",a)}function i(i,r){setTimeout(function(){if((!i||i.which!=n.FE.KEYCODE.ESC)&&t.selection.inEditor()&&t.core.hasFocus()&&!t.popups.areVisible()&&(t.opts.toolbarVisibleWithoutSelection||!t.selection.isCollapsed()&&!t.keys.isIME()||r)){if(t.$tb.data("instance",t),!1===t.events.trigger("toolbar.show",[i]))return!1;t.$tb.show();t.opts.toolbarContainer||t.position.forSelection(t.$tb);t.opts.zIndex>1?t.$tb.css("z-index",t.opts.zIndex+1):t.$tb.css("z-index",null)}},0)}function r(n){return!(!n||"keydown"!==n.type||!t.keys.ctrlKey(n))||!!t.button.getButtons(".fr-dropdown.fr-active").next().find(t.o_doc.activeElement).length||void(!1!==t.events.trigger("toolbar.hide")&&t.$tb.hide())}function w(){if(!1===t.events.trigger("toolbar.show"))return!1;t.$tb.show()}function v(r){clearTimeout(l);r&&r.which==n.FE.KEYCODE.ESC||(l=setTimeout(i,t.opts.typingTimer))}function o(){t.events.on("window.mousedown",r);t.events.on("keydown",r);t.events.on("blur",r);t.events.on("window.mouseup",i);t.helpers.isMobile()?t.helpers.isIOS()||(t.events.on("window.touchend",i),t.browser.mozilla&&setInterval(i,200)):t.events.on("window.keyup",v);t.events.on("keydown",function(t){t&&t.which==n.FE.KEYCODE.ESC&&r()});t.events.on("keydown",function(t){if(t.which==n.FE.KEYCODE.ALT)return t.stopPropagation(),!1},!0);t.events.$on(t.$wp,"scroll.toolbar",i);t.events.on("commands.after",i);t.helpers.isMobile()&&(t.events.$on(t.$doc,"selectionchange",v),t.events.$on(t.$doc,"orientationchange",i))}function b(){t.opts.toolbarInline?(t.$sc.append(t.$tb),t.$tb.data("container",t.$sc),t.$tb.addClass("fr-inline"),t.$tb.prepend('<span class="fr-arrow"><\/span>'),o(),t.opts.toolbarBottom=!1):(t.opts.toolbarBottom&&!t.helpers.isIOS()?(t.$box.append(t.$tb),t.$tb.addClass("fr-bottom"),t.$box.addClass("fr-bottom")):(t.opts.toolbarBottom=!1,t.$box.prepend(t.$tb),t.$tb.addClass("fr-top"),t.$box.addClass("fr-top")),t.$tb.addClass("fr-basic"),t.opts.toolbarSticky&&(t.opts.toolbarStickyOffset&&(t.opts.toolbarBottom?t.$tb.css("bottom",t.opts.toolbarStickyOffset):t.$tb.css("top",t.opts.toolbarStickyOffset)),t.position.addSticky(t.$tb)))}function k(){t.$tb.html("").removeData().remove();t.$tb=null}function d(){t.$box.removeClass("fr-top fr-bottom fr-inline fr-basic");t.$box.find(".fr-sticky-dummy").remove()}function c(){t.opts.theme&&t.$tb.addClass(t.opts.theme+"-theme");t.opts.zIndex>1&&t.$tb.css("z-index",t.opts.zIndex+1);"auto"!=t.opts.direction&&t.$tb.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction);t.helpers.isMobile()?t.$tb.addClass("fr-mobile"):t.$tb.addClass("fr-desktop");t.opts.toolbarContainer?(t.opts.toolbarInline&&(o(),r()),t.opts.toolbarBottom?t.$tb.addClass("fr-bottom"):t.$tb.addClass("fr-top")):b();s=t.$tb.get(0).ownerDocument;it="defaultView"in s?s.defaultView:s.parentWindow;y();p();t.accessibility.registerToolbar(t.$tb);t.events.$on(t.$tb,t._mousedown+" "+t._mouseup,function(n){var i=n.originalEvent?n.originalEvent.target||n.originalEvent.originalTarget:null;if(i&&"INPUT"!=i.tagName&&!t.edit.isDisabled())return n.stopPropagation(),n.preventDefault(),!1},!0)}function g(){if(t.$sc=n(t.opts.scrollableContainer).first(),!t.$wp)return!1;t.opts.toolbarContainer?(t.shared.$tb?(t.$tb=t.shared.$tb,t.opts.toolbarInline&&o()):(t.shared.$tb=n('<div class="fr-toolbar"><\/div>'),t.$tb=t.shared.$tb,n(t.opts.toolbarContainer).append(t.$tb),c(),t.$tb.data("instance",t)),t.opts.toolbarInline?t.$box.addClass("fr-inline"):t.$box.addClass("fr-basic"),t.events.on("focus",function(){t.$tb.data("instance",t)},!0),t.opts.toolbarInline=!1):t.opts.toolbarInline?(t.$box.addClass("fr-inline"),t.shared.$tb?(t.$tb=t.shared.$tb,o()):(t.shared.$tb=n('<div class="fr-toolbar"><\/div>'),t.$tb=t.shared.$tb,c())):(t.$box.addClass("fr-basic"),t.$tb=n('<div class="fr-toolbar"><\/div>'),c(),t.$tb.data("instance",t));t.events.on("destroy",d,!0);t.events.on(t.opts.toolbarInline||t.opts.toolbarContainer?"shared.destroy":"destroy",k,!0)}function nt(){!f&&t.$tb&&(t.$tb.find("> .fr-command").addClass("fr-disabled fr-no-refresh").attr("aria-disabled",!0),f=!0)}function tt(){f&&t.$tb&&(t.$tb.find("> .fr-command").removeClass("fr-disabled fr-no-refresh").attr("aria-disabled",!1),f=!1);t.button.bulkRefresh()}var s,it,u=[],l,f;return u[n.FE.XS]=t.opts.toolbarButtonsXS||t.opts.toolbarButtons,u[n.FE.SM]=t.opts.toolbarButtonsSM||t.opts.toolbarButtons,u[n.FE.MD]=t.opts.toolbarButtonsMD||t.opts.toolbarButtons,u[n.FE.LG]=t.opts.toolbarButtons,l=null,f=!1,{_init:g,hide:r,show:w,showInline:i,disable:nt,enable:tt}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{charCounterMax:-1,charCounterCount:!0});n.FE.PLUGINS.charCounter=function(t){function r(){return t.el.textContent.length}function u(i){if(t.opts.charCounterMax<0||r()<t.opts.charCounterMax)return!0;var u=i.which;return!(!t.keys.ctrlKey(i)&&t.keys.isCharacter(u)||u===n.FE.KEYCODE.IME)||(i.preventDefault(),i.stopPropagation(),t.events.trigger("charCounter.exceeded"),!1)}function f(i){return t.opts.charCounterMax<0?i:n("<div>").html(i).text().length+r()<=t.opts.charCounterMax?i:(t.events.trigger("charCounter.exceeded"),"")}function e(){var u,n;t.opts.charCounterCount&&(u=r()+(t.opts.charCounterMax>0?"/"+t.opts.charCounterMax:""),i.text(u),t.opts.toolbarBottom&&i.css("margin-bottom",t.$tb.outerHeight(!0)),n=t.$wp.get(0).offsetWidth-t.$wp.get(0).clientWidth,n>=0&&("rtl"==t.opts.direction?i.css("margin-left",n):i.css("margin-right",n)))}function o(){return!!t.$wp&&!!t.opts.charCounterCount&&(i=n('<span class="fr-counter"><\/span>'),i.css("bottom",t.$wp.css("border-bottom-width")),t.$box.append(i),t.events.on("keydown",u,!0),t.events.on("paste.afterCleanup",f),t.events.on("keyup contentChanged input",function(){t.events.trigger("charCounter.update")}),t.events.on("charCounter.update",e),t.events.trigger("charCounter.update"),void t.events.on("destroy",function(){n(t.o_win).off("resize.char"+t.id);i.removeData().remove();i=null}))}var i;return{_init:o,count:r}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.FE.PLUGINS.codeBeautifier=function(){function o(n,t){function ot(n){return n.replace(/^\s+/g,"")}function k(n){return n.replace(/\s+$/g,"")}function st(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=d,this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,source,!doctype,basefont,base,area,hr,wbr,param,img,isindex,embed".split(","),extra_liners:ft,in_array:function(n,t){for(var i=0;i<t.length;i++)if(n==t[i])return!0;return!1}},this.is_whitespace=function(n){for(var t=0;t<n.length;n++)if(!this.Utils.in_array(n.charAt(t),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var n="";if(n=this.input.charAt(this.pos),this.Utils.in_array(n,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(n,this.Utils.whitespace);)v&&"\n"==n&&this.newlines<=tt&&(this.newlines+=1),this.pos++,n=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(n){this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,n),this.print_indentation(n)):(this.line_char_count++,n.push(" "))},this.get_content=function(){for(var t,i="",n=[];"<"!=this.input.charAt(this.pos);){if(this.pos>=this.input.length)return n.length?n.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(n);else{if(r){if(t=this.input.substr(this.pos,3),"{{#"==t||"{{/"==t)break;if("{{!"==t)return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];if("{{"==this.input.substr(this.pos,2)&&"{{else}}"==this.get_tag(!0))break}i=this.input.charAt(this.pos);this.pos++;this.line_char_count++;n.push(i)}}return n.length?n.join(""):""},this.get_contents_to=function(n){var i,r,u,t;return this.pos==this.input.length?["","TK_EOF"]:(i="",r=new RegExp("<\/"+n+"\\s*>","igm"),r.lastIndex=this.pos,u=r.exec(this.input),t=u?u.index:this.input.length,this.pos<t&&(i=this.input.substring(this.pos,t),this.pos=t),i)},this.record_tag=function(n){this.tags[n+"count"]?(this.tags[n+"count"]++,this.tags[n+this.tags[n+"count"]]=this.indent_level):(this.tags[n+"count"]=1,this.tags[n+this.tags[n+"count"]]=this.indent_level);this.tags[n+this.tags[n+"count"]+"parent"]=this.tags.parent;this.tags.parent=n+this.tags[n+"count"]},this.retrieve_tag=function(n){if(this.tags[n+"count"]){for(var t=this.tags.parent;t&&n+this.tags[n+"count"]!=t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[n+this.tags[n+"count"]],this.tags.parent=this.tags[t+"parent"]);delete this.tags[n+this.tags[n+"count"]+"parent"];delete this.tags[n+this.tags[n+"count"]];1==this.tags[n+"count"]?delete this.tags[n+"count"]:this.tags[n+"count"]--}},this.indent_to_tag=function(n){if(this.tags[n+"count"]){for(var t=this.tags.parent;t&&n+this.tags[n+"count"]!=t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[n+this.tags[n+"count"]])}},this.get_tag=function(n){var s,e,i="",t=[],v="",o=!1,y=!0,p=this.pos,w=this.line_char_count,a,h,b,k,u,f;n=void 0!==n&&n;do{if(this.pos>=this.input.length)return n&&(this.pos=p,this.line_char_count=w),t.length?t.join(""):["","TK_EOF"];if(i=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(i,this.Utils.whitespace))o=!0;else{if("'"!=i&&'"'!=i||(i+=this.get_unformatted(i),o=!0),"="==i&&(o=!1),t.length&&"="!=t[t.length-1]&&">"!=i&&o){if(this.space_or_wrap(t),o=!1,!y&&"force"==it&&"/"!=i)for(this.print_newline(!0,t),this.print_indentation(t),a=0;a<rt;a++)t.push(c);for(h=0;h<t.length;h++)if(" "==t[h]){y=!1;break}}if(r&&"<"==e&&i+this.input.charAt(this.pos)=="{{"&&(i+=this.get_unformatted("}}"),t.length&&" "!=t[t.length-1]&&"<"!=t[t.length-1]&&(i=" "+i),o=!0),"<"!=i||e||(s=this.pos-1,e="<"),r&&!e&&t.length>=2&&"{"==t[t.length-1]&&"{"==t[t.length-2]&&(s="#"==i||"/"==i||"!"==i?this.pos-3:this.pos-2,e="{"),this.line_char_count++,t.push(i),t[1]&&("!"==t[1]||"?"==t[1]||"%"==t[1])){t=[this.get_comment(s)];break}if(r&&t[1]&&"{"==t[1]&&t[2]&&"!"==t[2]){t=[this.get_comment(s)];break}if(r&&"{"==e&&t.length>2&&"}"==t[t.length-2]&&"}"==t[t.length-1])break}}while(">"!=i);return u=t.join(""),b=-1!=u.indexOf(" ")?u.indexOf(" "):"{"==u[0]?u.indexOf("}"):u.indexOf(">"),k="<"!=u[0]&&r?"#"==u[2]?3:2:1,f=u.substring(k,b).toLowerCase(),"/"==u.charAt(u.length-2)||this.Utils.in_array(f,this.Utils.single_token)?n||(this.tag_type="SINGLE"):r&&"{"==u[0]&&"else"==f?n||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(f,l)?(v=this.get_unformatted("<\/"+f+">",u),t.push(v),this.pos-1,this.tag_type="SINGLE"):"script"==f&&(-1==u.search("type")||u.search("type")>-1&&u.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/)>-1)?n||(this.record_tag(f),this.tag_type="SCRIPT"):"style"==f&&(-1==u.search("type")||u.search("type")>-1&&u.search("text/css")>-1)?n||(this.record_tag(f),this.tag_type="STYLE"):"!"==f.charAt(0)?n||(this.tag_type="SINGLE",this.traverse_whitespace()):n||("/"==f.charAt(0)?(this.retrieve_tag(f.substring(1)),this.tag_type="END"):(this.record_tag(f),"html"!=f.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(t),this.Utils.in_array(f,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!=this.output[this.output.length-2]&&this.print_newline(!0,this.output))),n&&(this.pos=p,this.line_char_count=w),t.join("")},this.get_comment=function(n){var t="",i=">",r=!1,u;for(this.pos=n,u=this.input.charAt(this.pos),this.pos++;this.pos<=this.input.length&&(t+=u,t[t.length-1]!=i[i.length-1]||-1==t.indexOf(i));)!r&&t.length<10&&(0===t.indexOf("<![if")?(i="<![endif]>",r=!0):0===t.indexOf("<![cdata[")?(i="]\]>",r=!0):0===t.indexOf("<![")?(i="]>",r=!0):0===t.indexOf("<!--")?(i="-->",r=!0):0===t.indexOf("{{!")?(i="}}",r=!0):0===t.indexOf("<?")?(i="?>",r=!0):0===t.indexOf("<%")&&(i="%>",r=!0)),u=this.input.charAt(this.pos),this.pos++;return t},this.get_unformatted=function(n,t){if(t&&-1!=t.toLowerCase().indexOf(n))return"";var u="",i="",f=0,e=!0;do{if(this.pos>=this.input.length)return i;if(u=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(u,this.Utils.whitespace)){if(!e){this.line_char_count--;continue}if("\n"==u||"\r"==u){i+="\n";this.line_char_count=0;continue}}i+=u;this.line_char_count++;e=!0;r&&"{"==u&&i.length&&"{"==i[i.length-2]&&(i+=this.get_unformatted("}}"),f=i.length)}while(-1==i.toLowerCase().indexOf(n,f));return i},this.get_token=function(){var n,t;return"TK_TAG_SCRIPT"==this.last_token||"TK_TAG_STYLE"==this.last_token?(t=this.last_token.substr(7),n=this.get_contents_to(t),"string"!=typeof n?n:[n,"TK_"+t]):"CONTENT"==this.current_mode?(n=this.get_content(),"string"!=typeof n?n:[n,"TK_CONTENT"]):"TAG"==this.current_mode?"string"!=typeof(n=this.get_tag())?n:[n,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(n){return n=this.indent_level+n||0,n<1?"":new Array(n+1).join(this.indent_string)},this.is_unformatted=function(n,t){if(!this.Utils.in_array(n,t))return!1;if("a"!=n.toLowerCase()||!this.Utils.in_array("a",t))return!0;var r=this.get_tag(!0),i=(r||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(i&&!this.Utils.in_array(i,t))},this.printer=function(n,t,i,r,u){this.input=n||"";this.output=[];this.indent_character=t;this.indent_string="";this.indent_size=i;this.brace_style=u;this.indent_level=0;this.wrap_line_length=r;this.line_char_count=0;for(var f=0;f<this.indent_size;f++)this.indent_string+=this.indent_character;this.print_newline=function(n,t){this.line_char_count=0;t&&t.length&&(n||"\n"!=t[t.length-1])&&("\n"!=t[t.length-1]&&(t[t.length-1]=k(t[t.length-1])),t.push("\n"))};this.print_indentation=function(n){for(var t=0;t<this.indent_level;t++)n.push(this.indent_string),this.line_char_count+=this.indent_string.length};this.print_token=function(n){this.is_whitespace(n)&&!this.output.length||((n||""!==n)&&this.output.length&&"\n"==this.output[this.output.length-1]&&(this.print_indentation(this.output),n=ot(n)),this.print_token_raw(n))};this.print_token_raw=function(n){this.newlines>0&&(n=k(n));n&&""!==n&&(n.length>1&&"\n"==n[n.length-1]?(this.output.push(n.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(n));for(var t=0;t<this.newlines;t++)this.print_newline(t>0,this.output);this.newlines=0};this.indent=function(){this.indent_level++};this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var i,d,o,c,g,nt,l,v,tt,r,it,rt,ut,ft,y,et,s,p,a,f,h,w,b;for(t=t||{},void 0!==t.wrap_line_length&&0!==parseInt(t.wrap_line_length,10)||void 0===t.max_char||0===parseInt(t.max_char,10)||(t.wrap_line_length=t.max_char),d=void 0!==t.indent_inner_html&&t.indent_inner_html,o=void 0===t.indent_size?4:parseInt(t.indent_size,10),c=void 0===t.indent_char?" ":t.indent_char,nt=void 0===t.brace_style?"collapse":t.brace_style,g=0===parseInt(t.wrap_line_length,10)?32786:parseInt(t.wrap_line_length||250,10),l=t.unformatted||["a","span","img","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","address","pre"],v=void 0===t.preserve_newlines||t.preserve_newlines,tt=v?isNaN(parseInt(t.max_preserve_newlines,10))?32786:parseInt(t.max_preserve_newlines,10):0,r=void 0!==t.indent_handlebars&&t.indent_handlebars,it=void 0===t.wrap_attributes?"auto":t.wrap_attributes,rt=void 0===t.wrap_attributes_indent_size?o:parseInt(t.wrap_attributes_indent_size,10)||o,ut=void 0!==t.end_with_newline&&t.end_with_newline,ft=Array.isArray(t.extra_liners)?t.extra_liners.concat():"string"==typeof t.extra_liners?t.extra_liners.split(","):"head,body,/html".split(","),t.indent_with_tabs&&(c="\t",o=1),i=new st,i.printer(n,c,o,g,nt);;){if(y=i.get_token(),i.token_text=y[0],i.token_type=y[1],"TK_EOF"==i.token_type)break;switch(i.token_type){case"TK_TAG_START":i.print_newline(!1,i.output);i.print_token(i.token_text);i.indent_content&&(i.indent(),i.indent_content=!1);i.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":i.print_newline(!1,i.output);i.print_token(i.token_text);i.current_mode="CONTENT";break;case"TK_TAG_END":"TK_CONTENT"==i.last_token&&""===i.last_text&&(et=i.token_text.match(/\w+/)[0],s=null,i.output.length&&(s=i.output[i.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),null!=s&&(s[1]==et||i.Utils.in_array(s[1],l))||i.print_newline(!1,i.output));i.print_token(i.token_text);i.current_mode="CONTENT";break;case"TK_TAG_SINGLE":p=i.token_text.match(/^\s*<([a-z-]+)/i);p&&i.Utils.in_array(p[1],l)||i.print_newline(!1,i.output);i.print_token(i.token_text);i.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":i.print_token(i.token_text);i.indent_content&&(i.indent(),i.indent_content=!1);i.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":case"TK_CONTENT":i.print_token(i.token_text);i.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==i.token_text){if(i.print_newline(!1,i.output),f=i.token_text,h=1,"TK_SCRIPT"==i.token_type?a="function"==typeof e&&e:"TK_STYLE"==i.token_type&&(a="function"==typeof u&&u),"keep"==t.indent_scripts?h=0:"separate"==t.indent_scripts&&(h=-i.indent_level),w=i.get_full_indent(h),a)f=a(f.replace(/^\s*/,w),t);else{var ht=f.match(/^\s*/)[0],ct=ht.match(/[^\n\r]*$/)[0].split(i.indent_string).length-1,lt=i.get_full_indent(h-ct);f=f.replace(/^\s*/,w).replace(/\r\n|\r|\n/g,"\n"+lt).replace(/\s+$/,"")}f&&(i.print_token_raw(f),i.print_newline(!0,i.output))}i.current_mode="TAG";break;default:""!==i.token_text&&i.print_token(i.token_text)}i.last_token=i.token_type;i.last_text=i.token_text}return b=i.output.join("").replace(/[\r\n\t ]+$/,""),ut&&(b+="\n"),b}function u(n,t){function e(){return(i=n.charAt(++f))||""}function o(t){var i="",r=f;return t&&h(),i=n.charAt(f+1)||"",f=r-1,e(),i}function y(t){for(var r=f;e();)if("\\"===i)e();else{if(-1!==t.indexOf(i))break;if("\n"===i)break}return n.substring(r,f+1)}function ct(n){var t=f,i=y(n);return f=t-1,e(),i}function h(){for(var n="";b.test(o());)e(),n+=i;return n}function lt(){var n="";for(i&&b.test(i)&&(n=i);b.test(e());)n+=i;return n}function it(t){var r=f;for(t="/"===o(),e();e();){if(!t&&"*"===i&&"/"===o()){e();break}if(t&&"\n"===i)return n.substring(r,f)}return n.substring(r,f)+i}function rt(t){return n.substring(f-t.length,f).toLowerCase()===t}function at(){for(var t,i=0,r=f+1;r<n.length;r++){if(t=n.charAt(r),"{"===t)return!0;if("("===t)i+=1;else if(")"===t){if(0==i)return!1;i-=1}else if(";"===t||"}"===t)return!1}return!1}function vt(){l++;c+=dt}function yt(){l--;c=c.slice(0,-v)}var pt={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},wt={"@media":!0,"@supports":!0,"@document":!0},tt,s,a;t=t||{};n=n||"";n=n.replace(/\r\n|[\r\u2028\u2029]/g,"\n");var v=t.indent_size||4,ut=t.indent_char||" ",bt=void 0===t.selector_separator_newline||t.selector_separator_newline,kt=void 0!==t.end_with_newline&&t.end_with_newline,ft=void 0===t.newline_between_rules||t.newline_between_rules,w=t.eol?t.eol:"\n";"string"==typeof v&&(v=parseInt(v,10));t.indent_with_tabs&&(ut="\t",v=1);w=w.replace(/\\r/,"\r").replace(/\\n/,"\n");var i,b=/^\s+$/,f=-1,nt=0,c=n.match(/^[\t ]*/)[0],dt=new Array(v+1).join(ut),l=0,p=0,r={};r["{"]=function(n){r.singleSpace();u.push(n);r.newLine()};r["}"]=function(n){r.newLine();u.push(n);r.newLine()};r._lastCharWhitespace=function(){return b.test(u[u.length-1])};r.newLine=function(n){u.length&&(n||"\n"===u[u.length-1]||r.trim(),u.push("\n"),c&&u.push(c))};r.singleSpace=function(){u.length&&!r._lastCharWhitespace()&&u.push(" ")};r.preserveSingleSpace=function(){gt&&r.singleSpace()};r.trim=function(){for(;r._lastCharWhitespace();)u.pop()};for(var u=[],k=!1,d=!1,g=!1,et="",ot="";;){var st=lt(),gt=""!==st,ht=-1!==st.indexOf("\n");if(ot=et,et=i,!i)break;"/"===i&&"*"===o()?(tt=0===l,(ht||tt)&&r.newLine(),u.push(it()),r.newLine(),tt&&r.newLine(!0)):"/"===i&&"/"===o()?(ht||"{"===ot||r.trim(),r.singleSpace(),u.push(it()),r.newLine()):"@"===i?(r.preserveSingleSpace(),u.push(i),s=ct(": ,;{}()[]/='\""),s.match(/[ :]$/)&&(e(),s=y(": ").replace(/\s$/,""),u.push(s),r.singleSpace()),s=s.replace(/\s$/,""),s in pt&&(p+=1,s in wt&&(g=!0))):"#"===i&&"{"===o()?(r.preserveSingleSpace(),u.push(y("}"))):"{"===i?"}"===o(!0)?(h(),e(),r.singleSpace(),u.push("{}"),r.newLine(),ft&&0===l&&r.newLine(!0)):(vt(),r["{"](i),g?(g=!1,k=l>p):k=l>=p):"}"===i?(yt(),r["}"](i),k=!1,d=!1,p&&p--,ft&&0===l&&r.newLine(!0)):":"===i?(h(),!k&&!g||rt("&")||at()?":"===o()?(e(),u.push("::")):u.push(":"):(d=!0,u.push(":"),r.singleSpace())):'"'===i||"'"===i?(r.preserveSingleSpace(),u.push(y(i))):";"===i?(d=!1,u.push(i),r.newLine()):"("===i?rt("url")?(u.push(i),h(),e()&&(")"!==i&&'"'!==i&&"'"!==i?u.push(y(")")):f--)):(nt++,r.preserveSingleSpace(),u.push(i),h()):")"===i?(u.push(i),nt--):","===i?(u.push(i),h(),bt&&!d&&nt<1?r.newLine():r.singleSpace()):"]"===i?u.push(i):"["===i?(r.preserveSingleSpace(),u.push(i)):"="===i?(h(),i="=",u.push(i)):(r.preserveSingleSpace(),u.push(i))}return a="",c&&(a+=c),a+=u.join("").replace(/[\r\n\t ]+$/,""),kt&&(a+="\n"),"\n"!=w&&(a=a.replace(/[\n]/g,w)),a}function n(n,t){for(var i=0;i<t.length;i+=1)if(t[i]===n)return!0;return!1}function f(n){return n.replace(/^\s+|\s+$/g,"")}function s(n){return n.replace(/^\s+/g,"")}function e(n,t){return new h(n,t).beautify()}function h(r,u){function yt(n,t){var i=0;return n&&(i=n.indentation_level,!v.just_added_newline()&&n.line_indent_level>i&&(i=n.line_indent_level)),{mode:t,parent:n,last_text:n?n.last_text:"",last_word:n?n.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:i,line_indent_level:n?n.line_indent_level:i,start_line_index:v.get_line_number(),ternary_depth:0}}function pt(n){var i=n.newlines,t;if(c.keep_array_indentation&&nt(e.mode))for(t=0;t<i;t+=1)y(t>0);else if(c.max_preserve_newlines&&i>c.max_preserve_newlines&&(i=c.max_preserve_newlines),c.preserve_newlines&&n.newlines>1)for(y(),t=1;t<i;t+=1)y(!0);o=n;kt[o.type]()}function gt(n){n=n.replace(/\x0d/g,"");for(var i=[],t=n.indexOf("\n");-1!==t;)i.push(n.substring(0,t)),n=n.substring(t+1),t=n.indexOf("\n");return n.length&&i.push(n),i}function d(n){if(n=void 0!==n&&n,!v.just_added_newline())if(c.preserve_newlines&&o.wanted_newline||n)y(!1,!0);else if(c.wrap_line_length){var t=v.current_line.get_character_count()+o.text.length+(v.space_before_token?1:0);t>=c.wrap_line_length&&y(!1,!0)}}function y(n,i){if(!i&&";"!==e.last_text&&","!==e.last_text&&"="!==e.last_text&&"TK_OPERATOR"!==h)for(;e.mode===t.Statement&&!e.if_block&&!e.do_block;)g();v.add_new_line(n)&&(e.multiline_frame=!0)}function wt(){v.just_added_newline()&&(c.keep_array_indentation&&nt(e.mode)&&o.wanted_newline?(v.current_line.push(o.whitespace_before),v.space_before_token=!1):v.set_indent(e.indentation_level)&&(e.line_indent_level=e.indentation_level))}function p(n){if(v.raw)return void v.add_raw_token(o);c.comma_first&&"TK_COMMA"===h&&v.just_added_newline()&&","===v.previous_line.last()&&(v.previous_line.pop(),wt(),v.add_token(","),v.space_before_token=!0);n=n||o.text;wt();v.add_token(n)}function ut(){e.indentation_level+=1}function ni(){e.indentation_level>0&&(!e.parent||e.indentation_level>e.parent.indentation_level)&&(e.indentation_level-=1)}function ft(n){e?(lt.push(e),b=e):b=yt(null,n);e=yt(b,n)}function nt(n){return n===t.ArrayLiteral}function et(i){return n(i,[t.Expression,t.ForInitializer,t.Conditional])}function g(){lt.length>0&&(b=e,e=lt.pop(),b.mode===t.Statement&&v.remove_redundant_indentation(b))}function ot(){return e.parent.mode===t.ObjectLiteral&&e.mode===t.Statement&&(":"===e.last_text&&0===e.ternary_depth||"TK_RESERVED"===h&&n(e.last_text,["get","set"]))}function tt(){return!!("TK_RESERVED"===h&&n(e.last_text,["var","let","const"])&&"TK_WORD"===o.type||"TK_RESERVED"===h&&"do"===e.last_text||"TK_RESERVED"===h&&"return"===e.last_text&&!o.wanted_newline||"TK_RESERVED"===h&&"else"===e.last_text&&("TK_RESERVED"!==o.type||"if"!==o.text)||"TK_END_EXPR"===h&&(b.mode===t.ForInitializer||b.mode===t.Conditional)||"TK_WORD"===h&&e.mode===t.BlockStatement&&!e.in_case&&"--"!==o.text&&"++"!==o.text&&"function"!==k&&"TK_WORD"!==o.type&&"TK_RESERVED"!==o.type||e.mode===t.ObjectLiteral&&(":"===e.last_text&&0===e.ternary_depth||"TK_RESERVED"===h&&n(e.last_text,["get","set"])))&&(ft(t.Statement),ut(),"TK_RESERVED"===h&&n(e.last_text,["var","let","const"])&&"TK_WORD"===o.type&&(e.declaration_statement=!0),ot()||d("TK_RESERVED"===o.type&&n(o.text,["do","for","if","while"])),!0)}function ti(n,t){for(var i=0;i<n.length;i++)if(f(n[i]).charAt(0)!==t)return!1;return!0}function ii(n,t){for(var r,i=0,u=n.length;i<u;i++)if((r=n[i])&&0!==r.indexOf(t))return!1;return!0}function st(t){return n(t,["case","return","do","if","throw","else"])}function ht(n){var t=at+(n||0);return t<0||t>=vt.length?null:vt[t]}function ri(){tt();var i=t.Expression;if("["===o.text){if("TK_WORD"===h||")"===e.last_text)return"TK_RESERVED"===h&&n(e.last_text,it.line_starters)&&(v.space_before_token=!0),ft(i),p(),ut(),void(c.space_in_paren&&(v.space_before_token=!0));i=t.ArrayLiteral;nt(e.mode)&&("["!==e.last_text&&(","!==e.last_text||"]"!==k&&"}"!==k)||c.keep_array_indentation||y())}else"TK_RESERVED"===h&&"for"===e.last_text?i=t.ForInitializer:"TK_RESERVED"===h&&n(e.last_text,["if","while"])&&(i=t.Conditional);";"===e.last_text||"TK_START_BLOCK"===h?y():"TK_END_EXPR"===h||"TK_START_EXPR"===h||"TK_END_BLOCK"===h||"."===e.last_text?d(o.wanted_newline):"TK_RESERVED"===h&&"("===o.text||"TK_WORD"===h||"TK_OPERATOR"===h?"TK_RESERVED"===h&&("function"===e.last_word||"typeof"===e.last_word)||"*"===e.last_text&&"function"===k?c.space_after_anon_function&&(v.space_before_token=!0):"TK_RESERVED"!==h||!n(e.last_text,it.line_starters)&&"catch"!==e.last_text||c.space_before_conditional&&(v.space_before_token=!0):v.space_before_token=!0;"("===o.text&&"TK_RESERVED"===h&&"await"===e.last_word&&(v.space_before_token=!0);"("===o.text&&("TK_EQUALS"!==h&&"TK_OPERATOR"!==h||ot()||d());ft(i);p();c.space_in_paren&&(v.space_before_token=!0);ut()}function ui(){for(;e.mode===t.Statement;)g();e.multiline_frame&&d("]"===o.text&&nt(e.mode)&&!c.keep_array_indentation);c.space_in_paren&&("TK_START_EXPR"!==h||c.space_in_empty_paren?v.space_before_token=!0:(v.trim(),v.space_before_token=!1));"]"===o.text&&c.keep_array_indentation?(p(),g()):(g(),p());v.remove_redundant_indentation(b);e.do_while&&b.mode===t.Conditional&&(b.mode=t.Expression,e.do_block=!1,e.do_while=!1)}function fi(){var i=ht(1),r=ht(2),u,f;ft(r&&(":"===r.text&&n(i.type,["TK_STRING","TK_WORD","TK_RESERVED"])||n(i.text,["get","set"])&&n(r.type,["TK_WORD","TK_RESERVED"]))?n(k,["class","interface"])?t.BlockStatement:t.ObjectLiteral:t.BlockStatement);u=!i.comments_before.length&&"}"===i.text;f=u&&"function"===e.last_word&&"TK_END_EXPR"===h;"expand"===c.brace_style||"none"===c.brace_style&&o.wanted_newline?"TK_OPERATOR"!==h&&(f||"TK_EQUALS"===h||"TK_RESERVED"===h&&st(e.last_text)&&"else"!==e.last_text)?v.space_before_token=!0:y(!1,!0):"TK_OPERATOR"!==h&&"TK_START_EXPR"!==h?"TK_START_BLOCK"===h?y():v.space_before_token=!0:nt(b.mode)&&","===e.last_text&&("}"===k?v.space_before_token=!0:y());p();ut()}function ei(){for(;e.mode===t.Statement;)g();var n="TK_START_BLOCK"===h;"expand"===c.brace_style?n||y():n||(nt(e.mode)&&c.keep_array_indentation?(c.keep_array_indentation=!1,y(),c.keep_array_indentation=!0):y());g();p()}function bt(){if(("TK_RESERVED"===o.type&&e.mode!==t.ObjectLiteral&&n(o.text,["set","get"])&&(o.type="TK_WORD"),"TK_RESERVED"===o.type&&e.mode===t.ObjectLiteral)&&":"==ht(1).text&&(o.type="TK_WORD"),tt()||!o.wanted_newline||et(e.mode)||"TK_OPERATOR"===h&&"--"!==e.last_text&&"++"!==e.last_text||"TK_EQUALS"===h||!c.preserve_newlines&&"TK_RESERVED"===h&&n(e.last_text,["var","let","const","set","get"])||y(),e.do_block&&!e.do_while){if("TK_RESERVED"===o.type&&"while"===o.text)return v.space_before_token=!0,p(),v.space_before_token=!0,void(e.do_while=!0);y();e.do_block=!1}if(e.if_block)if(e.else_block||"TK_RESERVED"!==o.type||"else"!==o.text){for(;e.mode===t.Statement;)g();e.if_block=!1;e.else_block=!1}else e.else_block=!0;if("TK_RESERVED"===o.type&&("case"===o.text||"default"===o.text&&e.in_case_statement))return y(),(e.case_body||c.jslint_happy)&&(ni(),e.case_body=!1),p(),e.in_case=!0,void(e.in_case_statement=!0);if("TK_RESERVED"===o.type&&"function"===o.text&&((n(e.last_text,["}",";"])||v.just_added_newline()&&!n(e.last_text,["[","{",":","=",","]))&&(v.just_added_blankline()||o.comments_before.length||(y(),y(!0))),"TK_RESERVED"===h||"TK_WORD"===h?"TK_RESERVED"===h&&n(e.last_text,["get","set","new","return","export","async"])?v.space_before_token=!0:"TK_RESERVED"===h&&"default"===e.last_text&&"export"===k?v.space_before_token=!0:y():"TK_OPERATOR"===h||"="===e.last_text?v.space_before_token=!0:(e.multiline_frame||!et(e.mode)&&!nt(e.mode))&&y()),"TK_COMMA"!==h&&"TK_START_EXPR"!==h&&"TK_EQUALS"!==h&&"TK_OPERATOR"!==h||ot()||d(),"TK_RESERVED"===o.type&&n(o.text,["function","get","set"]))return p(),void(e.last_word=o.text);if(w="NONE","TK_END_BLOCK"===h?"TK_RESERVED"===o.type&&n(o.text,["else","catch","finally"])?"expand"===c.brace_style||"end-expand"===c.brace_style||"none"===c.brace_style&&o.wanted_newline?w="NEWLINE":(w="SPACE",v.space_before_token=!0):w="NEWLINE":"TK_SEMICOLON"===h&&e.mode===t.BlockStatement?w="NEWLINE":"TK_SEMICOLON"===h&&et(e.mode)?w="SPACE":"TK_STRING"===h?w="NEWLINE":"TK_RESERVED"===h||"TK_WORD"===h||"*"===e.last_text&&"function"===k?w="SPACE":"TK_START_BLOCK"===h?w="NEWLINE":"TK_END_EXPR"===h&&(v.space_before_token=!0,w="NEWLINE"),"TK_RESERVED"===o.type&&n(o.text,it.line_starters)&&")"!==e.last_text&&(w="else"===e.last_text||"export"===e.last_text?"SPACE":"NEWLINE"),"TK_RESERVED"===o.type&&n(o.text,["else","catch","finally"]))if("TK_END_BLOCK"!==h||"expand"===c.brace_style||"end-expand"===c.brace_style||"none"===c.brace_style&&o.wanted_newline)y();else{v.trim(!0);var i=v.current_line;"}"!==i.last()&&y();v.space_before_token=!0}else"NEWLINE"===w?"TK_RESERVED"===h&&st(e.last_text)?v.space_before_token=!0:"TK_END_EXPR"!==h?"TK_START_EXPR"===h&&"TK_RESERVED"===o.type&&n(o.text,["var","let","const"])||":"===e.last_text||("TK_RESERVED"===o.type&&"if"===o.text&&"else"===e.last_text?v.space_before_token=!0:y()):"TK_RESERVED"===o.type&&n(o.text,it.line_starters)&&")"!==e.last_text&&y():e.multiline_frame&&nt(e.mode)&&","===e.last_text&&"}"===k?y():"SPACE"===w&&(v.space_before_token=!0);p();e.last_word=o.text;"TK_RESERVED"===o.type&&"do"===o.text&&(e.do_block=!0);"TK_RESERVED"===o.type&&"if"===o.text&&(e.if_block=!0)}function oi(){for(tt()&&(v.space_before_token=!1);e.mode===t.Statement&&!e.if_block&&!e.do_block;)g();p()}function si(){tt()?v.space_before_token=!0:"TK_RESERVED"===h||"TK_WORD"===h?v.space_before_token=!0:"TK_COMMA"===h||"TK_START_EXPR"===h||"TK_EQUALS"===h||"TK_OPERATOR"===h?ot()||d():y();p()}function hi(){tt();e.declaration_statement&&(e.declaration_assignment=!0);v.space_before_token=!0;p();v.space_before_token=!0}function ci(){if(e.declaration_statement)return et(e.parent.mode)&&(e.declaration_assignment=!1),p(),void(e.declaration_assignment?(e.declaration_assignment=!1,y(!1,!0)):(v.space_before_token=!0,c.comma_first&&d()));p();e.mode===t.ObjectLiteral||e.mode===t.Statement&&e.parent.mode===t.ObjectLiteral?(e.mode===t.Statement&&g(),y()):(v.space_before_token=!0,c.comma_first&&d())}function li(){if(tt(),"TK_RESERVED"===h&&st(e.last_text))return v.space_before_token=!0,void p();if("*"===o.text&&"TK_DOT"===h)return void p();if(":"===o.text&&e.in_case)return e.case_body=!0,ut(),p(),y(),void(e.in_case=!1);if("::"===o.text)return void p();"TK_OPERATOR"===h&&d();var i=!0,r=!0;n(o.text,["--","++","!","~"])||n(o.text,["-","+"])&&(n(h,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||n(e.last_text,it.line_starters)||","===e.last_text)?(i=!1,r=!1,!o.wanted_newline||"--"!==o.text&&"++"!==o.text||y(!1,!0),";"===e.last_text&&et(e.mode)&&(i=!0),"TK_RESERVED"===h?i=!0:"TK_END_EXPR"===h?i=!("]"===e.last_text&&("--"===o.text||"++"===o.text)):"TK_OPERATOR"===h&&(i=n(o.text,["--","-","++","+"])&&n(e.last_text,["--","-","++","+"]),n(o.text,["+","-"])&&n(e.last_text,["--","++"])&&(r=!0)),e.mode!==t.BlockStatement&&e.mode!==t.Statement||"{"!==e.last_text&&";"!==e.last_text||y()):":"===o.text?0===e.ternary_depth?i=!1:e.ternary_depth-=1:"?"===o.text?e.ternary_depth+=1:"*"===o.text&&"TK_RESERVED"===h&&"function"===e.last_text&&(i=!1,r=!1);v.space_before_token=v.space_before_token||i;p();v.space_before_token=r}function ai(){if(v.raw)return v.add_raw_token(o),void(o.directives&&"end"===o.directives.preserve&&(c.test_output_raw||(v.raw=!1)));if(o.directives)return y(!1,!0),p(),"start"===o.directives.preserve&&(v.raw=!0),void y(!1,!0);if(!i.newline.test(o.text)&&!o.wanted_newline)return v.space_before_token=!0,p(),void(v.space_before_token=!0);var t,n=gt(o.text),r=!1,u=!1,f=o.whitespace_before,e=f.length;for(y(!1,!0),n.length>1&&(ti(n.slice(1),"*")?r=!0:ii(n.slice(1),f)&&(u=!0)),p(n[0]),t=1;t<n.length;t++)y(!1,!0),r?p(" "+s(n[t])):u&&n[t].length>e?p(n[t].substring(e)):v.add_token(n[t]);y(!1,!0)}function vi(){o.wanted_newline?y(!1,!0):v.trim(!0);v.space_before_token=!0;p();y(!1,!0)}function yi(){tt();"TK_RESERVED"===h&&st(e.last_text)?v.space_before_token=!0:d(")"===e.last_text&&c.break_chained_methods);p()}function pi(){p();"\n"===o.text[o.text.length-1]&&y()}function wi(){for(;e.mode===t.Statement;)g()}var v,at,it,o,h,k,ct,e,b,lt,w,kt,c,vt=[],dt="",rt;for(kt={TK_START_EXPR:ri,TK_END_EXPR:ui,TK_START_BLOCK:fi,TK_END_BLOCK:ei,TK_WORD:bt,TK_RESERVED:bt,TK_SEMICOLON:oi,TK_STRING:si,TK_EQUALS:hi,TK_OPERATOR:li,TK_COMMA:ci,TK_BLOCK_COMMENT:ai,TK_COMMENT:vi,TK_DOT:yi,TK_UNKNOWN:pi,TK_EOF:wi},u=u||{},c={},void 0!==u.braces_on_own_line&&(c.brace_style=u.braces_on_own_line?"expand":"collapse"),c.brace_style=u.brace_style?u.brace_style:c.brace_style?c.brace_style:"collapse","expand-strict"===c.brace_style&&(c.brace_style="expand"),c.indent_size=u.indent_size?parseInt(u.indent_size,10):4,c.indent_char=u.indent_char?u.indent_char:" ",c.eol=u.eol?u.eol:"\n",c.preserve_newlines=void 0===u.preserve_newlines||u.preserve_newlines,c.break_chained_methods=void 0!==u.break_chained_methods&&u.break_chained_methods,c.max_preserve_newlines=void 0===u.max_preserve_newlines?0:parseInt(u.max_preserve_newlines,10),c.space_in_paren=void 0!==u.space_in_paren&&u.space_in_paren,c.space_in_empty_paren=void 0!==u.space_in_empty_paren&&u.space_in_empty_paren,c.jslint_happy=void 0!==u.jslint_happy&&u.jslint_happy,c.space_after_anon_function=void 0!==u.space_after_anon_function&&u.space_after_anon_function,c.keep_array_indentation=void 0!==u.keep_array_indentation&&u.keep_array_indentation,c.space_before_conditional=void 0===u.space_before_conditional||u.space_before_conditional,c.unescape_strings=void 0!==u.unescape_strings&&u.unescape_strings,c.wrap_line_length=void 0===u.wrap_line_length?0:parseInt(u.wrap_line_length,10),c.e4x=void 0!==u.e4x&&u.e4x,c.end_with_newline=void 0!==u.end_with_newline&&u.end_with_newline,c.comma_first=void 0!==u.comma_first&&u.comma_first,c.test_output_raw=void 0!==u.test_output_raw&&u.test_output_raw,c.jslint_happy&&(c.space_after_anon_function=!0),u.indent_with_tabs&&(c.indent_char="\t",c.indent_size=1),c.eol=c.eol.replace(/\\r/,"\r").replace(/\\n/,"\n"),ct="";c.indent_size>0;)ct+=c.indent_char,c.indent_size-=1;if(rt=0,r&&r.length){for(;" "===r.charAt(rt)||"\t"===r.charAt(rt);)dt+=r.charAt(rt),rt+=1;r=r.substring(rt)}h="TK_START_BLOCK";k="";v=new l(ct,dt);v.raw=c.test_output_raw;lt=[];ft(t.BlockStatement);this.beautify=function(){var n,t,i;for(it=new a(r,c,ct),vt=it.tokenize(),at=0;n=ht();){for(i=0;i<n.comments_before.length;i++)pt(n.comments_before[i]);pt(n);k=e.last_text;h=n.type;e.last_text=n.text;at+=1}return t=v.get_code(),c.end_with_newline&&(t+="\n"),"\n"!=c.eol&&(t=t.replace(/[\n]/g,c.eol)),t}}function c(n){var i=0,r=-1,t=[],u=!0;this.set_indent=function(t){i=n.baseIndentLength+t*n.indent_length;r=t};this.get_character_count=function(){return i};this.is_empty=function(){return u};this.last=function(){return this._empty?null:t[t.length-1]};this.push=function(n){t.push(n);i+=n.length;u=!1};this.pop=function(){var n=null;return u||(n=t.pop(),i-=n.length,u=0===t.length),n};this.remove_indent=function(){r>0&&(r-=1,i-=n.indent_length)};this.trim=function(){for(;" "===this.last();)t.pop(),i-=1;u=0===t.length};this.toString=function(){var i="";return this._empty||(r>=0&&(i=n.indent_cache[r]),i+=t.join("")),i}}function l(n,i){i=i||"";this.indent_cache=[i];this.baseIndentLength=i.length;this.indent_length=n.length;this.raw=!1;var r=[];this.baseIndentString=i;this.indent_string=n;this.previous_line=null;this.current_line=null;this.space_before_token=!1;this.add_outputline=function(){this.previous_line=this.current_line;this.current_line=new c(this);r.push(this.current_line)};this.add_outputline();this.get_line_number=function(){return r.length};this.add_new_line=function(n){return(1!==this.get_line_number()||!this.just_added_newline())&&!(!n&&this.just_added_newline())&&(this.raw||this.add_outputline(),!0)};this.get_code=function(){return r.join("\n").replace(/[\r\n\t ]+$/,"")};this.set_indent=function(n){if(r.length>1){for(;n>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);return this.current_line.set_indent(n),!0}return this.current_line.set_indent(0),!1};this.add_raw_token=function(n){for(var t=0;t<n.newlines;t++)this.add_outputline();this.current_line.push(n.whitespace_before);this.current_line.push(n.text);this.space_before_token=!1};this.add_token=function(n){this.add_space_before_token();this.current_line.push(n)};this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" ");this.space_before_token=!1};this.remove_redundant_indentation=function(n){if(!n.multiline_frame&&n.mode!==t.ForInitializer&&n.mode!==t.Conditional)for(var i=n.start_line_index,u=r.length;i<u;)r[i].remove_indent(),i++};this.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim(n,i);t&&r.length>1&&this.current_line.is_empty();)r.pop(),this.current_line=r[r.length-1],this.current_line.trim();this.previous_line=r.length>1?r[r.length-2]:null};this.just_added_newline=function(){return this.current_line.is_empty()};this.just_added_blankline=function(){return this.just_added_newline()?1===r.length?!0:r[r.length-2].is_empty():!1}}function a(t,u){function g(n){var i,t;if(!n.match(ft))return null;for(i={},v.lastIndex=0,t=v.exec(n);t;)i[t[1]]=t[2],t=v.exec(n);return i}function y(){var y,vt=[],ft,v,ot,pt,st,wt,ri,bt,dt,at,gt;if(h=0,c="",e>=o)return["","TK_EOF"];for(ft=s.length?s[s.length-1]:new r("TK_START_BLOCK","{"),v=t.charAt(e),e+=1;n(v,tt);){if(i.newline.test(v)?"\n"===v&&"\r"===t.charAt(e-2)||(h+=1,vt=[]):vt.push(v),e>=o)return["","TK_EOF"];v=t.charAt(e);e+=1}if(vt.length&&(c=vt.join("")),a.test(v)){var yt=!0,kt=!0,ni=a;for("0"===v&&e<o&&/[Xxo]/.test(t.charAt(e))?(yt=!1,kt=!1,v+=t.charAt(e),e+=1,ni=/[o]/.test(t.charAt(e))?it:rt):(v="",e-=1);e<o&&ni.test(t.charAt(e));)v+=t.charAt(e),e+=1,yt&&e<o&&"."===t.charAt(e)&&(v+=t.charAt(e),e+=1,yt=!1),kt&&e<o&&/[Ee]/.test(t.charAt(e))&&(v+=t.charAt(e),e+=1,e<o&&/[+-]/.test(t.charAt(e))&&(v+=t.charAt(e),e+=1),kt=!1,yt=!1);return[v,"TK_WORD"]}if(i.isIdentifierStart(t.charCodeAt(e-1))){if(e<o)for(;i.isIdentifierChar(t.charCodeAt(e))&&(v+=t.charAt(e),(e+=1)!==o););return"TK_DOT"===ft.type||"TK_RESERVED"===ft.type&&n(ft.text,["set","get"])||!n(v,ut)?[v,"TK_WORD"]:"in"===v?[v,"TK_OPERATOR"]:[v,"TK_RESERVED"]}if("("===v||"["===v)return[v,"TK_START_EXPR"];if(")"===v||"]"===v)return[v,"TK_END_EXPR"];if("{"===v)return[v,"TK_START_BLOCK"];if("}"===v)return[v,"TK_END_BLOCK"];if(";"===v)return[v,"TK_SEMICOLON"];if("/"===v){if(ot="","*"===t.charAt(e))return e+=1,w.lastIndex=e,st=w.exec(t),ot="/*"+st[0],e+=st[0].length,pt=g(ot),pt&&"start"===pt.ignore&&(k.lastIndex=e,st=k.exec(t),ot+=st[0],e+=st[0].length),ot=ot.replace(i.lineBreak,"\n"),[ot,"TK_BLOCK_COMMENT",pt];if("/"===t.charAt(e))return e+=1,b.lastIndex=e,st=b.exec(t),ot="//"+st[0],e+=st[0].length,[ot,"TK_COMMENT"]}if("`"===v||"'"===v||'"'===v||("/"===v||u.e4x&&"<"===v&&t.slice(e-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])(\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{.*?}))*\s*(\/?)\s*>/))&&("TK_RESERVED"===ft.type&&n(ft.text,["return","case","throw","else","do","typeof","yield"])||"TK_END_EXPR"===ft.type&&")"===ft.text&&ft.parent&&"TK_RESERVED"===ft.parent.type&&n(ft.parent.text,["if","while","for"])||n(ft.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var ht=v,ct=!1,ti=!1;if(y=v,"/"===ht)for(wt=!1;e<o&&(ct||wt||t.charAt(e)!==ht)&&!i.newline.test(t.charAt(e));)y+=t.charAt(e),ct?ct=!1:(ct="\\"===t.charAt(e),"["===t.charAt(e)?wt=!0:"]"===t.charAt(e)&&(wt=!1)),e+=1;else if(u.e4x&&"<"===ht){var ii=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])(\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{.*?}))*\s*(\/?)\s*>/g,lt=t.slice(e-1),et=ii.exec(lt);if(et&&0===et.index){for(ri=et[2],bt=0;et;){var fi=!!et[1],ui=et[2],ei=!!et[et.length-1]||"![CDATA["===ui.slice(0,8);if(ui!==ri||ei||(fi?--bt:++bt),bt<=0)break;et=ii.exec(lt)}return dt=et?et.index+et[0].length:lt.length,lt=lt.slice(0,dt),e+=dt-1,lt=lt.replace(i.lineBreak,"\n"),[lt,"TK_STRING"]}}else for(;e<o&&(ct||t.charAt(e)!==ht&&("`"===ht||!i.newline.test(t.charAt(e))));)(ct||"`"===ht)&&i.newline.test(t.charAt(e))?("\r"===t.charAt(e)&&"\n"===t.charAt(e+1)&&(e+=1),y+="\n"):y+=t.charAt(e),ct?("x"!==t.charAt(e)&&"u"!==t.charAt(e)||(ti=!0),ct=!1):ct="\\"===t.charAt(e),e+=1;if(ti&&u.unescape_strings&&(y=nt(y)),e<o&&t.charAt(e)===ht&&(y+=ht,e+=1,"/"===ht))for(;e<o&&i.isIdentifierStart(t.charCodeAt(e));)y+=t.charAt(e),e+=1;return[y,"TK_STRING"]}if("#"===v){if(0===s.length&&"!"===t.charAt(e)){for(y=v;e<o&&"\n"!==v;)v=t.charAt(e),y+=v,e+=1;return[f(y)+"\n","TK_UNKNOWN"]}if(at="#",e<o&&a.test(t.charAt(e))){do v=t.charAt(e),at+=v,e+=1;while(e<o&&"#"!==v&&"="!==v);return"#"===v||("["===t.charAt(e)&&"]"===t.charAt(e+1)?(at+="[]",e+=2):"{"===t.charAt(e)&&"}"===t.charAt(e+1)&&(at+="{}",e+=2)),[at,"TK_WORD"]}}if("<"===v&&("?"===t.charAt(e)||"%"===t.charAt(e))&&(d.lastIndex=e-1,gt=d.exec(t),gt))return v=gt[0],e+=v.length-1,v=v.replace(i.lineBreak,"\n"),[v,"TK_STRING"];if("<"===v&&"<!--"===t.substring(e-1,e+3)){for(e+=3,v="<!--";!i.newline.test(t.charAt(e))&&e<o;)v+=t.charAt(e),e++;return l=!0,[v,"TK_COMMENT"]}if("-"===v&&l&&"-->"===t.substring(e-1,e+2))return l=!1,e+=2,["-->","TK_COMMENT"];if("."===v)return[v,"TK_DOT"];if(n(v,p)){for(;e<o&&n(v+t.charAt(e),p)&&(v+=t.charAt(e),!((e+=1)>=o)););return","===v?[v,"TK_COMMA"]:"="===v?[v,"TK_EQUALS"]:[v,"TK_OPERATOR"]}return[v,"TK_UNKNOWN"]}function nt(n){for(var i,e=!1,u="",r=0,f="",t=0;e||r<n.length;)if(i=n.charAt(r),r++,e){if(e=!1,"x"===i)f=n.substr(r,2),r+=2;else{if("u"!==i){u+="\\"+i;continue}f=n.substr(r,4);r+=4}if(!f.match(/^[0123456789abcdefABCDEF]+$/))return n;if((t=parseInt(f,16))>=0&&t<32){u+="x"===i?"\\x"+f:"\\u"+f;continue}if(34===t||39===t||92===t)u+="\\"+String.fromCharCode(t);else{if("x"===i&&t>126&&t<=255)return n;u+=String.fromCharCode(t)}}else"\\"===i?e=!0:u+=i;return u}var tt="\n\r\t ".split(""),a=/[0-9]/,it=/[01234567]/,rt=/[0123456789abcdefABCDEF]/,p="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: =>".split(" ");this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var h,c,l,s,e,o,ut=this.line_starters.concat(["do","in","else","get","set","new","catch","finally","typeof","yield","async","await"]),w=/([\s\S]*?)((?:\*\/)|$)/g,b=/([^\n\r\u2028\u2029]*)/g,ft=/\/\* beautify( \w+[:]\w+)+ \*\//g,v=/ (\w+)[:](\w+)/g,k=/([\s\S]*?)((?:\/\*\sbeautify\signore:end\s\*\/)|$)/g,d=/((<\?php|<\?=)[\s\S]*?\?>)|(<%[\s\S]*?%>)/g;this.tokenize=function(){o=t.length;e=0;l=!1;s=[];for(var n,f,u,i=null,v=[],a=[];!f||"TK_EOF"!==f.type;){for(u=y(),n=new r(u[1],u[0],h,c);"TK_COMMENT"===n.type||"TK_BLOCK_COMMENT"===n.type||"TK_UNKNOWN"===n.type;)"TK_BLOCK_COMMENT"===n.type&&(n.directives=u[2]),a.push(n),u=y(),n=new r(u[1],u[0],h,c);a.length&&(n.comments_before=a,a=[]);"TK_START_BLOCK"===n.type||"TK_START_EXPR"===n.type?(n.parent=f,v.push(i),i=n):("TK_END_BLOCK"===n.type||"TK_END_EXPR"===n.type)&&i&&("]"===n.text&&"["===i.text||")"===n.text&&"("===i.text||"}"===n.text&&"{"===i.text)&&(n.parent=i.parent,i=v.pop());s.push(n);f=n}return s}}var i={},t,r;return!function(n){var t="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",i=new RegExp("["+t+"]"),r=new RegExp("["+t+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]");n.newline=/[\n\r\u2028\u2029]/;n.lineBreak=new RegExp("\r\n|"+n.newline.source);n.allLineBreaks=new RegExp(n.lineBreak.source,"g");n.isIdentifierStart=function(n){return n<65?36===n||64===n:n<91||(n<97?95===n:n<123||n>=170&&i.test(String.fromCharCode(n)))};n.isIdentifierChar=function(n){return n<48?36===n:n<58||!(n<65)&&(n<91||(n<97?95===n:n<123||n>=170&&r.test(String.fromCharCode(n))))}}(i),t={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},r=function(n,t,i,r){this.type=n;this.text=t;this.comments_before=[];this.newlines=i||0;this.wanted_newline=i>0;this.whitespace_before=r||"";this.parent=null;this.directives=null},{run:o}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{codeMirror:window.CodeMirror,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"\t",indent_size:1,wrap_line_length:0},codeViewKeepActiveButtons:["fullscreen"]});n.FE.PLUGINS.codeView=function(t){function u(){return t.$box.hasClass("fr-code-view")}function o(){return r?r.getValue():i.val()}function s(n){var i=o();t.html.set(i);t.$el.blur();t.$tb.find(" > .fr-command").not(n).removeClass("fr-disabled").attr("aria-disabled",!1);n.removeClass("fr-active").attr("aria-pressed",!1);t.events.focus(!0);t.placeholder.refresh();t.undo.saveStep()}function h(u){var f,o,e,s,h,c;i||(l(),!r&&t.opts.codeMirror?r=t.opts.codeMirror.fromTextArea(i.get(0),t.opts.codeMirrorOptions):t.events.$on(i,"keydown keyup change input",function(){t.opts.height?this.removeAttribute("rows"):(this.rows=1,this.style.height=0===this.value.length?"auto":this.scrollHeight+"px")}));t.undo.saveStep();t.html.cleanEmptyTags();t.html.cleanWhiteTags(!0);t.core.hasFocus()&&(t.core.isEmpty()||(t.selection.save(),t.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F<\/span>'),t.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F<\/span>')));f=t.html.get(!1,!0);t.$el.find("span.fr-tmp").remove();t.$box.toggleClass("fr-code-view",!0);t.core.hasFocus()&&t.$el.blur();f=f.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM");f=f.replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM");t.codeBeautifier&&(f=t.codeBeautifier.run(f,t.opts.codeBeautifierOptions));r?(o=f.indexOf("FROALA-SM"),e=f.indexOf("FROALA-EM"),o>e?o=e:e-=9,f=f.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,""),s=f.substring(0,o).length-f.substring(0,o).replace(/\n/g,"").length,h=f.substring(0,e).length-f.substring(0,e).replace(/\n/g,"").length,o=f.substring(0,o).length-f.substring(0,f.substring(0,o).lastIndexOf("\n")+1).length,e=f.substring(0,e).length-f.substring(0,f.substring(0,e).lastIndexOf("\n")+1).length,r.setSize(null,t.opts.height?t.opts.height:"auto"),t.opts.heightMin&&t.$box.find(".CodeMirror-scroll").css("min-height",t.opts.heightMin),r.setValue(f),r.focus(),r.setSelection({line:s,ch:o},{line:h,ch:e}),r.refresh(),r.clearHistory()):(o=f.indexOf("FROALA-SM"),e=f.indexOf("FROALA-EM")-9,t.opts.heightMin&&i.css("min-height",t.opts.heightMin),t.opts.height&&i.css("height",t.opts.height),t.opts.heightMax&&i.css("max-height",t.opts.height||t.opts.heightMax),i.val(f.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change"),c=n(t.o_doc).scrollTop(),i.focus(),i.get(0).setSelectionRange(o,e),n(t.o_doc).scrollTop(c));t.$tb.find(" > .fr-command").not(u).filter(function(){return t.opts.codeViewKeepActiveButtons.indexOf(n(this).data("cmd"))<0}).addClass("fr-disabled").attr("aria-disabled",!0);u.addClass("fr-active").attr("aria-pressed",!0);!t.helpers.isMobile()&&t.opts.toolbarInline&&t.toolbar.hide()}function e(n){void 0===n&&(n=!u());var i=t.$tb.find('.fr-command[data-cmd="html"]');n?(t.popups.hideAll(),h(i)):(t.$box.toggleClass("fr-code-view",!1),s(i))}function c(){u()&&e(!1);r&&r.toTextArea();i.val("").removeData().remove();i=null;f&&(f.remove(),f=null)}function l(){i=n('<textarea class="fr-code ignore" tabIndex="-1">');t.$wp.append(i);i.attr("dir",t.opts.direction);t.$box.hasClass("fr-basic")||(f=n('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(t.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabIndex="-1"><i class="fa fa-code"><\/i><\/button>'),t.$box.append(f),t.events.bindClick(t.$box,"a.html-switch",function(){e(!1)}));var r=function(){return!u()};t.events.on("buttons.refresh",r);t.events.on("copy",r,!0);t.events.on("cut",r,!0);t.events.on("paste",r,!0);t.events.on("destroy",c,!0);t.events.on("html.set",function(){u()&&e(!0)});t.events.on("form.submit",function(){u()&&(t.html.set(o()),t.events.trigger("contentChanged",[],!0))},!0)}function a(){if(!t.$wp)return!1}var i,r,f;return{_init:a,toggle:e,isActive:u,get:o}};n.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,toggle:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"});n.FE.DefineIcon("html",{NAME:"code"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"colors.picker":"[_BUTTONS_][_TEXT_COLORS_][_BACKGROUND_COLORS_][_CUSTOM_COLOR_]"});n.extend(n.FE.DEFAULTS,{colorsText:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsBackground:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorsHEXInput:!0,colorsDefaultTab:"text",colorsButtons:["colorsBack","|","-"]});n.FE.PLUGINS.colors=function(t){function o(){var n=t.$tb.find('.fr-command[data-cmd="color"]'),i=t.popups.get("colors.picker"),r,f;(i||(i=s()),i.hasClass("fr-active"))||((t.popups.setContainer("colors.picker",t.$tb),u(i.find(".fr-selected-tab").attr("data-param1")),n.is(":visible"))?(r=n.offset().left+n.outerWidth()/2,f=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("colors.picker",r,f,n.outerHeight())):(t.position.forSelection(i),t.popups.show("colors.picker")))}function i(){t.popups.hide("colors.picker")}function s(){var n='<div class="fr-buttons fr-colors-buttons">',i,f,u;return t.opts.toolbarInline&&t.opts.colorsButtons.length>0&&(n+=t.button.buildList(t.opts.colorsButtons)),n+=h()+"<\/div>",i="",t.opts.colorsHEXInput&&(i='<div class="fr-color-hex-layer fr-active fr-layer" id="fr-color-hex-layer-'+t.id+'"><div class="fr-input-line"><input maxlength="7" id="fr-color-hex-layer-text-'+t.id+'" type="text" placeholder="HEX Color" tabIndex="1" aria-required="true"><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="customColor" tabIndex="2" role="button">'+t.language.translate("OK")+"<\/button><\/div><\/div>"),f={buttons:n,text_colors:r("text"),background_colors:r("background"),custom_color:i},u=t.popups.create("colors.picker",f),c(u),u}function h(){var n='<div class="fr-colors-tabs fr-group">';return n+='<span class="fr-colors-tab '+("background"==t.opts.colorsDefaultTab?"":"fr-selected-tab ")+'fr-command" tabIndex="-1" role="button" aria-pressed="'+("background"!=t.opts.colorsDefaultTab)+'" data-param1="text" data-cmd="colorChangeSet" title="'+t.language.translate("Text")+'">'+t.language.translate("Text")+"<\/span>",(n+='<span class="fr-colors-tab '+("background"==t.opts.colorsDefaultTab?"fr-selected-tab ":"")+'fr-command" tabIndex="-1" role="button" aria-pressed="'+("background"==t.opts.colorsDefaultTab)+'" data-param1="background" data-cmd="colorChangeSet" title="'+t.language.translate("Background")+'">'+t.language.translate("Background")+"<\/span>")+"<\/div>"}function r(n){for(var r="text"==n?t.opts.colorsText:t.opts.colorsBackground,u='<div class="fr-color-set fr-'+n+"-color"+(t.opts.colorsDefaultTab==n||"text"!=t.opts.colorsDefaultTab&&"background"!=t.opts.colorsDefaultTab&&"text"==n?" fr-selected-set":"")+'">',i=0;i<r.length;i++)0!==i&&i%t.opts.colorsStep==0&&(u+="<br>"),u+="REMOVE"!=r[i]?'<span class="fr-command fr-select-color" style="background: '+r[i]+';" tabIndex="-1" aria-selected="false" role="button" data-cmd="'+n+'Color" data-param1="'+r[i]+'"><span class="fr-sr-only">'+t.language.translate("Color")+" "+r[i]+"&nbsp;&nbsp;&nbsp;<\/span><\/span>":'<span class="fr-command fr-select-color" data-cmd="'+n+'Color" tabIndex="-1" role="button" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'">'+t.icon.create("remove")+'<span class="fr-sr-only">'+t.language.translate("Clear Formatting")+"<\/span><\/span>";return u+"<\/div>"}function c(i){t.events.on("popup.tab",function(r){var h=n(r.currentTarget),u,s,l,v;if(!t.popups.isVisible("colors.picker")||!h.is("span"))return!0;if(u=r.which,s=!0,n.FE.KEYCODE.TAB==u)l=i.find(".fr-buttons"),s=!t.accessibility.focusToolbar(l,!!r.shiftKey);else if(n.FE.KEYCODE.ARROW_UP==u||n.FE.KEYCODE.ARROW_DOWN==u||n.FE.KEYCODE.ARROW_LEFT==u||n.FE.KEYCODE.ARROW_RIGHT==u){if(h.is("span.fr-select-color")){var c=h.parent().find("span.fr-select-color"),a=c.index(h),o=t.opts.colorsStep,y=Math.floor(c.length/o),p=a%o,w=Math.floor(a/o),f=w*o+p,e=y*o;n.FE.KEYCODE.ARROW_UP==u?f=((f-o)%e+e)%e:n.FE.KEYCODE.ARROW_DOWN==u?f=(f+o)%e:n.FE.KEYCODE.ARROW_LEFT==u?f=((f-1)%e+e)%e:n.FE.KEYCODE.ARROW_RIGHT==u&&(f=(f+1)%e);v=n(c.get(f));t.events.disableBlur();v.focus();s=!1}}else n.FE.KEYCODE.ENTER==u&&(t.button.exec(h),s=!1);return!1===s&&(r.preventDefault(),r.stopPropagation()),s},!0)}function u(i){var u,e=t.popups.get("colors.picker"),r=n(t.selection.element()),f,o,s;for(u="background"==i?"background-color":"color",f=e.find(".fr-"+i+"-color .fr-select-color"),f.find(".fr-selected-color").remove(),f.removeClass("fr-active-item"),f.not('[data-param1="REMOVE"]').attr("aria-selected",!1);r.get(0)!=t.el;){if("transparent"!=r.css(u)&&"rgba(0, 0, 0, 0)"!=r.css(u)){o=e.find(".fr-"+i+'-color .fr-select-color[data-param1="'+t.helpers.RGBToHex(r.css(u))+'"]');o.append('<span class="fr-selected-color" aria-hidden="true"><\/span>');o.addClass("fr-active-item").attr("aria-selected",!0);break}r=r.parent()}s=e.find(".fr-color-hex-layer input");s.length&&s.val(t.helpers.RGBToHex(r.css(u))).trigger("change")}function l(n,i){n.hasClass("fr-selected-tab")||(n.siblings().removeClass("fr-selected-tab").attr("aria-pressed",!1),n.addClass("fr-selected-tab").attr("aria-pressed",!0),n.parents(".fr-popup").find(".fr-color-set").removeClass("fr-selected-set"),n.parents(".fr-popup").find(".fr-color-set.fr-"+i+"-color").addClass("fr-selected-set"),u(i));t.accessibility.focusPopup(n.parents(".fr-popup"))}function f(n){"REMOVE"!=n?t.format.applyStyle("background-color",t.helpers.HEXtoRGB(n)):t.format.removeStyle("background-color");i()}function e(n){"REMOVE"!=n?t.format.applyStyle("color",t.helpers.HEXtoRGB(n)):t.format.removeStyle("color");i()}function a(){t.popups.hide("colors.picker");t.toolbar.showInline()}function v(){var i=t.popups.get("colors.picker"),r=i.find(".fr-color-hex-layer input"),n;r.length&&(n=r.val(),"background"==i.find(".fr-selected-tab").attr("data-param1")?f(n):e(n))}return{showColorsPopup:o,hideColorsPopup:i,changeSet:l,background:f,customColor:v,text:e,back:a}};n.FE.DefineIcon("colors",{NAME:"tint"});n.FE.RegisterCommand("color",{title:"Colors",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("colors.picker")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("colors.picker")):this.colors.showColorsPopup()},plugin:"colors"});n.FE.RegisterCommand("textColor",{undo:!0,callback:function(n,t){this.colors.text(t)}});n.FE.RegisterCommand("backgroundColor",{undo:!0,callback:function(n,t){this.colors.background(t)}});n.FE.RegisterCommand("colorChangeSet",{undo:!1,focus:!1,callback:function(n,t){var i=this.popups.get("colors.picker").find('.fr-command[data-cmd="'+n+'"][data-param1="'+t+'"]');this.colors.changeSet(i,t)}});n.FE.DefineIcon("colorsBack",{NAME:"arrow-left"});n.FE.RegisterCommand("colorsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.colors.back()}});n.FE.RegisterCommand("customColor",{title:"OK",undo:!0,callback:function(){this.colors.customColor()}});n.FE.DefineIcon("remove",{NAME:"eraser"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{dragInline:!0});n.FE.PLUGINS.draggable=function(t){function o(i){return!(!i.originalEvent||!i.originalEvent.target||i.originalEvent.target.nodeType!=Node.TEXT_NODE)||(i.target&&"A"==i.target.tagName&&1==i.target.childNodes.length&&"IMG"==i.target.childNodes[0].tagName&&(i.target=i.target.childNodes[0]),n(i.target).hasClass("fr-draggable")?(t.undo.canDo()||t.undo.saveStep(),t.opts.dragInline?t.$el.attr("contenteditable",!0):t.$el.attr("contenteditable",!1),t.opts.toolbarInline&&t.toolbar.hide(),n(i.target).addClass("fr-dragging"),t.browser.msie||t.browser.edge||t.selection.clear(),void i.originalEvent.dataTransfer.setData("text","Froala")):(i.preventDefault(),!1))}function r(n){return!(n&&("HTML"==n.tagName||"BODY"==n.tagName||t.node.isElement(n)))}function u(n,r,u){t.opts.iframe&&(n+=t.$iframe.offset().top,r+=t.$iframe.offset().left);i.offset().top!=n&&i.css("top",n);i.offset().left!=r&&i.css("left",r);i.width()!=u&&i.css("width",u)}function s(f){var e=t.doc.elementFromPoint(f.originalEvent.pageX-t.win.pageXOffset,f.originalEvent.pageY-t.win.pageYOffset),l,s,a,h,v,o,c;if(!r(e)){for(l=0,s=e;!r(s)&&s==e&&f.originalEvent.pageY-t.win.pageYOffset-l>0;)l++,s=t.doc.elementFromPoint(f.originalEvent.pageX-t.win.pageXOffset,f.originalEvent.pageY-t.win.pageYOffset-l);for((!r(s)||i&&0===t.$el.find(s).length&&s!=i.get(0))&&(s=null),a=0,h=e;!r(h)&&h==e&&f.originalEvent.pageY-t.win.pageYOffset+a<n(t.doc).height();)a++,h=t.doc.elementFromPoint(f.originalEvent.pageX-t.win.pageXOffset,f.originalEvent.pageY-t.win.pageYOffset+a);(!r(h)||i&&0===t.$el.find(h).length&&h!=i.get(0))&&(h=null);e=null==h&&s?s:h&&null==s?h:h&&s?l<a?s:h:null}if(n(e).hasClass("fr-drag-helper"))return!1;(e&&!t.node.isBlock(e)&&(e=t.node.blockParent(e)),e&&["TD","TH","TR","THEAD","TBODY"].indexOf(e.tagName)>=0&&(e=n(e).parents("table").get(0)),e&&["LI"].indexOf(e.tagName)>=0&&(e=n(e).parents("UL, OL").get(0)),e&&!n(e).hasClass("fr-drag-helper"))?(i||(n.FE.$draggable_helper||(n.FE.$draggable_helper=n('<div class="fr-drag-helper"><\/div>')),i=n.FE.$draggable_helper,t.events.on("shared.destroy",function(){i.html("").removeData().remove();i=null},!0)),v=f.originalEvent.pageY<n(e).offset().top+n(e).outerHeight()/2,o=n(e),c=0,v||0!==o.next().length?(v||(o=o.next()),"before"==i.data("fr-position")&&o.is(i.data("fr-tag"))||(o.prev().length>0&&(c=parseFloat(o.prev().css("margin-bottom"))||0),c=Math.max(c,parseFloat(o.css("margin-top"))||0),u(o.offset().top-c/2-t.$box.offset().top,o.offset().left-t.win.pageXOffset-t.$box.offset().left,o.width()),i.data("fr-position","before"))):"after"==i.data("fr-position")&&o.is(i.data("fr-tag"))||(c=parseFloat(o.css("margin-bottom"))||0,u(o.offset().top+n(e).height()+c/2-t.$box.offset().top,o.offset().left-t.win.pageXOffset-t.$box.offset().left,o.width()),i.data("fr-position","after")),i.data("fr-tag",o),i.addClass("fr-visible"),i.appendTo(t.$box)):i&&t.$box.find(i).length>0&&i.removeClass("fr-visible")}function h(n){n.originalEvent.dataTransfer.dropEffect="move";t.opts.dragInline?l()||!t.browser.msie&&!t.browser.edge||n.preventDefault():(n.preventDefault(),s(n))}function c(n){n.originalEvent.dataTransfer.dropEffect="move";t.opts.dragInline||n.preventDefault()}function f(n){t.$el.attr("contenteditable",!0);var r=t.$el.find(".fr-dragging");i&&i.hasClass("fr-visible")&&t.$box.find(i).length?e(n):r.length&&(n.preventDefault(),n.stopPropagation());i&&t.$box.find(i).length&&i.removeClass("fr-visible");r.removeClass("fr-dragging")}function l(){for(var t=null,i=0;i<n.FE.INSTANCES.length;i++)if(t=n.FE.INSTANCES[i].$el.find(".fr-dragging"),t.length)return t.get(0)}function e(r){for(var f,u,e,s,o=0;o<n.FE.INSTANCES.length;o++)if(f=n.FE.INSTANCES[o].$el.find(".fr-dragging"),f.length){u=n.FE.INSTANCES[o];break}if(f.length){if(r.preventDefault(),r.stopPropagation(),i&&i.hasClass("fr-visible")&&t.$box.find(i).length)i.data("fr-tag")[i.data("fr-position")]('<span class="fr-marker"><\/span>'),i.removeClass("fr-visible");else if(!1===t.markers.insertAtPoint(r.originalEvent))return!1;return!1===(f=t.events.chainTrigger("element.beforeDrop",f))?!1:(f.removeClass("fr-dragging"),e=f,(f.parent().is("A")&&(e=f.parent()),t.core.isEmpty())?t.events.focus():(t.$el.find(".fr-marker").replaceWith(n.FE.MARKERS),t.selection.restore()),(u==t||t.undo.canDo()||t.undo.saveStep(),t.core.isEmpty())?t.$el.html(e):(s=t.markers.insert(),0===e.find(s).length?n(s).replaceWith(e):n(s).replaceWith(f),f.after(n.FE.MARKERS),t.selection.restore()),t.popups.hideAll(),t.selection.save(),t.$el.find(t.html.emptyBlockTagsQuery()).not("TD, TH, LI, .fr-inner").remove(),t.html.wrap(),t.html.fillEmptyBlocks(),t.selection.restore(),t.undo.saveStep(),t.opts.iframe&&t.size.syncIframe(),u!=t&&(u.popups.hideAll(),u.$el.find(u.html.emptyBlockTagsQuery()).not("TD, TH, LI, .fr-inner").remove(),u.html.wrap(),u.html.fillEmptyBlocks(),u.undo.saveStep(),u.events.trigger("element.dropped"),u.opts.iframe&&u.size.syncIframe()),t.events.trigger("element.dropped",[e]),!1)}i&&i.removeClass("fr-visible");t.undo.canDo()||t.undo.saveStep();setTimeout(function(){t.undo.saveStep()},0)}function a(n){if(n&&"DIV"==n.tagName&&t.node.hasClass(n,"fr-drag-helper"))n.parentNode.removeChild(n);else if(n&&n.nodeType==Node.ELEMENT_NODE)for(var r=n.querySelectorAll("div.fr-drag-helper"),i=0;i<r.length;i++)r[i].parentNode.removeChild(r[i])}function v(){t.opts.enter==n.FE.ENTER_BR&&(t.opts.dragInline=!0);t.events.on("dragstart",o,!0);t.events.on("dragover",h,!0);t.events.on("dragenter",c,!0);t.events.on("document.dragend",f,!0);t.events.on("document.drop",f,!0);t.events.on("drop",e,!0);t.events.on("html.processGet",a)}var i;return{_init:v}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{emoticons:"[_BUTTONS_][_EMOTICONS_]"});n.extend(n.FE.DEFAULTS,{emoticonsStep:8,emoticonsSet:[{code:"1f600",desc:"Grinning face"},{code:"1f601",desc:"Grinning face with smiling eyes"},{code:"1f602",desc:"Face with tears of joy"},{code:"1f603",desc:"Smiling face with open mouth"},{code:"1f604",desc:"Smiling face with open mouth and smiling eyes"},{code:"1f605",desc:"Smiling face with open mouth and cold sweat"},{code:"1f606",desc:"Smiling face with open mouth and tightly-closed eyes"},{code:"1f607",desc:"Smiling face with halo"},{code:"1f608",desc:"Smiling face with horns"},{code:"1f609",desc:"Winking face"},{code:"1f60a",desc:"Smiling face with smiling eyes"},{code:"1f60b",desc:"Face savoring delicious food"},{code:"1f60c",desc:"Relieved face"},{code:"1f60d",desc:"Smiling face with heart-shaped eyes"},{code:"1f60e",desc:"Smiling face with sunglasses"},{code:"1f60f",desc:"Smirking face"},{code:"1f610",desc:"Neutral face"},{code:"1f611",desc:"Expressionless face"},{code:"1f612",desc:"Unamused face"},{code:"1f613",desc:"Face with cold sweat"},{code:"1f614",desc:"Pensive face"},{code:"1f615",desc:"Confused face"},{code:"1f616",desc:"Confounded face"},{code:"1f617",desc:"Kissing face"},{code:"1f618",desc:"Face throwing a kiss"},{code:"1f619",desc:"Kissing face with smiling eyes"},{code:"1f61a",desc:"Kissing face with closed eyes"},{code:"1f61b",desc:"Face with stuck out tongue"},{code:"1f61c",desc:"Face with stuck out tongue and winking eye"},{code:"1f61d",desc:"Face with stuck out tongue and tightly-closed eyes"},{code:"1f61e",desc:"Disappointed face"},{code:"1f61f",desc:"Worried face"},{code:"1f620",desc:"Angry face"},{code:"1f621",desc:"Pouting face"},{code:"1f622",desc:"Crying face"},{code:"1f623",desc:"Persevering face"},{code:"1f624",desc:"Face with look of triumph"},{code:"1f625",desc:"Disappointed but relieved face"},{code:"1f626",desc:"Frowning face with open mouth"},{code:"1f627",desc:"Anguished face"},{code:"1f628",desc:"Fearful face"},{code:"1f629",desc:"Weary face"},{code:"1f62a",desc:"Sleepy face"},{code:"1f62b",desc:"Tired face"},{code:"1f62c",desc:"Grimacing face"},{code:"1f62d",desc:"Loudly crying face"},{code:"1f62e",desc:"Face with open mouth"},{code:"1f62f",desc:"Hushed face"},{code:"1f630",desc:"Face with open mouth and cold sweat"},{code:"1f631",desc:"Face screaming in fear"},{code:"1f632",desc:"Astonished face"},{code:"1f633",desc:"Flushed face"},{code:"1f634",desc:"Sleeping face"},{code:"1f635",desc:"Dizzy face"},{code:"1f636",desc:"Face without mouth"},{code:"1f637",desc:"Face with medical mask"}],emoticonsButtons:["emoticonsBack","|"],emoticonsUseImage:!0});n.FE.PLUGINS.emoticons=function(t){function r(){var n=t.$tb.find('.fr-command[data-cmd="emoticons"]'),i=t.popups.get("emoticons"),r,u;(i||(i=f()),i.hasClass("fr-active"))||(t.popups.refresh("emoticons"),t.popups.setContainer("emoticons",t.$tb),r=n.offset().left+n.outerWidth()/2,u=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("emoticons",r,u,n.outerHeight()))}function u(){t.popups.hide("emoticons")}function f(){var i="",r,n;return t.opts.toolbarInline&&t.opts.emoticonsButtons.length>0&&(i='<div class="fr-buttons fr-emoticons-buttons">'+t.button.buildList(t.opts.emoticonsButtons)+"<\/div>"),r={buttons:i,emoticons:e()},n=t.popups.create("emoticons",r),t.tooltip.bind(n,".fr-emoticon"),o(n),n}function i(){var n,i,r,u,f;return t.selection.isCollapsed()?(n=t.selection.element(),i=t.selection.endElement(),n&&t.node.hasClass(n,"fr-emoticon"))?n:i&&t.node.hasClass(i,"fr-emoticon")?i:(r=t.selection.ranges(0),u=r.startContainer,u.nodeType==Node.ELEMENT_NODE&&u.childNodes.length>0&&r.startOffset>0&&(f=u.childNodes[r.startOffset-1],t.node.hasClass(f,"fr-emoticon")))?f:!1:!1}function e(){for(var i='<div style="text-align: center">',n=0;n<t.opts.emoticonsSet.length;n++)0!==n&&n%t.opts.emoticonsStep==0&&(i+="<br>"),i+='<span class="fr-command fr-emoticon" tabIndex="-1" data-cmd="insertEmoticon" title="'+t.language.translate(t.opts.emoticonsSet[n].desc)+'" role="button" data-param1="'+t.opts.emoticonsSet[n].code+'">'+(t.opts.emoticonsUseImage?'<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/'+t.opts.emoticonsSet[n].code+'.svg"/>':"&#x"+t.opts.emoticonsSet[n].code+";")+'<span class="fr-sr-only">'+t.language.translate(t.opts.emoticonsSet[n].desc)+"&nbsp;&nbsp;&nbsp;<\/span><\/span>";return t.opts.emoticonsUseImage&&(i+='<p style="font-size: 12px; text-align: center; padding: 0 5px;">Emoji free by <a class="fr-link" tabIndex="-1" href="http://emojione.com/" target="_blank" rel="nofollow" role="link" aria-label="Open Emoji One website.">Emoji One<\/a><\/p>'),i+"<\/div>"}function o(i){t.events.on("popup.tab",function(r){var u=n(r.currentTarget),c,s,a,f,y,e,v;if(!t.popups.isVisible("emoticons")||!u.is("span, a"))return!0;if(f=r.which,n.FE.KEYCODE.TAB==f)(u.is("span.fr-emoticon")&&r.shiftKey||u.is("a")&&!r.shiftKey)&&(y=i.find(".fr-buttons"),c=!t.accessibility.focusToolbar(y,!!r.shiftKey)),!1!==c&&(e=i.find("span.fr-emoticon:focus:first, span.fr-emoticon:visible:first, a"),u.is("span.fr-emoticon")&&(e=e.not("span.fr-emoticon:not(:focus)")),s=e.index(u),s=r.shiftKey?((s-1)%e.length+e.length)%e.length:(s+1)%e.length,a=e.get(s),t.events.disableBlur(),a.focus(),c=!1);else if(n.FE.KEYCODE.ARROW_UP==f||n.FE.KEYCODE.ARROW_DOWN==f||n.FE.KEYCODE.ARROW_LEFT==f||n.FE.KEYCODE.ARROW_RIGHT==f){if(u.is("span.fr-emoticon")){v=u.parent().find("span.fr-emoticon");s=v.index(u);var l=t.opts.emoticonsStep,p=Math.floor(v.length/l),w=s%l,b=Math.floor(s/l),o=b*l+w,h=p*l;n.FE.KEYCODE.ARROW_UP==f?o=((o-l)%h+h)%h:n.FE.KEYCODE.ARROW_DOWN==f?o=(o+l)%h:n.FE.KEYCODE.ARROW_LEFT==f?o=((o-1)%h+h)%h:n.FE.KEYCODE.ARROW_RIGHT==f&&(o=(o+1)%h);a=n(v.get(o));t.events.disableBlur();a.focus();c=!1}}else n.FE.KEYCODE.ENTER==f&&(u.is("a")?u[0].click():t.button.exec(u),c=!1);return!1===c&&(r.preventDefault(),r.stopPropagation()),c},!0)}function s(r,u){var f=i(),e=t.selection.ranges(0);f?(0===e.startOffset&&t.selection.element()===f?n(f).before(n.FE.MARKERS+n.FE.INVISIBLE_SPACE):e.startOffset>0&&t.selection.element()===f&&e.commonAncestorContainer.parentNode.classList.contains("fr-emoticon")&&n(f).after(n.FE.INVISIBLE_SPACE+n.FE.MARKERS),t.selection.restore(),t.html.insert('<span class="fr-emoticon fr-deletable'+(u?" fr-emoticon-img":"")+'"'+(u?' style="background: url('+u+');"':"")+">"+(u?"&nbsp;":r)+"<\/span>&nbsp;"+n.FE.MARKERS,!0)):t.html.insert('<span class="fr-emoticon fr-deletable'+(u?" fr-emoticon-img":"")+'"'+(u?' style="background: url('+u+');"':"")+">"+(u?"&nbsp;":r)+"<\/span>&nbsp;",!0)}function h(){t.popups.hide("emoticons");t.toolbar.showInline()}function c(){var r=function(){for(var i=t.el.querySelectorAll(".fr-emoticon:not(.fr-deletable)"),n=0;n<i.length;n++)i[n].className+=" fr-deletable"};r();t.events.on("html.set",r);t.events.on("keydown",function(r){if(t.keys.isCharacter(r.which)&&t.selection.inEditor()){var f=t.selection.ranges(0),u=i();t.node.hasClass(u,"fr-emoticon-img")&&u&&(0===f.startOffset&&t.selection.element()===u?n(u).before(n.FE.MARKERS+n.FE.INVISIBLE_SPACE):n(u).after(n.FE.INVISIBLE_SPACE+n.FE.MARKERS),t.selection.restore())}});t.events.on("keyup",function(r){for(var e,f=t.el.querySelectorAll(".fr-emoticon"),u=0;u<f.length;u++)void 0!==f[u].textContent&&0===f[u].textContent.replace(/\u200B/gi,"").length&&n(f[u]).remove();r.which>=n.FE.KEYCODE.ARROW_LEFT&&r.which<=n.FE.KEYCODE.ARROW_DOWN||(e=i(),t.node.hasClass(e,"fr-emoticon-img")&&(n(e).append(n.FE.MARKERS),t.selection.restore()))})}return{_init:c,insert:s,showEmoticonsPopup:r,hideEmoticonsPopup:u,back:h}};n.FE.DefineIcon("emoticons",{NAME:"smile-o"});n.FE.RegisterCommand("emoticons",{title:"Emoticons",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("emoticons")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("emoticons")):this.emoticons.showEmoticonsPopup()},plugin:"emoticons"});n.FE.RegisterCommand("insertEmoticon",{callback:function(n,t){this.emoticons.insert("&#x"+t+";",this.opts.emoticonsUseImage?"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/"+t+".svg":null);this.emoticons.hideEmoticonsPopup()}});n.FE.DefineIcon("emoticonsBack",{NAME:"arrow-left"});n.FE.RegisterCommand("emoticonsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.emoticons.back()}})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{entities:"&quot;&#39;&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&not;&shy;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&middot;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;&szlig;&agrave;&aacute;&acirc;&atilde;&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide;&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;&yuml;&OElig;&oelig;&Scaron;&scaron;&Yuml;&fnof;&circ;&tilde;&Alpha;&Beta;&Gamma;&Delta;&Epsilon;&Zeta;&Eta;&Theta;&Iota;&Kappa;&Lambda;&Mu;&Nu;&Xi;&Omicron;&Pi;&Rho;&Sigma;&Tau;&Upsilon;&Phi;&Chi;&Psi;&Omega;&alpha;&beta;&gamma;&delta;&epsilon;&zeta;&eta;&theta;&iota;&kappa;&lambda;&mu;&nu;&xi;&omicron;&pi;&rho;&sigmaf;&sigma;&tau;&upsilon;&phi;&chi;&psi;&omega;&thetasym;&upsih;&piv;&ensp;&emsp;&thinsp;&zwnj;&zwj;&lrm;&rlm;&ndash;&mdash;&lsquo;&rsquo;&sbquo;&ldquo;&rdquo;&bdquo;&dagger;&Dagger;&bull;&hellip;&permil;&prime;&Prime;&lsaquo;&rsaquo;&oline;&frasl;&euro;&image;&weierp;&real;&trade;&alefsym;&larr;&uarr;&rarr;&darr;&harr;&crarr;&lArr;&uArr;&rArr;&dArr;&hArr;&forall;&part;&exist;&empty;&nabla;&isin;&notin;&ni;&prod;&sum;&minus;&lowast;&radic;&prop;&infin;&ang;&and;&or;&cap;&cup;&int;&there4;&sim;&cong;&asymp;&ne;&equiv;&le;&ge;&sub;&sup;&nsub;&sube;&supe;&oplus;&otimes;&perp;&sdot;&lceil;&rceil;&lfloor;&rfloor;&lang;&rang;&loz;&spades;&clubs;&hearts;&diams;"});n.FE.PLUGINS.entities=function(t){function u(n){var u=n.textContent,f,t;if(u.match(i)){for(f="",t=0;t<u.length;t++)f+=r[u[t]]?r[u[t]]:u[t];n.textContent=f}}function f(n){if(n&&["STYLE","SCRIPT","svg","IFRAME"].indexOf(n.tagName)>=0)return!0;for(var r=t.node.contents(n),i=0;i<r.length;i++)r[i].nodeType==Node.TEXT_NODE?u(r[i]):f(r[i]);n.nodeType==Node.TEXT_NODE&&u(n)}function e(n){return 0===n.length?"":t.clean.exec(n,f).replace(/\&amp;/g,"&")}function o(){var f,s,u,o;for(t.opts.htmlSimpleAmpersand||(t.opts.entities=t.opts.entities+"&amp;"),f=n("<div>").html(t.opts.entities).text(),s=t.opts.entities.split(";"),r={},i="",u=0;u<f.length;u++)o=f.charAt(u),r[o]=s[u]+";",i+="\\"+o+(u<f.length-1?"|":"");i=new RegExp("("+i+")","g");t.events.on("html.get",e,!0)}var i,r;return{_init:o}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"file.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_PROGRESS_BAR_]"});n.extend(n.FE.DEFAULTS,{fileUploadURL:"/FileApi/upload",fileUploadParam:"file",fileUploadParams:{},fileUploadToS3:!1,fileUploadMethod:"POST",fileMaxSize:10485760,fileAllowedTypes:["*"],fileInsertButtons:["fileBack","|"],fileUseSelectedText:!1});n.FE.PLUGINS.file=function(t){function b(){var n=t.$tb.find('.fr-command[data-cmd="insertFile"]'),i=t.popups.get("file.insert"),r,u;(i||(i=o()),e(),i.hasClass("fr-active"))||((t.popups.refresh("file.insert"),t.popups.setContainer("file.insert",t.$tb),n.is(":visible"))?(r=n.offset().left+n.outerWidth()/2,u=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("file.insert",r,u,n.outerHeight())):(t.position.forSelection(i),t.popups.show("file.insert")))}function s(){var n=t.popups.get("file.insert");n||(n=o());n.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive");n.find(".fr-file-progress-bar-layer").addClass("fr-active");n.find(".fr-buttons").hide();l(t.language.translate("Uploading"),0)}function e(n){var i=t.popups.get("file.insert");i&&(i.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),i.find(".fr-file-progress-bar-layer").removeClass("fr-active"),i.find(".fr-buttons").show(),n&&(t.events.focus(),t.popups.hide("file.insert")))}function l(n,i){var u=t.popups.get("file.insert"),r;u&&(r=u.find(".fr-file-progress-bar-layer"),r.find("h3").text(n+(i?" "+i+"%":"")),r.removeClass("fr-error"),i?(r.find("div").removeClass("fr-indeterminate"),r.find("div > span").css("width",i+"%")):r.find("div").addClass("fr-indeterminate"))}function k(n){var u,i,r;s();u=t.popups.get("file.insert");i=u.find(".fr-file-progress-bar-layer");i.addClass("fr-error");r=i.find("h3");r.text(n);t.events.disableBlur();r.focus()}function h(n,i,r){t.edit.on();t.events.focus(!0);t.selection.restore();t.opts.fileUseSelectedText&&t.selection.text().length&&(i=t.selection.text());t.html.insert('<a href="'+n+'" id="fr-inserted-file" class="fr-file">'+i+"<\/a>");var u=t.$el.find("#fr-inserted-file");u.removeAttr("id");t.popups.hide("file.insert");t.undo.saveStep();c();t.events.trigger("file.inserted",[u,r])}function d(n){try{if(!1===t.events.trigger("file.uploaded",[n],!0))return t.edit.on(),!1;var r=JSON.parse(n);return r.link?r:(i(v,n),!1)}catch(f){return i(u,n),!1}}function g(r){try{var f=n(r).find("Location").text(),e=n(r).find("Key").text();return!1===t.events.trigger("file.uploadedToS3",[f,e,r],!0)?(t.edit.on(),!1):f}catch(o){return i(u,r),!1}}function nt(n){var e=this.status,r=this.response,o=this.responseXML,f=this.responseText,s,c;try{t.opts.fileUploadToS3?201==e?(s=g(o),s&&h(s,n,r||o)):i(u,r||o):e>=200&&e<300?(c=d(f),c&&h(c.link,n,r||f)):i(y,r||f)}catch(l){i(u,r||f)}}function tt(){i(u,this.response||this.responseText||this.responseXML)}function it(n){if(n.lengthComputable){var i=n.loaded/n.total*100|0;l(t.language.translate("Uploading"),i)}}function i(n,i){t.edit.on();k(t.language.translate("Something went wrong. Please try again."));t.events.trigger("file.error",[{code:n,message:r[n]},i])}function rt(){t.edit.on();e(!0)}function a(n){var e,r,f,o,u,h;if(void 0!==n&&n.length>0){if(!1===t.events.trigger("file.beforeUpload",[n]))return!1;if(e=n[0],e.size>t.opts.fileMaxSize)return i(p),!1;if(t.opts.fileAllowedTypes.indexOf("*")<0&&t.opts.fileAllowedTypes.indexOf(e.type.replace(/file\//g,""))<0)return i(w),!1;if(t.drag_support.formdata&&(r=t.drag_support.formdata?new FormData:null),r){if(!1!==t.opts.fileUploadToS3){r.append("key",t.opts.fileUploadToS3.keyStart+(new Date).getTime()+"-"+(e.name||"untitled"));r.append("success_action_status","201");r.append("X-Requested-With","xhr");r.append("Content-Type",e.type);for(f in t.opts.fileUploadToS3.params)t.opts.fileUploadToS3.params.hasOwnProperty(f)&&r.append(f,t.opts.fileUploadToS3.params[f])}for(f in t.opts.fileUploadParams)t.opts.fileUploadParams.hasOwnProperty(f)&&r.append(f,t.opts.fileUploadParams[f]);r.append(t.opts.fileUploadParam,e);o=t.opts.fileUploadURL;t.opts.fileUploadToS3&&(o=t.opts.fileUploadToS3.uploadURL?t.opts.fileUploadToS3.uploadURL:"https://"+t.opts.fileUploadToS3.region+".amazonaws.com/"+t.opts.fileUploadToS3.bucket);u=t.core.getXHR(o,t.opts.fileUploadMethod);u.onload=function(){nt.call(u,e.name)};u.onerror=tt;u.upload.onprogress=it;u.onabort=rt;s();t.edit.off();h=t.popups.get("file.insert");h&&h.off("abortUpload").on("abortUpload",function(){4!=u.readyState&&u.abort()});u.send(r)}}}function ut(i){t.events.$on(i,"dragover dragenter",".fr-file-upload-layer",function(){return n(this).addClass("fr-drop"),!1},!0);t.events.$on(i,"dragleave dragend",".fr-file-upload-layer",function(){return n(this).removeClass("fr-drop"),!1},!0);t.events.$on(i,"drop",".fr-file-upload-layer",function(r){r.preventDefault();r.stopPropagation();n(this).removeClass("fr-drop");var u=r.originalEvent.dataTransfer;u&&u.files&&(i.data("instance")||t).file.upload(u.files)},!0);t.helpers.isIOS()&&t.events.$on(i,"touchstart",'.fr-file-upload-layer input[type="file"]',function(){n(this).trigger("click")});t.events.$on(i,"change",'.fr-file-upload-layer input[type="file"]',function(){this.files&&(i.data("instance")||t).file.upload(this.files);n(this).val("")},!0)}function ft(){e()}function o(n){var i,r;if(n)return t.popups.onHide("file.insert",ft),!0;i="";i='<div class="fr-buttons">'+t.button.buildList(t.opts.fileInsertButtons)+"<\/div>";r="";r='<div class="fr-file-upload-layer fr-layer fr-active" id="fr-file-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop file")+"<\/strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" name="'+t.opts.fileUploadParam+'" accept="/*" tabIndex="-1" aria-labelledby="fr-file-upload-layer-'+t.id+'" role="button"><\/div><\/div>';var f={buttons:i,upload_layer:r,progress_bar:'<div class="fr-file-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading<\/h3><div class="fr-loader"><span class="fr-progress"><\/span><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="fileDismissError" tabIndex="2" role="button">OK<\/button><\/div><\/div>'},u=t.popups.create("file.insert",f);return ut(u),u}function et(n){t.node.hasClass(n,"fr-file")}function ot(i){var r=i.originalEvent.dataTransfer,u,f;if(r&&r.files&&r.files.length&&(u=r.files[0],u&&void 0!==u.type&&u.type.indexOf("image")<0&&(t.opts.fileAllowedTypes.indexOf(u.type)>=0||t.opts.fileAllowedTypes.indexOf("*")>=0)))return t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(n.FE.MARKERS),t.popups.hideAll(),f=t.popups.get("file.insert"),f||(f=o()),t.popups.setContainer("file.insert",t.$sc),t.popups.show("file.insert",i.originalEvent.pageX,i.originalEvent.pageY),s(),a(r.files),i.preventDefault(),i.stopPropagation(),!1}function st(){t.events.on("drop",ot);t.events.$on(t.$win,"keydown",function(i){var u=i.which,r=t.popups.get("file.insert");r&&u==n.FE.KEYCODE.ESC&&r.trigger("abortUpload")});t.events.on("destroy",function(){var n=t.popups.get("file.insert");n&&n.trigger("abortUpload")})}function ht(){t.events.disableBlur();t.selection.restore();t.events.enableBlur();t.popups.hide("file.insert");t.toolbar.showInline()}function c(){for(var i=Array.prototype.slice.call(t.el.querySelectorAll("a.fr-file")),r=[],n=0;n<i.length;n++)r.push(i[n].getAttribute("href"));if(f)for(n=0;n<f.length;n++)r.indexOf(f[n].getAttribute("href"))<0&&t.events.trigger("file.unlink",[f[n]]);f=i}function ct(){st();t.events.on("link.beforeRemove",et);t.$wp&&(c(),t.events.on("contentChanged",c));o(!0)}var v=2,y=3,u=4,p=5,w=6,r={},f;return r[1]="File cannot be loaded from the passed link.",r[v]="No link in upload response.",r[y]="Error during file upload.",r[u]="Parsing response failed.",r[p]="File is too large.",r[w]="File file type is invalid.",r[7]="Files can be uploaded only to same domain in IE 8 and IE 9.",{_init:ct,showInsertPopup:b,upload:a,insert:h,back:ht,hideProgressBar:e}};n.FE.DefineIcon("insertFile",{NAME:"file-o"});n.FE.RegisterCommand("insertFile",{title:"Upload File",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("file.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("file.insert")):this.file.showInsertPopup()},plugin:"file"});n.FE.DefineIcon("fileBack",{NAME:"arrow-left"});n.FE.RegisterCommand("fileBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.file.back()},refresh:function(n){this.opts.toolbarInline?(n.removeClass("fr-hidden"),n.next(".fr-separator").removeClass("fr-hidden")):(n.addClass("fr-hidden"),n.next(".fr-separator").addClass("fr-hidden"))}});n.FE.RegisterCommand("fileDismissError",{title:"OK",callback:function(){this.file.hideProgressBar(!0)}})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{fontFamily:{"Arial,Helvetica,sans-serif":"Arial","Georgia,serif":"Georgia","Impact,Charcoal,sans-serif":"Impact","Tahoma,Geneva,sans-serif":"Tahoma","Times New Roman,Times,serif,-webkit-standard":"Times New Roman","Verdana,Geneva,sans-serif":"Verdana"},fontFamilySelection:!1,fontFamilyDefaultSelection:"Font Family"});n.FE.PLUGINS.fontFamily=function(t){function u(n){t.format.applyStyle("font-family",n)}function f(n,t){t.find(".fr-command.fr-active").removeClass("fr-active").attr("aria-selected",!1);t.find('.fr-command[data-param1="'+r()+'"]').addClass("fr-active").attr("aria-selected",!0);var i=t.find(".fr-dropdown-list"),u=t.find(".fr-active").parent();u.length?i.parent().scrollTop(u.offset().top-i.offset().top-(i.parent().outerHeight()/2-u.outerHeight()/2)):i.parent().scrollTop(0)}function i(t){var i=t.replace(/(sans-serif|serif|monospace|cursive|fantasy)/gi,"").replace(/"|'| /g,"").split(",");return n.grep(i,function(n){return n.length>0})}function e(n,t){for(var r,i=0;i<n.length;i++)for(r=0;r<t.length;r++)if(n[i]==t[r])return[i,r];return null}function r(){var s=n(t.selection.element()).css("font-family"),h=i(s),r=[],u,o,f;for(u in t.opts.fontFamily)t.opts.fontFamily.hasOwnProperty(u)&&(o=i(u),f=e(h,o),f&&r.push([u,f]));return 0===r.length?null:(r.sort(function(n,t){var i=n[1][0]-t[1][0];return 0===i?n[1][1]-t[1][1]:i}),r[0][0])}function o(i){if(t.opts.fontFamilySelection){var u=n(t.selection.element()).css("font-family").replace(/(sans-serif|serif|monospace|cursive|fantasy)/gi,"").replace(/"|'|/g,"").split(",");i.find("> span").text(t.opts.fontFamily[r()]||u[0]||t.language.translate(t.opts.fontFamilyDefaultSelection))}}return{apply:u,refreshOnShow:f,refresh:o}};n.FE.RegisterCommand("fontFamily",{type:"dropdown",displaySelection:function(n){return n.opts.fontFamilySelection},defaultSelection:function(n){return n.opts.fontFamilyDefaultSelection},displaySelectionWidth:120,html:function(){var i='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.fontFamily;for(var n in t)t.hasOwnProperty(n)&&(i+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="fontFamily" data-param1="'+n+'" style="font-family: '+n+'" title="'+t[n]+'">'+t[n]+"<\/a><\/li>");return i+"<\/ul>"},title:"Font Family",callback:function(n,t){this.fontFamily.apply(t)},refresh:function(n){this.fontFamily.refresh(n)},refreshOnShow:function(n,t){this.fontFamily.refreshOnShow(n,t)},plugin:"fontFamily"});n.FE.DefineIcon("fontFamily",{NAME:"font"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{fontSize:["8","9","10","11","12","14","18","24","30","36","48","60","72","96"],fontSizeSelection:!1,fontSizeDefaultSelection:"12"});n.FE.PLUGINS.fontSize=function(t){function i(n){t.format.applyStyle("font-size",n)}function r(i,r){var e=n(t.selection.element()).css("font-size"),u,f;r.find(".fr-command.fr-active").removeClass("fr-active").attr("aria-selected",!1);r.find('.fr-command[data-param1="'+e+'"]').addClass("fr-active").attr("aria-selected",!0);u=r.find(".fr-dropdown-list");f=r.find(".fr-active").parent();f.length?u.parent().scrollTop(f.offset().top-u.offset().top-(u.parent().outerHeight()/2-f.outerHeight()/2)):u.parent().scrollTop(0)}function u(i){if(t.opts.fontSizeSelection){var r=t.helpers.getPX(n(t.selection.element()).css("font-size"));i.find("> span").text(r)}}return{apply:i,refreshOnShow:r,refresh:u}};n.FE.RegisterCommand("fontSize",{type:"dropdown",title:"Font Size",displaySelection:function(n){return n.opts.fontSizeSelection},displaySelectionWidth:30,defaultSelection:function(n){return n.opts.fontSizeDefaultSelection},html:function(){for(var n,i='<ul class="fr-dropdown-list" role="presentation">',r=this.opts.fontSize,t=0;t<r.length;t++)n=r[t],i+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="fontSize" data-param1="'+n+'px" title="'+n+'">'+n+"<\/a><\/li>";return i+"<\/ul>"},callback:function(n,t){this.fontSize.apply(t)},refresh:function(n){this.fontSize.refresh(n)},refreshOnShow:function(n,t){this.fontSize.refreshOnShow(n,t)},plugin:"fontSize"});n.FE.DefineIcon("fontSize",{NAME:"text-height"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"forms.edit":"[_BUTTONS_]","forms.update":"[_BUTTONS_][_TEXT_LAYER_]"});n.extend(n.FE.DEFAULTS,{formEditButtons:["inputStyle","inputEdit"],formStyles:{"fr-rounded":"Rounded","fr-large":"Large"},formMultipleStyles:!0,formUpdateButtons:["inputBack","|"]});n.FE.PLUGINS.forms=function(t){function o(i){i.preventDefault();t.selection.clear();n(this).data("mousedown",!0)}function s(t){n(this).data("mousedown")&&(t.stopPropagation(),n(this).removeData("mousedown"),u=this,r(this));t.preventDefault()}function f(){t.$el.find("input, textarea, button").removeData("mousedown")}function h(){n(this).removeData("mousedown")}function c(){t.events.$on(t.$el,t._mousedown,"input, textarea, button",o);t.events.$on(t.$el,t._mouseup,"input, textarea, button",s);t.events.$on(t.$el,"touchmove","input, textarea, button",h);t.events.$on(t.$el,t._mouseup,f);t.events.$on(t.$win,t._mouseup,f);e(!0)}function i(){return u||null}function l(){var n="",u,f;return t.opts.formEditButtons.length>0&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.formEditButtons)+"<\/div>"),u={buttons:n},f=t.popups.create("forms.edit",u),t.$wp&&t.events.$on(t.$wp,"scroll.link-edit",function(){i()&&t.popups.isVisible("forms.edit")&&r(i())}),f}function r(i){var f=t.popups.get("forms.edit"),r,e,o;f||(f=l());u=i;r=n(i);t.popups.refresh("forms.edit");t.popups.setContainer("forms.edit",t.$sc);e=r.offset().left+r.outerWidth()/2;o=r.offset().top+r.outerHeight();t.popups.show("forms.edit",e,o,r.outerHeight())}function a(){var u=t.popups.get("forms.update"),f=i(),r;f&&(r=n(f),r.is("button")?u.find('input[type="text"][name="text"]').val(r.text()):u.find('input[type="text"][name="text"]').val(r.attr("placeholder")));u.find('input[type="text"][name="text"]').trigger("change")}function v(){u=null}function e(n){var r,i,u,f;return n?(t.popups.onRefresh("forms.update",a),t.popups.onHide("forms.update",v),!0):(r="",t.opts.formUpdateButtons.length>=1&&(r='<div class="fr-buttons">'+t.button.buildList(t.opts.formUpdateButtons)+"<\/div>"),i="",u=0,i='<div class="fr-forms-text-layer fr-layer fr-active">',i+='<div class="fr-input-line"><input name="text" type="text" placeholder="Text" tabIndex="'+ ++u+'"><\/div>',i+='<div class="fr-action-buttons"><button class="fr-command fr-submit" data-cmd="updateInput" href="#" tabIndex="'+ ++u+'" type="button">'+t.language.translate("Update")+"<\/button><\/div><\/div>",f={buttons:r,text_layer:i},t.popups.create("forms.update",f))}function y(){var f=i(),r,u,o,s;f&&(r=n(f),u=t.popups.get("forms.update"),u||(u=e()),t.popups.isVisible("forms.update")||t.popups.refresh("forms.update"),t.popups.setContainer("forms.update",t.$sc),o=r.offset().left+r.outerWidth()/2,s=r.offset().top+r.outerHeight(),t.popups.show("forms.update",o,s,r.outerHeight()))}function p(r,u,f){var e,o;if(void 0===u&&(u=t.opts.formStyles),void 0===f&&(f=t.opts.formMultipleStyles),e=i(),!e)return!1;f||(o=Object.keys(u),o.splice(o.indexOf(r),1),n(e).removeClass(o.join(" ")));n(e).toggleClass(r)}function w(){t.events.disableBlur();t.selection.restore();t.events.enableBlur();var n=i();n&&t.$wp&&("BUTTON"==n.tagName&&t.selection.restore(),r(n))}function b(){var o=t.popups.get("forms.update"),e=i(),u,f;e&&(u=n(e),f=o.find('input[type="text"][name="text"]').val()||"",f.length&&(u.is("button")?u.text(f):u.attr("placeholder",f)),t.popups.hide("forms.update"),r(e))}function k(){c();t.events.$on(t.$el,"submit","form",function(n){return n.preventDefault(),!1})}var u;return{_init:k,updateInput:b,getInput:i,applyStyle:p,showUpdatePopup:y,showEditPopup:r,back:w}};n.FE.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}});n.FE.DefineIcon("inputStyle",{NAME:"magic"});n.FE.RegisterCommand("inputStyle",{title:"Style",type:"dropdown",html:function(){var i='<ul class="fr-dropdown-list">',n=this.opts.formStyles;for(var t in n)n.hasOwnProperty(t)&&(i+='<li><a class="fr-command" tabIndex="-1" data-cmd="inputStyle" data-param1="'+t+'">'+this.language.translate(n[t])+"<\/a><\/li>");return i+"<\/ul>"},callback:function(n,t){var i=this.forms.getInput();i&&(this.forms.applyStyle(t),this.forms.showEditPopup(i))},refreshOnShow:function(t,i){var r=this.forms.getInput(),u;r&&(u=n(r),i.find(".fr-command").each(function(){var t=n(this).data("param1");n(this).toggleClass("fr-active",u.hasClass(t))}))}});n.FE.DefineIcon("inputEdit",{NAME:"edit"});n.FE.RegisterCommand("inputEdit",{title:"Edit Button",undo:!1,refreshAfterCallback:!1,callback:function(){this.forms.showUpdatePopup()}});n.FE.DefineIcon("inputBack",{NAME:"arrow-left"});n.FE.RegisterCommand("inputBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.forms.back()}});n.FE.RegisterCommand("updateInput",{undo:!1,focus:!1,title:"Update",callback:function(){this.forms.updateInput()}})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.FE.PLUGINS.fullscreen=function(t){function i(){return t.$box.hasClass("fr-fullscreen")}function u(){e=t.helpers.scrollTop();t.$box.toggleClass("fr-fullscreen");n("body:first").toggleClass("fr-fullscreen");o=n('<div style="display: none;"><\/div>');t.$box.after(o);t.helpers.isMobile()&&(t.$tb.data("parent",t.$tb.parent()),t.$tb.prependTo(t.$box),t.$tb.data("sticky-dummy")&&t.$tb.after(t.$tb.data("sticky-dummy")));s=t.opts.height;h=t.opts.heightMax;c=t.opts.zIndex;t.opts.height=t.o_win.innerHeight-(t.opts.toolbarInline?0:t.$tb.outerHeight());t.opts.zIndex=2147483641;t.opts.heightMax=null;t.size.refresh();t.opts.toolbarInline&&t.toolbar.showInline();for(var i=t.$box.parent();!i.is("body:first");)i.data("z-index",i.css("z-index")).data("overflow",i.css("overflow")).css("z-index","2147483640").css("overflow","visible"),i=i.parent();t.events.trigger("charCounter.update");t.$win.trigger("scroll")}function r(){t.$box.toggleClass("fr-fullscreen");n("body:first").toggleClass("fr-fullscreen");t.$tb.prependTo(t.$tb.data("parent"));t.$tb.data("sticky-dummy")&&t.$tb.after(t.$tb.data("sticky-dummy"));t.opts.height=s;t.opts.heightMax=h;t.opts.zIndex=c;t.size.refresh();n(t.o_win).scrollTop(e);t.opts.toolbarInline&&t.toolbar.showInline();t.events.trigger("charCounter.update");t.opts.toolbarSticky&&t.opts.toolbarStickyOffset&&(t.opts.toolbarBottom?t.$tb.css("bottom",t.opts.toolbarStickyOffset).data("bottom",t.opts.toolbarStickyOffset):t.$tb.css("top",t.opts.toolbarStickyOffset).data("top",t.opts.toolbarStickyOffset));for(var i=t.$box.parent();!i.is("body:first");)i.data("z-index")&&(i.css("z-index",""),i.css("z-index")!=i.data("z-index")&&i.css("z-index",i.data("z-index")),i.removeData("z-index")),i.data("overflow")?(i.css("overflow",""),i.css("overflow")!=i.data("overflow")&&i.css("overflow",i.data("overflow")),i.removeData("overflow")):(i.css("overflow",""),i.removeData("overflow")),i=i.parent();t.$win.trigger("scroll")}function l(){i()?r():u();f(t.$tb.find('.fr-command[data-cmd="fullscreen"]'))}function f(n){var r=i();n.toggleClass("fr-active",r).attr("aria-pressed",r);n.find("> *:not(.fr-sr-only)").replaceWith(r?t.icon.create("fullscreenCompress"):t.icon.create("fullscreen"))}function a(){if(!t.$wp)return!1;t.events.$on(n(t.o_win),"resize",function(){i()&&(r(),u())});t.events.on("toolbar.hide",function(){if(i()&&t.helpers.isMobile())return!1});t.events.on("destroy",function(){i()&&r()},!0)}var e,o,s,h,c;return{_init:a,toggle:l,refresh:f,isActive:i}};n.FE.RegisterCommand("fullscreen",{title:"Fullscreen",undo:!1,focus:!1,accessibilityFocus:!0,forcedRefresh:!0,toggle:!0,callback:function(){this.fullscreen.toggle()},refresh:function(n){this.fullscreen.refresh(n)},plugin:"fullscreen"});n.FE.DefineIcon("fullscreen",{NAME:"expand"});n.FE.DefineIcon("fullscreenCompress",{NAME:"compress"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"});n.extend(n.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageCaption","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUpload:!0,imageUploadURL:"/FileApi/UploadImage",imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif","svg+xml"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered","fr-shadow":"Shadow"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1,imageDefaultMargin:5});n.FE.PLUGINS.image=function(t){function pi(){var r=t.popups.get("image.insert"),n=r.find(".fr-image-by-url-layer input");n.val("");i&&n.val(i.attr("src"));n.trigger("change")}function wi(){var n=t.$tb.find('.fr-command[data-cmd="insertImage"]'),i=t.popups.get("image.insert"),r,u;(i||(i=g()),p(),i.hasClass("fr-active"))||((t.popups.refresh("image.insert"),t.popups.setContainer("image.insert",t.$tb),n.is(":visible"))?(r=n.offset().left+n.outerWidth()/2,u=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("image.insert",r,u,n.outerHeight())):(t.position.forSelection(i),t.popups.show("image.insert")))}function k(){var i=t.popups.get("image.edit"),n,r,u;(i||(i=gt()),i)&&(n=f(),h()&&(n=n.find(".fr-img-wrap")),t.popups.setContainer("image.edit",t.$sc),t.popups.refresh("image.edit"),r=n.offset().left+n.outerWidth()/2,u=n.offset().top+n.outerHeight(),t.popups.show("image.edit",r,u,n.outerHeight()))}function bi(){p()}function ki(n){n.hasClass("fr-dii")||n.hasClass("fr-dib")||(n.addClass("fr-fi"+nt(n)[0]),n.addClass("fr-di"+vt(n)[0]),n.css("margin",""),n.css("float",""),n.css("display",""),n.css("z-index",""),n.css("position",""),n.css("overflow",""),n.css("vertical-align",""))}function di(n){et(n,n.hasClass("fr-dib")?"block":n.hasClass("fr-dii")?"inline":null,n.hasClass("fr-fil")?"left":n.hasClass("fr-fir")?"right":nt(n));n.removeClass("fr-dib fr-dii fr-fir fr-fil")}function ct(){for(var i,u="IMG"==t.el.tagName?[t.el]:t.el.querySelectorAll("img"),r=0;r<u.length;r++)i=n(u[r]),!t.opts.htmlUntouched&&t.opts.useClasses?((t.opts.imageEditButtons.indexOf("imageAlign")>=0||t.opts.imageEditButtons.indexOf("imageDisplay")>=0)&&ki(i),t.opts.imageTextNear||i.removeClass("fr-dii").addClass("fr-dib")):t.opts.htmlUntouched||t.opts.useClasses||(t.opts.imageEditButtons.indexOf("imageAlign")>=0||t.opts.imageEditButtons.indexOf("imageDisplay")>=0)&&di(i),t.opts.iframe&&i.on("load",t.size.syncIframe)}function tt(i){var r,u,f,e;for(void 0===i&&(i=!0),u=Array.prototype.slice.call(t.el.querySelectorAll("img")),f=[],r=0;r<u.length;r++)f.push(u[r].getAttribute("src")),n(u[r]).toggleClass("fr-draggable",t.opts.imageMove),""===u[r].getAttribute("class")&&u[r].removeAttribute("class"),""===u[r].getAttribute("style")&&u[r].removeAttribute("style");if(l)for(r=0;r<l.length;r++)f.indexOf(l[r].getAttribute("src"))<0&&t.events.trigger("image.removed",[n(l[r])]);if(l&&i){for(e=[],r=0;r<l.length;r++)e.push(l[r].getAttribute("src"));for(r=0;r<u.length;r++)e.indexOf(u[r].getAttribute("src"))<0&&t.events.trigger("image.loaded",[n(u[r])])}l=u}function a(){var n,e,o,u;if(r||dr(),!i)return!1;n=t.$wp||t.$sc;n.append(r);r.data("instance",t);e=n.scrollTop()-("static"!=n.css("position")?n.offset().top:0);o=n.scrollLeft()-("static"!=n.css("position")?n.offset().left:0);o-=t.helpers.getPX(n.css("border-left-width"));e-=t.helpers.getPX(n.css("border-top-width"));t.$el.is("img")&&t.$sc.is("body")&&(e=0,o=0);u=f();h()&&(u=u.find(".fr-img-wrap"));r.css("top",(t.opts.iframe?u.offset().top+t.$iframe.position().top:u.offset().top+e)-1).css("left",(t.opts.iframe?u.offset().left:u.offset().left+o)-1).css("width",u.get(0).getBoundingClientRect().width).css("height",u.get(0).getBoundingClientRect().height).addClass("fr-active")}function it(n){return'<div class="fr-handler fr-h'+n+'"><\/div>'}function kt(u){var e,o,l;if(!t.core.sameInstance(r))return!0;if(u.preventDefault(),u.stopPropagation(),t.$el.find("img.fr-error").left)return!1;if(t.undo.canDo()||t.undo.saveStep(),e=u.pageX||u.originalEvent.touches[0].pageX,"mousedown"==u.type){var a=t.$oel.get(0),h=a.ownerDocument,f=h.defaultView||h.parentWindow,c=!1;try{c=f.location!=f.parent.location&&!(f.$&&f.$.FE)}catch(v){}c&&f.frameElement&&(e+=t.helpers.getPX(n(f.frameElement).offset().left)+f.frameElement.clientLeft)}s=n(this);s.data("start-x",e);s.data("start-width",i.width());s.data("start-height",i.height());o=i.width();t.opts.imageResizeWithPercent?(l=i.parentsUntil(t.$el,t.html.blockTagsQuery()).get(0)||t.el,i.css("width",(o/n(l).outerWidth()*100).toFixed(2)+"%")):i.css("width",o);y.show();t.popups.hideAll();ft()}function dt(u){var o,c,l;if(!t.core.sameInstance(r))return!0;if(s&&i){if((u.preventDefault(),t.$el.find("img.fr-error").left)||(c=u.pageX||(u.originalEvent.touches?u.originalEvent.touches[0].pageX:null),!c))return!1;var v=s.data("start-x"),e=c-v,f=s.data("start-width");((s.hasClass("fr-hnw")||s.hasClass("fr-hsw"))&&(e=0-e),t.opts.imageResizeWithPercent)?(l=i.parentsUntil(t.$el,t.html.blockTagsQuery()).get(0)||t.el,f=((f+e)/n(l).outerWidth()*100).toFixed(2),t.opts.imageRoundPercent&&(f=Math.round(f)),i.css("width",f+"%"),o=(t.helpers.getPX(i.css("width"))/n(l).outerWidth()*100).toFixed(2),o!==f&&i.css("width",o+"%"),i.css("height","").removeAttr("height")):(f+e>=t.opts.imageMinWidth&&(h()&&i.parent().css("width",f+e),i.css("width",f+e)),o=t.helpers.getPX(i.css("width")),o!==f+e&&i.css("width",o),(i.attr("style")||"").match(/(^height:)|(; *height:)/)&&i.css("height",s.data("start-height")*i.width()/s.data("start-width")));a();t.events.trigger("image.resize",[yt()])}}function lt(n){if(!t.core.sameInstance(r))return!0;if(s&&i){if(n&&n.stopPropagation(),t.$el.find("img.fr-error").left)return!1;s=null;y.hide();a();k();t.undo.saveStep();t.events.trigger("image.resizeEnd",[yt()])}}function e(n,r,u){t.edit.on();i&&i.addClass("fr-error");gi(t.language.translate("Something went wrong. Please try again."));!i&&u&&ut(u);t.events.trigger("image.error",[{code:n,message:c[n]},r,u])}function gt(n){var r,f;return n?(t.$wp&&t.events.$on(t.$wp,"scroll",function(){i&&t.popups.isVisible("image.edit")&&(t.events.disableBlur(),u(i))}),!0):(r="",t.opts.imageEditButtons.length>0)?(r+='<div class="fr-buttons">',r+=t.button.buildList(t.opts.imageEditButtons),r+="<\/div>",f={buttons:r},t.popups.create("image.edit",f)):!1}function v(n){var u=t.popups.get("image.insert"),r,e,o;(u||(u=g()),u.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),u.find(".fr-image-progress-bar-layer").addClass("fr-active"),u.find(".fr-buttons").hide(),i)&&(r=f(),t.popups.setContainer("image.insert",t.$sc),e=r.offset().left+r.width()/2,o=r.offset().top+r.height(),t.popups.show("image.insert",e,o,r.outerHeight()));void 0===n&&d(t.language.translate("Uploading"),0)}function p(n){var r=t.popups.get("image.insert"),u;r&&(r.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),r.find(".fr-image-progress-bar-layer").removeClass("fr-active"),r.find(".fr-buttons").show(),n||t.$el.find("img.fr-error").length)&&((t.events.focus(),t.$el.find("img.fr-error").length&&(t.$el.find("img.fr-error").remove(),t.undo.saveStep(),t.undo.run(),t.undo.dropRedo()),!t.$wp&&i)&&(u=i,o(!0),t.selection.setAfter(u.get(0)),t.selection.restore()),t.popups.hide("image.insert"))}function d(n,i){var u=t.popups.get("image.insert"),r;u&&(r=u.find(".fr-image-progress-bar-layer"),r.find("h3").text(n+(i?" "+i+"%":"")),r.removeClass("fr-error"),i?(r.find("div").removeClass("fr-indeterminate"),r.find("div > span").css("width",i+"%")):r.find("div").addClass("fr-indeterminate"))}function gi(n){var u,i,r;v();u=t.popups.get("image.insert");i=u.find(".fr-image-progress-bar-layer");i.addClass("fr-error");r=i.find("h3");r.text(n);t.events.disableBlur();r.focus()}function nr(){var r=t.popups.get("image.insert"),n=r.find(".fr-image-by-url-layer input");n.val().length>0&&(v(),d(t.language.translate("Loading image")),rt(n.val(),!0,[],i),n.val(""),n.blur())}function u(n){ci.call(n.get(0))}function ni(){var i=n(this);t.popups.hide("image.insert");i.removeClass("fr-uploading");i.next().is("br")&&i.next().remove();u(i);t.events.trigger("image.loaded",[i])}function rt(n,i,r,u,f){t.edit.off();d(t.language.translate("Loading image"));i&&(n=t.helpers.sanitizeURL(n));var o=new Image;o.onload=function(){var i,e,o,h,s,c;if(u){for(t.undo.canDo()||u.hasClass("fr-uploading")||t.undo.saveStep(),o=u.data("fr-old-src"),u.data("fr-image-pasted")&&(o=null),t.$wp?(i=u.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted"),i.off("load"),o&&u.attr("src",o),u.replaceWith(i)):i=u,h=i.get(0).attributes,s=0;s<h.length;s++)c=h[s],0===c.nodeName.indexOf("data-")&&i.removeAttr(c.nodeName);if(void 0!==r)for(e in r)r.hasOwnProperty(e)&&"link"!=e&&i.attr("data-"+e,r[e]);i.on("load",ni);i.attr("src",n);t.edit.on();tt(!1);t.undo.saveStep();t.$el.blur();t.events.trigger(o?"image.replaced":"image.inserted",[i,f])}else i=ti(n,r,ni),tt(!1),t.undo.saveStep(),t.$el.blur(),t.events.trigger("image.inserted",[i,f])};o.onerror=function(){e(li)};v(t.language.translate("Loading image"));o.src=n}function tr(n){try{if(!1===t.events.trigger("image.uploaded",[n],!0))return t.edit.on(),!1;var i=JSON.parse(n);return i.link?i:(e(ai,n),!1)}catch(r){return e(b,n),!1}}function ir(i){try{var r=n(i).find("Location").text(),u=n(i).find("Key").text();return!1===t.events.trigger("image.uploadedToS3",[r,u,i],!0)?(t.edit.on(),!1):r}catch(f){return e(b,i),!1}}function rr(n){var s,u;d(t.language.translate("Loading image"));var f=this.status,i=this.response,o=this.responseXML,r=this.responseText;try{t.opts.imageUploadToS3?201==f?(s=ir(o),s&&rt(s,!1,[],n,i||o)):e(b,i||o,n):f>=200&&f<300?(u=tr(r),u&&rt(u.link,!1,u,n,i||r)):e(vi,i||r,n)}catch(h){e(b,i||r,n)}}function ur(){e(b,this.response||this.responseText||this.responseXML)}function fr(n){if(n.lengthComputable){var i=n.loaded/n.total*100|0;d(t.language.translate("Uploading"),i)}}function ti(i,r,u){var h,c="",s,o,f;if(r&&void 0!==r)for(h in r)r.hasOwnProperty(h)&&"link"!=h&&(c+=" data-"+h+'="'+r[h]+'"');return s=t.opts.imageDefaultWidth,s&&"auto"!=s&&(s+=t.opts.imageResizeWithPercent?"%":"px"),o=n('<img src="'+i+'"'+c+(s?' style="width: '+s+';"':"")+">"),et(o,t.opts.imageDefaultDisplay,t.opts.imageDefaultAlign),o.on("load",u),o.on("error",function(){e(wt)}),t.edit.on(),t.events.focus(!0),t.selection.restore(),t.undo.saveStep(),t.opts.imageSplitHTML?t.markers.split():t.markers.insert(),f=t.$el.find(".fr-marker"),f.length?(f.parent().is("hr")&&f.parent().after(f),t.node.isLastSibling(f)&&f.parent().hasClass("fr-deletable")&&f.insertAfter(f.parent()),f.replaceWith(o)):t.$el.append(o),t.html.wrap(),t.selection.clear(),o}function er(){t.edit.on();p(!0)}function or(i,r,f,o){function h(){var f=n(this);f.off("load");f.addClass("fr-uploading");f.next().is("br")&&f.next().remove();t.placeholder.refresh();u(f);a();v();t.edit.off();i.onload=function(){rr.call(i,f)};i.onerror=ur;i.upload.onprogress=fr;i.onabort=er;f.off("abortUpload").on("abortUpload",function(){4!=i.readyState&&i.abort()});i.send(r)}var c,s=new FileReader;s.addEventListener("load",function(){var n=s.result;if(s.result.indexOf("svg+xml")<0){for(var r=atob(s.result.split(",")[1]),u=[],i=0;i<r.length;i++)u.push(r.charCodeAt(i));n=window.URL.createObjectURL(new Blob([new Uint8Array(u)],{type:"image/jpeg"}))}o?(o.on("load",h),o.one("error",function(){o.off("load");o.attr("src",o.data("fr-old-src"));e(wt)}),t.edit.on(),t.undo.saveStep(),o.data("fr-old-src",o.attr("src")),o.attr("src",n)):c=ti(n,null,h)},!1);s.readAsDataURL(f)}function at(n,r){var u,f,o,s;if(void 0!==n&&n.length>0){if(!1===t.events.trigger("image.beforeUpload",[n,r]))return!1;if(u=n[0],u.name||(u.name=(new Date).getTime()+".jpg"),u.size>t.opts.imageMaxSize)return e(yi),!1;if(t.opts.imageAllowedTypes.indexOf(u.type.replace(/image\//g,""))<0)return e(pt),!1;if(t.drag_support.formdata&&(f=t.drag_support.formdata?new FormData:null),f){if(!1!==t.opts.imageUploadToS3){f.append("key",t.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(u.name||"untitled"));f.append("success_action_status","201");f.append("X-Requested-With","xhr");f.append("Content-Type",u.type);for(o in t.opts.imageUploadToS3.params)t.opts.imageUploadToS3.params.hasOwnProperty(o)&&f.append(o,t.opts.imageUploadToS3.params[o])}for(o in t.opts.imageUploadParams)t.opts.imageUploadParams.hasOwnProperty(o)&&f.append(o,t.opts.imageUploadParams[o]);f.append(t.opts.imageUploadParam,u,u.name);s=t.opts.imageUploadURL;t.opts.imageUploadToS3&&(s=t.opts.imageUploadToS3.uploadURL?t.opts.imageUploadToS3.uploadURL:"https://"+t.opts.imageUploadToS3.region+".amazonaws.com/"+t.opts.imageUploadToS3.bucket);or(t.core.getXHR(s,t.opts.imageUploadMethod),f,u,r||i)}}}function sr(r){t.events.$on(r,"dragover dragenter",".fr-image-upload-layer",function(){return n(this).addClass("fr-drop"),!1},!0);t.events.$on(r,"dragleave dragend",".fr-image-upload-layer",function(){return n(this).removeClass("fr-drop"),!1},!0);t.events.$on(r,"drop",".fr-image-upload-layer",function(i){var u,f;i.preventDefault();i.stopPropagation();n(this).removeClass("fr-drop");u=i.originalEvent.dataTransfer;u&&u.files&&(f=r.data("instance")||t,f.events.disableBlur(),f.image.upload(u.files),f.events.enableBlur())},!0);t.helpers.isIOS()&&t.events.$on(r,"touchstart",'.fr-image-upload-layer input[type="file"]',function(){n(this).trigger("click")},!0);t.events.$on(r,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var u=r.data("instance")||t;u.events.disableBlur();r.find("input:focus").blur();u.events.enableBlur();u.image.upload(this.files,i)}n(this).val("")},!0)}function hr(n){if(n.is("img")&&n.parents(".fr-img-caption").length>0)return n.parents(".fr-img-caption")}function cr(i){var r=i.originalEvent.dataTransfer,u,f,s,h;if(r&&r.files&&r.files.length&&(u=r.files[0],u&&u.type&&-1!==u.type.indexOf("image")))return t.opts.imageUpload?(t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(n.FE.MARKERS),0===t.$el.find(".fr-marker").length&&t.selection.setAtEnd(t.el),t.popups.hideAll(),f=t.popups.get("image.insert"),f||(f=g()),t.popups.setContainer("image.insert",t.$sc),s=i.originalEvent.pageX,h=i.originalEvent.pageY,t.opts.iframe&&(h+=t.$iframe.offset().top,s+=t.$iframe.offset().left),t.popups.show("image.insert",s,h),v(),t.opts.imageAllowedTypes.indexOf(u.type.replace(/image\//g,""))>=0?(o(!0),at(r.files)):e(pt),i.preventDefault(),i.stopPropagation(),!1):(i.preventDefault(),i.stopPropagation(),!1)}function lr(){t.events.$on(t.$el,t._mousedown,"IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',function(i){if("false"==n(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable"))return!0;t.helpers.isMobile()||t.selection.clear();st=!0;t.popups.areVisible()&&t.events.disableBlur();t.browser.msie&&(t.events.disableBlur(),t.$el.attr("contenteditable",!1));t.draggable||"touchstart"==i.type||i.preventDefault();i.stopPropagation()});t.events.$on(t.$el,t._mouseup,"IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',function(i){if("false"==n(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable"))return!0;st&&(st=!1,i.stopPropagation(),t.browser.msie&&(t.$el.attr("contenteditable",!0),t.events.enableBlur()))});t.events.on("keyup",function(i){if(i.shiftKey&&""===t.selection.text().replace(/\n/g,"")&&t.keys.isArrow(i.which)){var r=t.selection.element(),f=t.selection.endElement();r&&"IMG"==r.tagName?u(n(r)):f&&"IMG"==f.tagName&&u(n(f))}},!0);t.events.on("drop",cr);t.events.on("element.beforeDrop",hr);t.events.on("mousedown window.mousedown",fu);t.events.on("window.touchmove",ft);t.events.on("mouseup window.mouseup",function(){if(i)return o(),!1;ft()});t.events.on("commands.mousedown",function(n){n.parents(".fr-toolbar").length>0&&o()});t.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){st=!1;o(!0)});t.events.on("modals.hide",function(){i&&(w(),t.selection.clear())})}function g(n){var r,e,o;if(n)return t.popups.onRefresh("image.insert",pi),t.popups.onHide("image.insert",bi),!0;e="";t.opts.imageUpload||t.opts.imageInsertButtons.splice(t.opts.imageInsertButtons.indexOf("imageUpload"),1);t.opts.imageInsertButtons.length>1&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.imageInsertButtons)+"<\/div>");var u=t.opts.imageInsertButtons.indexOf("imageUpload"),f=t.opts.imageInsertButtons.indexOf("imageByURL"),s="";u>=0&&(r=" fr-active",f>=0&&u>f&&(r=""),s='<div class="fr-image-upload-layer'+r+' fr-layer" id="fr-image-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop image")+"<\/strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+t.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+t.id+'" role="button"><\/div><\/div>');o="";f>=0&&(r=" fr-active",u>=0&&f>u&&(r=""),o='<div class="fr-image-by-url-layer'+r+' fr-layer" id="fr-image-by-url-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+t.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+t.language.translate("Insert")+"<\/button><\/div><\/div>");var c={buttons:e,upload_layer:s,by_url_layer:o,progress_bar:'<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading<\/h3><div class="fr-loader"><span class="fr-progress"><\/span><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK<\/button><\/div><\/div>'},h=t.popups.create("image.insert",c);return t.$wp&&t.events.$on(t.$wp,"scroll",function(){i&&t.popups.isVisible("image.insert")&&ot()}),sr(h),h}function ar(){i&&t.popups.get("image.alt").find("input").val(i.attr("alt")||"").trigger("change")}function ii(){var i=t.popups.get("image.alt"),n,r,u;i||(i=ri());p();t.popups.refresh("image.alt");t.popups.setContainer("image.alt",t.$sc);n=f();h()&&(n=n.find(".fr-img-wrap"));r=n.offset().left+n.outerWidth(!0)/2;u=n.offset().top+n.outerHeight(!0);t.popups.show("image.alt",r,u,n.outerHeight())}function ri(n){var r,u,f,e;return n?(t.popups.onRefresh("image.alt",ar),!0):(r="",r='<div class="fr-buttons">'+t.button.buildList(t.opts.imageAltButtons)+"<\/div>",u="",u='<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+t.id+'" type="text" placeholder="'+t.language.translate("Alternate Text")+'" tabIndex="1"><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+t.language.translate("Update")+"<\/button><\/div><\/div>",f={buttons:r,alt_layer:u},e=t.popups.create("image.alt",f),t.$wp&&t.events.$on(t.$wp,"scroll.image-alt",function(){i&&t.popups.isVisible("image.alt")&&ii()}),e)}function vr(n){if(i){var r=t.popups.get("image.alt");i.attr("alt",n||r.find("input").val()||"");r.find("input:focus").blur();u(i)}}function yr(){if(i){var n=t.popups.get("image.size");n.find('input[name="width"]').val(i.get(0).style.width).trigger("change");n.find('input[name="height"]').val(i.get(0).style.height).trigger("change")}}function ui(){var i=t.popups.get("image.size"),n,r,u;i||(i=fi());p();t.popups.refresh("image.size");t.popups.setContainer("image.size",t.$sc);n=f();h()&&(n=n.find(".fr-img-wrap"));r=n.offset().left+n.outerWidth(!0)/2;u=n.offset().top+n.outerHeight(!0);t.popups.show("image.size",r,u,n.outerHeight())}function fi(n){var r,u,f,e;return n?(t.popups.onRefresh("image.size",yr),!0):(r="",r='<div class="fr-buttons">'+t.button.buildList(t.opts.imageSizeButtons)+"<\/div>",u="",u='<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+t.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+t.id+'" type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"><\/div><div class="fr-input-line"><input id="fr-image-size-layer-height'+t.id+'" type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"><\/div><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+t.language.translate("Update")+"<\/button><\/div><\/div>",f={buttons:r,size_layer:u},e=t.popups.create("image.size",f),t.$wp&&t.events.$on(t.$wp,"scroll.image-size",function(){i&&t.popups.isVisible("image.size")&&ui()}),e)}function pr(n,r){var f,e;i&&(f=t.popups.get("image.size"),n=n||f.find('input[name="width"]').val()||"",r=r||f.find('input[name="height"]').val()||"",e=/^[\d]+((px)|%)*$/g,n.match(e)?i.css("width",n):i.css("width",""),r.match(e)?i.css("height",r):i.css("height",""),f.find("input:focus").blur(),u(i))}function wr(n){var s,e,r=t.popups.get("image.insert"),u,o;i||t.opts.toolbarInline?i&&(u=f(),h()&&(u=u.find(".fr-img-wrap")),e=u.offset().top+u.outerHeight(!0),s=u.offset().left+u.outerWidth(!0)/2):(o=t.$tb.find('.fr-command[data-cmd="insertImage"]'),s=o.offset().left+o.outerWidth()/2,e=o.offset().top+(t.opts.toolbarBottom?10:o.outerHeight()-10));!i&&t.opts.toolbarInline&&(e=r.offset().top-t.helpers.getPX(r.css("margin-top")),r.hasClass("fr-above")&&(e+=r.outerHeight()));r.find(".fr-layer").removeClass("fr-active");r.find(".fr-"+n+"-layer").addClass("fr-active");t.popups.show("image.insert",s,e,i?i.outerHeight():0);t.accessibility.focusPopup(r)}function br(n){t.popups.get("image.insert").find(".fr-image-upload-layer").hasClass("fr-active")&&n.addClass("fr-active").attr("aria-pressed",!0)}function kr(n){t.popups.get("image.insert").find(".fr-image-by-url-layer").hasClass("fr-active")&&n.addClass("fr-active").attr("aria-pressed",!0)}function ei(n,t,i,r){return n.pageX=t,kt.call(this,n),n.pageX=n.pageX+i*Math.floor(Math.pow(1.1,r)),dt.call(this,n),lt.call(this,n),++r}function dr(){var f;if(t.shared.$image_resizer?(r=t.shared.$image_resizer,y=t.shared.$img_overlay,t.events.on("destroy",function(){r.removeClass("fr-active").appendTo(n("body:first"))},!0)):(t.shared.$image_resizer=n('<div class="fr-image-resizer"><\/div>'),r=t.shared.$image_resizer,t.events.$on(r,"mousedown",function(n){n.stopPropagation()},!0),t.opts.imageResize&&(r.append(it("nw")+it("ne")+it("sw")+it("se")),t.shared.$img_overlay=n('<div class="fr-image-overlay"><\/div>'),y=t.shared.$img_overlay,f=r.get(0).ownerDocument,n(f).find("body:first").append(y))),t.events.on("shared.destroy",function(){r.html("").removeData().remove();r=null;t.opts.imageResize&&(y.remove(),y=null)},!0),t.helpers.isMobile()||t.events.$on(n(t.o_win),"resize",function(){i&&!i.hasClass("fr-uploading")?o(!0):i&&(a(),ot(),v(!1))}),t.opts.imageResize){f=r.get(0).ownerDocument;t.events.$on(r,t._mousedown,".fr-handler",kt);t.events.$on(n(f),t._mousemove,dt);t.events.$on(n(f.defaultView||f.parentWindow),t._mouseup,lt);t.events.$on(y,"mouseleave",lt);var e=1,s=null,h=0;t.events.on("keydown",function(r){if(i){var o=-1!=navigator.userAgent.indexOf("Mac OS X")?r.metaKey:r.ctrlKey,f=r.which;(f!==s||r.timeStamp-h>200)&&(e=1);(f==n.FE.KEYCODE.EQUALS||t.browser.mozilla&&f==n.FE.KEYCODE.FF_EQUALS)&&o&&!r.altKey?e=ei.call(this,r,1,1,e):(f==n.FE.KEYCODE.HYPHEN||t.browser.mozilla&&f==n.FE.KEYCODE.FF_HYPHEN)&&o&&!r.altKey?e=ei.call(this,r,2,-1,e):t.keys.ctrlKey(r)||f!=n.FE.KEYCODE.ENTER||(i.before("<br>"),u(i));s=f;h=r.timeStamp}},!0);t.events.on("keyup",function(){e=1})}}function ut(i){(i=i||f())&&!1!==t.events.trigger("image.beforeRemove",[i])&&(t.popups.hideAll(),w(),o(!0),t.undo.canDo()||t.undo.saveStep(),i.get(0)==t.el?i.removeAttr("src"):("A"==i.get(0).parentNode.tagName?(t.selection.setBefore(i.get(0).parentNode)||t.selection.setAfter(i.get(0).parentNode)||i.parent().after(n.FE.MARKERS),n(i.get(0).parentNode).remove()):(t.selection.setBefore(i.get(0))||t.selection.setAfter(i.get(0))||i.after(n.FE.MARKERS),i.remove()),t.html.fillEmptyBlocks(),t.selection.restore()),t.undo.saveStep())}function oi(r){var u=r.which,e,f;return i&&(u==n.FE.KEYCODE.BACKSPACE||u==n.FE.KEYCODE.DELETE)?(r.preventDefault(),r.stopPropagation(),ut(),!1):i&&u==n.FE.KEYCODE.ESC?(e=i,o(!0),t.selection.setAfter(e.get(0)),t.selection.restore(),r.preventDefault(),!1):i&&(u==n.FE.KEYCODE.ARROW_LEFT||u==n.FE.KEYCODE.ARROW_RIGHT)?(f=i.get(0),o(!0),u==n.FE.KEYCODE.ARROW_LEFT?t.selection.setBefore(f):t.selection.setAfter(f),t.selection.restore(),r.preventDefault(),!1):i&&u!=n.FE.KEYCODE.F10&&!t.keys.isBrowserAction(r)?(r.preventDefault(),r.stopPropagation(),!1):void 0}function si(n){if(n&&"IMG"==n.tagName)t.node.hasClass(n,"fr-uploading")||t.node.hasClass(n,"fr-error")?n.parentNode.removeChild(n):t.node.hasClass(n,"fr-draggable")&&n.classList.remove("fr-draggable");else if(n&&n.nodeType==Node.ELEMENT_NODE)for(var r=n.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable"),i=0;i<r.length;i++)si(r[i])}function gr(){if(lr(),"IMG"==t.el.tagName&&t.$el.addClass("fr-view"),t.events.$on(t.$el,t.helpers.isMobile()&&!t.helpers.isWindowsPhone()?"touchend":"click","IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',ci),t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',function(){bt=!1}),t.events.$on(t.$el,"touchmove",function(){bt=!0})),t.$wp?(t.events.on("window.keydown keydown",oi,!0),t.events.on("keyup",function(t){if(i&&t.which==n.FE.KEYCODE.ENTER)return!1},!0)):t.events.$on(t.$win,"keydown",oi),t.events.on("toolbar.esc",function(){if(i){if(t.$wp)t.events.disableBlur(),t.events.focus();else{var n=i;o(!0);t.selection.setAfter(n.get(0));t.selection.restore()}return!1}},!0),t.events.on("toolbar.focusEditor",function(){if(i)return!1},!0),t.events.on("window.cut window.copy",function(n){i&&t.popups.isVisible("image.edit")&&!t.popups.get("image.edit").find(":focus").length&&(w(),t.paste.saveCopiedText(i.get(0).outerHTML,"\n"),"copy"==n.type?setTimeout(function(){u(i)}):(o(!0),t.undo.saveStep(),setTimeout(function(){t.undo.saveStep()},0)))},!0),t.browser.msie&&t.events.on("keydown",function(r){if(!t.selection.isCollapsed()||!i)return!0;var u=r.which;u==n.FE.KEYCODE.C&&t.keys.ctrlKey(r)?t.events.trigger("window.copy"):u==n.FE.KEYCODE.X&&t.keys.ctrlKey(r)&&t.events.trigger("window.cut")}),t.events.$on(n(t.o_win),"keydown",function(t){var r=t.which;if(i&&r==n.FE.KEYCODE.BACKSPACE)return t.preventDefault(),!1}),t.events.$on(t.$win,"keydown",function(t){var r=t.which;i&&i.hasClass("fr-uploading")&&r==n.FE.KEYCODE.ESC&&i.trigger("abortUpload")}),t.events.on("destroy",function(){i&&i.hasClass("fr-uploading")&&i.trigger("abortUpload")}),t.events.on("paste.before",ru),t.events.on("paste.beforeCleanup",uu),t.events.on("paste.after",nu),t.events.on("html.set",ct),t.events.on("html.inserted",ct),ct(),t.events.on("destroy",function(){l=[]}),t.events.on("html.processGet",si),t.opts.imageOutputSize){var r;t.events.on("html.beforeGet",function(){var i,u,f;for(r=t.el.querySelectorAll("img"),i=0;i<r.length;i++)u=r[i].style.width||n(r[i]).width(),f=r[i].style.height||n(r[i]).height(),u&&r[i].setAttribute("width",(""+u).replace(/px/,"")),f&&r[i].setAttribute("height",(""+f).replace(/px/,""))})}t.opts.iframe&&t.events.on("image.loaded",t.size.syncIframe);t.$wp&&(tt(),t.events.on("contentChanged",tt));t.events.$on(n(t.o_win),"orientationchange.image",function(){setTimeout(function(){i&&u(i)},100)});gt(!0);g(!0);fi(!0);ri(!0);t.events.on("node.remove",function(n){if("IMG"==n.get(0).tagName)return ut(n),!1})}function hi(r){if(!1===t.events.trigger("image.beforePasteUpload",[r]))return!1;i=n(r);a();k();ot();v();for(var f=atob(n(r).attr("src").split(",")[1]),e=[],u=0;u<f.length;u++)e.push(f.charCodeAt(u));at([new Blob([new Uint8Array(e)],{type:"image/jpeg"})],i)}function nu(){t.opts.imagePaste?t.$el.find("img[data-fr-image-pasted]").each(function(i,r){var u,f;t.opts.imagePasteProcess&&(u=t.opts.imageDefaultWidth,u&&"auto"!=u&&(u+=t.opts.imageResizeWithPercent?"%":"px"),n(r).css("width",u).removeClass("fr-dii fr-dib fr-fir fr-fil").addClass((t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign&&"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"")));0===r.src.indexOf("data:")?hi(r):0===r.src.indexOf("blob:")?(f=new Image,f.crossOrigin="Anonymous",f.onload=function(){var n=t.o_doc.createElement("CANVAS"),i=n.getContext("2d");n.height=this.naturalHeight;n.width=this.naturalWidth;i.drawImage(this,0,0);r.src=n.toDataURL("image/png");hi(r)},f.src=r.src):0!==r.src.indexOf("http")||0===r.src.indexOf("https://mail.google.com/mail")?(t.selection.save(),n(r).remove(),t.selection.restore()):n(r).removeAttr("data-fr-image-pasted")}):t.$el.find("img[data-fr-image-pasted]").remove()}function tu(n){var r=n.target.result,i=t.opts.imageDefaultWidth;i&&"auto"!=i&&(i+=t.opts.imageResizeWithPercent?"%":"px");t.html.insert('<img data-fr-image-pasted="true" class="'+(t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign&&"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"")+'" src="'+r+'"'+(i?' style="width: '+i+';"':"")+">");t.events.trigger("paste.after")}function iu(n){var t=new FileReader;t.onload=tu;t.readAsDataURL(n)}function ru(n){var t,i;if(n&&n.clipboardData&&n.clipboardData.items){if(t=null,n.clipboardData.getData("text/rtf"))t=n.clipboardData.items[0].getAsFile();else for(i=0;i<n.clipboardData.items.length&&!(t=n.clipboardData.items[i].getAsFile());i++);if(t)return iu(t),!1}}function uu(n){return n.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function ci(r){if("false"==n(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")||r&&"touchend"==r.type&&bt)return!0;if(r&&t.edit.isDisabled())return r.stopPropagation(),r.preventDefault(),!1;for(var u=0;u<n.FE.INSTANCES.length;u++)n.FE.INSTANCES[u]!=t&&n.FE.INSTANCES[u].events.trigger("image.hideResizer");t.toolbar.disable();r&&(r.stopPropagation(),r.preventDefault());t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur());t.opts.iframe&&t.size.syncIframe();i=n(this);t.browser.msie||w();a();k();t.browser.msie||t.selection.clear();t.helpers.isIOS()&&(t.events.disableBlur(),t.$el.blur());t.button.bulkRefresh();t.events.trigger("video.hideResizer")}function o(n){i&&(eu()||!0===n)&&(t.toolbar.enable(),r.removeClass("fr-active"),t.popups.hide("image.edit"),i=null,ft())}function fu(){ht=!0}function ft(){ht=!1}function eu(){return ht}function et(n,i,r){!t.opts.htmlUntouched&&t.opts.useClasses?(n.removeClass("fr-fil fr-fir fr-dib fr-dii"),r&&n.addClass("fr-fi"+r[0]),i&&n.addClass("fr-di"+i[0])):"inline"==i?(n.css({display:"inline-block",verticalAlign:"bottom",margin:t.opts.imageDefaultMargin}),"center"==r?n.css({float:"none",marginBottom:"",marginTop:"",maxWidth:"calc(100% - "+2*t.opts.imageDefaultMargin+"px)"}):"left"==r?n.css({float:"left",marginLeft:0,maxWidth:"calc(100% - "+t.opts.imageDefaultMargin+"px)"}):n.css({float:"right",marginRight:0,maxWidth:"calc(100% - "+t.opts.imageDefaultMargin+"px)"})):"block"==i&&(n.css({display:"block",float:"none",verticalAlign:"top",margin:t.opts.imageDefaultMargin+"px auto"}),"left"==r?n.css({marginLeft:0}):"right"==r&&n.css({marginRight:0}))}function ou(n){var i=f();i.removeClass("fr-fir fr-fil");!t.opts.htmlUntouched&&t.opts.useClasses?"left"==n?i.addClass("fr-fil"):"right"==n&&i.addClass("fr-fir"):et(i,vt(),n);w();a();k();t.selection.clear()}function nt(n){if(void 0===n&&(n=f()),n){if(n.hasClass("fr-fil"))return"left";if(n.hasClass("fr-fir"))return"right";if(n.hasClass("fr-dib")||n.hasClass("fr-dii"))return"center";var t=n.css("float");if(n.css("float","none"),"block"==n.css("display")){if(n.css("float",""),n.css("float")!=t&&n.css("float",t),0===parseInt(n.css("margin-left"),10))return"left";if(0===parseInt(n.css("margin-right"),10))return"right"}else{if(n.css("float",""),n.css("float")!=t&&n.css("float",t),"left"==n.css("float"))return"left";if("right"==n.css("float"))return"right"}}return"center"}function vt(n){void 0===n&&(n=f());var t=n.css("float");return n.css("float","none"),"block"==n.css("display")?(n.css("float",""),n.css("float")!=t&&n.css("float",t),"block"):(n.css("float",""),n.css("float")!=t&&n.css("float",t),"inline")}function su(n){i&&n.find("> *:first").replaceWith(t.icon.create("image-align-"+nt()))}function hu(n,t){i&&t.find('.fr-command[data-param1="'+nt()+'"]').addClass("fr-active").attr("aria-selected",!0)}function cu(n){var i=f();i.removeClass("fr-dii fr-dib");!t.opts.htmlUntouched&&t.opts.useClasses?"inline"==n?i.addClass("fr-dii"):"block"==n&&i.addClass("fr-dib"):et(i,n,nt());w();a();k();t.selection.clear()}function lu(n,t){i&&t.find('.fr-command[data-param1="'+vt()+'"]').addClass("fr-active").attr("aria-selected",!0)}function ot(){var i=t.popups.get("image.insert"),n,r,u;i||(i=g());t.popups.isVisible("image.insert")||(p(),t.popups.refresh("image.insert"),t.popups.setContainer("image.insert",t.$sc));n=f();h()&&(n=n.find(".fr-img-wrap"));r=n.offset().left+n.outerWidth(!0)/2;u=n.offset().top+n.outerHeight(!0);t.popups.show("image.insert",r,u,n.outerHeight(!0))}function w(){if(i){t.events.disableBlur();t.selection.clear();var n=t.doc.createRange();n.selectNode(i.get(0));t.selection.get().addRange(n);t.events.enableBlur()}}function au(){i?(t.events.disableBlur(),n(".fr-popup input:focus").blur(),u(i)):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("image.insert"),t.toolbar.showInline())}function yt(){return i}function f(){return h()?i.parents(".fr-img-caption:first"):i}function vu(n,r,f){if(void 0===r&&(r=t.opts.imageStyles),void 0===f&&(f=t.opts.imageMultipleStyles),!i)return!1;if(!f){var e=Object.keys(r);e.splice(e.indexOf(n),1);i.removeClass(e.join(" "))}"object"==typeof r[n]?(i.removeAttr("style"),i.css(r[n].style)):i.toggleClass(n);u(i)}function h(){return!!i&&i.parents(".fr-img-caption").length>0}function yu(){var r;i&&!h()?(r=i,i.parent().is("a")&&(r=i.parent()),r.wrap('<span contenteditable="false" class="fr-img-caption '+i.attr("class")+'" draggable="false"><\/span>'),r.wrap('<span class="fr-img-wrap"><\/span>'),r.after('<span class="fr-inner" contenteditable="true">'+n.FE.START_MARKER+"Image caption"+n.FE.END_MARKER+"<\/span>"),i.removeAttr("class"),i.parent().css("width",i.width()),o(!0),t.selection.restore()):(r=f(),i.insertAfter(r),i.attr("class",r.attr("class").replace("fr-img-caption","")),r.remove(),u(i))}var i,r,s,y,st=!1,li=1,ai=2,vi=3,b=4,yi=5,pt=6,wt=8,c={},l,bt,ht;return c[li]="Image cannot be loaded from the passed link.",c[ai]="No link in upload response.",c[vi]="Error during file upload.",c[b]="Parsing response failed.",c[yi]="File is too large.",c[pt]="Image file type is invalid.",c[7]="Files can be uploaded only to same domain in IE 8 and IE 9.",c[wt]="Image file is corrupted.",ht=!1,{_init:gr,showInsertPopup:wi,showLayer:wr,refreshUploadButton:br,refreshByURLButton:kr,upload:at,insertByURL:nr,align:ou,refreshAlign:su,refreshAlignOnShow:hu,display:cu,refreshDisplayOnShow:lu,replace:ot,back:au,get:yt,getEl:f,insert:rt,showProgressBar:v,remove:ut,hideProgressBar:p,applyStyle:vu,showAltPopup:ii,showSizePopup:ui,setAlt:vr,setSize:pr,toggleCaption:yu,hasCaption:h,exitEdit:o,edit:u}};n.FE.DefineIcon("insertImage",{NAME:"image"});n.FE.RegisterShortcut(n.FE.KEYCODE.P,"insertImage",null,"P");n.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"});n.FE.DefineIcon("imageUpload",{NAME:"upload"});n.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-upload")},refresh:function(n){this.image.refreshUploadButton(n)}});n.FE.DefineIcon("imageByURL",{NAME:"link"});n.FE.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-by-url")},refresh:function(n){this.image.refreshByURLButton(n)}});n.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(n){this.image.get()?n.text(this.language.translate("Replace")):n.text(this.language.translate("Insert"))}});n.FE.DefineIcon("imageDisplay",{NAME:"star"});n.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(n,t){this.image.display(t)},refresh:function(n){this.opts.imageTextNear||n.addClass("fr-hidden")},refreshOnShow:function(n,t){this.image.refreshDisplayOnShow(n,t)}});n.FE.DefineIcon("image-align",{NAME:"align-left"});n.FE.DefineIcon("image-align-left",{NAME:"align-left"});n.FE.DefineIcon("image-align-right",{NAME:"align-right"});n.FE.DefineIcon("image-align-center",{NAME:"align-justify"});n.FE.DefineIcon("imageAlign",{NAME:"align-justify"});n.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',i=n.FE.COMMANDS.imageAlign.options;for(var t in i)i.hasOwnProperty(t)&&(r+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+t+'" title="'+this.language.translate(i[t])+'">'+this.icon.create("image-align-"+t)+'<span class="fr-sr-only">'+this.language.translate(i[t])+"<\/span><\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){this.image.align(t)},refresh:function(n){this.image.refreshAlign(n)},refreshOnShow:function(n,t){this.image.refreshAlignOnShow(n,t)}});n.FE.DefineIcon("imageReplace",{NAME:"exchange"});n.FE.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}});n.FE.DefineIcon("imageRemove",{NAME:"trash"});n.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}});n.FE.DefineIcon("imageBack",{NAME:"arrow-left"});n.FE.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(n){this.image.get()||this.opts.toolbarInline?(n.removeClass("fr-hidden"),n.next(".fr-separator").removeClass("fr-hidden")):(n.addClass("fr-hidden"),n.next(".fr-separator").addClass("fr-hidden"))}});n.FE.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}});n.FE.DefineIcon("imageStyle",{NAME:"magic"});n.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',i=this.opts.imageStyles,t,n;for(t in i)i.hasOwnProperty(t)&&(n=i[t],"object"==typeof n&&(n=n.title),r+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+t+'">'+this.language.translate(n)+"<\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){this.image.applyStyle(t)},refreshOnShow:function(t,i){var r=this.image.get();r&&i.find(".fr-command").each(function(){var i=n(this).data("param1"),t=r.hasClass(i);n(this).toggleClass("fr-active",t).attr("aria-selected",t)})}});n.FE.DefineIcon("imageAlt",{NAME:"info"});n.FE.RegisterCommand("imageAlt",{undo:!1,focus:!1,popup:!0,title:"Alternate Text",callback:function(){this.image.showAltPopup()}});n.FE.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}});n.FE.DefineIcon("imageSize",{NAME:"arrows-alt"});n.FE.RegisterCommand("imageSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.image.showSizePopup()}});n.FE.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}});n.FE.DefineIcon("imageCaption",{NAME:"commenting"});n.FE.RegisterCommand("imageCaption",{undo:!0,focus:!1,title:"Image Caption",refreshAfterCallback:!0,callback:function(){this.image.toggleCaption()},refresh:function(n){this.image.get()&&n.toggleClass("fr-active",this.image.hasCaption())}})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){if(n.extend(n.FE.DEFAULTS,{imageManagerLoadURL:"/FileApi/loadfiles",imageManagerLoadMethod:"get",imageManagerLoadParams:{},imageManagerPreloader:"",imageManagerDeleteURL:"",imageManagerDeleteMethod:"post",imageManagerDeleteParams:{},imageManagerPageSize:12,imageManagerScrollOffset:20,imageManagerToggleTags:!0}),n.FE.PLUGINS.imageManager=function(t){function vt(){var r,u,n;i||(r='<div class="fr-modal-head-line"><i class="fa fa-bars fr-modal-more fr-not-available" id="fr-modal-more-'+t.sid+'" title="'+t.language.translate("Tags")+'"><\/i><h4 data-text="true">'+t.language.translate("Manage Images")+"<\/h4><\/div>",r+='<div class="fr-modal-tags" id="fr-modal-tags"><\/div>',u='<img class="fr-preloader" id="fr-preloader" alt="'+t.language.translate("Loading")+'.." src="'+t.opts.imageManagerPreloader+'" style="display: none;">',u+='<div class="fr-image-list" id="fr-image-list"><\/div>',n=t.modals.create(p,r,u),i=n.$modal,f=n.$head,a=n.$body);i.data("current-image",t.image.get());t.modals.show(p);v||ii();pt()}function yt(){t.modals.hide(p)}function g(){var t=n(window).outerWidth();return t<768?2:t<1200?3:4}function nt(){r.empty();for(var n=0;n<k;n++)r.append('<div class="fr-list-column"><\/div>')}function pt(){v.show();r.find(".fr-list-column").empty();t.opts.imageManagerLoadURL?n.ajax({url:t.opts.imageManagerLoadURL,method:t.opts.imageManagerLoadMethod,data:t.opts.imageManagerLoadParams,dataType:"json",crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(n,i,r){t.events.trigger("imageManager.imagesLoaded",[n]);wt(n,r.response);v.hide()}).fail(function(){var n=this.xhr();o(et,n.response||n.responseText)}):o(ot)}function wt(n,t){try{r.find(".fr-list-column").empty();b=0;h=0;d=0;y=n;s()}catch(i){o(st,t)}}function s(){if(h<y.length&&(r.outerHeight()<=a.outerHeight()+t.opts.imageManagerScrollOffset||a.scrollTop()+t.opts.imageManagerScrollOffset>r.outerHeight()-a.outerHeight())){b++;for(var n=t.opts.imageManagerPageSize*(b-1);n<Math.min(y.length,t.opts.imageManagerPageSize*b);n++)bt(y[n])}}function bt(i){var e=new Image,r=n('<div class="fr-image-container fr-empty fr-image-'+d+++'" data-loading="'+t.language.translate("Loading")+'.." data-deleting="'+t.language.translate("Deleting")+'..">');w(!1);e.onload=function(){var a,v,y,p;if(r.height(Math.floor(r.width()/e.width*e.height)),a=n("<img/>"),i.thumb)a.attr("src",i.thumb);else{if(o(ht,i),!i.url)return o(ct,i),!1;a.attr("src",i.url)}if(i.url&&a.attr("data-url",i.url),i.tag)if(f.find(".fr-modal-more.fr-not-available").removeClass("fr-not-available"),f.find(".fr-modal-tags").show(),i.tag.indexOf(",")>=0){for(v=i.tag.split(","),y=0;y<v.length;y++)v[y]=v[y].trim(),0===u.find('a[title="'+v[y]+'"]').length&&u.append('<a role="button" title="'+v[y]+'">'+v[y]+"<\/a>");a.attr("data-tag",v.join())}else 0===u.find('a[title="'+i.tag.trim()+'"]').length&&u.append('<a role="button" title="'+i.tag.trim()+'">'+i.tag.trim()+"<\/a>"),a.attr("data-tag",i.tag.trim());i.name&&a.attr("alt",i.name);for(p in i)i.hasOwnProperty(p)&&"thumb"!=p&&"url"!=p&&"tag"!=p&&a.attr("data-"+p,i[p]);r.append(a).append(n(t.icon.create("imageManagerDelete")).addClass("fr-delete-img").attr("title",t.language.translate("Delete"))).append(n(t.icon.create("imageManagerInsert")).addClass("fr-insert-img").attr("title",t.language.translate("Insert")));u.find(".fr-selected-tag").each(function(n,t){ut(a,t.text)||r.hide()});a.on("load",function(){r.removeClass("fr-empty");r.height("auto");h++;l(c(parseInt(a.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1));w(!1);h%t.opts.imageManagerPageSize==0&&s()});t.events.trigger("imageManager.imageLoaded",[a])};e.onerror=function(){h++;r.remove();l(c(parseInt(r.attr("class").match(/fr-image-(\d+)/)[1],10)+1));o(ft,i);h%t.opts.imageManagerPageSize==0&&s()};e.src=i.thumb||i.url;tt().append(r)}function tt(){var t,i;return r.find(".fr-list-column").each(function(r,u){var f=n(u);0===r?(i=f.outerHeight(),t=f):f.outerHeight()<i&&(i=f.outerHeight(),t=f)}),t}function c(t){var f,i,u;for(void 0===t&&(t=0),f=[],i=d-1;i>=t;i--)u=r.find(".fr-image-"+i),u.length&&(f.push(u),n('<div id="fr-image-hidden-container">').append(u),r.find(".fr-image-"+i).remove());return f}function l(n){for(var t=n.length-1;t>=0;t--)tt().append(n[t])}function w(n){var r,u;if(void 0===n&&(n=!0),!i.is(":visible"))return!0;r=g();r!=k&&(k=r,u=c(),nt(),l(u));t.modals.resize(p);n&&s()}function it(n){var r={},i=n.data();for(var t in i)i.hasOwnProperty(t)&&"url"!=t&&"tag"!=t&&(r[t]=i[t]);return r}function kt(r){var o=n(r.currentTarget).siblings("img"),u=i.data("instance")||t,f=i.data("current-image");if(t.modals.hide(p),u.image.showProgressBar(),f)f.data("fr-old-src",f.attr("src")),f.trigger("click");else{u.events.focus(!0);u.selection.restore();var e=u.position.getBoundingRect(),s=e.left+e.width/2+n(t.doc).scrollLeft(),h=e.top+e.height+n(t.doc).scrollTop();u.popups.setContainer("image.insert",t.$sc);u.popups.show("image.insert",s,h)}u.image.insert(o.data("url"),!1,it(o),f)}function dt(){i.find("#fr-modal-tags > a").each(function(){0===i.find('#fr-image-list [data-tag*="'+n(this).text()+'"]').length&&n(this).removeClass("fr-selected-tag").hide()});rt()}function gt(i){var r=n(i.currentTarget).siblings("img"),u=t.language.translate("Are you sure? Image will be deleted.");confirm(u)&&(t.opts.imageManagerDeleteURL?!1!==t.events.trigger("imageManager.beforeDeleteImage",[r])&&(r.parent().addClass("fr-image-deleting"),n.ajax({method:t.opts.imageManagerDeleteMethod,url:t.opts.imageManagerDeleteURL,data:n.extend(n.extend({src:r.attr("src")},it(r)),t.opts.imageManagerDeleteParams),crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(n){t.events.trigger("imageManager.imageDeleted",[n]);var i=c(parseInt(r.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);r.parent().remove();l(i);dt();w(!0)}).fail(function(){var n=this.xhr();o(lt,n.response||n.responseText)})):o(at))}function o(i,r){10<=i&&i<20?v.hide():20<=i&&i<30&&n(".fr-image-deleting").removeClass("fr-image-deleting");t.events.trigger("imageManager.error",[{code:i,message:e[i]},r])}function ni(){var n=f.find(".fr-modal-head-line").outerHeight(),t=u.outerHeight();f.toggleClass("fr-show-tags");f.hasClass("fr-show-tags")?(f.css("height",n+t),u.find("a").css("opacity",1)):(f.css("height",n),u.find("a").css("opacity",0))}function rt(){var t=u.find(".fr-selected-tag");t.length>0?(r.find("img").parent().show(),t.each(function(t,i){r.find("img").each(function(t,r){var u=n(r);ut(u,i.text)||u.parent().hide()})})):r.find("img").parent().show();l(c());s()}function ti(i){i.preventDefault();var r=n(i.currentTarget);r.toggleClass("fr-selected-tag");t.opts.imageManagerToggleTags&&r.siblings("a").removeClass("fr-selected-tag");rt()}function ut(n,t){for(var r=(n.attr("data-tag")||"").split(","),i=0;i<r.length;i++)if(r[i]==t)return!0;return!1}function ii(){v=i.find("#fr-preloader");r=i.find("#fr-image-list");u=i.find("#fr-modal-tags");k=g();nt();f.css("height",f.find(".fr-modal-head-line").outerHeight());t.events.$on(n(t.o_win),"resize",function(){w(y?!0:!1)});t.helpers.isMobile()&&(t.events.bindClick(r,"div.fr-image-container",function(t){i.find(".fr-mobile-selected").removeClass("fr-mobile-selected");n(t.currentTarget).addClass("fr-mobile-selected")}),i.on(t._mousedown,function(){i.find(".fr-mobile-selected").removeClass("fr-mobile-selected")}));t.events.bindClick(r,".fr-insert-img",kt);t.events.bindClick(r,".fr-delete-img",gt);i.on(t._mousedown+" "+t._mouseup,function(n){n.stopPropagation()});i.on(t._mousedown,"*",function(){t.events.disableBlur()});a.on("scroll",s);t.events.bindClick(i,"i#fr-modal-more-"+t.sid,ni);t.events.bindClick(u,"a",ti)}function ri(){if(!t.$wp&&"IMG"!=t.el.tagName)return!1}var i,f,a,v,r,u,y,b,h,d,k,p="image_manager",ft=10,et=11,ot=12,st=13,ht=14,ct=15,lt=21,at=22,e={};return e[ft]="Image cannot be loaded from the passed link.",e[et]="Error during load images request.",e[ot]="Missing imageManagerLoadURL option.",e[st]="Parsing load response failed.",e[ht]="Missing image thumb.",e[ct]="Missing image URL.",e[lt]="Error during delete image request.",e[at]="Missing imageManagerDeleteURL option.",{require:["image"],_init:ri,show:vt,hide:yt}},!n.FE.PLUGINS.image)throw new Error("Image manager plugin requires image plugin.");n.FE.DEFAULTS.imageInsertButtons.push("imageManager");n.FE.RegisterCommand("imageManager",{title:"Browse",undo:!1,focus:!1,modal:!0,callback:function(){this.imageManager.show()},plugin:"imageManager"});n.FE.DefineIcon("imageManager",{NAME:"folder"});n.FE.DefineIcon("imageManagerInsert",{NAME:"plus"});n.FE.DefineIcon("imageManagerDelete",{NAME:"trash"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{inlineStyles:{"Big Red":"font-size: 20px; color: red;","Small Blue":"font-size: 14px; color: blue;"}});n.FE.PLUGINS.inlineStyle=function(t){function i(i){""!==t.selection.text()?t.html.insert(n.FE.START_MARKER+'<span style="'+i+'">'+t.selection.text()+"<\/span>"+n.FE.END_MARKER):t.html.insert('<span style="'+i+'">'+n.FE.INVISIBLE_SPACE+n.FE.MARKERS+"<\/span>")}return{apply:i}};n.FE.RegisterCommand("inlineStyle",{type:"dropdown",html:function(){var i='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.inlineStyles;for(var n in t)t.hasOwnProperty(n)&&(i+='<li role="presentation"><span style="'+t[n]+'" role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="inlineStyle" data-param1="'+t[n]+'" title="'+this.language.translate(n)+'">'+this.language.translate(n)+"<\/a><\/span><\/li>");return i+"<\/ul>"},title:"Inline Style",callback:function(n,t){this.inlineStyle.apply(t)},plugin:"inlineStyle"});n.FE.DefineIcon("inlineStyle",{NAME:"paint-brush"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{lineBreakerTags:["table","hr","form","dl","span.fr-video",".fr-embedly"],lineBreakerOffset:15,lineBreakerHorizontalOffset:10});n.FE.PLUGINS.lineBreaker=function(t){function u(n,r){var f,e,o,u,a,v,s,h,c,l;if(null==n)u=r.parent(),a=u.offset().top,s=r.offset().top,f=s-Math.min((s-a)/2,t.opts.lineBreakerOffset),o=u.outerWidth(),e=u.offset().left;else if(null==r)u=n.parent(),v=u.offset().top+u.outerHeight(),h=n.offset().top+n.outerHeight(),f=h+Math.min((v-h)/2,t.opts.lineBreakerOffset),o=u.outerWidth(),e=u.offset().left;else{if(u=n.parent(),c=n.offset().top+n.height(),l=r.offset().top,c>l)return!1;f=(c+l)/2;o=u.outerWidth();e=u.offset().left}t.opts.iframe&&(e+=t.$iframe.offset().left-t.helpers.scrollLeft(),f+=t.$iframe.offset().top-t.helpers.scrollTop());t.$box.append(i);i.css("top",f-t.win.pageYOffset);i.css("left",e-t.win.pageXOffset);i.css("width",o);i.data("tag1",n);i.data("tag2",r);i.addClass("fr-visible").data("instance",t)}function l(n,r){var s,o,h=n.offset().top,c=n.offset().top+n.outerHeight(),e;if(Math.abs(c-r)<=t.opts.lineBreakerOffset||Math.abs(r-h)<=t.opts.lineBreakerOffset)if(Math.abs(c-r)<Math.abs(r-h)){for(o=n.get(0),e=o.nextSibling;e&&e.nodeType==Node.TEXT_NODE&&0===e.textContent.length;)e=e.nextSibling;if(!e)return u(n,null),!0;if(s=f(e))return u(n,s),!0}else{if(o=n.get(0),!o.previousSibling)return u(null,n),!0;if(s=f(o.previousSibling))return u(s,n),!0}i.removeClass("fr-visible").removeData("instance")}function f(i){if(i){var r=n(i);if(0===t.$el.find(r).length)return null;if(i.nodeType!=Node.TEXT_NODE&&r.is(t.opts.lineBreakerTags.join(",")))return r;if(r.parents(t.opts.lineBreakerTags.join(",")).length>0)return i=r.parents(t.opts.lineBreakerTags.join(",")).get(0),0!==t.$el.find(i).length&&n(i).is(t.opts.lineBreakerTags.join(","))?n(i):null}return null}function s(i,r){var u=t.doc.elementFromPoint(i,r);return u&&!n(u).closest(".fr-line-breaker").length&&!t.node.isElement(u)&&u!=t.$wp.get(0)&&n(u).closest(t.$wp).length?u:null}function h(n,i,r){for(var f=r,u=null;f<=t.opts.lineBreakerOffset&&!u;)u=s(n,i-f),u||(u=s(n,i+f)),f+=r;return u}function c(n,i,r){for(var u=null;!u&&n>t.$box.offset().left&&n<t.$box.offset().left+t.$box.outerWidth();)u=s(n,i),u||(u=h(n,i,5)),"left"==r?n-=t.opts.lineBreakerHorizontalOffset:n+=t.opts.lineBreakerHorizontalOffset;return u}function a(n){r=null;var o=null,u=null,e=t.doc.elementFromPoint(n.pageX-t.win.pageXOffset,n.pageY-t.win.pageYOffset);e&&("HTML"==e.tagName||"BODY"==e.tagName||t.node.isElement(e)||(e.getAttribute("class")||"").indexOf("fr-line-breaker")>=0)?(u=h(n.pageX-t.win.pageXOffset,n.pageY-t.win.pageYOffset,1),u||(u=c(n.pageX-t.win.pageXOffset-t.opts.lineBreakerHorizontalOffset,n.pageY-t.win.pageYOffset,"left")),u||(u=c(n.pageX-t.win.pageXOffset+t.opts.lineBreakerHorizontalOffset,n.pageY-t.win.pageYOffset,"right")),o=f(u)):o=f(e);o?l(o,n.pageY):t.core.sameInstance(i)&&i.removeClass("fr-visible").removeData("instance")}function v(n){return!(i.hasClass("fr-visible")&&!t.core.sameInstance(i))&&(t.popups.areVisible()||t.el.querySelector(".fr-selected-cell")?(i.removeClass("fr-visible"),!0):void(!1!==o||t.edit.isDisabled()||(r&&clearTimeout(r),r=setTimeout(a,30,n))))}function e(){r&&clearTimeout(r);i.hasClass("fr-visible")&&i.removeClass("fr-visible").removeData("instance")}function y(){o=!0;e()}function p(){o=!1}function w(r){if(!t.core.sameInstance(i))return!0;r.preventDefault();i.removeClass("fr-visible").removeData("instance");var f=i.data("tag1"),e=i.data("tag2"),u=t.html.defaultTag();null==f?u&&"TD"!=e.parent().get(0).tagName&&0===e.parents(u).length?e.before("<"+u+">"+n.FE.MARKERS+"<br><\/"+u+">"):e.before(n.FE.MARKERS+"<br>"):u&&"TD"!=f.parent().get(0).tagName&&0===f.parents(u).length?f.after("<"+u+">"+n.FE.MARKERS+"<br><\/"+u+">"):f.after(n.FE.MARKERS+"<br>");t.selection.restore()}function b(){t.shared.$line_breaker||(t.shared.$line_breaker=n('<div class="fr-line-breaker"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Break")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect x="21" y="11" width="2" height="8"/><rect x="14" y="17" width="7" height="2"/><path d="M14.000,14.000 L14.000,22.013 L9.000,18.031 L14.000,14.000 Z"/><\/svg><\/a><\/div>'));i=t.shared.$line_breaker;t.events.on("shared.destroy",function(){i.html("").removeData().remove();i=null},!0);t.events.on("destroy",function(){i.removeData("instance").removeClass("fr-visible").appendTo("body:first");clearTimeout(r)},!0);t.events.$on(i,"mousemove",function(n){n.stopPropagation()},!0);t.events.$on(i,"mousedown","a",function(n){n.stopPropagation()},!0);t.events.$on(i,"click","a",w,!0)}function k(){if(!t.$wp)return!1;b();o=!1;t.events.$on(t.$win,"mousemove",v);t.events.$on(n(t.win),"scroll",e);t.events.on("popups.show.table.edit",e);t.events.on("commands.after",e);t.events.$on(n(t.win),"mousedown",y);t.events.$on(n(t.win),"mouseup",p)}var i,o,r;return{_init:k}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"link.edit":"[_BUTTONS_]","link.insert":"[_BUTTONS_][_INPUT_LAYER_]"});n.extend(n.FE.DEFAULTS,{linkEditButtons:["linkOpen","linkStyle","linkEdit","linkRemove"],linkInsertButtons:["linkBack","|","linkList"],linkAttributes:{},linkAutoPrefix:"http://",linkStyles:{"fr-green":"Green","fr-strong":"Thick"},linkMultipleStyles:!0,linkConvertEmailAddress:!0,linkAlwaysBlank:!1,linkAlwaysNoFollow:!1,linkList:[{text:"Froala",href:"https://froala.com",target:"_blank"},{text:"Google",href:"https://google.com",target:"_blank"},{displayText:"Facebook",href:"https://facebook.com"}],linkText:!0});n.FE.PLUGINS.link=function(t){function i(){var f=t.image?t.image.get():null,u,r,i;return!f&&t.$wp?(u=t.selection.ranges(0).commonAncestorContainer,u&&(u.contains&&u.contains(t.el)||!t.el.contains(u)||t.el==u)&&(u=null),u&&"A"===u.tagName)?u:(r=t.selection.element(),i=t.selection.endElement(),"A"==r.tagName||t.node.isElement(r)||(r=n(r).parentsUntil(t.$el,"a:first").get(0)),"A"==i.tagName||t.node.isElement(i)||(i=n(i).parentsUntil(t.$el,"a:first").get(0)),i&&(i.contains&&i.contains(t.el)||!t.el.contains(i)||t.el==i)&&(i=null),r&&(r.contains&&r.contains(t.el)||!t.el.contains(r)||t.el==r)&&(r=null),i&&i==r&&"A"==i.tagName?r:null):"A"==t.el.tagName?t.el:f&&f.get(0).parentNode&&"A"==f.get(0).parentNode.tagName?f.get(0).parentNode:void 0}function e(){var c=t.image?t.image.get():null,f=[],i,n,r,u,e,h,o,s;if(c)"A"==c.get(0).parentNode.tagName&&f.push(c.get(0).parentNode);else if(t.win.getSelection){if(e=t.win.getSelection(),e.getRangeAt&&e.rangeCount)for(u=t.doc.createRange(),h=0;h<e.rangeCount;++h)if(i=e.getRangeAt(h),n=i.commonAncestorContainer,n&&1!=n.nodeType&&(n=n.parentNode),n&&"a"==n.nodeName.toLowerCase())f.push(n);else for(r=n.getElementsByTagName("a"),o=0;o<r.length;++o)u.selectNodeContents(r[o]),u.compareBoundaryPoints(i.END_TO_START,i)<1&&u.compareBoundaryPoints(i.START_TO_END,i)>-1&&f.push(r[o])}else if(t.doc.selection&&"Control"!=t.doc.selection.type)if(i=t.doc.selection.createRange(),n=i.parentElement(),"a"==n.nodeName.toLowerCase())f.push(n);else for(r=n.getElementsByTagName("a"),u=t.doc.body.createTextRange(),s=0;s<r.length;++s)u.moveToElementText(r[s]),u.compareEndPoints("StartToEnd",i)>-1&&u.compareEndPoints("EndToStart",i)<1&&f.push(r[s]);return f}function r(r){if(t.core.hasFocus()){if(u(),r&&"keyup"===r.type&&(r.altKey||r.which==n.FE.KEYCODE.ALT))return!0;setTimeout(function(){var u,s,f,e;if((!r||r&&(1==r.which||"mouseup"!=r.type))&&(u=i(),s=t.image?t.image.get():null,u&&!s)){if(t.image&&(f=t.node.contents(u),1==f.length&&"IMG"==f[0].tagName))return e=t.selection.ranges(0),0===e.startOffset&&0===e.endOffset?n(u).before(n.FE.MARKERS):n(u).after(n.FE.MARKERS),t.selection.restore(),!1;r&&r.stopPropagation();o(u)}},t.helpers.isIOS()?100:0)}}function o(i){var u=t.popups.get("link.edit"),r,f,e;u||(u=a());r=n(i);t.popups.isVisible("link.edit")||t.popups.refresh("link.edit");t.popups.setContainer("link.edit",t.$sc);f=r.offset().left+n(i).outerWidth()/2;e=r.offset().top+r.outerHeight();t.popups.show("link.edit",f,e,r.outerHeight())}function u(){t.popups.hide("link.edit")}function a(){var n="",r,u;return t.opts.linkEditButtons.length>1&&("A"==t.el.tagName&&t.opts.linkEditButtons.indexOf("linkRemove")>=0&&t.opts.linkEditButtons.splice(t.opts.linkEditButtons.indexOf("linkRemove"),1),n='<div class="fr-buttons">'+t.button.buildList(t.opts.linkEditButtons)+"<\/div>"),r={buttons:n},u=t.popups.create("link.edit",r),t.$wp&&t.events.$on(t.$wp,"scroll.link-edit",function(){i()&&t.popups.isVisible("link.edit")&&o(i())}),u}function v(){}function s(){var r=t.popups.get("link.insert"),s=i();if(s){for(var f,e=n(s),h=r.find('input.fr-link-attr[type="text"]'),o=r.find('input.fr-link-attr[type="checkbox"]'),u=0;u<h.length;u++)f=n(h[u]),f.val(e.attr(f.attr("name")||""));for(o.prop("checked",!1),u=0;u<o.length;u++)f=n(o[u]),e.attr(f.attr("name"))==f.data("checked")&&f.prop("checked",!0);r.find('input.fr-link-attr[type="text"][name="text"]').val(e.text())}else r.find('input.fr-link-attr[type="text"]').val(""),r.find('input.fr-link-attr[type="checkbox"]').prop("checked",!1),r.find('input.fr-link-attr[type="text"][name="text"]').val(t.selection.text());r.find("input.fr-link-attr").trigger("change");(t.image?t.image.get():null)?r.find('.fr-link-attr[name="text"]').parent().hide():r.find('.fr-link-attr[name="text"]').parent().show()}function y(){var n=t.$tb.find('.fr-command[data-cmd="insertLink"]'),i=t.popups.get("link.insert"),r,u;(i||(i=f()),i.hasClass("fr-active"))||((t.popups.refresh("link.insert"),t.popups.setContainer("link.insert",t.$tb||t.$sc),n.is(":visible"))?(r=n.offset().left+n.outerWidth()/2,u=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("link.insert",r,u,n.outerHeight())):(t.position.forSelection(i),t.popups.show("link.insert")))}function f(n){var e,f,o,h,a;if(n)return t.popups.onRefresh("link.insert",s),t.popups.onHide("link.insert",v),!0;e="";t.opts.linkInsertButtons.length>=1&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.linkInsertButtons)+"<\/div>");var r="",u=0;r='<div class="fr-link-insert-layer fr-layer fr-active" id="fr-link-insert-layer-'+t.id+'">';r+='<div class="fr-input-line"><input id="fr-link-insert-layer-url-'+t.id+'" name="href" type="text" class="fr-link-attr" placeholder="URL" tabIndex="'+ ++u+'"><\/div>';t.opts.linkText&&(r+='<div class="fr-input-line"><input id="fr-link-insert-layer-text-'+t.id+'" name="text" type="text" class="fr-link-attr" placeholder="'+t.language.translate("Text")+'" tabIndex="'+ ++u+'"><\/div>');for(f in t.opts.linkAttributes)t.opts.linkAttributes.hasOwnProperty(f)&&(o=t.opts.linkAttributes[f],r+='<div class="fr-input-line"><input name="'+f+'" type="text" class="fr-link-attr" placeholder="'+t.language.translate(o)+'" tabIndex="'+ ++u+'"><\/div>');return t.opts.linkAlwaysBlank||(r+='<div class="fr-checkbox-line"><span class="fr-checkbox"><input name="target" class="fr-link-attr" data-checked="_blank" type="checkbox" id="fr-link-target-'+t.id+'" tabIndex="'+ ++u+'"><span><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z" fill="#FFF"><\/path><\/svg><\/span><\/span><label for="fr-link-target-'+t.id+'">'+t.language.translate("Open in new tab")+"<\/label><\/div>"),r+='<div class="fr-action-buttons"><button class="fr-command fr-submit" role="button" data-cmd="linkInsert" href="#" tabIndex="'+ ++u+'" type="button">'+t.language.translate("Insert")+"<\/button><\/div><\/div>",h={buttons:e,input_layer:r},a=t.popups.create("link.insert",h),t.$wp&&t.events.$on(t.$wp,"scroll.link-insert",function(){(t.image?t.image.get():null)&&t.popups.isVisible("link.insert")&&l();i&&t.popups.isVisible("link.insert")&&c()}),a}function p(){var r=i(),f=t.image?t.image.get():null;if(!1===t.events.trigger("link.beforeRemove",[r]))return!1;f&&r?(f.unwrap(),t.image.edit(f)):r&&(t.selection.save(),n(r).replaceWith(n(r).html()),t.selection.restore(),u())}function w(){t.events.on("keyup",function(t){t.which!=n.FE.KEYCODE.ESC&&r(t)});t.events.on("window.mouseup",r);t.events.$on(t.$el,"click","a",function(n){t.edit.isDisabled()&&n.preventDefault()});t.helpers.isMobile()&&t.events.$on(t.$doc,"selectionchange",r);f(!0);"A"==t.el.tagName&&t.$el.addClass("fr-view");t.events.on("toolbar.esc",function(){if(t.popups.isVisible("link.edit"))return t.events.disableBlur(),t.events.focus(),!1},!0)}function b(i){for(var r,f=t.opts.linkList[i],e=t.popups.get("link.insert"),o=e.find('input.fr-link-attr[type="text"]'),s=e.find('input.fr-link-attr[type="checkbox"]'),u=0;u<o.length;u++)r=n(o[u]),f[r.attr("name")]?r.val(f[r.attr("name")]):"text"!=r.attr("name")&&r.val("");for(u=0;u<s.length;u++)r=n(s[u]),r.prop("checked",r.data("checked")==f[r.attr("name")]);t.accessibility.focusPopup(e)}function k(){for(var i,e=t.popups.get("link.insert"),u=e.find('input.fr-link-attr[type="text"]'),o=e.find('input.fr-link-attr[type="checkbox"]'),c=u.filter('[name="href"]').val(),l=u.filter('[name="text"]').val(),f={},s,r=0;r<u.length;r++)i=n(u[r]),["href","text"].indexOf(i.attr("name"))<0&&(f[i.attr("name")]=i.val());for(r=0;r<o.length;r++)i=n(o[r]),f[i.attr("name")]=i.is(":checked")?i.data("checked"):i.data("unchecked")||null;s=t.helpers.scrollTop();h(c,l,f);n(t.o_win).scrollTop(s)}function d(){var f,i,u,h,e;if(!t.selection.isCollapsed()){for(t.selection.save(),f=t.$el.find(".fr-marker").addClass("fr-unprocessed").toArray();f.length;){if(i=n(f.pop()),i.removeClass("fr-unprocessed"),u=t.node.deepestParent(i.get(0)),u){var r=i.get(0),s="",o="";do r=r.parentNode,t.node.isBlock(r)||(s+=t.node.closeTagString(r),o=t.node.openTagString(r)+o);while(r!=u);h=t.node.openTagString(i.get(0))+i.html()+t.node.closeTagString(i.get(0));i.replaceWith('<span id="fr-break"><\/span>');e=u.outerHTML;e=e.replace(/<span id="fr-break"><\/span>/g,s+h+o);u.outerHTML=e}f=t.$el.find(".fr-marker.fr-unprocessed").toArray()}t.html.cleanEmptyTags();t.selection.restore()}}function h(u,f,o){var s,a,p,h,v,c,l,y;if(void 0===o&&(o={}),!1===t.events.trigger("link.beforeInsert",[u,f,o]))return!1;if(s=t.image?t.image.get():null,s||"A"==t.el.tagName?"A"==t.el.tagName&&t.$el.focus():(t.selection.restore(),t.popups.hide("link.insert")),a=u,t.opts.linkConvertEmailAddress&&n.FE.MAIL_REGEX.test(u)&&!/^mailto:.*/i.test(u)&&(u="mailto:"+u),p=/^([A-Za-z]:(\\){1,2}|[A-Za-z]:((\\){1,2}[^\\]+)+)(\\)?$/i,""===t.opts.linkAutoPrefix||new RegExp("^("+n.FE.LinkProtocols.join("|")+"):.","i").test(u)||/^data:image.*/i.test(u)||/^(https?:|ftps?:|file:|)\/\//i.test(u)||p.test(u)||["/","{","[","#","("].indexOf((u||"")[0])<0&&(u=t.opts.linkAutoPrefix+u),u=t.helpers.sanitizeURL(u),t.opts.linkAlwaysBlank&&(o.target="_blank"),t.opts.linkAlwaysNoFollow&&(o.rel="nofollow"),"_blank"==o.target?o.rel?o.rel+=" noopener noreferrer":o.rel="noopener noreferrer":null==o.target&&(o.rel=o.rel?o.rel.replace(/noopener/,"").replace(/noreferrer/,""):null),f=f||"",u===t.opts.linkAutoPrefix)return t.popups.get("link.insert").find('input[name="href"]').addClass("fr-error"),t.events.trigger("link.bad",[a]),!1;if(v=i(),v)h=n(v),h.attr("href",u),f.length>0&&h.text()!=f&&!s&&h.text(f),s||h.prepend(n.FE.START_MARKER).append(n.FE.END_MARKER),h.attr(o),s||t.selection.restore();else{for(s?s.wrap('<a href="'+u+'"><\/a>'):(t.format.remove("a"),t.selection.isCollapsed()?(f=0===f.length?a:f,t.html.insert('<a href="'+u+'">'+n.FE.START_MARKER+f+n.FE.END_MARKER+"<\/a>"),t.selection.restore()):f.length>0&&f!=t.selection.text().replace(/\n/g,"")?(t.selection.remove(),t.html.insert('<a href="'+u+'">'+n.FE.START_MARKER+f+n.FE.END_MARKER+"<\/a>"),t.selection.restore()):(d(),t.format.apply("a",{href:u}))),c=e(),l=0;l<c.length;l++)h=n(c[l]),h.attr(o),h.removeAttr("_moz_dirty");1==c.length&&t.$wp&&!s&&(n(c[0]).prepend(n.FE.START_MARKER).append(n.FE.END_MARKER),t.selection.restore())}s?(y=t.popups.get("link.insert"),y&&y.find("input:focus").blur(),t.image.edit(s)):r()}function c(){var e,o;if(u(),e=i(),e){o=t.popups.get("link.insert");o||(o=f());t.popups.isVisible("link.insert")||(t.popups.refresh("link.insert"),t.selection.save(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()));t.popups.setContainer("link.insert",t.$sc);var r=(t.image?t.image.get():null)||n(e),s=r.offset().left+r.outerWidth()/2,h=r.offset().top+r.outerHeight();t.popups.show("link.insert",s,h,r.outerHeight())}}function g(){(t.image?t.image.get():null)?t.image.back():(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),i()&&t.$wp?(t.selection.restore(),u(),r()):"A"==t.el.tagName?(t.$el.focus(),r()):(t.popups.hide("link.insert"),t.toolbar.showInline()))}function l(){var n=t.image?t.image.getEl():null,i,r,u;n&&(i=t.popups.get("link.insert"),t.image.hasCaption()&&(n=n.find(".fr-img-wrap")),i||(i=f()),s(!0),t.popups.setContainer("link.insert",t.$sc),r=n.offset().left+n.outerWidth(!0)/2,u=n.offset().top+n.outerHeight(!0),t.popups.show("link.insert",r,u,n.outerHeight()))}function nt(u,f,e){var o,s;if(void 0===e&&(e=t.opts.linkMultipleStyles),void 0===f&&(f=t.opts.linkStyles),o=i(),!o)return!1;e||(s=Object.keys(f),s.splice(s.indexOf(u),1),n(o).removeClass(s.join(" ")));n(o).toggleClass(u);r()}return{_init:w,remove:p,showInsertPopup:y,usePredefined:b,insertCallback:k,insert:h,update:c,get:i,allSelected:e,back:g,imageLink:l,applyStyle:nt}};n.FE.DefineIcon("insertLink",{NAME:"link"});n.FE.RegisterShortcut(n.FE.KEYCODE.K,"insertLink",null,"K");n.FE.RegisterCommand("insertLink",{title:"Insert Link",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("link.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("link.insert")):this.link.showInsertPopup()},plugin:"link"});n.FE.DefineIcon("linkOpen",{NAME:"external-link"});n.FE.RegisterCommand("linkOpen",{title:"Open Link",undo:!1,refresh:function(n){this.link.get()?n.removeClass("fr-hidden"):n.addClass("fr-hidden")},callback:function(){var n=this.link.get();n&&this.o_win.open(n.href)},plugin:"link"});n.FE.DefineIcon("linkEdit",{NAME:"edit"});n.FE.RegisterCommand("linkEdit",{title:"Edit Link",undo:!1,refreshAfterCallback:!1,popup:!0,callback:function(){this.link.update()},refresh:function(n){this.link.get()?n.removeClass("fr-hidden"):n.addClass("fr-hidden")},plugin:"link"});n.FE.DefineIcon("linkRemove",{NAME:"unlink"});n.FE.RegisterCommand("linkRemove",{title:"Unlink",callback:function(){this.link.remove()},refresh:function(n){this.link.get()?n.removeClass("fr-hidden"):n.addClass("fr-hidden")},plugin:"link"});n.FE.DefineIcon("linkBack",{NAME:"arrow-left"});n.FE.RegisterCommand("linkBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.link.back()},refresh:function(n){var t=this.link.get()&&this.doc.hasFocus();(this.image?this.image.get():null)||t||this.opts.toolbarInline?(n.removeClass("fr-hidden"),n.next(".fr-separator").removeClass("fr-hidden")):(n.addClass("fr-hidden"),n.next(".fr-separator").addClass("fr-hidden"))},plugin:"link"});n.FE.DefineIcon("linkList",{NAME:"search"});n.FE.RegisterCommand("linkList",{title:"Choose Link",type:"dropdown",focus:!1,undo:!1,refreshAfterCallback:!1,html:function(){for(var i='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.linkList,n=0;n<t.length;n++)i+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="linkList" data-param1="'+n+'">'+(t[n].displayText||t[n].text)+"<\/a><\/li>";return i+"<\/ul>"},callback:function(n,t){this.link.usePredefined(t)},plugin:"link"});n.FE.RegisterCommand("linkInsert",{focus:!1,refreshAfterCallback:!1,callback:function(){this.link.insertCallback()},refresh:function(n){this.link.get()?n.text(this.language.translate("Update")):n.text(this.language.translate("Insert"))},plugin:"link"});n.FE.DefineIcon("imageLink",{NAME:"link"});n.FE.RegisterCommand("imageLink",{title:"Insert Link",undo:!1,focus:!1,popup:!0,callback:function(){this.link.imageLink()},refresh:function(n){var t,i=this.link.get();i?(t=n.prev(),t.hasClass("fr-separator")&&t.removeClass("fr-hidden"),n.addClass("fr-hidden")):(t=n.prev(),t.hasClass("fr-separator")&&t.addClass("fr-hidden"),n.removeClass("fr-hidden"))},plugin:"link"});n.FE.DefineIcon("linkStyle",{NAME:"magic"});n.FE.RegisterCommand("linkStyle",{title:"Style",type:"dropdown",html:function(){var i='<ul class="fr-dropdown-list" role="presentation">',n=this.opts.linkStyles;for(var t in n)n.hasOwnProperty(t)&&(i+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="linkStyle" data-param1="'+t+'">'+this.language.translate(n[t])+"<\/a><\/li>");return i+"<\/ul>"},callback:function(n,t){this.link.applyStyle(t)},refreshOnShow:function(t,i){var r=this.link.get(),u;r&&(u=n(r),i.find(".fr-command").each(function(){var i=n(this).data("param1"),t=u.hasClass(i);n(this).toggleClass("fr-active",t).attr("aria-selected",t)}))},plugin:"link"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.FE.PLUGINS.lists=function(t){function i(n){return'<span class="fr-open-'+n.toLowerCase()+'"><\/span>'}function r(n){return'<span class="fr-close-'+n.toLowerCase()+'"><\/span>'}function o(t,i){for(var f,e,u=[],r=0;r<t.length;r++)f=t[r].parentNode,"LI"==t[r].tagName&&f.tagName!=i&&u.indexOf(f)<0&&u.push(f);for(r=u.length-1;r>=0;r--)e=n(u[r]),e.replaceWith("<"+i.toLowerCase()+">"+e.html()+"<\/"+i.toLowerCase()+">")}function s(i,r){var c,l,f,u,e,h,s;for(o(i,r),l=t.html.defaultTag(),f=null,i.length&&(c="rtl"==t.opts.direction||"rtl"==n(i[0]).css("direction")?"margin-right":"margin-left"),u=0;u<i.length;u++)if("LI"!=i[u].tagName){for(e=t.helpers.getPX(n(i[u]).css(c))||0,i[u].style.marginLeft=null,null===f&&(f=e),h=f>0?"<"+r+' style="'+c+": "+f+'px;">':"<"+r+">",s="<\/"+r+">",e-=f;e/t.opts.indentMargin>0;)h+="<"+r+">",s+=s,e-=t.opts.indentMargin;l&&i[u].tagName.toLowerCase()==l?n(i[u]).replaceWith(h+"<li"+t.node.attributes(i[u])+">"+n(i[u]).html()+"<\/li>"+s):n(i[u]).wrap(h+"<li><\/li>"+s)}t.clean.lists()}function u(u){for(var h,c,l,v,a,s,f=u.length-1;f>=0;f--)for(h=f-1;h>=0;h--)if(n(u[h]).find(u[f]).length||u[h]==u[f]){u.splice(f,1);break}for(c=[],f=0;f<u.length;f++){var e=n(u[f]),o=u[f].parentNode,y=e.attr("class");(e.before(r(o.tagName)),"LI"==o.parentNode.tagName)?(e.before(r("LI")),e.after(i("LI"))):(l="",y&&(l+=' class="'+y+'"'),v="rtl"==t.opts.direction||"rtl"==e.css("direction")?"margin-right":"margin-left",t.helpers.getPX(n(o).css(v))&&(l+=' style="'+v+":"+t.helpers.getPX(n(o).css(v))+'px;"'),l&&e.wrapInner("<"+t.html.defaultTag()+l+"><\/"+t.html.defaultTag()+">"),t.node.isEmpty(e.get(0),!0)||0!==e.find(t.html.blockTagsQuery()).length||e.append("<br>"),e.append(i("LI")),e.prepend(r("LI")));e.after(i(o.tagName));"LI"==o.parentNode.tagName&&(o=o.parentNode.parentNode);c.indexOf(o)<0&&c.push(o)}for(f=0;f<c.length;f++)a=n(c[f]),s=a.html(),s=s.replace(/<span class="fr-close-([a-z]*)"><\/span>/g,"<\/$1>"),s=s.replace(/<span class="fr-open-([a-z]*)"><\/span>/g,"<$1>"),a.replaceWith(t.node.openTagString(a.get(0))+s+t.node.closeTagString(a.get(0)));t.$el.find("li:empty").remove();t.$el.find("ul:empty, ol:empty").remove();t.clean.lists();t.html.wrap()}function h(n,t){for(var r=!0,i=0;i<n.length;i++){if("LI"!=n[i].tagName)return!1;n[i].parentNode.tagName!=t&&(r=!1)}return r}function c(n){t.selection.save();t.html.wrap(!0,!0,!0,!0);t.selection.restore();for(var i=t.selection.blocks(),r=0;r<i.length;r++)"LI"!=i[r].tagName&&"LI"==i[r].parentNode.tagName&&(i[r]=i[r].parentNode);t.selection.save();h(i,n)?u(i):s(i,n);t.html.unwrap();t.selection.restore()}function l(i,r){var f=n(t.selection.element()),u;f.get(0)!=t.el&&(u=f.get(0),u="LI"!=u.tagName&&u.firstElementChild&&"LI"!=u.firstElementChild.tagName?f.parents("li").get(0):"LI"==u.tagName||u.firstElementChild?u.firstElementChild&&"LI"==u.firstElementChild.tagName?f.get(0).firstChild:f.get(0):f.parents("li").get(0),u&&u.parentNode.tagName==r&&t.el.contains(u.parentNode)&&i.addClass("fr-active"))}function f(i){var r,f,e,h,u,c,o,s;for(t.selection.save(),r=0;r<i.length;r++)if(f=i[r].previousSibling,f)if(e=n(i[r]).find("> ul, > ol").last().get(0),e){for(h=n("<li>").prependTo(n(e)),u=t.node.contents(i[r])[0];u&&!t.node.isList(u);)c=u.nextSibling,h.append(u),u=c;n(f).append(n(e));n(i[r]).remove()}else o=n(f).find("> ul, > ol").last().get(0),o?n(o).append(n(i[r])):(s=n("<"+i[r].parentNode.tagName+">"),n(f).append(s),s.append(n(i[r])));t.clean.lists();t.selection.restore()}function e(n){t.selection.save();u(n);t.selection.restore()}function a(n){if("indent"==n||"outdent"==n){for(var o=!1,r=t.selection.blocks(),u=[],i=0;i<r.length;i++)"LI"==r[i].tagName?(o=!0,u.push(r[i])):"LI"==r[i].parentNode.tagName&&(o=!0,u.push(r[i].parentNode));o&&("indent"==n?f(u):e(u))}}function v(){t.events.on("commands.after",a);t.events.on("keydown",function(i){if(i.which==n.FE.KEYCODE.TAB){for(var o=t.selection.blocks(),r=[],u=0;u<o.length;u++)"LI"==o[u].tagName?r.push(o[u]):"LI"==o[u].parentNode.tagName&&r.push(o[u].parentNode);if(r.length>1||r.length&&(t.selection.info(r[0]).atStart||t.node.isEmpty(r[0])))return i.preventDefault(),i.stopPropagation(),i.shiftKey?e(r):f(r),!1}},!0)}return{_init:v,format:c,refresh:l}};n.FE.RegisterCommand("formatUL",{title:"Unordered List",refresh:function(n){this.lists.refresh(n,"UL")},callback:function(){this.lists.format("UL")},plugin:"lists"});n.FE.RegisterCommand("formatOL",{title:"Ordered List",refresh:function(n){this.lists.refresh(n,"OL")},callback:function(){this.lists.format("OL")},plugin:"lists"});n.FE.DefineIcon("formatUL",{NAME:"list-ul"});n.FE.DefineIcon("formatOL",{NAME:"list-ol"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{paragraphFormat:{N:"Normal",H1:"Heading 1",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",PRE:"Code"},paragraphFormatSelection:!1});n.FE.PLUGINS.paragraphFormat=function(t){function i(i,r){var o=t.html.defaultTag(),f,u,e;if(r&&r.toLowerCase()!=o)if(i.find("ul, ol").length>0)for(f=n("<"+r+">"),i.prepend(f),u=t.node.contents(i.get(0))[0];u&&["UL","OL"].indexOf(u.tagName)<0;)e=u.nextSibling,f.append(u),u=e;else i.html("<"+r+">"+i.html()+"<\/"+r+">")}function r(i,r){var u=t.html.defaultTag();r||(r='div class="fr-temp-div" data-empty="true"');r.toLowerCase()==u?i.replaceWith(i.html()):i.replaceWith(n("<"+r+">").html(i.html()))}function u(i,r){var u=t.html.defaultTag();r||(r='div class="fr-temp-div"'+(t.node.isEmpty(i.get(0),!0)?' data-empty="true"':""));r.toLowerCase()==u?(t.node.isEmpty(i.get(0),!0)||i.append("<br/>"),i.replaceWith(i.html())):i.replaceWith(n("<"+r+">").html(i.html()))}function f(i,r){r||(r='div class="fr-temp-div"'+(t.node.isEmpty(i.get(0),!0)?' data-empty="true"':""));i.replaceWith(n("<"+r+" "+t.node.attributes(i.get(0))+">").html(i.html()).removeAttr("data-empty"))}function e(e){var s,o,h;for("N"==e&&(e=t.html.defaultTag()),t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore(),s=t.selection.blocks(),t.selection.save(),t.$el.find("pre").attr("skip",!0),o=0;o<s.length;o++)s[o].tagName==e||t.node.isList(s[o])||(h=n(s[o]),"LI"==s[o].tagName?i(h,e):"LI"==s[o].parentNode.tagName&&s[o]?r(h,e):["TD","TH"].indexOf(s[o].parentNode.tagName)>=0?u(h,e):f(h,e));t.$el.find('pre:not([skip="true"]) + pre:not([skip="true"])').each(function(){n(this).prev().append("<br>"+n(this).html());n(this).remove()});t.$el.find("pre").removeAttr("skip");t.html.unwrap();t.selection.restore()}function o(n,i){var u=t.selection.blocks();if(u.length){var r=u[0],f="N",e=t.html.defaultTag();r.tagName.toLowerCase()!=e&&r!=t.el&&(f=r.tagName);i.find('.fr-command[data-param1="'+f+'"]').addClass("fr-active").attr("aria-selected",!0)}else i.find('.fr-command[data-param1="N"]').addClass("fr-active").attr("aria-selected",!0)}function s(n){var r;if(t.opts.paragraphFormatSelection)if(r=t.selection.blocks(),r.length){var u=r[0],i="N",f=t.html.defaultTag();u.tagName.toLowerCase()!=f&&u!=t.el&&(i=u.tagName);["LI","TD","TH"].indexOf(i)>=0&&(i="N");n.find("> span").text(t.language.translate(t.opts.paragraphFormat[i]))}else n.find("> span").text(t.language.translate(t.opts.paragraphFormat.N))}return{apply:e,refreshOnShow:o,refresh:s}};n.FE.RegisterCommand("paragraphFormat",{type:"dropdown",displaySelection:function(n){return n.opts.paragraphFormatSelection},defaultSelection:"Normal",displaySelectionWidth:100,html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.paragraphFormat,n,i;for(n in t)t.hasOwnProperty(n)&&(i=this.shortcuts.get("paragraphFormat."+n),i=i?'<span class="fr-shortcut">'+i+"<\/span>":"",r+='<li role="presentation"><'+("N"==n?this.html.defaultTag()||"DIV":n)+' style="padding: 0 !important; margin: 0 !important;" role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="paragraphFormat" data-param1="'+n+'" title="'+this.language.translate(t[n])+'">'+this.language.translate(t[n])+"<\/a><\/"+("N"==n?this.html.defaultTag()||"DIV":n)+"><\/li>");return r+"<\/ul>"},title:"Paragraph Format",callback:function(n,t){this.paragraphFormat.apply(t)},refresh:function(n){this.paragraphFormat.refresh(n)},refreshOnShow:function(n,t){this.paragraphFormat.refreshOnShow(n,t)},plugin:"paragraphFormat"});n.FE.DefineIcon("paragraphFormat",{NAME:"paragraph"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{paragraphStyles:{"fr-text-gray":"Gray","fr-text-bordered":"Bordered","fr-text-spaced":"Spaced","fr-text-uppercase":"Uppercase"},paragraphMultipleStyles:!0});n.FE.PLUGINS.paragraphStyle=function(t){function i(i,r,u){var o,f,s,e;for(void 0===r&&(r=t.opts.paragraphStyles),void 0===u&&(u=t.opts.paragraphMultipleStyles),o="",u||(o=Object.keys(r),o.splice(o.indexOf(i),1),o=o.join(" ")),t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore(),f=t.selection.blocks(),t.selection.save(),s=n(f[0]).hasClass(i),e=0;e<f.length;e++)n(f[e]).removeClass(o).toggleClass(i,!s),n(f[e]).hasClass("fr-temp-div")&&n(f[e]).removeClass("fr-temp-div"),""===n(f[e]).attr("class")&&n(f[e]).removeAttr("class");t.html.unwrap();t.selection.restore()}function r(i,r){var u=t.selection.blocks(),f;u.length&&(f=n(u[0]),r.find(".fr-command").each(function(){var i=n(this).data("param1"),t=f.hasClass(i);n(this).toggleClass("fr-active",t).attr("aria-selected",t)}))}function u(){}return{_init:u,apply:i,refreshOnShow:r}};n.FE.RegisterCommand("paragraphStyle",{type:"dropdown",html:function(){var i='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.paragraphStyles;for(var n in t)t.hasOwnProperty(n)&&(i+='<li role="presentation"><a class="fr-command '+n+'" tabIndex="-1" role="option" data-cmd="paragraphStyle" data-param1="'+n+'" title="'+this.language.translate(t[n])+'">'+this.language.translate(t[n])+"<\/a><\/li>");return i+"<\/ul>"},title:"Paragraph Style",callback:function(n,t){this.paragraphStyle.apply(t)},refreshOnShow:function(n,t){this.paragraphStyle.refreshOnShow(n,t)},plugin:"paragraphStyle"});n.FE.DefineIcon("paragraphStyle",{NAME:"magic"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{quickInsertButtons:["image","video","embedly","table","ul","ol","hr"],quickInsertTags:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote"]});n.FE.QUICK_INSERT_BUTTONS={};n.FE.DefineIcon("quickInsert",{PATH:'<path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/>',template:"svg"});n.FE.RegisterQuickInsertButton=function(t,i){n.FE.QUICK_INSERT_BUTTONS[t]=n.extend({undo:!0},i)};n.FE.RegisterQuickInsertButton("image",{icon:"insertImage",requiredPlugin:"image",title:"Insert Image",undo:!1,callback:function(){var t=this;t.shared.$qi_image_input||(t.shared.$qi_image_input=n('<input accept="image/*" name="quickInsertImage'+this.id+'" style="display: none;" type="file">'),n("body:first").append(t.shared.$qi_image_input),t.events.$on(t.shared.$qi_image_input,"change",function(){var t=n(this).data("inst");this.files&&(t.quickInsert.hide(),t.image.upload(this.files));n(this).val("")},!0));t.$qi_image_input=t.shared.$qi_image_input;t.helpers.isMobile()&&t.selection.save();t.$qi_image_input.data("inst",t).trigger("click")}});n.FE.RegisterQuickInsertButton("video",{icon:"insertVideo",requiredPlugin:"video",title:"Insert Video",undo:!1,callback:function(){var n=prompt(this.language.translate("Paste the URL of the video you want to insert."));n&&this.video.insertByURL(n)}});n.FE.RegisterQuickInsertButton("embedly",{icon:"embedly",requiredPlugin:"embedly",title:"Embed URL",undo:!1,callback:function(){var n=prompt(this.language.translate("Paste the URL of any web content you want to insert."));n&&this.embedly.add(n)}});n.FE.RegisterQuickInsertButton("table",{icon:"insertTable",requiredPlugin:"table",title:"Insert Table",callback:function(){this.table.insert(2,2)}});n.FE.RegisterQuickInsertButton("ol",{icon:"formatOL",requiredPlugin:"lists",title:"Ordered List",callback:function(){this.lists.format("OL")}});n.FE.RegisterQuickInsertButton("ul",{icon:"formatUL",requiredPlugin:"lists",title:"Unordered List",callback:function(){this.lists.format("UL")}});n.FE.RegisterQuickInsertButton("hr",{icon:"insertHR",title:"Insert Horizontal Line",callback:function(){this.commands.insertHR()}});n.FE.PLUGINS.quickInsert=function(t){function o(n){var f,o,e;f=n.offset().top-t.$box.offset().top;o=0-i.outerWidth();e=(i.outerHeight()-n.outerHeight())/2;t.opts.iframe&&(f+=t.$iframe.offset().top-t.helpers.scrollTop());i.hasClass("fr-on")&&f>=0&&r.css("top",f-e);f>=0&&f-e<=t.$box.outerHeight()-n.outerHeight()?(i.hasClass("fr-hidden")&&(i.hasClass("fr-on")&&s(),i.removeClass("fr-hidden")),i.css("top",f-e)):i.hasClass("fr-visible")&&(i.addClass("fr-hidden"),u());i.css("left",o)}function h(n){i||c();i.hasClass("fr-on")&&u();t.$box.append(i);o(n);i.data("tag",n);i.addClass("fr-visible")}function f(){if(t.core.hasFocus()){var r=t.selection.element();t.node.isBlock(r)||(r=t.node.blockParent(r));r&&t.node.isEmpty(r)&&t.node.isElement(r.parentNode)&&t.opts.quickInsertTags.indexOf(r.tagName.toLowerCase())>=0?i&&i.data("tag").is(n(r))&&i.hasClass("fr-on")?u():t.selection.isCollapsed()&&h(n(r)):e()}}function e(){i&&(t.html.checkIfEmpty(),i.hasClass("fr-on")&&u(),i.removeClass("fr-visible fr-on"),i.css("left",-9999).css("top",-9999))}function s(f){var e;if(f&&f.preventDefault(),i.hasClass("fr-on")&&!i.hasClass("fr-hidden"))u();else{if(!t.shared.$qi_helper){for(var s=t.opts.quickInsertButtons,h='<div class="fr-qi-helper">',c=0,o=0;o<s.length;o++)e=n.FE.QUICK_INSERT_BUTTONS[s[o]],e&&(!e.requiredPlugin||n.FE.PLUGINS[e.requiredPlugin]&&t.opts.pluginsEnabled.indexOf(e.requiredPlugin)>=0)&&(h+='<a class="fr-btn fr-floating-btn" role="button" title="'+t.language.translate(e.title)+'" tabIndex="-1" data-cmd="'+s[o]+'" style="transition-delay: '+.025*c+++'s;">'+t.icon.create(e.icon)+"<\/a>");h+="<\/div>";t.shared.$qi_helper=n(h);t.tooltip.bind(t.shared.$qi_helper,"> a.fr-btn")}r=t.shared.$qi_helper;r.appendTo(t.$box);setTimeout(function(){r.css("top",parseFloat(i.css("top")));r.css("left",parseFloat(i.css("left"))+i.outerWidth());r.find("a").addClass("fr-size-1");i.addClass("fr-on")},10)}}function u(){var n=t.$box.find(".fr-qi-helper");n.length&&(n.find("a").removeClass("fr-size-1"),n.css("left",-9999),i.hasClass("fr-hidden")||i.removeClass("fr-on"))}function c(){t.shared.$quick_insert||(t.shared.$quick_insert=n('<div class="fr-quick-insert"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Quick Insert")+'">'+t.icon.create("quickInsert")+"<\/a><\/div>"));i=t.shared.$quick_insert;t.tooltip.bind(t.$box,".fr-quick-insert > a.fr-floating-btn");t.events.on("destroy",function(){i.removeClass("fr-on").appendTo(n("body:first")).css("left",-9999).css("top",-9999);r&&(u(),r.appendTo(n("body:first")))},!0);t.events.on("shared.destroy",function(){i.html("").removeData().remove();i=null;r&&(r.html("").removeData().remove(),r=null)},!0);t.events.on("commands.before",e);t.events.on("commands.after",function(){t.popups.areVisible()||f()});t.events.bindClick(t.$box,".fr-quick-insert > a",s);t.events.bindClick(t.$box,".fr-qi-helper > a.fr-btn",function(i){var r=n(i.currentTarget).data("cmd");n.FE.QUICK_INSERT_BUTTONS[r].callback.apply(t,[i.currentTarget]);n.FE.QUICK_INSERT_BUTTONS[r].undo&&t.undo.saveStep();t.quickInsert.hide()});t.events.$on(t.$wp,"scroll",function(){i.hasClass("fr-visible")&&o(i.data("tag"))})}function l(){if(!t.$wp)return!1;t.opts.iframe&&t.$el.parent("html").find("head").append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">');t.popups.onShow("image.edit",e);t.events.on("mouseup",f);t.helpers.isMobile()&&t.events.$on(n(t.o_doc),"selectionchange",f);t.events.on("blur",e);t.events.on("keyup",f);t.events.on("keydown",function(){setTimeout(function(){f()},0)})}var i,r;return{_init:l,hide:e}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.FE.PLUGINS.quote=function(t){function i(n){for(;n.parentNode&&n.parentNode!=t.el;)n=n.parentNode;return n}function r(){for(var u=t.selection.blocks(),f,r=0;r<u.length;r++)u[r]=i(u[r]);for(t.selection.save(),f=n("<blockquote>"),f.insertBefore(u[0]),r=0;r<u.length;r++)f.append(u[r]);t.html.unwrap();t.selection.restore()}function u(){for(var r=t.selection.blocks(),i=0;i<r.length;i++)"BLOCKQUOTE"!=r[i].tagName&&(r[i]=n(r[i]).parentsUntil(t.$el,"BLOCKQUOTE").get(0));for(t.selection.save(),i=0;i<r.length;i++)r[i]&&n(r[i]).replaceWith(r[i].innerHTML);t.html.unwrap();t.selection.restore()}function f(n){t.selection.save();t.html.wrap(!0,!0,!0,!0);t.selection.restore();"increase"==n?r():"decrease"==n&&u()}return{apply:f}};n.FE.RegisterShortcut(n.FE.KEYCODE.SINGLE_QUOTE,"quote","increase","'");n.FE.RegisterShortcut(n.FE.KEYCODE.SINGLE_QUOTE,"quote","decrease","'",!0);n.FE.RegisterCommand("quote",{title:"Quote",type:"dropdown",options:{increase:"Increase",decrease:"Decrease"},callback:function(n,t){this.quote.apply(t)},plugin:"quote"});n.FE.DefineIcon("quote",{NAME:"quote-left"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.DEFAULTS,{saveInterval:1e4,saveURL:null,saveParams:{},saveParam:"body",saveMethod:"POST"});n.FE.PLUGINS.save=function(t){function e(n,i){t.events.trigger("save.error",[{code:n,message:f[n]},i])}function o(r){var o,u,f,s;if(void 0===r&&(r=t.html.get()),!1===t.events.trigger("save.before"))return!1;if(t.opts.saveURL){o={};for(u in t.opts.saveParams)t.opts.saveParams.hasOwnProperty(u)&&(f=t.opts.saveParams[u],o[u]="function"==typeof f?f.call(this):f);s={};s[t.opts.saveParam]=r;n.ajax({type:t.opts.saveMethod,url:t.opts.saveURL,data:n.extend(s,o),crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(n){i=r;t.events.trigger("save.after",[n])}).fail(function(n){e(c,n.response||n.responseText)})}else e(h)}function s(){clearTimeout(u);u=setTimeout(function(){var n=t.html.get();(i!=n||r)&&(i=n,r=!1,o(n))},t.opts.saveInterval)}function l(){s();r=!1}function a(){r=!0}function v(){t.opts.saveInterval&&(i=t.html.get(),t.events.on("contentChanged",s),t.events.on("keydown destroy",function(){clearTimeout(u)}))}var u=null,i=null,r=!1,h=1,c=2,f={};return f[h]="Missing saveURL option.",f[c]="Something went wrong during save.",{_init:v,save:o,reset:l,force:a}};n.FE.DefineIcon("save",{NAME:"floppy-o"});n.FE.RegisterCommand("save",{title:"Save",undo:!1,focus:!1,refreshAfterCallback:!1,callback:function(){this.save.save()},plugin:"save"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_]"});n.extend(n.FE.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizer:!0,tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0,tableInsertHelper:!0,tableInsertHelperOffset:15});n.FE.PLUGINS.table=function(t){function ri(){var n=t.$tb.find('.fr-command[data-cmd="insertTable"]'),i=t.popups.get("table.insert"),r,u;(i||(i=et()),i.hasClass("fr-active"))||(t.popups.refresh("table.insert"),t.popups.setContainer("table.insert",t.$tb),r=n.offset().left+n.outerWidth()/2,u=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("table.insert",r,u,n.outerHeight()))}function s(){var r=f(),i;if(r){i=t.popups.get("table.edit");i||(i=ot());t.popups.setContainer("table.edit",t.$sc);var n=pt(r),u=(n.left+n.right)/2,e=n.bottom;t.popups.show("table.edit",u,e,n.bottom-n.top);t.edit.isDisabled()&&(t.toolbar.disable(),t.$el.removeClass("fr-no-selection"),t.edit.on(),t.button.bulkRefresh(),t.selection.setAtEnd(t.$el.find(".fr-selected-cell:last").get(0)),t.selection.restore())}}function ft(){var r=f(),i;if(r){i=t.popups.get("table.colors");i||(i=oi());t.popups.setContainer("table.colors",t.$sc);var n=pt(r),u=(n.left+n.right)/2,e=n.bottom;ci();t.popups.show("table.colors",u,e,n.bottom-n.top)}}function ui(){0===u().length&&t.toolbar.enable()}function et(i){var u,f,r;return i?(t.popups.onHide("table.insert",function(){t.popups.get("table.insert").find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),!0):(u="",t.opts.tableInsertButtons.length>0&&(u='<div class="fr-buttons">'+t.button.buildList(t.opts.tableInsertButtons)+"<\/div>"),f={buttons:u,rows_columns:fi()},r=t.popups.create("table.insert",f),t.events.$on(r,"mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(t){rt(n(t.currentTarget))},!0),ei(r),r)}function rt(n){var f=n.data("row"),o=n.data("col"),e=n.parent(),i,r,u;for(e.siblings(".fr-table-size-info").html(f+" &times; "+o),e.find("> span").removeClass("hover fr-active-item"),i=1;i<=t.opts.tableInsertMaxSize;i++)for(r=0;r<=t.opts.tableInsertMaxSize;r++)u=e.find('> span[data-row="'+i+'"][data-col="'+r+'"]'),i<=f&&r<=o?u.addClass("hover"):i<=f+1||i<=2&&!t.helpers.isMobile()?u.css("display","inline-block"):i>2&&!t.helpers.isMobile()&&u.css("display","none");n.addClass("fr-active-item")}function fi(){for(var i,u,f,r='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1<\/div><div class="fr-select-table-size">',n=1;n<=t.opts.tableInsertMaxSize;n++){for(i=1;i<=t.opts.tableInsertMaxSize;i++)u="inline-block",n>2&&!t.helpers.isMobile()&&(u="none"),f="fr-table-cell ",1==n&&1==i&&(f+=" hover"),r+='<span class="fr-command '+f+'" tabIndex="-1" data-cmd="tableInsert" data-row="'+n+'" data-col="'+i+'" data-param1="'+n+'" data-param2="'+i+'" style="display: '+u+';" role="button"><span><\/span><span class="fr-sr-only">'+n+" &times; "+i+"&nbsp;&nbsp;&nbsp;<\/span><\/span>";r+='<div class="new-line"><\/div>'}return r+"<\/div><\/div>"}function ei(i){t.events.$on(i,"focus","[tabIndex]",function(t){rt(n(t.currentTarget))});t.events.on("popup.tab",function(i){var u=n(i.currentTarget),o,r,a,h;if(!t.popups.isVisible("table.insert")||!u.is("span, a"))return!0;if(r=i.which,n.FE.KEYCODE.ARROW_UP==r||n.FE.KEYCODE.ARROW_DOWN==r||n.FE.KEYCODE.ARROW_LEFT==r||n.FE.KEYCODE.ARROW_RIGHT==r){if(u.is("span.fr-table-cell")){var c=u.parent().find("span.fr-table-cell"),l=c.index(u),s=t.opts.tableInsertMaxSize,f=l%s,e=Math.floor(l/s);n.FE.KEYCODE.ARROW_UP==r?e=Math.max(0,e-1):n.FE.KEYCODE.ARROW_DOWN==r?e=Math.min(t.opts.tableInsertMaxSize-1,e+1):n.FE.KEYCODE.ARROW_LEFT==r?f=Math.max(0,f-1):n.FE.KEYCODE.ARROW_RIGHT==r&&(f=Math.min(t.opts.tableInsertMaxSize-1,f+1));a=e*s+f;h=n(c.get(a));rt(h);t.events.disableBlur();h.focus();o=!1}}else n.FE.KEYCODE.ENTER==r&&(t.button.exec(u),o=!1);return!1===o&&(i.preventDefault(),i.stopPropagation()),o},!0)}function ot(n){var i,r,u;return n?(t.popups.onHide("table.edit",ui),!0):(i="",t.opts.tableEditButtons.length>0&&(i='<div class="fr-buttons">'+t.button.buildList(t.opts.tableEditButtons)+"<\/div>"),r={buttons:i},u=t.popups.create("table.edit",r),t.events.$on(t.$wp,"scroll.table-edit",function(){t.popups.isVisible("table.edit")&&s()}),u)}function oi(){var i="",r,n;return t.opts.tableColorsButtons.length>0&&(i='<div class="fr-buttons fr-table-colors-buttons">'+t.button.buildList(t.opts.tableColorsButtons)+"<\/div>"),r={buttons:i,colors:si()},n=t.popups.create("table.colors",r),t.events.$on(t.$wp,"scroll.table-colors",function(){t.popups.isVisible("table.colors")&&ft()}),hi(n),n}function si(){for(var i='<div class="fr-table-colors">',n=0;n<t.opts.tableColors.length;n++)0!==n&&n%t.opts.tableColorsStep==0&&(i+="<br>"),i+="REMOVE"!=t.opts.tableColors[n]?'<span class="fr-command" style="background: '+t.opts.tableColors[n]+';" tabIndex="-1" role="button" data-cmd="tableCellBackgroundColor" data-param1="'+t.opts.tableColors[n]+'"><span class="fr-sr-only">'+t.language.translate("Color")+" "+t.opts.tableColors[n]+"&nbsp;&nbsp;&nbsp;<\/span><\/span>":'<span class="fr-command" data-cmd="tableCellBackgroundColor" tabIndex="-1" role="button" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'">'+t.icon.create("tableColorRemove")+'<span class="fr-sr-only">'+t.language.translate("Clear Formatting")+"<\/span><\/span>";return i+"<\/div>"}function hi(i){t.events.on("popup.tab",function(r){var h=n(r.currentTarget),u,s,l,v;if(!t.popups.isVisible("table.colors")||!h.is("span"))return!0;if(u=r.which,s=!0,n.FE.KEYCODE.TAB==u)l=i.find(".fr-buttons"),s=!t.accessibility.focusToolbar(l,!!r.shiftKey);else if(n.FE.KEYCODE.ARROW_UP==u||n.FE.KEYCODE.ARROW_DOWN==u||n.FE.KEYCODE.ARROW_LEFT==u||n.FE.KEYCODE.ARROW_RIGHT==u){var c=h.parent().find("span.fr-command"),a=c.index(h),o=t.opts.colorsStep,y=Math.floor(c.length/o),p=a%o,w=Math.floor(a/o),f=w*o+p,e=y*o;n.FE.KEYCODE.ARROW_UP==u?f=((f-o)%e+e)%e:n.FE.KEYCODE.ARROW_DOWN==u?f=(f+o)%e:n.FE.KEYCODE.ARROW_LEFT==u?f=((f-1)%e+e)%e:n.FE.KEYCODE.ARROW_RIGHT==u&&(f=(f+1)%e);v=n(c.get(f));t.events.disableBlur();v.focus();s=!1}else n.FE.KEYCODE.ENTER==u&&(t.button.exec(h),s=!1);return!1===s&&(r.preventDefault(),r.stopPropagation()),s},!0)}function ci(){var n=t.popups.get("table.colors"),i=t.$el.find(".fr-selected-cell:first");n.find(".fr-selected-color").removeClass("fr-selected-color fr-active-item");n.find('span[data-param1="'+t.helpers.RGBToHex(i.css("background-color"))+'"]').addClass("fr-selected-color fr-active-item")}function li(i,r){for(var e,u='<table style="width: 100%;" class="fr-inserted-table"><tbody>',s=100/r,o,f=0;f<i;f++){for(u+="<tr>",e=0;e<r;e++)u+='<td style="width: '+s.toFixed(4)+'%;">',0===f&&0===e&&(u+=n.FE.MARKERS),u+="<br><\/td>";u+="<\/tr>"}u+="<\/tbody><\/table>";t.html.insert(u);t.selection.restore();o=t.$el.find(".fr-inserted-table");o.removeClass("fr-inserted-table");t.events.trigger("table.inserted",[o.get(0)])}function it(){if(u().length>0){var n=c();t.selection.setBefore(n.get(0))||t.selection.setAfter(n.get(0));t.selection.restore();t.popups.hide("table.edit");n.remove();t.toolbar.enable()}}function ai(){var t=c(),r,i,u;if(t.length>0&&0===t.find("th").length){for(i="<thead><tr>",u=0,t.find("tr:first > td").each(function(){var t=n(this);u+=parseInt(t.attr("colspan"),10)||1}),r=0;r<u;r++)i+="<th><br><\/th>";i+="<\/tr><\/thead>";t.prepend(i);s()}}function vi(){var n=c(),r=n.find("thead"),i;r.length>0&&(0===n.find("tbody tr").length?it():(r.remove(),u().length>0)?s():(t.popups.hide("table.edit"),i=n.find("tbody tr:first td:first").get(0),i&&(t.selection.setAtEnd(i),t.selection.restore())))}function st(i){var h=c(),r,u,l,e,a,o,v;if(h.length>0){if(t.$el.find("th.fr-selected-cell").length>0&&"above"==i)return;for(e=f(),a=d(e),u="above"==i?a.min_i:a.max_i,o="<tr>",r=0;r<e[u].length;r++)"below"==i&&u<e.length-1&&e[u][r]==e[u+1][r]||"above"==i&&u>0&&e[u][r]==e[u-1][r]?(0===r||r>0&&e[u][r]!=e[u][r-1])&&(v=n(e[u][r]),v.attr("rowspan",parseInt(v.attr("rowspan"),10)+1)):o+="<td><br><\/td>";o+="<\/tr>";l=n(t.$el.find("th.fr-selected-cell").length>0&&"below"==i?h.find("tbody").not(h.find("table tbody")):h.find("tr").not(h.find("table tr")).get(u));"below"==i?"TBODY"==l.prop("tagName")?l.prepend(o):l.after(o):"above"==i&&(l.before(o),t.popups.isVisible("table.edit")&&s())}}function yi(){var e=c(),r,u,l,i,o,h,a,v,s,y;if(e.length>0)if(i=f(),o=d(i),0===o.min_i&&o.max_i==i.length-1)it();else{for(r=o.max_i;r>=o.min_i;r--){for(l=n(e.find("tr").not(e.find("table tr")).get(r)),u=0;u<i[r].length;u++)if((0===u||i[r][u]!=i[r][u-1])&&(h=n(i[r][u]),parseInt(h.attr("rowspan"),10)>1&&(a=parseInt(h.attr("rowspan"),10)-1,1==a?h.removeAttr("rowspan"):h.attr("rowspan",a)),r<i.length-1&&i[r][u]==i[r+1][u]&&(0===r||i[r][u]!=i[r-1][u]))){for(v=i[r][u],s=u;s>0&&i[r][s]==i[r][s-1];)s--;0===s?n(e.find("tr").not(e.find("table tr")).get(r+1)).prepend(v):n(i[r+1][s-1]).after(v)}y=l.parent();l.remove();0===y.find("tr").length&&y.remove();i=f(e)}at(0,i.length-1,0,i[0].length-1,e);o.min_i>0?t.selection.setAtEnd(i[o.min_i-1][0]):t.selection.setAtEnd(i[0][0]);t.selection.restore();t.popups.hide("table.edit")}}function pi(i){var o=c(),u,r,l,e,a,h;o.length>0&&(r=f(),l=d(r),u="before"==i?l.min_j:l.max_j,a=100/r[0].length,h=100/(r[0].length+1),o.find("th, td").each(function(){e=n(this);e.data("old-width",e.outerWidth()/o.outerWidth()*100)}),o.find("tr").not(o.find("table tr")).each(function(t){for(var e,v,c,f,s=n(this),o=0,l=0;o-1<u;){if(!(f=s.find("> th, > td").get(l))){f=null;break}f==r[t][o]?(o+=parseInt(n(f).attr("colspan"),10)||1,l++):(o+=parseInt(n(r[t][o]).attr("colspan"),10)||1,"after"==i&&(f=0===l?-1:s.find("> th, > td").get(l-1)))}e=n(f);"after"==i&&o-1>u||"before"==i&&u>0&&r[t][u]==r[t][u-1]?(0===t||t>0&&r[t][u]!=r[t-1][u])&&(v=parseInt(e.attr("colspan"),10)+1,e.attr("colspan",v),e.css("width",(e.data("old-width")*h/a+h).toFixed(4)+"%"),e.removeData("old-width")):(c=s.find("th").length>0?'<th style="width: '+h.toFixed(4)+'%;"><br><\/th>':'<td style="width: '+h.toFixed(4)+'%;"><br><\/td>',-1==f?s.prepend(c):null==f?s.append(c):"before"==i?e.before(c):"after"==i&&e.after(c))}),o.find("th, td").each(function(){e=n(this);e.data("old-width")&&(e.css("width",(e.data("old-width")*h/a).toFixed(4)+"%"),e.removeData("old-width"))}),t.popups.isVisible("table.edit")&&s())}function wi(){var l=c(),e,o,i,r,u,a,v,y,s;if(l.length>0)if(r=f(),u=d(r),0===u.min_j&&u.max_j==r[0].length-1)it();else{for(a=100/r[0].length,v=100/(r[0].length-u.max_j+u.min_j-1),l.find("th, td").each(function(){i=n(this);i.hasClass("fr-selected-cell")||i.data("old-width",i.outerWidth()/l.outerWidth()*100)}),o=u.max_j;o>=u.min_j;o--)for(e=0;e<r.length;e++)(0===e||r[e][o]!=r[e-1][o])&&((i=n(r[e][o]),(parseInt(i.attr("colspan"),10)||1)>1)?(y=parseInt(i.attr("colspan"),10)-1,1==y?i.removeAttr("colspan"):i.attr("colspan",y),i.css("width",((i.data("old-width")-h(o,r))*v/a).toFixed(4)+"%"),i.removeData("old-width")):(s=n(i.parent().get(0)),i.remove(),0===s.find("> th, > td").length&&(0===s.prev().length||0===s.next().length||s.prev().find("> th[rowspan], > td[rowspan]").length<s.prev().find("> th, > td").length)&&s.remove()));at(0,r.length-1,0,r[0].length-1,l);u.min_j>0?t.selection.setAtEnd(r[u.min_i][u.min_j-1]):t.selection.setAtEnd(r[u.min_i][0]);t.selection.restore();t.popups.hide("table.edit");l.find("th, td").each(function(){i=n(this);i.data("old-width")&&(i.css("width",(i.data("old-width")*v/a).toFixed(4)+"%"),i.removeData("old-width"))})}}function ht(n,t,i){var o,u,s,h,c,e=0,r=f(i);for(t=Math.min(t,r[0].length-1),u=n;u<=t;u++)if(!(u>n&&r[0][u]==r[0][u-1])&&(h=parseInt(r[0][u].getAttribute("colspan"),10)||1)>1&&r[0][u]==r[0][u+1])for(e=h-1,o=1;o<r.length;o++)if(r[o][u]!=r[o-1][u]){for(s=u;s<u+h;s++)if((c=parseInt(r[o][s].getAttribute("colspan"),10)||1)>1&&r[o][s]==r[o][s+1])e=Math.min(e,c-1),s+=e;else if(!(e=Math.max(0,e-1)))break;if(!e)break}e&&lt(r,e,"colspan",0,r.length-1,n,t)}function ct(n,t,i){var u,o,s,h,c,e=0,r=f(i);for(t=Math.min(t,r.length-1),u=n;u<=t;u++)if(!(u>n&&r[u][0]==r[u-1][0])&&(h=parseInt(r[u][0].getAttribute("rowspan"),10)||1)>1&&r[u][0]==r[u+1][0])for(e=h-1,o=1;o<r[0].length;o++)if(r[u][o]!=r[u][o-1]){for(s=u;s<u+h;s++)if((c=parseInt(r[s][o].getAttribute("rowspan"),10)||1)>1&&r[s][o]==r[s+1][o])e=Math.min(e,c-1),s+=e;else if(!(e=Math.max(0,e-1)))break;if(!e)break}e&&lt(r,e,"rowspan",n,t,0,r[0].length-1)}function lt(n,t,i,r,u,f,e){for(var s,h,o=r;o<=u;o++)for(s=f;s<=e;s++)o>r&&n[o][s]==n[o-1][s]||s>f&&n[o][s]==n[o][s-1]||(h=parseInt(n[o][s].getAttribute(i),10)||1)>1&&(h-t>1?n[o][s].setAttribute(i,h-t):n[o][s].removeAttribute(i))}function at(n,t,i,r,u){ct(n,t,u);ht(i,r,u)}function bi(){var l;if(u().length>1&&(0===t.$el.find("th.fr-selected-cell").length||0===t.$el.find("td.fr-selected-cell").length)){vt();for(var o,p=f(),r=d(p),c=t.$el.find(".fr-selected-cell"),e=n(c[0]),w=e.parent(),a=w.find(".fr-selected-cell"),h=e.closest("table"),v=e.html(),y=0,i=0;i<a.length;i++)y+=n(a[i]).outerWidth();for(e.css("width",(y/h.outerWidth()*100).toFixed(4)+"%"),r.min_j<r.max_j&&e.attr("colspan",r.max_j-r.min_j+1),r.min_i<r.max_i&&e.attr("rowspan",r.max_i-r.min_i+1),i=1;i<c.length;i++)o=n(c[i]),"<br>"!=o.html()&&""!==o.html()&&(v+="<br>"+o.html()),o.remove();for(e.html(v),t.selection.setAtEnd(e.get(0)),t.selection.restore(),t.toolbar.enable(),ct(r.min_i,r.max_i,h),l=h.find("tr:empty"),i=l.length-1;i>=0;i--)n(l[i]).remove();ht(r.min_j,r.max_j,h);s()}}function ki(){var a,h,r,l,b,p;if(1==u().length){var s=t.$el.find(".fr-selected-cell"),k=s.parent(),w=s.closest("table"),y=parseInt(s.attr("rowspan"),10),i=f(),c=o(s.get(0),i),v=s.clone().html("<br>");if(y>1){for(a=Math.ceil(y/2),a>1?s.attr("rowspan",a):s.removeAttr("rowspan"),y-a>1?v.attr("rowspan",y-a):v.removeAttr("rowspan"),h=c.row+a,r=0===c.col?c.col:c.col-1;r>=0&&(i[h][r]==i[h][r-1]||h>0&&i[h][r]==i[h-1][r]);)r--;-1==r?n(w.find("tr").not(w.find("table tr")).get(h)).prepend(v):n(i[h][r]).after(v)}else{for(b=n("<tr>").append(v),l=0;l<i[0].length;l++)(0===l||i[c.row][l]!=i[c.row][l-1])&&(p=n(i[c.row][l]),p.is(s)||p.attr("rowspan",(parseInt(p.attr("rowspan"),10)||1)+1));k.after(b)}e();t.popups.hide("table.edit")}}function di(){var h,w,c,y,b;if(1==u().length){var i=t.$el.find(".fr-selected-cell"),a=parseInt(i.attr("colspan"),10)||1,p=i.parent().outerWidth(),l=i.outerWidth(),v=i.clone().html("<br>"),r=f(),s=o(i.get(0),r);if(a>1)h=Math.ceil(a/2),l=ni(s.col,s.col+h-1,r)/p*100,w=ni(s.col+h,s.col+a-1,r)/p*100,h>1?i.attr("colspan",h):i.removeAttr("colspan"),a-h>1?v.attr("colspan",a-h):v.removeAttr("colspan"),i.css("width",l.toFixed(4)+"%"),v.css("width",w.toFixed(4)+"%");else{for(c=0;c<r.length;c++)(0===c||r[c][s.col]!=r[c-1][s.col])&&(y=n(r[c][s.col]),y.is(i)||(b=(parseInt(y.attr("colspan"),10)||1)+1,y.attr("colspan",b)));l=l/p*50;i.css("width",l.toFixed(4)+"%");v.css("width",l.toFixed(4)+"%")}i.after(v);e();t.popups.hide("table.edit")}}function gi(n){"REMOVE"!=n?t.$el.find(".fr-selected-cell").css("background-color",t.helpers.HEXtoRGB(n)):t.$el.find(".fr-selected-cell").css("background-color","")}function nr(n){t.$el.find(".fr-selected-cell").css("vertical-align",n)}function tr(n){t.$el.find(".fr-selected-cell").css("text-align",n)}function ir(n,t,i,r){if(t.length>0){if(!i){var u=Object.keys(r);u.splice(u.indexOf(n),1);t.removeClass(u.join(" "))}t.toggleClass(n)}}function f(t){t=t||null;var i=[];if(null==t&&u().length>0&&(t=c()),t)return t.find("tr").not(t.find("table tr")).each(function(t,r){var f=n(r),u=0;f.find("> th, > td").each(function(r,f){for(var o,s=n(f),h=parseInt(s.attr("colspan"),10)||1,c=parseInt(s.attr("rowspan"),10)||1,e=t;e<t+c;e++)for(o=u;o<u+h;o++)i[e]||(i[e]=[]),i[e][o]?u++:i[e][o]=f;u+=h})}),i}function o(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]==n)return{row:i,col:r}}function b(n,t,i){for(var r=n+1,u=t+1;r<i.length;){if(i[r][t]!=i[n][t]){r--;break}r++}for(r==i.length&&r--;u<i[n].length;){if(i[n][u]!=i[n][t]){u--;break}u++}return u==i[n].length&&u--,{row:r,col:u}}function vt(){t.el.querySelector(".fr-cell-fixed")&&t.el.querySelector(".fr-cell-fixed").classList.remove("fr-cell-fixed");t.el.querySelector(".fr-cell-handler")&&t.el.querySelector(".fr-cell-handler").classList.remove("fr-cell-handler")}function e(){var i=t.$el.find(".fr-selected-cell");i.length>0&&i.each(function(){var t=n(this);t.removeClass("fr-selected-cell");""===t.attr("class")&&t.removeAttr("class")});vt()}function k(){setTimeout(function(){t.selection.clear();t.$el.addClass("fr-no-selection");t.$el.blur()},0)}function d(n){var u=t.$el.find(".fr-selected-cell"),i,c;if(u.length>0){for(var f=n.length,e=0,s=n[0].length,h=0,r=0;r<u.length;r++)i=o(u[r],n),c=b(i.row,i.col,n),f=Math.min(i.row,f),e=Math.max(c.row,e),s=Math.min(i.col,s),h=Math.max(c.col,h);return{min_i:f,max_i:e,min_j:s,max_j:h}}return null}function yt(t,i,r,u,f){for(var y,e,a,s=t,h=i,c=r,l=u,v=s;v<=h;v++)((parseInt(n(f[v][c]).attr("rowspan"),10)||1)>1||(parseInt(n(f[v][c]).attr("colspan"),10)||1)>1)&&(e=o(f[v][c],f),a=b(e.row,e.col,f),s=Math.min(e.row,s),h=Math.max(a.row,h),c=Math.min(e.col,c),l=Math.max(a.col,l)),((parseInt(n(f[v][l]).attr("rowspan"),10)||1)>1||(parseInt(n(f[v][l]).attr("colspan"),10)||1)>1)&&(e=o(f[v][l],f),a=b(e.row,e.col,f),s=Math.min(e.row,s),h=Math.max(a.row,h),c=Math.min(e.col,c),l=Math.max(a.col,l));for(y=c;y<=l;y++)((parseInt(n(f[s][y]).attr("rowspan"),10)||1)>1||(parseInt(n(f[s][y]).attr("colspan"),10)||1)>1)&&(e=o(f[s][y],f),a=b(e.row,e.col,f),s=Math.min(e.row,s),h=Math.max(a.row,h),c=Math.min(e.col,c),l=Math.max(a.col,l)),((parseInt(n(f[h][y]).attr("rowspan"),10)||1)>1||(parseInt(n(f[h][y]).attr("colspan"),10)||1)>1)&&(e=o(f[h][y],f),a=b(e.row,e.col,f),s=Math.min(e.row,s),h=Math.max(a.row,h),c=Math.min(e.col,c),l=Math.max(a.col,l));return s==t&&h==i&&c==r&&l==u?{min_i:t,max_i:i,min_j:r,max_j:u}:yt(s,h,c,l,f)}function pt(t){var i=d(t),r=n(t[i.min_i][i.min_j]),u=n(t[i.min_i][i.max_j]),f=n(t[i.max_i][i.min_j]);return{left:r.offset().left,right:u.offset().left+u.outerWidth(),top:r.offset().top,bottom:f.offset().top+f.outerHeight()}}function l(i,r){var l,a;if(n(i).is(r))e(),t.edit.on(),n(i).addClass("fr-selected-cell");else{k();t.edit.off();var u=f(),s=o(i,u),h=o(r,u),c=yt(Math.min(s.row,h.row),Math.max(s.row,h.row),Math.min(s.col,h.col),Math.max(s.col,h.col),u);for(e(),i.classList.add("fr-cell-fixed"),r.classList.add("fr-cell-handler"),l=c.min_i;l<=c.max_i;l++)for(a=c.min_j;a<=c.max_j;a++)n(u[l][a]).addClass("fr-selected-cell")}}function wt(i){var r=null,u=n(i.target);return"TD"==i.target.tagName||"TH"==i.target.tagName?r=i.target:u.closest("td").length>0?r=u.closest("td").get(0):u.closest("th").length>0&&(r=u.closest("th").get(0)),0===t.$el.find(r).length?null:r}function g(){e();t.popups.hide("table.edit")}function rr(i){var r=wt(i),f;(u().length>0&&!r&&g(),!t.edit.isDisabled()||t.popups.isVisible("table.edit"))&&(1!=i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey?(3==i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey)&&r&&g():(v=!0,r)&&(u().length>0&&!i.shiftKey&&g(),i.stopPropagation(),t.events.trigger("image.hideResizer"),t.events.trigger("video.hideResizer"),a=!0,f=r.tagName.toLowerCase(),i.shiftKey&&t.$el.find(f+".fr-selected-cell").length>0?n(t.$el.find(f+".fr-selected-cell").closest("table")).is(n(r).closest("table"))?l(w,r):k():((t.keys.ctrlKey(i)||i.shiftKey)&&(u().length>1||0===n(r).find(t.selection.element()).length&&!n(r).is(t.selection.element()))&&k(),w=r,l(w,w))))}function bt(r){if((a||t.$tb.is(r.target)||t.$tb.is(n(r.target).closest(t.$tb.get(0)))||(u().length>0&&t.toolbar.enable(),e()),!(1!=r.which||1==r.which&&t.helpers.isMac()&&r.ctrlKey))&&((v=!1,a)&&(a=!1,wt(r)||1!=u().length?u().length>0&&(t.selection.isCollapsed()?s():e()):e()),y)){y=!1;i.removeClass("fr-moving");t.$el.removeClass("fr-no-selection");t.edit.on();var f=parseFloat(i.css("left"))+t.opts.tableResizerOffset;t.opts.iframe&&(f-=t.$iframe.offset().left);i.data("release-position",f);i.removeData("max-left");i.removeData("max-right");yr(r);ut()}}function ur(i){if(!0===a){if(n(i.currentTarget).closest("table").is(c())&&("TD"==i.currentTarget.tagName&&0===t.$el.find("th.fr-selected-cell").length||"TH"==i.currentTarget.tagName&&0===t.$el.find("td.fr-selected-cell").length))return void l(w,i.currentTarget);k()}}function fr(i,r){for(var e,u=i;u&&"TABLE"!=u.tagName&&u.parentNode!=t.el;)u=u.parentNode;u&&"TABLE"==u.tagName&&(e=f(n(u)),"up"==r?dt(o(i,e),u,e):"down"==r&&gt(o(i,e),u,e))}function kt(n,i,r,u){for(var e,f=i;f!=t.el&&"TD"!=f.tagName&&"TH"!=f.tagName&&("up"==u?e=f.previousElementSibling:"down"==u&&(e=f.nextElementSibling),!e);)f=f.parentNode;"TD"==f.tagName||"TH"==f.tagName?fr(f,u):e&&("up"==u&&t.selection.setAtEnd(e),"down"==u&&t.selection.setAtStart(e))}function dt(n,i,r){n.row>0?t.selection.setAtEnd(r[n.row-1][n.col]):kt(n,i,r,"up")}function gt(n,i,r){var u=parseInt(r[n.row][n.col].getAttribute("rowspan"),10)||1;n.row<r.length-u?t.selection.setAtStart(r[n.row+u][n.col]):kt(n,i,r,"down")}function er(i){var e=i.which,s=t.selection.blocks(),r,h,c,l;if(s.length&&(s=s[0],"TD"==s.tagName||"TH"==s.tagName)){for(r=s;r&&"TABLE"!=r.tagName&&r.parentNode!=t.el;)r=r.parentNode;if(r&&"TABLE"==r.tagName&&(n.FE.KEYCODE.ARROW_LEFT==e||n.FE.KEYCODE.ARROW_UP==e||n.FE.KEYCODE.ARROW_RIGHT==e||n.FE.KEYCODE.ARROW_DOWN==e)&&(u().length>0&&g(),t.browser.webkit&&(n.FE.KEYCODE.ARROW_UP==e||n.FE.KEYCODE.ARROW_DOWN==e)))return(h=t.selection.ranges(0).startContainer,h.nodeType==Node.TEXT_NODE&&(n.FE.KEYCODE.ARROW_UP==e&&h.previousSibling||n.FE.KEYCODE.ARROW_DOWN==e&&h.nextSibling))?void 0:(i.preventDefault(),i.stopPropagation(),c=f(n(r)),l=o(s,c),n.FE.KEYCODE.ARROW_UP==e?dt(l,r,c):n.FE.KEYCODE.ARROW_DOWN==e&&gt(l,r,c),t.selection.restore(),!1)}}function or(){t.shared.$table_resizer||(t.shared.$table_resizer=n('<div class="fr-table-resizer"><div><\/div><\/div>'));i=t.shared.$table_resizer;t.events.$on(i,"mousedown",function(n){return!t.core.sameInstance(i)||(u().length>0&&g(),1==n.which?(t.selection.save(),y=!0,i.addClass("fr-moving"),k(),t.edit.off(),i.find("div").css("opacity",1),!1):void 0)});t.events.$on(i,"mousemove",function(n){if(!t.core.sameInstance(i))return!0;y&&(t.opts.iframe&&(n.pageX-=t.$iframe.offset().left),ti(n))});t.events.on("shared.destroy",function(){i.html("").removeData().remove();i=null},!0);t.events.on("destroy",function(){t.$el.find(".fr-selected-cell").removeClass("fr-selected-cell");i.hide().appendTo(n("body:first"))},!0)}function ut(){i&&(i.find("div").css("opacity",0),i.css("top",0),i.css("left",0),i.css("height",0),i.find("div").css("height",0),i.hide())}function nt(){r&&r.removeClass("fr-visible").css("left","-9999px")}function sr(r,u){var a=n(u),c=a.closest("table"),g=c.parent(),v,y,tt,it;if(u&&"TD"!=u.tagName&&"TH"!=u.tagName&&(a.closest("td").length>0?u=a.closest("td"):a.closest("th").length>0&&(u=a.closest("th"))),u&&("TD"==u.tagName||"TH"==u.tagName)){if(a=n(u),0===t.$el.find(a).length)return!1;if(v=a.offset().left-1,y=v+a.outerWidth(),Math.abs(r.pageX-v)<=t.opts.tableResizerOffset||Math.abs(y-r.pageX)<=t.opts.tableResizerOffset){var k,d,nt,p,w,e=f(c),l=o(u,e),s=b(l.row,l.col,e),ft=c.offset().top,rt=c.outerHeight()-1;"rtl"!=t.opts.direction?r.pageX-v<=t.opts.tableResizerOffset?(nt=v,l.col>0?(p=v-h(l.col-1,e)+t.opts.tableResizingLimit,w=v+h(l.col,e)-t.opts.tableResizingLimit,k=l.col-1,d=l.col):(k=null,d=0,p=c.offset().left-1-parseInt(c.css("margin-left"),10),w=c.offset().left-1+c.width()-e[0].length*t.opts.tableResizingLimit)):y-r.pageX<=t.opts.tableResizerOffset&&(nt=y,s.col<e[s.row].length&&e[s.row][s.col+1]?(p=y-h(s.col,e)+t.opts.tableResizingLimit,w=y+h(s.col+1,e)-t.opts.tableResizingLimit,k=s.col,d=s.col+1):(k=s.col,d=null,p=c.offset().left-1+e[0].length*t.opts.tableResizingLimit,w=g.offset().left-1+g.width()+parseFloat(g.css("padding-left")))):y-r.pageX<=t.opts.tableResizerOffset?(nt=y,l.col>0?(p=y-h(l.col,e)+t.opts.tableResizingLimit,w=y+h(l.col-1,e)-t.opts.tableResizingLimit,k=l.col,d=l.col-1):(k=null,d=0,p=c.offset().left+e[0].length*t.opts.tableResizingLimit,w=g.offset().left-1+g.width()+parseFloat(g.css("padding-left")))):r.pageX-v<=t.opts.tableResizerOffset&&(nt=v,s.col<e[s.row].length&&e[s.row][s.col+1]?(p=v-h(s.col+1,e)+t.opts.tableResizingLimit,w=v+h(s.col,e)-t.opts.tableResizingLimit,k=s.col+1,d=s.col):(k=s.col,d=null,p=g.offset().left+parseFloat(g.css("padding-left")),w=c.offset().left-1+c.width()-e[0].length*t.opts.tableResizingLimit));i||or();i.data("table",c);i.data("first",k);i.data("second",d);i.data("instance",t);t.$wp.append(i);tt=nt-t.win.pageXOffset-t.opts.tableResizerOffset;it=ft-t.win.pageYOffset;t.opts.iframe&&(tt+=t.$iframe.offset().left-t.helpers.scrollLeft(),it+=t.$iframe.offset().top-t.helpers.scrollTop(),p+=t.$iframe.offset().left,w+=t.$iframe.offset().left);i.data("max-left",p);i.data("max-right",w);i.data("origin",nt-t.win.pageXOffset);i.css("top",it);i.css("left",tt);i.css("height",rt);i.find("div").css("height",rt);i.css("padding-left",t.opts.tableResizerOffset);i.css("padding-right",t.opts.tableResizerOffset);i.show()}else t.core.sameInstance(i)&&ut()}else i&&a.get(0)!=i.get(0)&&a.parent().get(0)!=i.get(0)&&t.core.sameInstance(i)&&ut()}function hr(i,u){var f;if(t.$box.find(".fr-line-breaker").is(":visible"))return!1;r||ii();t.$box.append(r);r.data("instance",t);var h=n(u),c=h.find("tr:first"),e=i.pageX,o=0,s=0;t.opts.iframe&&(o+=t.$iframe.offset().left-t.helpers.scrollLeft(),s+=t.$iframe.offset().top-t.helpers.scrollTop());c.find("th, td").each(function(){var i=n(this);return i.offset().left<=e&&e<i.offset().left+i.outerWidth()/2?(f=parseInt(r.find("a").css("width"),10),r.css("top",s+i.offset().top-t.win.pageYOffset-f-5),r.css("left",o+i.offset().left-t.win.pageXOffset-f/2),r.data("selected-cell",i),r.data("position","before"),r.addClass("fr-visible"),!1):i.offset().left+i.outerWidth()/2<=e&&e<i.offset().left+i.outerWidth()?(f=parseInt(r.find("a").css("width"),10),r.css("top",s+i.offset().top-t.win.pageYOffset-f-5),r.css("left",o+i.offset().left+i.outerWidth()-t.win.pageXOffset-f/2),r.data("selected-cell",i),r.data("position","after"),r.addClass("fr-visible"),!1):void 0})}function cr(i,u){var f;if(t.$box.find(".fr-line-breaker").is(":visible"))return!1;r||ii();t.$box.append(r);r.data("instance",t);var h=n(u),e=i.pageY,o=0,s=0;t.opts.iframe&&(o+=t.$iframe.offset().left-t.helpers.scrollLeft(),s+=t.$iframe.offset().top-t.helpers.scrollTop());h.find("tr").each(function(){var i=n(this);return i.offset().top<=e&&e<i.offset().top+i.outerHeight()/2?(f=parseInt(r.find("a").css("width"),10),r.css("top",s+i.offset().top-t.win.pageYOffset-f/2),r.css("left",o+i.offset().left-t.win.pageXOffset-f-5),r.data("selected-cell",i.find("td:first")),r.data("position","above"),r.addClass("fr-visible"),!1):i.offset().top+i.outerHeight()/2<=e&&e<i.offset().top+i.outerHeight()?(f=parseInt(r.find("a").css("width"),10),r.css("top",s+i.offset().top+i.outerHeight()-t.win.pageYOffset-f/2),r.css("left",o+i.offset().left-t.win.pageXOffset-f-5),r.data("selected-cell",i.find("td:first")),r.data("position","below"),r.addClass("fr-visible"),!1):void 0})}function lr(i,f){if(0===u().length){var s,e,o;if(f&&("HTML"==f.tagName||"BODY"==f.tagName||t.node.isElement(f)))for(s=1;s<=t.opts.tableInsertHelperOffset;s++){if(e=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset+s),n(e).hasClass("fr-tooltip"))return!0;if(e&&("TH"==e.tagName||"TD"==e.tagName||"TABLE"==e.tagName)&&(n(e).parents(".fr-wrapper").length||t.opts.iframe))return hr(i,n(e).closest("table")),!0;if(o=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset+s,i.pageY-t.win.pageYOffset),n(o).hasClass("fr-tooltip"))return!0;if(o&&("TH"==o.tagName||"TD"==o.tagName||"TABLE"==o.tagName)&&(n(o).parents(".fr-wrapper").length||t.opts.iframe))return cr(i,n(o).closest("table")),!0}t.core.sameInstance(r)&&nt()}}function ar(n){tt=null;var i=t.doc.elementFromPoint(n.pageX-t.win.pageXOffset,n.pageY-t.win.pageYOffset);t.opts.tableResizer&&(!t.popups.areVisible()||t.popups.areVisible()&&t.popups.isVisible("table.edit"))&&sr(n,i);!t.opts.tableInsertHelper||t.popups.areVisible()||t.$tb.hasClass("fr-inline")&&t.$tb.is(":visible")||lr(n,i)}function vr(){if(y){var r=i.data("table"),n=r.offset().top-t.win.pageYOffset;t.opts.iframe&&(n+=t.$iframe.offset().top-t.helpers.scrollTop());i.css("top",n)}}function yr(){var c=i.data("origin"),l=i.data("release-position"),b;if(c!==l){var p=i.data("first"),e=i.data("second"),u=i.data("table"),o=u.outerWidth();if(t.undo.canDo()||t.undo.saveStep(),null!==p&&null!==e){for(var a,v,s=f(u),y=[],w=[],d=[],g=[],r=0;r<s.length;r++)a=n(s[r][p]),v=n(s[r][e]),y[r]=a.outerWidth(),d[r]=v.outerWidth(),w[r]=y[r]/o*100,g[r]=d[r]/o*100;for(r=0;r<s.length;r++)a=n(s[r][p]),v=n(s[r][e]),b=(w[r]*(y[r]+l-c)/y[r]).toFixed(4),a.css("width",b+"%"),v.css("width",(w[r]+g[r]-b).toFixed(4)+"%")}else{var h,k=u.parent(),nt=o/k.width()*100,tt=(parseInt(u.css("margin-left"),10)||0)/k.width()*100,it=(parseInt(u.css("margin-right"),10)||0)/k.width()*100;"rtl"==t.opts.direction&&0===e||"rtl"!=t.opts.direction&&0!==e?(h=(o+l-c)/o*nt,u.css("margin-right","calc(100% - "+Math.round(h).toFixed(4)+"% - "+Math.round(tt).toFixed(4)+"%)")):("rtl"==t.opts.direction&&0!==e||"rtl"!=t.opts.direction&&0===e)&&(h=(o-l+c)/o*nt,u.css("margin-left","calc(100% - "+Math.round(h).toFixed(4)+"% - "+Math.round(it).toFixed(4)+"%)"));u.css("width",Math.round(h).toFixed(4)+"%")}t.selection.restore();t.undo.saveStep()}i.removeData("origin");i.removeData("release-position");i.removeData("first");i.removeData("second");i.removeData("table")}function h(t,i){for(var u=n(i[0][t]).outerWidth(),r=1;r<i.length;r++)u=Math.min(u,n(i[r][t]).outerWidth());return u}function ni(n,t,i){for(var u=0,r=n;r<=t;r++)u+=h(r,i);return u}function ti(n){var r,f,e;(u().length>1&&v&&k(),!1===v&&!1===a&&!1===y)?(tt&&clearTimeout(tt),t.edit.isDisabled()&&!t.popups.isVisible("table.edit")||(tt=setTimeout(ar,30,n))):y?(r=n.pageX-t.win.pageXOffset,t.opts.iframe&&(r+=t.$iframe.offset().left),f=i.data("max-left"),e=i.data("max-right"),r>=f&&r<=e?i.css("left",r-t.opts.tableResizerOffset):r<f&&parseFloat(i.css("left"),10)>f-t.opts.tableResizerOffset?i.css("left",f-t.opts.tableResizerOffset):r>e&&parseFloat(i.css("left"),10)<e-t.opts.tableResizerOffset&&i.css("left",e-t.opts.tableResizerOffset)):v&&nt()}function p(i){t.node.isEmpty(i.get(0))?i.prepend(n.FE.MARKERS):i.prepend(n.FE.START_MARKER).append(n.FE.END_MARKER)}function pr(i){var r,f;if(i.which==n.FE.KEYCODE.TAB&&(u().length>0?r=t.$el.find(".fr-selected-cell:last"):(f=t.selection.element(),"TD"==f.tagName||"TH"==f.tagName?r=n(f):f!=t.el&&(n(f).parentsUntil(t.$el,"td").length>0?r=n(f).parents("td:first"):n(f).parentsUntil(t.$el,"th").length>0&&(r=n(f).parents("th:first")))),r))return i.preventDefault(),n(t.selection.element()).parents("ol, ul").length>0||(g(),i.shiftKey?r.prev().length>0?p(r.prev()):r.closest("tr").length>0&&r.closest("tr").prev().length>0?p(r.closest("tr").prev().find("td:last")):r.closest("tbody").length>0&&r.closest("table").find("thead tr").length>0&&p(r.closest("table").find("thead tr th:last")):r.next().length>0?p(r.next()):r.closest("tr").length>0&&r.closest("tr").next().length>0?p(r.closest("tr").next().find("td:first")):r.closest("thead").length>0&&r.closest("table").find("tbody tr").length>0?p(r.closest("table").find("tbody tr td:first")):(r.addClass("fr-selected-cell"),st("below"),e(),p(r.closest("tr").next().find("td:first"))),t.selection.restore(),!1)}function ii(){t.shared.$ti_helper||(t.shared.$ti_helper=n('<div class="fr-insert-helper"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Insert")+'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/><\/svg><\/a><\/div>'),t.events.bindClick(t.shared.$ti_helper,"a",function(){var n=r.data("selected-cell"),i=r.data("position"),u=r.data("instance")||t;"before"==i?(n.addClass("fr-selected-cell"),u.table.insertColumn(i),n.removeClass("fr-selected-cell")):"after"==i?(n.addClass("fr-selected-cell"),u.table.insertColumn(i),n.removeClass("fr-selected-cell")):"above"==i?(n.addClass("fr-selected-cell"),u.table.insertRow(i),n.removeClass("fr-selected-cell")):"below"==i&&(n.addClass("fr-selected-cell"),u.table.insertRow(i),n.removeClass("fr-selected-cell"));nt()}),t.events.on("shared.destroy",function(){t.shared.$ti_helper.html("").removeData().remove();t.shared.$ti_helper=null},!0),t.events.$on(t.shared.$ti_helper,"mousemove",function(n){n.stopPropagation()},!0),t.events.$on(n(t.o_win),"scroll",function(){nt()},!0),t.events.$on(t.$wp,"scroll",function(){nt()},!0));r=t.shared.$ti_helper;t.events.on("destroy",function(){r=null});t.tooltip.bind(t.$box,".fr-insert-helper > a.fr-floating-btn")}function wr(){w=null;clearTimeout(tt)}function br(){u().length>0?s():(t.popups.hide("table.insert"),t.toolbar.showInline())}function u(){return t.el.querySelectorAll(".fr-selected-cell")}function c(){var r=u(),i;if(r.length){for(i=r[0];i&&"TABLE"!=i.tagName&&i.parentNode!=t.el;)i=i.parentNode;return n(i&&"TABLE"==i.tagName?i:[])}return n([])}function kr(i){if(i.altKey&&i.which==n.FE.KEYCODE.SPACE){var u,r=t.selection.element();if("TD"==r.tagName||"TH"==r.tagName?u=r:n(r).closest("td").length>0?u=n(r).closest("td").get(0):n(r).closest("th").length>0&&(u=n(r).closest("th").get(0)),u)return i.preventDefault(),l(u,u),s(),!1}}function dr(i){var c=u(),s,a,e,h,r;if(c.length>0)if(e=f(),h=i.which,1==c.length?(s=c[0],a=s):(s=t.el.querySelector(".fr-cell-fixed"),a=t.el.querySelector(".fr-cell-handler")),r=o(a,e),n.FE.KEYCODE.ARROW_RIGHT==h){if(r.col<e[0].length-1)return l(s,e[r.row][r.col+1]),!1}else if(n.FE.KEYCODE.ARROW_DOWN==h){if(r.row<e.length-1)return l(s,e[r.row+1][r.col]),!1}else if(n.FE.KEYCODE.ARROW_LEFT==h){if(r.col>0)return l(s,e[r.row][r.col-1]),!1}else if(n.FE.KEYCODE.ARROW_UP==h&&r.row>0)return l(s,e[r.row-1][r.col]),!1}function gr(){if(!t.$wp)return!1;if(!t.helpers.isMobile()){v=!1;a=!1;y=!1;t.events.$on(t.$el,"mousedown",rr);t.popups.onShow("image.edit",function(){e();v=!1;a=!1});t.popups.onShow("link.edit",function(){e();v=!1;a=!1});t.events.on("commands.mousedown",function(n){n.parents(".fr-toolbar").length>0&&e()});t.events.$on(t.$el,"mouseenter","th, td",ur);t.events.$on(t.$win,"mouseup",bt);t.opts.iframe&&t.events.$on(n(t.o_win),"mouseup",bt);t.events.$on(t.$win,"mousemove",ti);t.events.$on(n(t.o_win),"scroll",vr);t.events.on("contentChanged",function(){u().length>0&&(s(),t.$el.find("img").on("load.selected-cells",function(){n(this).off("load.selected-cells");u().length>0&&s()}))});t.events.$on(n(t.o_win),"resize",function(){e()});t.events.on("toolbar.esc",function(){if(u().length>0)return t.events.disableBlur(),t.events.focus(),!1},!0);t.events.$on(t.$el,"keydown",function(n){n.shiftKey?!1===dr(n)&&setTimeout(function(){s()},0):er(n)});t.events.on("keydown",function(i){var r,f;if(!1===pr(i))return!1;if(r=u(),r.length>0){if(r.length>0&&t.keys.ctrlKey(i)&&i.which==n.FE.KEYCODE.A)return e(),t.popups.isVisible("table.edit")&&t.popups.hide("table.edit"),r=[],!0;if(i.which==n.FE.KEYCODE.ESC&&t.popups.isVisible("table.edit"))return e(),t.popups.hide("table.edit"),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),r=[],!1;if(r.length>1&&i.which==n.FE.KEYCODE.BACKSPACE){for(t.undo.saveStep(),f=0;f<r.length;f++)n(r[f]).html("<br>"),f==r.length-1&&n(r[f]).prepend(n.FE.MARKERS);return t.selection.restore(),t.undo.saveStep(),r=[],!1}if(r.length>1&&i.which!=n.FE.KEYCODE.F10&&!t.keys.isBrowserAction(i))return i.preventDefault(),r=[],!1}else if(r=[],!1===kr(i))return!1},!0);var i=[];t.events.on("html.beforeGet",function(){i=u();for(var n=0;n<i.length;n++)i[n].className=(i[n].className||"").replace(/fr-selected-cell/g,"")});t.events.on("html.afterGet",function(){for(var n=0;n<i.length;n++)i[n].className=(i[n].className?i[n].className.trim()+" ":"")+"fr-selected-cell";i=[]});et(!0);ot(!0)}t.events.on("destroy",wr)}var i,r,a,v,w,tt,y;return{_init:gr,insert:li,remove:it,insertRow:st,deleteRow:yi,insertColumn:pi,deleteColumn:wi,mergeCells:bi,splitCellVertically:di,splitCellHorizontally:ki,addHeader:ai,removeHeader:vi,setBackground:gi,showInsertPopup:ri,showEditPopup:s,showColorsPopup:ft,back:br,verticalAlign:nr,horizontalAlign:tr,applyStyle:ir,selectedTable:c,selectedCells:u}};n.FE.DefineIcon("insertTable",{NAME:"table"});n.FE.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()},plugin:"table"});n.FE.RegisterCommand("tableInsert",{callback:function(n,t,i){this.table.insert(t,i);this.popups.hide("table.insert")}});n.FE.DefineIcon("tableHeader",{NAME:"header"});n.FE.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,toggle:!0,callback:function(){this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]').hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(n){var t=this.table.selectedTable();t.length>0&&(0===t.find("th").length?n.removeClass("fr-active").attr("aria-pressed",!1):n.addClass("fr-active").attr("aria-pressed",!0))}});n.FE.DefineIcon("tableRows",{NAME:"bars"});n.FE.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',t=n.FE.COMMANDS.tableRows.options;for(var i in t)t.hasOwnProperty(i)&&(r+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableRows" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"<\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}});n.FE.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"});n.FE.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',t=n.FE.COMMANDS.tableColumns.options;for(var i in t)t.hasOwnProperty(i)&&(r+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableColumns" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"<\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}});n.FE.DefineIcon("tableCells",{NAME:"square-o"});n.FE.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',t=n.FE.COMMANDS.tableCells.options;for(var i in t)t.hasOwnProperty(i)&&(r+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCells" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"<\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(n,t){this.$el.find(".fr-selected-cell").length>1?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="merge"]').removeClass("fr-disabled").attr("aria-disabled",!1)):(t.find('a[data-param1="merge"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled").attr("aria-disabled",!1),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled").attr("aria-disabled",!1))}});n.FE.DefineIcon("tableRemove",{NAME:"trash"});n.FE.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}});n.FE.DefineIcon("tableStyle",{NAME:"paint-brush"});n.FE.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var i='<ul class="fr-dropdown-list" role="presentation">',n=this.opts.tableStyles;for(var t in n)n.hasOwnProperty(t)&&(i+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableStyle" data-param1="'+t+'" title="'+this.language.translate(n[t])+'">'+this.language.translate(n[t])+"<\/a><\/li>");return i+"<\/ul>"},callback:function(n,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(t,i){var r=this.$el.find(".fr-selected-cell").closest("table");r&&i.find(".fr-command").each(function(){var i=n(this).data("param1"),t=r.hasClass(i);n(this).toggleClass("fr-active",t).attr("aria-selected",t)})}});n.FE.DefineIcon("tableCellBackground",{NAME:"tint"});n.FE.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,popup:!0,callback:function(){this.table.showColorsPopup()}});n.FE.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(n,t){this.table.setBackground(t)}});n.FE.DefineIcon("tableBack",{NAME:"arrow-left"});n.FE.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(n){0!==this.table.selectedCells().length||this.opts.toolbarInline?(n.removeClass("fr-hidden"),n.next(".fr-separator").removeClass("fr-hidden")):(n.addClass("fr-hidden"),n.next(".fr-separator").addClass("fr-hidden"))}});n.FE.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v"});n.FE.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',i=n.FE.COMMANDS.tableCellVerticalAlign.options;for(var t in i)i.hasOwnProperty(t)&&(r+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellVerticalAlign" data-param1="'+t.toLowerCase()+'" title="'+this.language.translate(i[t])+'">'+this.language.translate(t)+"<\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){this.table.verticalAlign(t)},refreshOnShow:function(n,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active").attr("aria-selected",!0)}});n.FE.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"});n.FE.DefineIcon("align-left",{NAME:"align-left"});n.FE.DefineIcon("align-right",{NAME:"align-right"});n.FE.DefineIcon("align-center",{NAME:"align-center"});n.FE.DefineIcon("align-justify",{NAME:"align-justify"});n.FE.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',i=n.FE.COMMANDS.tableCellHorizontalAlign.options;for(var t in i)i.hasOwnProperty(t)&&(r+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="tableCellHorizontalAlign" data-param1="'+t+'" title="'+this.language.translate(i[t])+'">'+this.icon.create("align-"+t)+'<span class="fr-sr-only">'+this.language.translate(i[t])+"<\/span><\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){this.table.horizontalAlign(t)},refresh:function(t){var i=this.table.selectedCells();i.length&&t.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(n(i[0]))))},refreshOnShow:function(n,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active").attr("aria-selected",!0)}});n.FE.DefineIcon("tableCellStyle",{NAME:"magic"});n.FE.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var i='<ul class="fr-dropdown-list" role="presentation">',n=this.opts.tableCellStyles;for(var t in n)n.hasOwnProperty(t)&&(i+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellStyle" data-param1="'+t+'" title="'+this.language.translate(n[t])+'">'+this.language.translate(n[t])+"<\/a><\/li>");return i+"<\/ul>"},callback:function(n,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(t,i){var r=this.$el.find(".fr-selected-cell:first");r&&i.find(".fr-command").each(function(){var i=n(this).data("param1"),t=r.hasClass(i);n(this).toggleClass("fr-active",t).attr("aria-selected",t)})}});n.FE.DefineIcon("tableColorRemove",{NAME:"eraser"})});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.FE.URLRegEx="(^| |\\u00A0)("+n.FE.LinkRegEx+"|([a-z0-9+-_.]{1,}@[a-z0-9+-_.]{1,}))$";n.FE.PLUGINS.url=function(t){function o(r,u,f){for(var e,o="";f.length&&"."==f[f.length-1];)o+=".",f=f.substring(0,f.length-1);return e=f,t.opts.linkConvertEmailAddress&&n.FE.MAIL_REGEX.test(e)&&!/^mailto:.*/i.test(e)&&(e="mailto:"+e),/^((http|https|ftp|ftps|mailto|tel|sms|notes|data)\:)/i.test(e)||(e="//"+e),(u||"")+"<a"+(t.opts.linkAlwaysBlank?' target="_blank"':"")+(i?' rel="'+i+'"':"")+' href="'+e+'">'+f.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"<\/a>"+o}function r(){return new RegExp(n.FE.URLRegEx,"gi")}function u(n){return t.opts.linkAlwaysNoFollow&&(i="nofollow"),t.opts.linkAlwaysBlank&&(i?i+=" noopener noreferrer":i="noopener noreferrer"),n.replace(r(),o)}function f(n){return!!n&&("A"===n.tagName||!(!n.parentNode||n.parentNode==t.el)&&f(n.parentNode))}function e(n){var t=n.split(" ");return t[t.length-1]}function s(){var s=t.selection.ranges(0),i=s.startContainer,o;if(!i||i.nodeType!==Node.TEXT_NODE||f(i))return!1;r().test(e(i.textContent))?(n(i).before(u(i.textContent)),i.parentNode.removeChild(i)):i.previousSibling&&"A"===i.previousSibling.tagName&&(o=i.previousSibling.innerText+i.textContent,r().test(e(o))&&(n(i.previousSibling).replaceWith(u(o)),i.parentNode.removeChild(i)))}function h(){t.events.on("paste.afterCleanup",function(i){var r=t.doc.createElement("div"),f,e;for(r.innerHTML=i,f=t.doc.createTreeWalker(r,NodeFilter.SHOW_TEXT,t.node.filter(function(t){return new RegExp(n.FE.URLRegEx,"gi").test(t.textContent)}),!1);f.nextNode();)e=f.currentNode,n(e).after(u(e.textContent)).remove();return r.innerHTML});t.events.on("keydown",function(i){var r=i.which;t.selection.isCollapsed()&&(r==n.FE.KEYCODE.ENTER||r==n.FE.KEYCODE.SPACE||r==n.FE.KEYCODE.PERIOD)&&s()},!0)}var i=null;return{_init:h}}});!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.extend(n.FE.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_][_UPLOAD_LAYER_][_PROGRESS_BAR_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"});n.extend(n.FE.DEFAULTS,{videoAllowedTypes:["mp4","webm","ogg"],videoAllowedProviders:[".*"],videoDefaultAlign:"center",videoDefaultDisplay:"block",videoDefaultWidth:600,videoEditButtons:["videoReplace","videoRemove","|","videoDisplay","videoAlign","videoSize"],videoInsertButtons:["videoBack","|","videoByURL","videoEmbed","videoUpload"],videoMaxSize:52428800,videoMove:!0,videoResize:!0,videoSizeButtons:["videoBack","|"],videoSplitHTML:!1,videoTextNear:!0,videoUploadMethod:"POST",videoUploadParam:"file",videoUploadParams:{},videoUploadToS3:!1,videoUploadURL:"/FileApi/Video"});n.FE.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be)|(youtube.com))\/((v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))?\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}?wmode=opaque" frameborder="0" allowfullscreen><\/iframe>',provider:"youtube"},{test_regex:/^.*(?:vimeo.com)\/(?:channels(\/\w+\/)?|groups\/*\/videos\/\u200b\d+\/|video\/|)(\d+)(?:$|\/|\?)/,url_regex:/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/i,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen><\/iframe>',provider:"vimeo"},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen><\/iframe>',provider:"dailymotion"},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"><\/iframe>',provider:"yahoo"},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"//rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"><\/iframe>',provider:"rutube"},{test_regex:/^(?:.+)vidyard.com\/(?:watch)?\/?([^.&\/]+)\/?(?:[^_.&]+)?/,url_regex:/^(?:.+)vidyard.com\/(?:watch)?\/?([^.&\/]+)\/?(?:[^_.&]+)?/g,url_text:"//play.vidyard.com/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen><\/iframe>',provider:"vidyard"}];n.FE.VIDEO_EMBED_REGEX=/^\W*((<iframe.*><\/iframe>)|(<embed.*>))\W*$/i;n.FE.PLUGINS.video=function(t){function ni(){var i=t.popups.get("video.insert"),n;i.find(".fr-video-by-url-layer input").val("").trigger("change");n=i.find(".fr-video-embed-layer textarea");n.val("").trigger("change");n=i.find(".fr-video-upload-layer input");n.val("").trigger("change")}function ti(){var n=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),i=t.popups.get("video.insert"),r,u;(i||(i=l()),h(),i.hasClass("fr-active"))||(t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$tb),r=n.offset().left+n.outerWidth()/2,u=n.offset().top+(t.opts.toolbarBottom?10:n.outerHeight()-10),t.popups.show("video.insert",r,u,n.outerHeight()))}function p(){var r=t.popups.get("video.edit");if(r||(r=tr()),r){t.popups.setContainer("video.edit",t.$sc);t.popups.refresh("video.edit");var n=i.find("iframe, embed, video"),u=n.offset().left+n.outerWidth()/2,f=n.offset().top+n.outerHeight();t.popups.show("video.edit",u,f,n.outerHeight())}}function l(n){var e,o,s;if(n)return t.popups.onRefresh("video.insert",ni),t.popups.onHide("image.insert",cr),!0;e="";t.opts.videoInsertButtons.length>1&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.videoInsertButtons)+"<\/div>");var i,h="",r=t.opts.videoInsertButtons.indexOf("videoUpload"),u=t.opts.videoInsertButtons.indexOf("videoByURL"),f=t.opts.videoInsertButtons.indexOf("videoEmbed");u>=0&&(i=" fr-active",(u>r&&r>=0||u>f&&f>=0)&&(i=""),h='<div class="fr-video-by-url-layer fr-layer'+i+'" id="fr-video-by-url-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-video-by-url-layer-text-'+t.id+'" type="text" placeholder="'+t.language.translate("Paste in a video URL")+'" tabIndex="1" aria-required="true"><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2" role="button">'+t.language.translate("Insert")+"<\/button><\/div><\/div>");o="";f>=0&&(i=" fr-active",(f>r&&r>=0||f>u&&u>=0)&&(i=""),o='<div class="fr-video-embed-layer fr-layer'+i+'" id="fr-video-embed-layer-'+t.id+'"><div class="fr-input-line"><textarea id="fr-video-embed-layer-text'+t.id+'" type="text" placeholder="'+t.language.translate("Embedded Code")+'" tabIndex="1" aria-required="true" rows="5"><\/textarea><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2" role="button">'+t.language.translate("Insert")+"<\/button><\/div><\/div>");s="";r>=0&&(i=" fr-active",(r>f&&f>=0||r>u&&u>=0)&&(i=""),s='<div class="fr-video-upload-layer fr-layer'+i+'" id="fr-video-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop video")+"<\/strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" accept="video/'+t.opts.videoAllowedTypes.join(", video/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-video-upload-layer-'+t.id+'" role="button"><\/div><\/div>');var l={buttons:e,by_url_layer:h,embed_layer:o,upload_layer:s,progress_bar:'<div class="fr-video-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading<\/h3><div class="fr-loader"><span class="fr-progress"><\/span><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="videoDismissError" tabIndex="2" role="button">OK<\/button><\/div><\/div>'},c=t.popups.create("video.insert",l);return gi(c),c}function ii(n){var e,f,r=t.popups.get("video.insert"),u;i||t.opts.toolbarInline||(u=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),e=u.offset().left+u.outerWidth()/2,f=u.offset().top+(t.opts.toolbarBottom?10:u.outerHeight()-10));t.opts.toolbarInline&&(f=r.offset().top-t.helpers.getPX(r.css("margin-top")),r.hasClass("fr-above")&&(f+=r.outerHeight()));r.find(".fr-layer").removeClass("fr-active");r.find(".fr-"+n+"-layer").addClass("fr-active");t.popups.show("video.insert",e,f,0);t.accessibility.focusPopup(r)}function ri(n){t.popups.get("video.insert").find(".fr-video-by-url-layer").hasClass("fr-active")&&n.addClass("fr-active").attr("aria-pressed",!0)}function ui(n){t.popups.get("video.insert").find(".fr-video-embed-layer").hasClass("fr-active")&&n.addClass("fr-active").attr("aria-pressed",!0)}function fi(n){t.popups.get("video.insert").find(".fr-video-upload-layer").hasClass("fr-active")&&n.addClass("fr-active").attr("aria-pressed",!0)}function g(n){var u,r;t.events.focus(!0);t.selection.restore();u=!1;i&&(ut(),u=!0);t.html.insert('<span contenteditable="false" draggable="true" class="fr-jiv fr-video">'+n+"<\/span>",!1,t.opts.videoSplitHTML);t.popups.hide("video.insert");r=t.$el.find(".fr-jiv");r.removeClass("fr-jiv");d(r,t.opts.videoDefaultDisplay,t.opts.videoDefaultAlign);r.toggleClass("fr-draggable",t.opts.videoMove);t.events.trigger(u?"video.replaced":"video.inserted",[r])}function st(){var i=n(this);t.popups.hide("video.insert");i.removeClass("fr-uploading");i.parent().next().is("br")&&i.parent().next().remove();nt(i.parent());t.events.trigger("video.loaded",[i.parent()])}function ht(n,i,r,u,f){t.edit.off();b("Loading video");i&&(n=t.helpers.sanitizeURL(n));var e=function(){var i,e,s,l,h,o,c;if(u){for(t.undo.canDo()||u.find("video").hasClass("fr-uploading")||t.undo.saveStep(),s=u.find("video").data("fr-old-src"),l=u.data("fr-replaced"),u.data("fr-replaced",!1),t.$wp?(i=u.clone(),i.find("video").removeData("fr-old-src").removeClass("fr-uploading"),i.find("video").off("canplay"),s&&u.find("video").attr("src",s),u.replaceWith(i)):i=u,h=i.find("video").get(0).attributes,o=0;o<h.length;o++)c=h[o],0===c.nodeName.indexOf("data-")&&i.find("video").removeAttr(c.nodeName);if(void 0!==r)for(e in r)r.hasOwnProperty(e)&&"link"!=e&&i.find("video").attr("data-"+e,r[e]);i.find("video").on("canplay",st);i.find("video").attr("src",n);t.edit.on();vt();t.undo.saveStep();t.$el.blur();t.events.trigger(l?"video.replaced":"video.inserted",[i,f])}else i=pi(n,r,st),vt(),t.undo.saveStep(),t.events.trigger("video.inserted",[i,f])};w("Loading video");e()}function w(n){var u=t.popups.get("video.insert"),r,f,e;(u||(u=l()),u.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),u.find(".fr-video-progress-bar-layer").addClass("fr-active"),u.find(".fr-buttons").hide(),i)&&(r=i.find("video"),t.popups.setContainer("video.insert",t.$sc),f=r.offset().left+r.width()/2,e=r.offset().top+r.height(),t.popups.show("video.insert",f,e,r.outerHeight()));void 0===n&&b(t.language.translate("Uploading"),0)}function h(n){var r=t.popups.get("video.insert"),u;r&&(r.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),r.find(".fr-video-progress-bar-layer").removeClass("fr-active"),r.find(".fr-buttons").show(),n||t.$el.find("video.fr-error").length)&&((t.events.focus(),t.$el.find("video.fr-error").length&&(t.$el.find("video.fr-error").parent().remove(),t.undo.saveStep(),t.undo.run(),t.undo.dropRedo()),!t.$wp&&i)&&(u=i,s(!0),t.selection.setAfter(u.find("video").get(0)),t.selection.restore()),t.popups.hide("video.insert"))}function b(n,i){var u=t.popups.get("video.insert"),r;u&&(r=u.find(".fr-video-progress-bar-layer"),r.find("h3").text(n+(i?" "+i+"%":"")),r.removeClass("fr-error"),i?(r.find("div").removeClass("fr-indeterminate"),r.find("div > span").css("width",i+"%")):r.find("div").addClass("fr-indeterminate"))}function ei(n){var u,i,r;w();u=t.popups.get("video.insert");i=u.find(".fr-video-progress-bar-layer");i.addClass("fr-error");r=i.find("h3");r.text(n);t.events.disableBlur();r.focus()}function oi(i){var r,f,u;if(void 0===i&&(i=t.popups.get("video.insert").find('.fr-video-by-url-layer input[type="text"]').val()||""),r=null,/^http/.test(i)||(i="https://"+i),t.helpers.isURL(i))for(f=0;f<n.FE.VIDEO_PROVIDERS.length;f++)if(u=n.FE.VIDEO_PROVIDERS[f],u.test_regex.test(i)&&new RegExp(t.opts.videoAllowedProviders.join("|")).test(u.provider)){r=i.replace(u.url_regex,u.url_text);r=u.html.replace(/\{url\}/,r);break}r?g(r):t.events.trigger("video.linkError",[i])}function si(i){void 0===i&&(i=t.popups.get("video.insert").find(".fr-video-embed-layer textarea").val()||"");0!==i.length&&n.FE.VIDEO_EMBED_REGEX.test(i)?g(i):t.events.trigger("video.codeError",[i])}function nt(n){yt.call(n.get(0))}function hi(n){try{if(!1===t.events.trigger("video.uploaded",[n],!0))return t.edit.on(),!1;var i=JSON.parse(n);return i.link?i:(f(kt,n),!1)}catch(r){return f(c,n),!1}}function ci(i){try{var r=n(i).find("Location").text(),u=n(i).find("Key").text();return!1===t.events.trigger("video.uploadedToS3",[r,u,i],!0)?(t.edit.on(),!1):r}catch(e){return f(c,i),!1}}function li(n){var s,u;b("Loading video");var e=this.status,i=this.response,o=this.responseXML,r=this.responseText;try{t.opts.videoUploadToS3?201==e?(s=ci(o),s&&ht(s,!1,[],n,i||o)):f(c,i||o):e>=200&&e<300?(u=hi(r),u&&ht(u.link,!1,u,n,i||r)):f(dt,i||r)}catch(h){f(c,i||r)}}function ai(){f(c,this.response||this.responseText||this.responseXML)}function vi(n){if(n.lengthComputable){var i=n.loaded/n.total*100|0;b(t.language.translate("Uploading"),i)}}function yi(){t.edit.on();h(!0)}function pi(i,r,u){var s,h="",e,f,o;if(r&&void 0!==r)for(s in r)r.hasOwnProperty(s)&&"link"!=s&&(h+=" data-"+s+'="'+r[s]+'"');return e=t.opts.videoDefaultWidth,e&&"auto"!=e&&(e+="px"),f=n('<span contenteditable="false" draggable="true" class="fr-video fr-dv'+t.opts.videoDefaultDisplay[0]+("center"!=t.opts.videoDefaultAlign?" fr-fv"+t.opts.videoDefaultAlign[0]:"")+'"><video src="'+i+'" '+h+(e?' style="width: '+e+';" ':"")+" controls>"+t.language.translate("Your browser does not support HTML5 video.")+"<\/video><\/span>"),f.toggleClass("fr-draggable",t.opts.videoMove),t.edit.on(),t.events.focus(!0),t.selection.restore(),t.undo.saveStep(),t.opts.videoSplitHTML?t.markers.split():t.markers.insert(),o=t.$el.find(".fr-marker"),t.node.isLastSibling(o)&&o.parent().hasClass("fr-deletable")&&o.insertAfter(o.parent()),o.replaceWith(f),t.html.wrap(),t.selection.clear(),f.find("video").get(0).readyState>f.find("video").get(0).HAVE_FUTURE_DATA||t.helpers.isIOS()?u.call(f.find("video").get(0)):f.find("video").on("canplaythrough load",u),f}function ct(i){var o,s;if(!t.core.sameInstance(r))return!0;if(i.preventDefault(),i.stopPropagation(),o=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null),s=i.pageY||(i.originalEvent.touches?i.originalEvent.touches[0].pageY:null),!o||!s)return!1;if("mousedown"==i.type){var l=t.$oel.get(0),h=l.ownerDocument,f=h.defaultView||h.parentWindow,c=!1;try{c=f.location!=f.parent.location&&!(f.$&&f.$.FE)}catch(a){}c&&f.frameElement&&(o+=t.helpers.getPX(n(f.frameElement).offset().left)+f.frameElement.clientLeft,s=i.clientY+t.helpers.getPX(n(f.frameElement).offset().top)+f.frameElement.clientTop)}t.undo.canDo()||t.undo.saveStep();u=n(this);u.data("start-x",o);u.data("start-y",s);e.show();t.popups.hideAll();it()}function lt(n){var e,o,c,l;if(!t.core.sameInstance(r))return!0;if(u){if(n.preventDefault(),e=n.pageX||(n.originalEvent.touches?n.originalEvent.touches[0].pageX:null),o=n.pageY||(n.originalEvent.touches?n.originalEvent.touches[0].pageY:null),!e||!o)return!1;c=u.data("start-x");l=u.data("start-y");u.data("start-x",e);u.data("start-y",o);var s=e-c,h=o-l,f=i.find("iframe, embed, video"),v=f.width(),y=f.height();(u.hasClass("fr-hnw")||u.hasClass("fr-hsw"))&&(s=0-s);(u.hasClass("fr-hnw")||u.hasClass("fr-hne"))&&(h=0-h);f.css("width",v+s);f.css("height",y+h);f.removeAttr("width");f.removeAttr("height");a()}}function tt(n){if(!t.core.sameInstance(r))return!0;u&&i&&(n&&n.stopPropagation(),u=null,e.hide(),a(),p(),t.undo.saveStep())}function k(n){return'<div class="fr-handler fr-h'+n+'"><\/div>'}function at(n,t,i,r){return n.pageX=t,n.pageY=t,ct.call(this,n),n.pageX=n.pageX+i*Math.floor(Math.pow(1.1,r)),n.pageY=n.pageY+i*Math.floor(Math.pow(1.1,r)),lt.call(this,n),tt.call(this,n),++r}function wi(){var u;if(t.shared.$video_resizer?(r=t.shared.$video_resizer,e=t.shared.$vid_overlay,t.events.on("destroy",function(){r.removeClass("fr-active").appendTo(n("body:first"))},!0)):(t.shared.$video_resizer=n('<div class="fr-video-resizer"><\/div>'),r=t.shared.$video_resizer,t.events.$on(r,"mousedown",function(n){n.stopPropagation()},!0),t.opts.videoResize&&(r.append(k("nw")+k("ne")+k("sw")+k("se")),t.shared.$vid_overlay=n('<div class="fr-video-overlay"><\/div>'),e=t.shared.$vid_overlay,u=r.get(0).ownerDocument,n(u).find("body:first").append(e))),t.events.on("shared.destroy",function(){r.html("").removeData().remove();r=null;t.opts.videoResize&&(e.remove(),e=null)},!0),t.helpers.isMobile()||t.events.$on(n(t.o_win),"resize.video",function(){s(!0)}),t.opts.videoResize){u=r.get(0).ownerDocument;t.events.$on(r,t._mousedown,".fr-handler",ct);t.events.$on(n(u),t._mousemove,lt);t.events.$on(n(u.defaultView||u.parentWindow),t._mouseup,tt);t.events.$on(e,"mouseleave",tt);var f=1,o=null,h=0;t.events.on("keydown",function(r){if(i){var e=-1!=navigator.userAgent.indexOf("Mac OS X")?r.metaKey:r.ctrlKey,u=r.which;(u!==o||r.timeStamp-h>200)&&(f=1);(u==n.FE.KEYCODE.EQUALS||t.browser.mozilla&&u==n.FE.KEYCODE.FF_EQUALS)&&e&&!r.altKey?f=at.call(this,r,1,1,f):(u==n.FE.KEYCODE.HYPHEN||t.browser.mozilla&&u==n.FE.KEYCODE.FF_HYPHEN)&&e&&!r.altKey&&(f=at.call(this,r,2,-1,f));o=u;h=r.timeStamp}});t.events.on("keyup",function(){f=1})}}function vt(){for(var r=Array.prototype.slice.call(t.el.querySelectorAll("video")),u=[],i=0;i<r.length;i++)u.push(r[i].getAttribute("src")),n(r[i]).toggleClass("fr-draggable",t.opts.videoMove),""===r[i].getAttribute("class")&&r[i].removeAttribute("class"),""===r[i].getAttribute("style")&&r[i].removeAttribute("style");if(y)for(i=0;i<y.length;i++)u.indexOf(y[i].getAttribute("src"))<0&&t.events.trigger("video.removed",[n(y[i])]);y=r}function a(){r||wi();(t.$wp||t.$sc).append(r);r.data("instance",t);var n=i.find("iframe, embed, video");r.css("top",(t.opts.iframe?n.offset().top-1+t.$iframe.position().top:n.offset().top-t.$wp.offset().top-1)+t.$wp.scrollTop()).css("left",(t.opts.iframe?n.offset().left-1:n.offset().left-t.$wp.offset().left-1)+t.$wp.scrollLeft()).css("width",n.outerWidth()).css("height",n.height()).addClass("fr-active")}function yt(r){if(r&&"touchend"==r.type&&ot)return!0;if(r&&t.edit.isDisabled())return r.stopPropagation(),r.preventDefault(),!1;if(t.edit.isDisabled())return!1;for(var u=0;u<n.FE.INSTANCES.length;u++)n.FE.INSTANCES[u]!=t&&n.FE.INSTANCES[u].events.trigger("video.hideResizer");t.toolbar.disable();t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur());i=n(this);n(this).addClass("fr-active");t.opts.iframe&&t.size.syncIframe();ft();a();p();t.selection.clear();t.button.bulkRefresh();t.events.trigger("image.hideResizer")}function s(n){i&&(ki()||!0===n)&&(r.removeClass("fr-active"),t.toolbar.enable(),i.removeClass("fr-active"),i=null,it())}function bi(){t.shared.vid_exit_flag=!0}function it(){t.shared.vid_exit_flag=!1}function ki(){return t.shared.vid_exit_flag}function di(i){var r=i.originalEvent.dataTransfer,u,e;if(r&&r.files&&r.files.length&&(u=r.files[0],u&&u.type&&-1!==u.type.indexOf("video")))return t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(n.FE.MARKERS),t.popups.hideAll(),e=t.popups.get("video.insert"),e||(e=l()),t.popups.setContainer("video.insert",t.$sc),t.popups.show("video.insert",i.originalEvent.pageX,i.originalEvent.pageY),w(),t.opts.videoAllowedTypes.indexOf(u.type.replace(/video\//g,""))>=0?pt(r.files):f(et),i.preventDefault(),i.stopPropagation(),!1}function pt(n){var o,r,e,s,u,h;if(void 0!==n&&n.length>0){if(!1===t.events.trigger("video.beforeUpload",[n]))return!1;if(o=n[0],o.size>t.opts.videoMaxSize)return f(gt),!1;if(t.opts.videoAllowedTypes.indexOf(o.type.replace(/video\//g,""))<0)return f(et),!1;if(t.drag_support.formdata&&(r=t.drag_support.formdata?new FormData:null),r){if(!1!==t.opts.videoUploadToS3){r.append("key",t.opts.videoUploadToS3.keyStart+(new Date).getTime()+"-"+(o.name||"untitled"));r.append("success_action_status","201");r.append("X-Requested-With","xhr");r.append("Content-Type",o.type);for(e in t.opts.videoUploadToS3.params)t.opts.videoUploadToS3.params.hasOwnProperty(e)&&r.append(e,t.opts.videoUploadToS3.params[e])}for(e in t.opts.videoUploadParams)t.opts.videoUploadParams.hasOwnProperty(e)&&r.append(e,t.opts.videoUploadParams[e]);r.append(t.opts.videoUploadParam,o);s=t.opts.videoUploadURL;t.opts.videoUploadToS3&&(s=t.opts.videoUploadToS3.uploadURL?t.opts.videoUploadToS3.uploadURL:"https://"+t.opts.videoUploadToS3.region+".amazonaws.com/"+t.opts.videoUploadToS3.bucket);u=t.core.getXHR(s,t.opts.videoUploadMethod);u.onload=function(){li.call(u,i)};u.onerror=ai;u.upload.onprogress=vi;u.onabort=yi;w();t.events.disableBlur();t.edit.off();t.events.enableBlur();h=t.popups.get("video.insert");h&&h.off("abortUpload").on("abortUpload",function(){4!=u.readyState&&u.abort()});u.send(r)}}}function gi(i){t.events.$on(i,"dragover dragenter",".fr-video-upload-layer",function(){return n(this).addClass("fr-drop"),!1},!0);t.events.$on(i,"dragleave dragend",".fr-video-upload-layer",function(){return n(this).removeClass("fr-drop"),!1},!0);t.events.$on(i,"drop",".fr-video-upload-layer",function(r){var u,f;r.preventDefault();r.stopPropagation();n(this).removeClass("fr-drop");u=r.originalEvent.dataTransfer;u&&u.files&&(f=i.data("instance")||t,f.events.disableBlur(),f.video.upload(u.files),f.events.enableBlur())},!0);t.helpers.isIOS()&&t.events.$on(i,"touchstart",'.fr-video-upload-layer input[type="file"]',function(){n(this).trigger("click")},!0);t.events.$on(i,"change",'.fr-video-upload-layer input[type="file"]',function(){if(this.files){var r=i.data("instance")||t;r.events.disableBlur();i.find("input:focus").blur();r.events.enableBlur();r.video.upload(this.files)}n(this).val("")},!0)}function nr(){t.events.on("drop",di,!0);t.events.on("mousedown window.mousedown",bi);t.events.on("window.touchmove",it);t.events.on("mouseup window.mouseup",s);t.events.on("commands.mousedown",function(n){n.parents(".fr-toolbar").length>0&&s()});t.events.on("blur video.hideResizer commands.undo commands.redo element.dropped",function(){s(!0)})}function f(n,r){t.edit.on();i&&i.find("video").addClass("fr-error");ei(t.language.translate("Something went wrong. Please try again."));t.events.trigger("video.error",[{code:n,message:o[n]},r])}function tr(){var n="",r,u;return t.opts.videoEditButtons.length>0?(n+='<div class="fr-buttons">',n+=t.button.buildList(t.opts.videoEditButtons),n+="<\/div>",r={buttons:n},u=t.popups.create("video.edit",r),t.events.$on(t.$wp,"scroll.video-edit",function(){i&&t.popups.isVisible("video.edit")&&(t.events.disableBlur(),nt(i))}),u):!1}function ir(){if(i){var r=t.popups.get("video.size"),n=i.find("iframe, embed, video");r.find('input[name="width"]').val(n.get(0).style.width||n.attr("width")).trigger("change");r.find('input[name="height"]').val(n.get(0).style.height||n.attr("height")).trigger("change")}}function rr(){var r=t.popups.get("video.size");r||(r=wt());h();t.popups.refresh("video.size");t.popups.setContainer("video.size",t.$sc);var n=i.find("iframe, embed, video"),u=n.offset().left+n.width()/2,f=n.offset().top+n.height();t.popups.show("video.size",u,f,n.height())}function wt(n){var r,u,f,e;return n?(t.popups.onRefresh("video.size",ir),!0):(r="",r='<div class="fr-buttons">'+t.button.buildList(t.opts.videoSizeButtons)+"<\/div>",u="",u='<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+t.id+'"><div class="fr-video-group"><div class="fr-input-line"><input id="fr-video-size-layer-width-'+t.id+'" type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"><\/div><div class="fr-input-line"><input id="fr-video-size-layer-height-'+t.id+'" type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"><\/div><\/div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2" role="button">'+t.language.translate("Update")+"<\/button><\/div><\/div>",f={buttons:r,size_layer:u},e=t.popups.create("video.size",f),t.events.$on(t.$wp,"scroll",function(){i&&t.popups.isVisible("video.size")&&(t.events.disableBlur(),nt(i))}),e)}function v(n){if(void 0===n&&(n=i),n){if(n.hasClass("fr-fvl"))return"left";if(n.hasClass("fr-fvr"))return"right";if(n.hasClass("fr-dvb")||n.hasClass("fr-dvi"))return"center";if("block"==n.css("display")){if("left"==n.css("text-algin"))return"left";if("right"==n.css("text-align"))return"right"}else{if("left"==n.css("float"))return"left";if("right"==n.css("float"))return"right"}}return"center"}function ur(n){i.removeClass("fr-fvr fr-fvl");!t.opts.htmlUntouched&&t.opts.useClasses?"left"==n?i.addClass("fr-fvl"):"right"==n&&i.addClass("fr-fvr"):d(i,rt(),n);ft();a();p();t.selection.clear()}function fr(n){if(!i)return!1;n.find("> *:first").replaceWith(t.icon.create("video-align-"+v()))}function er(n,t){i&&t.find('.fr-command[data-param1="'+v()+'"]').addClass("fr-active").attr("aria-selected",!0)}function rt(n){void 0===n&&(n=i);var t=n.css("float");return n.css("float","none"),"block"==n.css("display")?(n.css("float",""),n.css("float")!=t&&n.css("float",t),"block"):(n.css("float",""),n.css("float")!=t&&n.css("float",t),"inline")}function or(n){i.removeClass("fr-dvi fr-dvb");!t.opts.htmlUntouched&&t.opts.useClasses?"inline"==n?i.addClass("fr-dvi"):"block"==n&&i.addClass("fr-dvb"):d(i,n,v());ft();a();p();t.selection.clear()}function sr(n,t){i&&t.find('.fr-command[data-param1="'+rt()+'"]').addClass("fr-active").attr("aria-selected",!0)}function hr(){var n=t.popups.get("video.insert"),r,u;n||(n=l());t.popups.isVisible("video.insert")||(h(),t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$sc));r=i.offset().left+i.width()/2;u=i.offset().top+i.height();t.popups.show("video.insert",r,u,i.outerHeight())}function ut(){if(i&&!1!==t.events.trigger("video.beforeRemove",[i])){var n=i;t.popups.hideAll();s(!0);t.selection.setBefore(n.get(0))||t.selection.setAfter(n.get(0));n.remove();t.selection.restore();t.html.fillEmptyBlocks();t.events.trigger("video.removed",[n])}}function cr(){h()}function d(n,i,r){!t.opts.htmlUntouched&&t.opts.useClasses?(n.removeClass("fr-fvl fr-fvr fr-dvb fr-dvi"),n.addClass("fr-fv"+r[0]+" fr-dv"+i[0])):"inline"==i?(n.css({display:"inline-block"}),"center"==r?n.css({float:"none"}):"left"==r?n.css({float:"left"}):n.css({float:"right"})):(n.css({display:"block",clear:"both"}),"left"==r?n.css({textAlign:"left"}):"right"==r?n.css({textAlign:"right"}):n.css({textAlign:"center"}))}function lr(n){n.hasClass("fr-dvi")||n.hasClass("fr-dvb")||(n.addClass("fr-fv"+v(n)[0]),n.addClass("fr-dv"+rt(n)[0]))}function ar(n){d(n,n.hasClass("fr-dvb")?"block":n.hasClass("fr-dvi")?"inline":null,n.hasClass("fr-fvl")?"left":n.hasClass("fr-fvr")?"right":v(n));n.removeClass("fr-dvb fr-dvi fr-fvr fr-fvl")}function bt(){var i,r,u;for(t.$el.find("video").filter(function(){return 0===n(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"><\/span>'),t.$el.find("embed, iframe").filter(function(){var u,i,r;if(t.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),n(this).parents("span.fr-video").length>0)return!1;for(u=n(this).attr("src"),i=0;i<n.FE.VIDEO_PROVIDERS.length;i++)if(r=n.FE.VIDEO_PROVIDERS[i],r.test_regex.test(u)&&new RegExp(t.opts.videoAllowedProviders.join("|")).test(r.provider))return!0;return!1}).map(function(){return 0===n(this).parents("object").length?this:n(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"><\/span>'),i=t.$el.find("span.fr-video, video"),r=0;r<i.length;r++)u=n(i[r]),!t.opts.htmlUntouched&&t.opts.useClasses?(lr(u),t.opts.videoTextNear||u.removeClass("fr-dvi").addClass("fr-dvb")):t.opts.htmlUntouched||t.opts.useClasses||ar(u);i.toggleClass("fr-draggable",t.opts.videoMove)}function vr(){nr();t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","span.fr-video",function(){ot=!1}),t.events.$on(t.$el,"touchmove",function(){ot=!0}));t.events.on("html.set",bt);bt();t.events.$on(t.$el,"mousedown","span.fr-video",function(n){n.stopPropagation()});t.events.$on(t.$el,"click touchend","span.fr-video",yt);t.events.on("keydown",function(r){var u=r.which;return!i||u!=n.FE.KEYCODE.BACKSPACE&&u!=n.FE.KEYCODE.DELETE?i&&u==n.FE.KEYCODE.ESC?(s(!0),r.preventDefault(),!1):i&&u!=n.FE.KEYCODE.F10&&!t.keys.isBrowserAction(r)?(r.preventDefault(),!1):void 0:(r.preventDefault(),ut(),t.undo.saveStep(),!1)},!0);t.events.on("toolbar.esc",function(){if(i)return t.events.disableBlur(),t.events.focus(),!1},!0);t.events.on("toolbar.focusEditor",function(){if(i)return!1},!0);t.events.on("keydown",function(){t.$el.find("span.fr-video:empty").remove()});l(!0);wt(!0)}function ft(){if(i){t.selection.clear();var n=t.doc.createRange();n.selectNode(i.get(0));t.selection.get().addRange(n)}}function yr(){i?(t.events.disableBlur(),i.trigger("click")):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("video.insert"),t.toolbar.showInline())}function pr(n,r){if(i){var f=t.popups.get("video.size"),u=i.find("iframe, embed, video");u.css("width",n||f.find('input[name="width"]').val());u.css("height",r||f.find('input[name="height"]').val());u.get(0).style.width&&u.removeAttr("width");u.get(0).style.height&&u.removeAttr("height");f.find("input:focus").blur();setTimeout(function(){i.trigger("click")},t.helpers.isAndroid()?50:0)}}function wr(){return i}var e,u,r,i,kt=2,dt=3,c=4,gt=5,et=6,o={},y,ot;return o[1]="Video cannot be loaded from the passed link.",o[kt]="No link in upload response.",o[dt]="Error during file upload.",o[c]="Parsing response failed.",o[gt]="File is too large.",o[et]="Video file type is invalid.",o[7]="Files can be uploaded only to same domain in IE 8 and IE 9.",t.shared.vid_exit_flag=!1,{_init:vr,showInsertPopup:ti,showLayer:ii,refreshByURLButton:ri,refreshEmbedButton:ui,refreshUploadButton:fi,upload:pt,insertByURL:oi,insertEmbed:si,insert:g,align:ur,refreshAlign:fr,refreshAlignOnShow:er,display:or,refreshDisplayOnShow:sr,remove:ut,hideProgressBar:h,showSizePopup:rr,replace:hr,back:yr,setSize:pr,get:wr}};n.FE.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()},plugin:"video"});n.FE.DefineIcon("insertVideo",{NAME:"video-camera"});n.FE.DefineIcon("videoByURL",{NAME:"link"});n.FE.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-by-url")},refresh:function(n){this.video.refreshByURLButton(n)}});n.FE.DefineIcon("videoEmbed",{NAME:"code"});n.FE.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-embed")},refresh:function(n){this.video.refreshEmbedButton(n)}});n.FE.DefineIcon("videoUpload",{NAME:"upload"});n.FE.RegisterCommand("videoUpload",{title:"Upload Video",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-upload")},refresh:function(n){this.video.refreshUploadButton(n)}});n.FE.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}});n.FE.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}});n.FE.DefineIcon("videoDisplay",{NAME:"star"});n.FE.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(n,t){this.video.display(t)},refresh:function(n){this.opts.videoTextNear||n.addClass("fr-hidden")},refreshOnShow:function(n,t){this.video.refreshDisplayOnShow(n,t)}});n.FE.DefineIcon("video-align",{NAME:"align-left"});n.FE.DefineIcon("video-align-left",{NAME:"align-left"});n.FE.DefineIcon("video-align-right",{NAME:"align-right"});n.FE.DefineIcon("video-align-center",{NAME:"align-justify"});n.FE.DefineIcon("videoAlign",{NAME:"align-center"});n.FE.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var r='<ul class="fr-dropdown-list" role="presentation">',i=n.FE.COMMANDS.videoAlign.options;for(var t in i)i.hasOwnProperty(t)&&(r+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="videoAlign" data-param1="'+t+'" title="'+this.language.translate(i[t])+'">'+this.icon.create("video-align-"+t)+'<span class="fr-sr-only">'+this.language.translate(i[t])+"<\/span><\/a><\/li>");return r+"<\/ul>"},callback:function(n,t){this.video.align(t)},refresh:function(n){this.video.refreshAlign(n)},refreshOnShow:function(n,t){this.video.refreshAlignOnShow(n,t)}});n.FE.DefineIcon("videoReplace",{NAME:"exchange"});n.FE.RegisterCommand("videoReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.video.replace()}});n.FE.DefineIcon("videoRemove",{NAME:"trash"});n.FE.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}});n.FE.DefineIcon("videoSize",{NAME:"arrows-alt"});n.FE.RegisterCommand("videoSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.video.showSizePopup()}});n.FE.DefineIcon("videoBack",{NAME:"arrow-left"});n.FE.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(n){this.video.get()||this.opts.toolbarInline?(n.removeClass("fr-hidden"),n.next(".fr-separator").removeClass("fr-hidden")):(n.addClass("fr-hidden"),n.next(".fr-separator").addClass("fr-hidden"))}});n.FE.RegisterCommand("videoDismissError",{title:"OK",undo:!1,callback:function(){this.video.hideProgressBar(!0)}});n.FE.RegisterCommand("videoSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.video.setSize()}})}),function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof module=="object"&&module.exports?module.exports=function(t,i){return i===undefined&&(i=typeof window!="undefined"?require("jquery"):require("jquery")(t)),n(i)}:n(window.jQuery)}(function(n){n.FE.LANGUAGE.vi={translation:{"Type something":"Viết điều gì đó...",Bold:"Đậm",Italic:"Nghiêng",Underline:"Gạch chân",Strikethrough:"Gạch ngang chữ",Insert:"Chèn",Delete:"Xóa",Cancel:"Hủy",OK:"OK",Back:"Trở về",Remove:"Xóa",More:"Thêm",Update:"Cập nhật",Style:"Kiểu","Font Family":"Phông chữ","Font Size":"Cỡ chữ",Colors:"Màu sắc",Background:"Nền",Text:"Chữ","Paragraph Format":"Định dạng đoạn văn bản",Normal:"Normal",Code:"Code","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Paragraph Style":"Kiểu đoạn văn bản","Inline Style":"Kiểu dòng",Align:"Căn chỉnh","Align Left":"Căn trái","Align Center":"Căn giữa","Align Right":"Căn phải","Align Justify":"Căn đều",None:"Không","Ordered List":"Danh sách theo thứ tự","Unordered List":"Danh sách liệt kê","Decrease Indent":"Giảm căn lề","Increase Indent":"Tăng căn lề","Insert Link":"Chèn link","Open in new tab":"Mở trong tab mới","Open Link":"Mở link","Edit Link":"Sửa link",Unlink:"Bỏ link","Choose Link":"Chọn link","Insert Image":"Chèn hình","Upload Image":"Tải hình lên","By URL":"Bằng URL",Browse:"Duyệt file","Drop image":"Kéo thả hình","or click":"hoặc chọn","Manage Images":"Quản lý hình ảnh",Loading:"Đang tải",Deleting:"Đang xóa",Tags:"Tags","Are you sure? Image will be deleted.":"Bạn có chắc chắn? Hình ảnh sẽ bị xóa.",Replace:"Thay thế",Uploading:"Đang tải lên","Loading image":"Đang tải hình ảnh",Display:"Hiển thị",Inline:"Cùng dòng với chữ","Break Text":"Không cùng dòng với chữ","Alternate Text":"Thay thế chữ","Change Size":"Thay đổi kích cỡ",Width:"Chiều rộng",Height:"Chiều cao","Something went wrong. Please try again.":"Có lỗi xảy ra. Vui lòng thử lại sau.","Insert Video":"Chèn video","Embedded Code":"Mã nhúng","Insert Table":"Chèn bảng","Table Header":"Dòng đầu bảng","Remove Table":"Xóa bảng","Table Style":"Kiểu bảng","Horizontal Align":"Căn chỉnh chiều ngang",Row:"Dòng","Insert row above":"Chèn dòng phía trên","Insert row below":"Chèn dòng phía dưới","Delete row":"Xóa dòng",Column:"Cột","Insert column before":"Chèn cột bên trái","Insert column after":"Chèn cột bên phải","Delete column":"Xóa cột",Cell:"Ô bảng","Merge cells":"Gộp ô","Horizontal split":"Chia dòng","Vertical split":"Chia cột","Cell Background":"Màu nền","Vertical Align":"Căn chỉnh chiều dọc",Top:"Trên cùng",Middle:"Giữa",Bottom:"Dưới đáy","Align Top":"Căn trên","Align Middle":"Căn giữa","Align Bottom":"Căn dưới","Cell Style":"Kiểu ô","Upload File":"Tải file lên","Drop file":"Kéo thả file",Emoticons:"Biểu tượng cảm xúc",Break:"Ngắt dòng",Subscript:"Subscript",Superscript:"Superscript",Fullscreen:"Toàn màn hình","Insert Horizontal Line":"Chèn đường kẻ ngang văn bản","Clear Formatting":"Xóa định dạng",Undo:"Undo",Redo:"Redo","Select All":"Chọn tất cả","Code View":"Xem dạng code",Quote:"Trích dẫn",Increase:"Tăng",Decrease:"Giảm","Quick Insert":"Chèn nhanh"},direction:"ltr"}});